LEMMA	  Let MATH be a quasi-finite ring map. Given two factorizations MATH and MATH with MATH and MATH finite and MATH and MATH open immersions, there exists an MATH-subalgebra MATH finite over MATH such that MATH an open immersion and MATH and MATH factor through MATH.  
LEMMA	  The module (REF) is well defined, i.e., independent of the choice of the factorization.  
LEMMA	  Let MATH be a quasi-finite map of Noetherian rings. <CASES> CASE: If MATH factors as MATH for some MATH, then MATH. CASE: If MATH, then MATH. CASE: If MATH, then MATH. </CASES>  
LEMMA	  The base change map (REF) is independent of the choice of the factorization MATH. Given ring maps MATH the composition of the base change maps for MATH and MATH is the base change map for MATH.  
LEMMA	  If MATH is flat, then the base change map (REF) induces an isomorphism MATH.  
LEMMA	  Let MATH be quasi-finite homomorphisms of Noetherian rings. There is a canonical map MATH.  
LEMMA	  Let MATH and MATH be quasi-finite maps of Noetherian rings. Then MATH as modules over MATH.  
LEMMA	  Let MATH be a quasi-finite homomorphism of Noetherian rings. Then MATH is the set of primes of MATH lying over associated primes of MATH.  
LEMMA	  Let MATH be a flat quasi-finite homomorphism of Noetherian rings. Then MATH is a flat MATH-module.  
LEMMA	  If MATH is flat, then the base change map (REF) induces an isomorphism MATH.  
LEMMA	  Let MATH be a quasi-finite homomorphism of Noetherian rings. Let MATH be the algebraic relative dualizing complex discussed in Dualizing Complexes, Section REF. Then there is a (nonunique) isomorphism MATH.  
LEMMA	  Let MATH be a morphism of schemes which is finite locally free. Then MATH is etale if and only if its discriminant is empty.  
DEFNN	  Let MATH be a flat quasi-finite map of Noetherian rings. The trace element is the unique element MATH with the following property: for any Noetherian MATH-algebra MATH such that MATH comes with a product decomposition MATH with MATH finite the image of MATH in MATH is MATH. Here we use the base change map (REF) and Lemma REF to get MATH.  
LEMMA	  Let MATH be a flat quasi-finite map of Noetherian rings. Then there is at most one trace element in MATH.  
LEMMA	  Let MATH be a finite flat map of Noetherian rings. Then MATH is the trace element.  
LEMMA	  Let MATH be a flat quasi-finite map of Noetherian rings. Let MATH be a trace element. <CASES> CASE: If MATH is a map with MATH Noetherian, then with MATH the image of MATH in MATH is a trace element. CASE: If MATH, then MATH is a trace element in MATH. CASE: If MATH, then the image of MATH in MATH is a trace element. CASE: If MATH, then MATH maps to a trace element in both MATH and MATH. </CASES>  
LEMMA	  Let MATH be a flat quasi-finite map of Noetherian rings. Let MATH be elements generating the unit ideal. Let MATH be an element whose image in MATH is a trace element for MATH. Then MATH is a trace element.  
LEMMA	  Let MATH be a flat quasi-finite map of Noetherian rings. There exists a trace element MATH.  
LEMMA	  Let MATH be a field and let MATH be a finite MATH-algebra. Assume MATH is local with residue field MATH. The following are equivalent <CASES> CASE: MATH is nonzero, CASE: MATH is nonzero, and CASE: MATH is separable and MATH is prime to the characteristic of MATH. </CASES>  
LEMMA	  Let MATH, MATH be ring maps. Set MATH. <CASES> CASE: The annihilator MATH of MATH is MATH where MATH is the annihilator of MATH. CASE: The Noether different MATH of MATH over MATH is MATH, where MATH is the Noether different of MATH over MATH. </CASES>  
LEMMA	  Let MATH be a finite type ring map. Let MATH be a flat ring map. Set MATH. <CASES> CASE: The annihilator MATH of MATH is MATH where MATH is the annihilator of MATH. CASE: The Noether different MATH of MATH over MATH is MATH, where MATH is the Noether different of MATH over MATH. </CASES>  
LEMMA	  Let MATH be ring maps with MATH of finite type and MATH inducing an open immersion of spectra. <CASES> CASE: The annihilator MATH of MATH is MATH where MATH is the annihilator of MATH. CASE: The Noether different MATH of MATH over MATH is MATH, where MATH is the Noether different of MATH over MATH. </CASES>  
LEMMA	  Let MATH be a quasi-finite homomorphism of Noetherian rings. <CASES> CASE: If MATH is a flat map of Noetherian rings, then MATH is commutative where notation as in Lemma REF and horizontal arrows are given by (REF). CASE: If MATH, then MATH is commutative for MATH where notation as in Lemma REF and horizontal arrows are given by (REF). </CASES>  
LEMMA	  Let MATH be a flat quasi-finite homomorphism of Noetherian rings. The pairing of Remark REF induces an isomorphism MATH.  
LEMMA	  Let MATH be a flat quasi-finite homomorphism of Noetherian rings. The diagram MATH commutes where the horizontal arrow is the isomorphism of Lemma REF. Hence the Noether different of MATH over MATH is the image of the map MATH.  
LEMMA	  Let MATH be a finite type ring map. Let MATH be the Noether different. Then MATH is the set of primes MATH such that MATH is not unramified at MATH.  
DEFNN	  Let MATH be a morphism of schemes which is locally of finite type. The Kahler different is the MATHth fitting ideal of MATH.  
LEMMA	  Consider a cartesian diagram of schemes MATH with MATH locally of finite type. Let MATH, resp.\ MATH be the closed subscheme cut out by the Kahler different of MATH, resp.\ MATH. Then MATH induces an isomorphism MATH.  
LEMMA	  Let MATH be a morphism of schemes which is locally of finite type. Let MATH be the closed subscheme defined by the Kahler different. Then MATH is exactly the set of points where MATH is not unramified.  
LEMMA	  Let MATH be a ring. Let MATH and MATH. Set MATH. The Kahler different of MATH over MATH is the ideal of MATH generated by MATH.  
LEMMA	  Assume the Dedekind different of MATH is defined. Consider the statements <CASES> CASE: MATH is flat, CASE: MATH is a normal ring, CASE: MATH, CASE: MATH, and CASE: the Dedekind different MATH is an ideal of MATH. </CASES> Then we have (1) MATH (3), (2) MATH (3), (3) MATH (4), and (4) MATH (5).  
LEMMA	  If the Dedekind different of MATH is defined, then there is a canonical isomorphism MATH.  
LEMMA	  If the Dedekind different of MATH is defined and MATH is flat, then <CASES> CASE: the canonical isomorphism MATH sends MATH to the trace element MATH, and CASE: the Dedekind different is MATH. </CASES>  
DEFNN	  Let MATH be a flat locally quasi-finite morphism of locally Noetherian schemes. Let MATH be the relative dualizing module and let MATH be the trace element (Remarks REF and REF). The annihilator of MATH is the different of MATH. It is a coherent ideal MATH.  
LEMMA	  Let MATH be a flat quasi-finite morphism of Noetherian schemes. Let MATH, MATH be affine open subschemes with MATH. If the Dedekind different of MATH is defined, then MATH as coherent ideal sheaves on MATH.  
LEMMA	  Let MATH be a flat quasi-finite morphism of Noetherian schemes. Let MATH, MATH be affine open subschemes with MATH. If MATH is invertible, i.e., if MATH is an invertible MATH-module, then MATH as coherent ideal sheaves on MATH where MATH is the Noether different of MATH over MATH.  
LEMMA	  Consider a cartesian diagram of Noetherian schemes MATH with MATH flat and quasi-finite. Let MATH, resp.\ MATH be the closed subscheme cut out by the different MATH, resp.\ MATH. Then MATH induces a bijective closed immersion MATH. If MATH is flat or if MATH is invertible, then MATH.  
LEMMA	  Let MATH be a finite flat morphism of Noetherian schemes. Then MATH maps MATH into the ideal sheaf of the discriminant MATH.  
LEMMA	  Let MATH be a flat quasi-finite morphism of Noetherian schemes. The closed subscheme MATH defined by the different MATH is exactly the set of points where MATH is not etale (equivalently not unramified).  
LEMMA	  Let MATH be a flat quasi-finite morphism of Noetherian schemes. Let MATH be the closed subscheme defined by MATH. <CASES> CASE: If MATH is invertible, then MATH is a locally principal closed subscheme of MATH. CASE: If MATH is invertible and MATH is finite, then the norm of MATH is the discriminant MATH of MATH. CASE: If MATH is invertible and MATH is etale at the associated points of MATH, then MATH is an effective Cartier divisor and there is an isomorphism MATH. </CASES>  
LEMMA	  Let MATH be a morphism of schemes. The following are equivalent <CASES> CASE: MATH is locally quasi-finite and syntomic, CASE: MATH is locally quasi-finite, flat, and a local complete intersection morphism, CASE: MATH is locally quasi-finite, flat, locally of finite presentation, and the fibres of MATH are local complete intersections, CASE: MATH is locally quasi-finite and for every MATH there are affine opens MATH, MATH with MATH an integer MATH and MATH such that MATH, CASE: for every MATH there are affine opens MATH, MATH with MATH such that MATH is a relative global complete intersection of the form MATH, CASE: MATH is locally quasi-finite, flat, locally of finite presentation, and MATH has tor-amplitude in MATH, and CASE: MATH is flat, locally of finite presentation, MATH is perfect of rank MATH with tor-amplitude in MATH, </CASES>  
LEMMA	  Invertibility of the relative dualizing module. <CASES> CASE: If MATH is a quasi-finite flat homomorphism of Noetherian rings, then MATH is an invertible MATH-module if and only if MATH is an invertible MATH-module for all primes MATH. CASE: If MATH is a quasi-finite flat morphism of Noetherian schemes, then MATH is invertible if and only if MATH is invertible for all MATH. </CASES>  
LEMMA	  Let MATH be a field. Let MATH be a global complete intersection over MATH of dimension MATH. Then MATH is invertible.  
LEMMA	  Let MATH be a morphism of locally Noetherian schemes. If MATH satisfies the equivalent conditions of Lemma REF then MATH is an invertible MATH-module.  
LEMMA	  With notation as in Example REF the schemes MATH and MATH are regular and irreducible, the morphism MATH is locally quasi-finite and syntomic, and there is a dense open subscheme MATH such that MATH restricts to an etale morphism MATH.  
LEMMA	  Let MATH be a morphism of schemes. If MATH satisfies the equivalent conditions of Lemma REF then for every MATH there exist MATH and a commutative diagram MATH where MATH and MATH are open, where MATH is as in Example REF, and where the square on the right hand side is cartesian.  
LEMMA	  Let MATH be a morphism of schemes. The following are equivalent <CASES> CASE: MATH is finite and syntomic, CASE: MATH is finite, flat, and a local complete intersection morphism, CASE: MATH is finite, flat, locally of finite presentation, and the fibres of MATH are local complete intersections, CASE: MATH is finite and for every MATH there is an affine open MATH an integer MATH and MATH such that MATH is isomorphic to the spectrum of MATH, CASE: MATH is finite, flat, locally of finite presentation, and MATH has tor-amplitude in MATH, and CASE: MATH is finite, flat, locally of finite presentation, and MATH is perfect of rank MATH with tor-amplitude in MATH, </CASES>  
LEMMA	  With notation as in Example REF there is an open subscheme MATH with the following property: a morphism of schemes MATH factors through MATH if and only if MATH is syntomic.  
LEMMA	  With notation as in Example REF and MATH as in Lemma REF then MATH is smooth over MATH.  
LEMMA	  With notation as in Example REF consider the open subscheme MATH over which MATH is etale. Then MATH is a dense subset of the open MATH of Lemma REF.  
LEMMA	  Let MATH be a morphism of schemes. If MATH satisfies the equivalent conditions of Lemma REF then for every MATH there exist a MATH and a commutative diagram MATH with the following properties <CASES> CASE: MATH is open, MATH, and MATH, CASE: MATH is as in Example REF, CASE: MATH is as in Lemma REF and MATH, CASE: where the middle square is cartesian. </CASES>  
LEMMA	  REF Let MATH be a ring map. Let MATH be a Koszul regular sequence. Assume MATH is flat over MATH. Let MATH be a Koszul regular sequence generating the kernel of the multiplication map MATH. Write MATH. Then the annihilator of MATH is a principal ideal generated by the image of MATH.  
LEMMA	  Let MATH be a ring. Let MATH and MATH. Set MATH. Assume that MATH is quasi-finite over MATH. Then <CASES> CASE: MATH is flat over MATH and MATH is a relative local complete intersection, CASE: the annihilator MATH of MATH is free of rank MATH over MATH, CASE: the Noether different of MATH over MATH is generated by MATH in MATH. </CASES>  
LEMMA	  Let MATH be a morphism of Noetherian schemes. If MATH satisfies the equivalent conditions of Lemma REF then the different MATH of MATH is the Kahler different of MATH.  
LEMMA	  Let MATH be a ring. Let MATH and MATH. Set MATH. Assume that MATH is quasi-finite over MATH. Then there is an isomorphism MATH mapping MATH to MATH.  
LEMMA	  Let MATH be a Noetherian scheme. Let MATH, MATH be smooth schemes of relative dimension MATH over MATH. Let MATH be a locally quasi-finite morphism over MATH. Then MATH is flat and the closed subscheme MATH cut out by the different of MATH is the locally principal closed subscheme cut out by MATH If MATH is etale at the associated points of MATH, then MATH is an effective Cartier divisor and MATH as invertible sheaves on MATH.  
PROPN	  There exists a unique rule that to every locally quasi-finite syntomic morphism of locally Noetherian schemes MATH assigns an isomorphism MATH satisfying the following two properties <CASES> CASE: the section MATH is mapped to MATH, and CASE: the rule is compatible with restriction to opens and with base change. </CASES>  
LEMMA	  Let MATH be a map of Noetherian rings. Consider the conditions <CASES> CASE: nonzerodivisors of MATH map to nonzerodivisors of MATH, CASE: (1) holds and MATH is flat, CASE: MATH is flat for every MATH, CASE: (3) holds and MATH is flat for every MATH lying over an element in MATH. </CASES> Then we have the following implications MATH If going up holds for MATH then (2) and (4) are equivalent.  
LEMMA	  Assume the Dedekind different is defined for MATH. Set MATH and MATH. The generalization of Remark REF applies to the morphism MATH if and only if MATH (e.g., if MATH is normal, see Lemma REF). In this case MATH is an ideal of MATH and we have MATH as coherent ideal sheaves on MATH.  
LEMMA	  Let MATH be a quasi-finite separated morphism of Noetherian schemes. For every pair of affine opens MATH, MATH with MATH there is an isomorphism MATH where MATH is as in Duality for Schemes, Section REF. These isomorphisms are compatible with restriction maps and define a canonical isomorphism MATH with MATH as in Remark REF. Similarly, if MATH is a quasi-finite morphism of schemes of finite type over a Noetherian base MATH endowed with a dualizing complex MATH, then MATH.  
LEMMA	  Let MATH be a finite flat morphism of Noetherian schemes. The map MATH of Section REF corresponds to a map MATH (see proof). Denote MATH the image of MATH. Via the isomorphism MATH of Lemma REF this agrees with the construction in Remark REF.  
LEMMA	  Let MATH be a quasi-finite morphism of Noetherian schemes. The following are equivalent <CASES> CASE: MATH is Gorenstein, CASE: MATH is flat and the fibres of MATH are Gorenstein, CASE: MATH is flat and MATH is invertible (Remark REF), CASE: for every MATH there are affine opens MATH, MATH with MATH such that MATH is flat and MATH is an invertible MATH-module. </CASES>  
