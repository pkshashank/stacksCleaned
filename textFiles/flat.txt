\begin{lemma} \label{lemma-lift-etale} Let $i : Z \to X$ be a closed immersion of affine schemes. Let $Z' \to Z$ be an \'etale morphism with $Z'$ affine. Then there exists an \'etale morphism $X' \to X$ with $X'$ affine such that $Z' \cong Z \times_X X'$ as schemes over $Z$. \end{lemma} 
\begin{lemma} \label{lemma-etale-at-point} Let $$ \xymatrix{ X \ar[d] & X' \ar[l] \ar[d] \\ S & S' \ar[l] } $$ be a commutative diagram of schemes with $X' \to X$ and $S' \to S$ \'etale. Let $s' \in S'$ be a point. Then $$ X' \times_{S'} \Spec(\mathcal{O}_{S', s'}) \longrightarrow X \times_S \Spec(\mathcal{O}_{S', s'}) $$ is \'etale. \end{lemma} 
\begin{lemma} \label{lemma-etale-flat-up-down} Let $X \to T \to S$ be morphisms of schemes with $T \to S$ \'etale. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. Let $x \in X$ be a point. Then $$ \mathcal{F}\text{ flat over }S\text{ at }x \Leftrightarrow \mathcal{F}\text{ flat over }T\text{ at }x $$ In particular $\mathcal{F}$ is flat over $S$ if and only if $\mathcal{F}$ is flat over $T$. \end{lemma} 
\begin{lemma} \label{lemma-etale-flat-up-down-local-ring} Let $T \to S$ be an \'etale morphism. Let $t \in T$ with image $s \in S$. Let $M$ be a $\mathcal{O}_{T, t}$-module. Then $$ M\text{ flat over }\mathcal{O}_{S, s} \Leftrightarrow M\text{ flat over }\mathcal{O}_{T, t}. $$ \end{lemma} 
\begin{lemma} \label{lemma-flat-up-down-henselization} Let $S$ be a scheme and $s \in S$ a point. Denote $\mathcal{O}_{S, s}^h$ (resp.\ $\mathcal{O}_{S, s}^{sh}$) the henselization (resp.\ strict henselization), see Algebra, Definition \ref{algebra-definition-henselization}. Let $M^{sh}$ be a $\mathcal{O}_{S, s}^{sh}$-module. The following are equivalent \begin{enumerate} \item $M^{sh}$ is flat over $\mathcal{O}_{S, s}$, \item $M^{sh}$ is flat over $\mathcal{O}_{S, s}^h$, and \item $M^{sh}$ is flat over $\mathcal{O}_{S, s}^{sh}$. \end{enumerate} If $M^{sh} = M^h \otimes_{\mathcal{O}_{S, s}^h} \mathcal{O}_{S, s}^{sh}$ this is also equivalent to \begin{enumerate} \item[(4)] $M^h$ is flat over $\mathcal{O}_{S, s}$, and \item[(5)] $M^h$ is flat over $\mathcal{O}_{S, s}^h$. \end{enumerate} If $M^h = M \otimes_{\mathcal{O}_{S, s}} \mathcal{O}_{S, s}^h$ this is also equivalent to \begin{enumerate} \item[(6)] $M$ is flat over $\mathcal{O}_{S, s}$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-tor-amplitude-up-down-henselization} Let $S$ be a scheme and $s \in S$ a point. Denote $\mathcal{O}_{S, s}^h$ (resp.\ $\mathcal{O}_{S, s}^{sh}$) the henselization (resp.\ strict henselization), see Algebra, Definition \ref{algebra-definition-henselization}. Let $M^{sh}$ be an object of $D(\mathcal{O}_{S, s}^{sh})$. Let $a, b \in \mathbf{Z}$. The following are equivalent \begin{enumerate} \item $M^{sh}$ has tor amplitude in $[a, b]$ over $\mathcal{O}_{S, s}$, \item $M^{sh}$ has tor amplitude in $[a, b]$ over $\mathcal{O}_{S, s}^h$, and \item $M^{sh}$ has tor amplitude in $[a, b]$ over $\mathcal{O}_{S, s}^{sh}$. \end{enumerate} If $M^{sh} = M^h \otimes_{\mathcal{O}_{S, s}^h}^\mathbf{L} \mathcal{O}_{S, s}^{sh}$ for $M^h \in D(\mathcal{O}_{S, s}^h)$ this is also equivalent to \begin{enumerate} \item[(4)] $M^h$ has tor amplitude in $[a, b]$ over $\mathcal{O}_{S, s}$, and \item[(5)] $M^h$ has tor amplitude in $[a, b]$ over $\mathcal{O}_{S, s}^h$. \end{enumerate} If $M^h = M \otimes_{\mathcal{O}_{S, s}}^\mathbf{L} \mathcal{O}_{S, s}^h$ for $M \in D(\mathcal{O}_{S, s})$ this is also equivalent to \begin{enumerate} \item[(6)] $M$ has tor amplitude in $[a, b]$ over $\mathcal{O}_{S, s}$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-finite-flat-weak-assassin-up-down} Let $g : T \to S$ be a finite flat morphism of schemes. Let $\mathcal{G}$ be a quasi-coherent $\mathcal{O}_S$-module. Let $t \in T$ be a point with image $s \in S$. Then $$ t \in \text{WeakAss}(g^*\mathcal{G}) \Leftrightarrow s \in \text{WeakAss}(\mathcal{G}) $$ \end{lemma} 
\begin{lemma} \label{lemma-etale-weak-assassin-up-down} Let $h : U \to S$ be an \'etale morphism of schemes. Let $\mathcal{G}$ be a quasi-coherent $\mathcal{O}_S$-module. Let $u \in U$ be a point with image $s \in S$. Then $$ u \in \text{WeakAss}(h^*\mathcal{G}) \Leftrightarrow s \in \text{WeakAss}(\mathcal{G}) $$ \end{lemma} 
\begin{lemma} \label{lemma-weakly-associated-henselization} Let $S$ be a scheme and $s \in S$ a point. Denote $\mathcal{O}_{S, s}^h$ (resp.\ $\mathcal{O}_{S, s}^{sh}$) the henselization (resp.\ strict henselization), see Algebra, Definition \ref{algebra-definition-henselization}. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_S$-module. The following are equivalent \begin{enumerate} \item $s$ is a weakly associated point of $\mathcal{F}$, \item $\mathfrak m_s$ is a weakly associated prime of $\mathcal{F}_s$, \item $\mathfrak m_s^h$ is a weakly associated prime of $\mathcal{F}_s \otimes_{\mathcal{O}_{S, s}} \mathcal{O}_{S, s}^h$, and \item $\mathfrak m_s^{sh}$ is a weakly associated prime of $\mathcal{F}_s \otimes_{\mathcal{O}_{S, s}} \mathcal{O}_{S, s}^{sh}$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-sheaf-lives-on-subscheme} Let $f : X \to S$ be a finite type morphism of affine schemes. Let $\mathcal{F}$ be a finite type quasi-coherent $\mathcal{O}_X$-module. Let $x \in X$ with image $s = f(x)$ in $S$. Set $\mathcal{F}_s = \mathcal{F}|_{X_s}$. Then there exist a closed immersion $i : Z \to X$ of finite presentation, and a quasi-coherent finite type $\mathcal{O}_Z$-module $\mathcal{G}$ such that $i_*\mathcal{G} = \mathcal{F}$ and $Z_s = \text{Supp}(\mathcal{F}_s)$. \end{lemma} 
\begin{lemma} \label{lemma-elementary-devissage} Let $f : X \to S$ be morphism of schemes which is locally of finite type. Let $\mathcal{F}$ be a finite type quasi-coherent $\mathcal{O}_X$-module. Let $x \in X$ with image $s = f(x)$ in $S$. Set $\mathcal{F}_s = \mathcal{F}|_{X_s}$ and $n = \dim_x(\text{Supp}(\mathcal{F}_s))$. Then we can construct \begin{enumerate} \item elementary \'etale neighbourhoods $g : (X', x') \to (X, x)$, $e : (S', s') \to (S, s)$, \item a commutative diagram $$ \xymatrix{ X \ar[dd]_f & X' \ar[dd] \ar[l]^g & Z' \ar[l]^i \ar[d]^\pi \\ & & Y' \ar[d]^h \\ S & S' \ar[l]_e & S' \ar@{=}[l] } $$ \item a point $z' \in Z'$ with $i(z') = x'$, $y' = \pi(z')$, $h(y') = s'$, \item a finite type quasi-coherent $\mathcal{O}_{Z'}$-module $\mathcal{G}$, \end{enumerate} such that the following properties hold \begin{enumerate} \item $X'$, $Z'$, $Y'$, $S'$ are affine schemes, \item $i$ is a closed immersion of finite presentation, \item $i_*(\mathcal{G}) \cong g^*\mathcal{F}$, \item $\pi$ is finite and $\pi^{-1}(\{y'\}) = \{z'\}$, \item the extension $\kappa(y')/\kappa(s')$ is purely transcendental, \item $h$ is smooth of relative dimension $n$ with geometrically integral fibres. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-devissage-finite-presentation} Assumptions and notation as in Lemma \ref{lemma-elementary-devissage}. If $f$ is locally of finite presentation then $\pi$ is of finite presentation. In this case the following are equivalent \begin{enumerate} \item $\mathcal{F}$ is an $\mathcal{O}_X$-module of finite presentation in a neighbourhood of $x$, \item $\mathcal{G}$ is an $\mathcal{O}_{Z'}$-module of finite presentation in a neighbourhood of $z'$, and \item $\pi_*\mathcal{G}$ is an $\mathcal{O}_{Y'}$-module of finite presentation in a neighbourhood of $y'$. \end{enumerate} Still assuming $f$ locally of finite presentation the following are equivalent to each other \begin{enumerate} \item[(a)] $\mathcal{F}_x$ is an $\mathcal{O}_{X, x}$-module of finite presentation, \item[(b)] $\mathcal{G}_{z'}$ is an $\mathcal{O}_{Z', z'}$-module of finite presentation, and \item[(c)] $(\pi_*\mathcal{G})_{y'}$ is an $\mathcal{O}_{Y', y'}$-module of finite presentation. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-devissage-flat} Assumptions and notation as in Lemma \ref{lemma-elementary-devissage}. The following are equivalent \begin{enumerate} \item $\mathcal{F}$ is flat over $S$ in a neighbourhood of $x$, \item $\mathcal{G}$ is flat over $S'$ in a neighbourhood of $z'$, and \item $\pi_*\mathcal{G}$ is flat over $S'$ in a neighbourhood of $y'$. \end{enumerate} The following are equivalent also \begin{enumerate} \item[(a)] $\mathcal{F}_x$ is flat over $\mathcal{O}_{S, s}$, \item[(b)] $\mathcal{G}_{z'}$ is flat over $\mathcal{O}_{S', s'}$, and \item[(c)] $(\pi_*\mathcal{G})_{y'}$ is flat over $\mathcal{O}_{S', s'}$. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-one-step-devissage} Let $S$ be a scheme. Let $X$ be locally of finite type over $S$. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module of finite type. Let $s \in S$ be a point. A {\it one step d\'evissage of $\mathcal{F}/X/S$ over $s$} is given by morphisms of schemes over $S$ $$ \xymatrix{ X & Z \ar[l]_i \ar[r]^\pi & Y } $$ and a quasi-coherent $\mathcal{O}_Z$-module $\mathcal{G}$ of finite type such that \begin{enumerate} \item $X$, $S$, $Z$ and $Y$ are affine, \item $i$ is a closed immersion of finite presentation, \item $\mathcal{F} \cong i_*\mathcal{G}$, \item $\pi$ is finite, and \item the structure morphism $Y \to S$ is smooth with geometrically irreducible fibres of dimension $\dim(\text{Supp}(\mathcal{F}_s))$. \end{enumerate} In this case we say $(Z, Y, i, \pi, \mathcal{G})$ is a one step d\'evissage of $\mathcal{F}/X/S$ over $s$. \end{definition} 
\begin{definition} \label{definition-one-step-devissage-at-x} Let $S$ be a scheme. Let $X$ be locally of finite type over $S$. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module of finite type. Let $x \in X$ be a point with image $s$ in $S$. A {\it one step d\'evissage of $\mathcal{F}/X/S$ at $x$} is a system $(Z, Y, i, \pi, \mathcal{G}, z, y)$, where $(Z, Y, i, \pi, \mathcal{G})$ is a one step d\'evissage of $\mathcal{F}/X/S$ over $s$ and \begin{enumerate} \item $\dim_x(\text{Supp}(\mathcal{F}_s)) = \dim(\text{Supp}(\mathcal{F}_s))$, \item $z \in Z$ is a point with $i(z) = x$ and $\pi(z) = y$, \item we have $\pi^{-1}(\{y\}) = \{z\}$, \item the extension $\kappa(y)/\kappa(s)$ is purely transcendental. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-elementary-devissage-variant} Let $f : X \to S$ be morphism of schemes which is locally of finite type. Let $\mathcal{F}$ be a finite type quasi-coherent $\mathcal{O}_X$-module. Let $x \in X$ with image $s = f(x)$ in $S$. Then there exists a commutative diagram of pointed schemes $$ \xymatrix{ (X, x) \ar[d]_f & (X', x') \ar[l]^g \ar[d] \\ (S, s) & (S', s') \ar[l] \\ } $$ such that $(S', s') \to (S, s)$ and $(X', x') \to (X, x)$ are elementary \'etale neighbourhoods, and such that $g^*\mathcal{F}/X'/S'$ has a one step d\'evissage at $x'$. \end{lemma} 
\begin{lemma} \label{lemma-base-change-one-step} Let $S$, $X$, $\mathcal{F}$, $s$ be as in Definition \ref{definition-one-step-devissage}. Let $(Z, Y, i, \pi, \mathcal{G})$ be a one step d\'evissage of $\mathcal{F}/X/S$ over $s$. Let $(S', s') \to (S, s)$ be any morphism of pointed schemes. Given this data let $X', Z', Y', i', \pi'$ be the base changes of $X, Z, Y, i, \pi$ via $S' \to S$. Let $\mathcal{F}'$ be the pullback of $\mathcal{F}$ to $X'$ and let $\mathcal{G}'$ be the pullback of $\mathcal{G}$ to $Z'$. If $S'$ is affine, then $(Z', Y', i', \pi', \mathcal{G}')$ is a one step d\'evissage of $\mathcal{F}'/X'/S'$ over $s'$. \end{lemma} 
\begin{lemma} \label{lemma-base-change-one-step-at-x} Let $S$, $X$, $\mathcal{F}$, $x$, $s$ be as in Definition \ref{definition-one-step-devissage-at-x}. Let $(Z, Y, i, \pi, \mathcal{G}, z, y)$ be a one step d\'evissage of $\mathcal{F}/X/S$ at $x$. Let $(S', s') \to (S, s)$ be a morphism of pointed schemes which induces an isomorphism $\kappa(s) = \kappa(s')$. Let $(Z', Y', i', \pi', \mathcal{G}')$ be as constructed in Lemma \ref{lemma-base-change-one-step} and let $x' \in X'$ (resp.\ $z' \in Z'$, $y' \in Y'$) be the unique point mapping to both $x \in X$ (resp.\ $z \in Z$, $y \in Y$) and $s' \in S'$. If $S'$ is affine, then $(Z', Y', i', \pi', \mathcal{G}', z', y')$ is a one step d\'evissage of $\mathcal{F}'/X'/S'$ at $x'$. \end{lemma} 
\begin{definition} \label{definition-shrink} Let $S$, $X$, $\mathcal{F}$, $x$, $s$ be as in Definition \ref{definition-one-step-devissage-at-x}. Let $(Z, Y, i, \pi, \mathcal{G}, z, y)$ be a one step d\'evissage of $\mathcal{F}/X/S$ at $x$. Let us define a {\it standard shrinking} of this situation to be given by standard opens $S' \subset S$, $X' \subset X$, $Z' \subset Z$, and $Y' \subset Y$ such that $s \in S'$, $x \in X'$, $z \in Z'$, and $y \in Y'$ and such that $$ (Z', Y', i|_{Z'}, \pi|_{Z'}, \mathcal{G}|_{Z'}, z, y) $$ is a one step d\'evissage of $\mathcal{F}|_{X'}/X'/S'$ at $x$. \end{definition} 
\begin{lemma} \label{lemma-shrink} With assumption and notation as in Definition \ref{definition-shrink} we have: \begin{enumerate} \item \label{item-shrink-base} If $S' \subset S$ is a standard open neighbourhood of $s$, then setting $X' = X_{S'}$, $Z' = Z_{S'}$ and $Y' = Y_{S'}$ we obtain a standard shrinking. \item \label{item-shrink-on-Y} Let $W \subset Y$ be a standard open neighbourhood of $y$. Then there exists a standard shrinking with $Y' = W \times_S S'$. \item \label{item-shrink-on-X} Let $U \subset X$ be an open neighbourhood of $x$. Then there exists a standard shrinking with $X' \subset U$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-elementary-etale-neighbourhood} Let $S$, $X$, $\mathcal{F}$, $x$, $s$ be as in Definition \ref{definition-one-step-devissage-at-x}. Let $(Z, Y, i, \pi, \mathcal{G}, z, y)$ be a one step d\'evissage of $\mathcal{F}/X/S$ at $x$. Let $$ \xymatrix{ (Y, y) \ar[d] & (Y', y') \ar[l] \ar[d] \\ (S, s) & (S', s') \ar[l] } $$ be a commutative diagram of pointed schemes such that the horizontal arrows are elementary \'etale neighbourhoods. Then there exists a commutative diagram $$ \xymatrix{ & & (X'', x'') \ar[lld] \ar[d] & (Z'', z'') \ar[l] \ar[lld] \ar[d] \\ (X, x) \ar[d] & (Z, z) \ar[l] \ar[d] & (S'', s'') \ar[lld] & (Y'', y'') \ar[lld] \ar[l] \\ (S, s) & (Y, y) \ar[l] } $$ of pointed schemes with the following properties: \begin{enumerate} \item $(S'', s'') \to (S', s')$ is an elementary \'etale neighbourhood and the morphism $S'' \to S$ is the composition $S'' \to S' \to S$, \item $Y''$ is an open subscheme of $Y' \times_{S'} S''$, \item $Z'' = Z \times_Y Y''$, \item $(X'', x'') \to (X, x)$ is an elementary \'etale neighbourhood, and \item $(Z'', Y'', i'', \pi'', \mathcal{G}'', z'', y'')$ is a one step d\'evissage at $x''$ of the sheaf $\mathcal{F}''$. \end{enumerate} Here $\mathcal{F}''$ (resp.\ $\mathcal{G}''$) is the pullback of $\mathcal{F}$ (resp.\ $\mathcal{G}$) via the morphism $X'' \to X$ (resp.\ $Z'' \to Z$) and $i'' : Z'' \to X''$ and $\pi'' : Z'' \to Y''$ are as in the diagram. \end{lemma} 
\begin{lemma} \label{lemma-existence-alpha} Let $S$, $X$, $\mathcal{F}$, $s$ be as in Definition \ref{definition-one-step-devissage}. Let $(Z, Y, i, \pi, \mathcal{G})$ be a one step d\'evissage of $\mathcal{F}/X/S$ over $s$. Let $\xi \in Y_s$ be the (unique) generic point. Then there exists an integer $r > 0$ and an $\mathcal{O}_Y$-module map $$ \alpha : \mathcal{O}_Y^{\oplus r} \longrightarrow \pi_*\mathcal{G} $$ such that $$ \alpha : \kappa(\xi)^{\oplus r} \longrightarrow (\pi_*\mathcal{G})_\xi \otimes_{\mathcal{O}_{Y, \xi}} \kappa(\xi) $$ is an isomorphism. Moreover, in this case we have $$ \dim(\text{Supp}(\Coker(\alpha)_s)) < \dim(\text{Supp}(\mathcal{F}_s)). $$ \end{lemma} 
\begin{definition} \label{definition-complete-devissage} Let $S$ be a scheme. Let $X$ be locally of finite type over $S$. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module of finite type. Let $s \in S$ be a point. A {\it complete d\'evissage of $\mathcal{F}/X/S$ over $s$} is given by a diagram $$ \xymatrix{ X & Z_1 \ar[l]^{i_1} \ar[d]^{\pi_1} \\ & Y_1 & Z_2 \ar[l]^{i_2} \ar[d]^{\pi_2} \\ & & Y_2 & Z_3 \ar[l] \ar[d] \\ & & & ... & ... \ar[l] \ar[d] \\ & & & & Y_n } $$ of schemes over $S$, finite type quasi-coherent $\mathcal{O}_{Z_k}$-modules $\mathcal{G}_k$, and $\mathcal{O}_{Y_k}$-module maps $$ \alpha_k : \mathcal{O}_{Y_k}^{\oplus r_k} \longrightarrow \pi_{k, *}\mathcal{G}_k, \quad k = 1, \ldots, n $$ satisfying the following properties: \begin{enumerate} \item $(Z_1, Y_1, i_1, \pi_1, \mathcal{G}_1)$ is a one step d\'evissage of $\mathcal{F}/X/S$ over $s$, \item the map $\alpha_k$ induces an isomorphism $$ \kappa(\xi_k)^{\oplus r_k} \longrightarrow (\pi_{k, *}\mathcal{G}_k)_{\xi_k} \otimes_{\mathcal{O}_{Y_k, \xi_k}} \kappa(\xi_k) $$ where $\xi_k \in (Y_k)_s$ is the unique generic point, \item for $k = 2, \ldots, n$ the system $(Z_k, Y_k, i_k, \pi_k, \mathcal{G}_k)$ is a one step d\'evissage of $\Coker(\alpha_{k - 1})/Y_{k - 1}/S$ over $s$, \item $\Coker(\alpha_n) = 0$. \end{enumerate} In this case we say that $(Z_k, Y_k, i_k, \pi_k, \mathcal{G}_k, \alpha_k)_{k = 1, \ldots, n}$ is a complete d\'evissage of $\mathcal{F}/X/S$ over $s$. \end{definition} 
\begin{definition} \label{definition-complete-devissage-at-x} Let $S$ be a scheme. Let $X$ be locally of finite type over $S$. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module of finite type. Let $x \in X$ be a point with image $s \in S$. A {\it complete d\'evissage of $\mathcal{F}/X/S$ at $x$} is given by a system $$ (Z_k, Y_k, i_k, \pi_k, \mathcal{G}_k, \alpha_k, z_k, y_k)_{k = 1, \ldots, n} $$ such that $(Z_k, Y_k, i_k, \pi_k, \mathcal{G}_k, \alpha_k)$ is a complete d\'evissage of $\mathcal{F}/X/S$ over $s$, and such that \begin{enumerate} \item $(Z_1, Y_1, i_1, \pi_1, \mathcal{G}_1, z_1, y_1)$ is a one step d\'evissage of $\mathcal{F}/X/S$ at $x$, \item for $k = 2, \ldots, n$ the system $(Z_k, Y_k, i_k, \pi_k, \mathcal{G}_k, z_k, y_k)$ is a one step d\'evissage of $\Coker(\alpha_{k - 1})/Y_{k - 1}/S$ at $y_{k - 1}$. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-base-change-complete} Let $S$, $X$, $\mathcal{F}$, $s$ be as in Definition \ref{definition-complete-devissage}. Let $(S', s') \to (S, s)$ be any morphism of pointed schemes. Let $(Z_k, Y_k, i_k, \pi_k, \mathcal{G}_k, \alpha_k)_{k = 1, \ldots, n}$ be a complete d\'evissage of $\mathcal{F}/X/S$ over $s$. Given this data let $X', Z'_k, Y'_k, i'_k, \pi'_k$ be the base changes of $X, Z_k, Y_k, i_k, \pi_k$ via $S' \to S$. Let $\mathcal{F}'$ be the pullback of $\mathcal{F}$ to $X'$ and let $\mathcal{G}'_k$ be the pullback of $\mathcal{G}_k$ to $Z'_k$. Let $\alpha'_k$ be the pullback of $\alpha_k$ to $Y'_k$. If $S'$ is affine, then $(Z'_k, Y'_k, i'_k, \pi'_k, \mathcal{G}'_k, \alpha'_k)_{k = 1, \ldots, n}$ is a complete d\'evissage of $\mathcal{F}'/X'/S'$ over $s'$. \end{lemma} 
\begin{lemma} \label{lemma-base-change-complete-at-x} Let $S$, $X$, $\mathcal{F}$, $x$, $s$ be as in Definition \ref{definition-complete-devissage-at-x}. Let $(S', s') \to (S, s)$ be a morphism of pointed schemes which induces an isomorphism $\kappa(s) = \kappa(s')$. Let $(Z_k, Y_k, i_k, \pi_k, \mathcal{G}_k, \alpha_k, z_k, y_k)_{k = 1, \ldots, n}$ be a complete d\'evissage of $\mathcal{F}/X/S$ at $x$. Let $(Z'_k, Y'_k, i'_k, \pi'_k, \mathcal{G}'_k, \alpha'_k)_{k = 1, \ldots, n}$ be as constructed in Lemma \ref{lemma-base-change-complete} and let $x' \in X'$ (resp.\ $z'_k \in Z'$, $y'_k \in Y'$) be the unique point mapping to both $x \in X$ (resp.\ $z_k \in Z_k$, $y_k \in Y_k$) and $s' \in S'$. If $S'$ is affine, then $(Z'_k, Y'_k, i'_k, \pi'_k, \mathcal{G}'_k, \alpha'_k, z'_k, y'_k)_{k = 1, \ldots, n}$ is a complete d\'evissage of $\mathcal{F}'/X'/S'$ at $x'$. \end{lemma} 
\begin{definition} \label{definition-shrink-complete} Let $S$, $X$, $\mathcal{F}$, $x$, $s$ be as in Definition \ref{definition-complete-devissage-at-x}. Consider a complete d\'evissage $(Z_k, Y_k, i_k, \pi_k, \mathcal{G}_k, \alpha_k, z_k, y_k)_{k = 1, \ldots, n}$ of $\mathcal{F}/X/S$ at $x$. Let us define a {\it standard shrinking} of this situation to be given by standard opens $S' \subset S$, $X' \subset X$, $Z'_k \subset Z_k$, and $Y'_k \subset Y_k$ such that $s_k \in S'$, $x_k \in X'$, $z_k \in Z'$, and $y_k \in Y'$ and such that $$ (Z'_k, Y'_k, i'_k, \pi'_k, \mathcal{G}'_k, \alpha'_k, z_k, y_k)_{k = 1, \ldots, n} $$ is a one step d\'evissage of $\mathcal{F}'/X'/S'$ at $x$ where $\mathcal{G}'_k = \mathcal{G}_k|_{Z'_k}$ and $\mathcal{F}' = \mathcal{F}|_{X'}$. \end{definition} 
\begin{lemma} \label{lemma-shrink-complete} With assumption and notation as in Definition \ref{definition-shrink-complete} we have: \begin{enumerate} \item \label{item-shrink-base-complete} If $S' \subset S$ is a standard open neighbourhood of $s$, then setting $X' = X_{S'}$, $Z'_k = Z_{S'}$ and $Y'_k = Y_{S'}$ we obtain a standard shrinking. \item \label{item-shrink-on-Y-complete} Let $W \subset Y_n$ be a standard open neighbourhood of $y$. Then there exists a standard shrinking with $Y'_n = W \times_S S'$. \item \label{item-shrink-on-X-complete} Let $U \subset X$ be an open neighbourhood of $x$. Then there exists a standard shrinking with $X' \subset U$. \end{enumerate} \end{lemma} 
\begin{proposition} \label{proposition-existence-complete-at-x} Let $S$ be a scheme. Let $X$ be locally of finite type over $S$. Let $x \in X$ be a point with image $s \in S$. There exists a commutative diagram $$ \xymatrix{ (X, x) \ar[d] & (X', x') \ar[l]^g \ar[d] \\ (S, s) & (S', s') \ar[l] } $$ of pointed schemes such that the horizontal arrows are elementary \'etale neighbourhoods and such that $g^*\mathcal{F}/X'/S'$ has a complete d\'evissage at $x$. \end{proposition} 
\begin{lemma} \label{lemma-existence-complete} Let $X \to S$ be a finite type morphism of schemes. Let $\mathcal{F}$ be a finite type quasi-coherent $\mathcal{O}_X$-module. Let $s \in S$ be a point. There exists an elementary \'etale neighbourhood $(S', s') \to (S, s)$ and \'etale morphisms $h_i : Y_i \to X_{S'}$, $i = 1, \ldots, n$ such that for each $i$ there exists a complete d\'evissage of $\mathcal{F}_i/Y_i/S'$ over $s'$, where $\mathcal{F}_i$ is the pullback of $\mathcal{F}$ to $Y_i$ and such that $X_s = (X_{S'})_{s'} \subset \bigcup h_i(Y_i)$. \end{lemma} 
\begin{definition} \label{definition-elementary-etale-neighbourhood} Let $R \to S$ be a ring map. Let $\mathfrak q$ be a prime of $S$ lying over the prime $\mathfrak p$ of $R$. A {\it elementary \'etale localization of the ring map $R \to S$ at $\mathfrak q$} is given by a commutative diagram of rings and accompanying primes $$ \xymatrix{ S \ar[r] & S' \\ R \ar[u] \ar[r] & R' \ar[u] } \quad\quad \xymatrix{ \mathfrak q \ar@{-}[r] & \mathfrak q' \\ \mathfrak p \ar@{-}[u] \ar@{-}[r] & \mathfrak p' \ar@{-}[u] } $$ such that $R \to R'$ and $S \to S'$ are \'etale ring maps and $\kappa(\mathfrak p) = \kappa(\mathfrak p')$ and $\kappa(\mathfrak q) = \kappa(\mathfrak q')$. \end{definition} 
\begin{definition} \label{definition-complete-devissage-algebra} Let $R \to S$ be a finite type ring map. Let $\mathfrak r$ be a prime of $R$. Let $N$ be a finite $S$-module. A {\it complete d\'evissage of $N/S/R$ over $\mathfrak r$} is given by $R$-algebra maps $$ \xymatrix{ & A_1 & & A_2 & & ... & & A_n \\ S \ar[ru] & & B_1 \ar[lu] \ar[ru] & & ... \ar[lu] \ar[ru] & & ... \ar[lu] \ar[ru] & & B_n \ar[lu] } $$ finite $A_i$-modules $M_i$ and $B_i$-module maps $\alpha_i : B_i^{\oplus r_i} \to M_i$ such that \begin{enumerate} \item $S \to A_1$ is surjective and of finite presentation, \item $B_i \to A_{i + 1}$ is surjective and of finite presentation, \item $B_i \to A_i$ is finite, \item $R \to B_i$ is smooth with geometrically irreducible fibres, \item $N \cong M_1$ as $S$-modules, \item $\Coker(\alpha_i) \cong M_{i + 1}$ as $B_i$-modules, \item $\alpha_i : \kappa(\mathfrak p_i)^{\oplus r_i} \to M_i \otimes_{B_i} \kappa(\mathfrak p_i)$ is an isomorphism where $\mathfrak p_i = \mathfrak rB_i$, and \item $\Coker(\alpha_n) = 0$. \end{enumerate} In this situation we say that $(A_i, B_i, M_i, \alpha_i)_{i = 1, \ldots, n}$ is a complete d\'evissage of $N/S/R$ over $\mathfrak r$. \end{definition} 
\begin{definition} \label{definition-complete-devissage-at-x-algebra} Let $R \to S$ be a finite type ring map. Let $\mathfrak q$ be a prime of $S$ lying over the prime $\mathfrak r$ of $R$. Let $N$ be a finite $S$-module. A {\it complete d\'evissage of $N/S/R$ at $\mathfrak q$} is given by a complete d\'evissage $(A_i, B_i, M_i, \alpha_i)_{i = 1, \ldots, n}$ of $N/S/R$ over $\mathfrak r$ and prime ideals $\mathfrak q_i \subset B_i$ lying over $\mathfrak r$ such that \begin{enumerate} \item $\kappa(\mathfrak r) \subset \kappa(\mathfrak q_i)$ is purely transcendental, \item there is a unique prime $\mathfrak q'_i \subset A_i$ lying over $\mathfrak q_i \subset B_i$, \item $\mathfrak q = \mathfrak q'_1 \cap S$ and $\mathfrak q_i = \mathfrak q'_{i + 1} \cap A_i$, \item $R \to B_i$ has relative dimension $\dim_{\mathfrak q_i}(\text{Supp}(M_i \otimes_R \kappa(\mathfrak r)))$. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-existence-algebra} Let $R \to S$ be a finite type ring map. Let $M$ be a finite $S$-module. Let $\mathfrak q$ be a prime ideal of $S$. There exists an elementary \'etale localization $R' \to S', \mathfrak q', \mathfrak p'$ of the ring map $R \to S$ at $\mathfrak q$ such that there exists a complete d\'evissage of $(M \otimes_S S')/S'/R'$ at $\mathfrak q'$. \end{lemma} 
\begin{lemma} \label{lemma-homothety-spectrum} Let $R \to S$ be a ring map. Let $N$ be a $S$-module. Assume \begin{enumerate} \item $R$ is a local ring with maximal ideal $\mathfrak m$, \item $\overline{S} = S/\mathfrak m S$ is Noetherian, and \item $\overline{N} = N/\mathfrak m_R N$ is a finite $\overline{S}$-module. \end{enumerate} Let $\Sigma \subset S$ be the multiplicative subset of elements which are not a zerodivisor on $\overline{N}$. Then $\Sigma^{-1}S$ is a semi-local ring whose spectrum consists of primes $\mathfrak q \subset S$ contained in an element of $\text{Ass}_S(\overline{N})$. Moreover, any maximal ideal of $\Sigma^{-1}S$ corresponds to an associated prime of $\overline{N}$ over $\overline{S}$. \end{lemma} 
\begin{lemma} \label{lemma-homothety-universally-injective} Assumption and notation as in Lemma \ref{lemma-homothety-spectrum}. Assume moreover that \begin{enumerate} \item $S$ is local and $R \to S$ is a local homomorphism, \item $S$ is essentially of finite presentation over $R$, \item $N$ is finitely presented over $S$, and \item $N$ is flat over $R$. \end{enumerate} Then each $s \in \Sigma$ defines a universally injective $R$-module map $s : N \to N$, and the map $N \to \Sigma^{-1}N$ is $R$-universally injective. \end{lemma} 
\begin{lemma} \label{lemma-base-change-universally-flat-local} Let $R \to S$ be a ring map. Let $N$ be an $S$-module. Let $S \to S'$ be a ring map. Assume \begin{enumerate} \item $R \to S$ is a local homomorphism of local rings \item $S$ is essentially of finite presentation over $R$, \item $N$ is of finite presentation over $S$, \item $N$ is flat over $R$, \item $S \to S'$ is flat, and \item the image of $\Spec(S') \to \Spec(S)$ contains all primes $\mathfrak q$ of $S$ lying over $\mathfrak m_R$ such that $\mathfrak q$ is an associated prime of $N/\mathfrak m_R N$. \end{enumerate} Then $N \to N \otimes_S S'$ is $R$-universally injective. \end{lemma} 
\begin{lemma} \label{lemma-base-change-universally-flat} Let $R \to S$ be a ring map. Let $N$ be an $S$-module. Let $S \to S'$ be a ring map. Assume \begin{enumerate} \item $R \to S$ is of finite presentation and $N$ is of finite presentation over $S$, \item $N$ is flat over $R$, \item $S \to S'$ is flat, and \item the image of $\Spec(S') \to \Spec(S)$ contains all primes $\mathfrak q$ such that $\mathfrak q$ is an associated prime of $N \otimes_R \kappa(\mathfrak p)$ where $\mathfrak p$ is the inverse image of $\mathfrak q$ in $R$. \end{enumerate} Then $N \to N \otimes_S S'$ is $R$-universally injective. \end{lemma} 
\begin{lemma} \label{lemma-universally-injective-local} Let $(R, \mathfrak m)$ be a local ring. Let $u : M \to N$ be an $R$-module map. If $M$ is a projective $R$-module, $N$ is a flat $R$-module, and $\overline{u} : M/\mathfrak mM \to N/\mathfrak mN$ is injective then $u$ is universally injective. \end{lemma} 
\begin{lemma} \label{lemma-invert-universally-injective} Assumption and notation as in Lemma \ref{lemma-homothety-spectrum}. Assume moreover that $N$ is projective as an $R$-module. Then each $s \in \Sigma$ defines a universally injective $R$-module map $s : N \to N$, and the map $N \to \Sigma^{-1}N$ is $R$-universally injective. \end{lemma} 
\begin{lemma} \label{lemma-completed-direct-sum-ML} Let $R$ be a ring. Let $I \subset R$ be an ideal. Let $A$ be a set. Assume $R$ is Noetherian and complete with respect to $I$. The completion $(\bigoplus\nolimits_{\alpha \in A} R)^\wedge$ is flat and Mittag-Leffler. \end{lemma} 
\begin{lemma} \label{lemma-lift-ML} Let $R$ be a ring. Let $I \subset R$ be an ideal. Let $M$ be an $R$-module. Assume \begin{enumerate} \item $R$ is Noetherian and $I$-adically complete, \item $M$ is flat over $R$, and \item $M/IM$ is a projective $R/I$-module. \end{enumerate} Then the $I$-adic completion $M^\wedge$ is a flat Mittag-Leffler $R$-module. \end{lemma} 
\begin{lemma} \label{lemma-universally-injective-to-completion} Let $R$ be a ring. Let $I \subset R$ be an ideal. Let $R \to S$ be a ring map, and $N$ an $S$-module. Assume \begin{enumerate} \item $R$ is a Noetherian ring, \item $S$ is a Noetherian ring, \item $N$ is a finite $S$-module, and \item for any finite $R$-module $Q$, any $\mathfrak q \in \text{Ass}_S(Q \otimes_R N)$ satisfies $IS + \mathfrak q \not = S$. \end{enumerate} Then the map $N \to N^\wedge$ of $N$ into the $I$-adic completion of $N$ is universally injective as a map of $R$-modules. \end{lemma} 
\begin{lemma} \label{lemma-universally-injective-to-completion-flat} Let $R$ be a ring. Let $I \subset R$ be an ideal. Let $R \to S$ be a ring map, and $N$ an $S$-module. Assume \begin{enumerate} \item $R$ is a Noetherian ring, \item $S$ is a Noetherian ring, \item $N$ is a finite $S$-module, \item $N$ is flat over $R$, and \item for any prime $\mathfrak q \subset S$ which is an associated prime of $N \otimes_R \kappa(\mathfrak p)$ where $\mathfrak p = R \cap \mathfrak q$ we have $IS + \mathfrak q \not = S$. \end{enumerate} Then the map $N \to N^\wedge$ of $N$ into the $I$-adic completion of $N$ is universally injective as a map of $R$-modules. \end{lemma} 
\begin{lemma} \label{lemma-flat-pure-over-complete-projective} Let $R$ be a ring. Let $I \subset R$ be an ideal. Let $R \to S$ be a ring map, and $N$ an $S$-module. Assume \begin{enumerate} \item $R$ is Noetherian and $I$-adically complete, \item $R \to S$ is of finite type, \item $N$ is a finite $S$-module, \item $N$ is flat over $R$, \item $N/IN$ is projective as a $R/I$-module, and \item for any prime $\mathfrak q \subset S$ which is an associated prime of $N \otimes_R \kappa(\mathfrak p)$ where $\mathfrak p = R \cap \mathfrak q$ we have $IS + \mathfrak q \not = S$. \end{enumerate} Then $N$ is projective as an $R$-module. \end{lemma} 
\begin{lemma} \label{lemma-fibres-irreducible-flat-projective} Let $R$ be a ring. Let $R \to S$ be a ring map. Assume \begin{enumerate} \item $R$ is Noetherian, \item $R \to S$ is of finite type and flat, and \item every fibre ring $S \otimes_R \kappa(\mathfrak p)$ is geometrically integral over $\kappa(\mathfrak p)$. \end{enumerate} Then $S$ is projective as an $R$-module. \end{lemma} 
\begin{lemma} \label{lemma-fibres-irreducible-flat-projective-nonnoetherian} Let $R$ be a ring. Let $R \to S$ be a ring map. Assume \begin{enumerate} \item $R \to S$ is of finite presentation and flat, and \item every fibre ring $S \otimes_R \kappa(\mathfrak p)$ is geometrically integral over $\kappa(\mathfrak p)$. \end{enumerate} Then $S$ is projective as an $R$-module. \end{lemma} 
\begin{lemma} \label{lemma-induction-step} Let $(R, \mathfrak m)$ be a local ring. Let $R \to S$ be a finitely presented flat ring map with geometrically integral fibres. Write $\mathfrak p = \mathfrak mS$. Let $\mathfrak q \subset S$ be a prime ideal lying over $\mathfrak m$. Let $N$ be a finite $S$-module. There exist $r \geq 0$ and an $S$-module map $$ \alpha : S^{\oplus r} \longrightarrow N $$ such that $\alpha : \kappa(\mathfrak p)^{\oplus r} \to N \otimes_S \kappa(\mathfrak p)$ is an isomorphism. For any such $\alpha$ the following are equivalent: \begin{enumerate} \item $N_{\mathfrak q}$ is $R$-flat, \item $\alpha$ is $R$-universally injective and $\Coker(\alpha)_{\mathfrak q}$ is $R$-flat, \item $\alpha$ is injective and $\Coker(\alpha)_{\mathfrak q}$ is $R$-flat, \item $\alpha_{\mathfrak p}$ is an isomorphism and $\Coker(\alpha)_{\mathfrak q}$ is $R$-flat, and \item $\alpha_{\mathfrak q}$ is injective and $\Coker(\alpha)_{\mathfrak q}$ is $R$-flat. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-complete-devissage-flat-finite-type-module} Let $(R, \mathfrak m)$ be a local ring. Let $R \to S$ be a ring map of finite presentation. Let $N$ be a finite $S$-module. Let $\mathfrak q$ be a prime of $S$ lying over $\mathfrak m$. Assume that $N_{\mathfrak q}$ is flat over $R$, and assume there exists a complete d\'evissage of $N/S/R$ at $\mathfrak q$. Then $N$ is a finitely presented $S$-module, free as an $R$-module, and there exists an isomorphism $$ N \cong B_1^{\oplus r_1} \oplus \ldots \oplus B_n^{\oplus r_n} $$ as $R$-modules where each $B_i$ is a smooth $R$-algebra with geometrically irreducible fibres. \end{lemma} 
\begin{proposition} \label{proposition-finite-type-flat-at-point} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent sheaf on $X$. Let $x \in X$ with image $s \in S$. Assume that \begin{enumerate} \item $f$ is locally of finite presentation, \item $\mathcal{F}$ is of finite type, and \item $\mathcal{F}$ is flat at $x$ over $S$. \end{enumerate} Then there exists an elementary \'etale neighbourhood $(S', s') \to (S, s)$ and an open subscheme $$ V \subset X \times_S \Spec(\mathcal{O}_{S', s'}) $$ which contains the unique point of $X \times_S \Spec(\mathcal{O}_{S', s'})$ mapping to $x$ such that the pullback of $\mathcal{F}$ to $V$ is an $\mathcal{O}_V$-module of finite presentation and flat over $\mathcal{O}_{S', s'}$. \end{proposition} 
\begin{lemma} \label{lemma-open-in-fibre-where-flat} Let $f : X \to S$ be a morphism of schemes which is locally of finite type. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module of finite type. Let $s \in S$. Then the set $$ \{x \in X_s \mid \mathcal{F} \text{ flat over }S\text{ at }x\} $$ is open in the fibre $X_s$. \end{lemma} 
\begin{lemma} \label{lemma-finite-type-flat-at-point} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent sheaf on $X$. Let $x \in X$ with image $s \in S$. Assume that \begin{enumerate} \item $f$ is locally of finite type, \item $\mathcal{F}$ is of finite type, and \item $\mathcal{F}$ is flat at $x$ over $S$. \end{enumerate} Then there exists an elementary \'etale neighbourhood $(S', s') \to (S, s)$ and an open subscheme $$ V \subset X \times_S \Spec(\mathcal{O}_{S', s'}) $$ which contains the unique point of $X \times_S \Spec(\mathcal{O}_{S', s'})$ mapping to $x$ such that the pullback of $\mathcal{F}$ to $V$ is flat over $\mathcal{O}_{S', s'}$. \end{lemma} 
\begin{lemma} \label{lemma-finite-type-flat-along-fibre} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent sheaf on $X$. Let $s \in S$. Assume that \begin{enumerate} \item $f$ is of finite presentation, \item $\mathcal{F}$ is of finite type, and \item $\mathcal{F}$ is flat over $S$ at every point of the fibre $X_s$. \end{enumerate} Then there exists an elementary \'etale neighbourhood $(S', s') \to (S, s)$ and an open subscheme $$ V \subset X \times_S \Spec(\mathcal{O}_{S', s'}) $$ which contains the fibre $X_s = X \times_S s'$ such that the pullback of $\mathcal{F}$ to $V$ is an $\mathcal{O}_V$-module of finite presentation and flat over $\mathcal{O}_{S', s'}$. \end{lemma} 
\begin{lemma} \label{lemma-finite-type-flat-along-fibre-variant} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent sheaf on $X$. Let $s \in S$. Assume that \begin{enumerate} \item $f$ is of finite type, \item $\mathcal{F}$ is of finite type, and \item $\mathcal{F}$ is flat over $S$ at every point of the fibre $X_s$. \end{enumerate} Then there exists an elementary \'etale neighbourhood $(S', s') \to (S, s)$ and an open subscheme $$ V \subset X \times_S \Spec(\mathcal{O}_{S', s'}) $$ which contains the fibre $X_s = X \times_S s'$ such that the pullback of $\mathcal{F}$ to $V$ is flat over $\mathcal{O}_{S', s'}$. \end{lemma} 
\begin{lemma} \label{lemma-finite-type-flat-at-point-X} Let $S$ be a scheme. Let $X$ be locally of finite type over $S$. Let $x \in X$ with image $s \in S$. If $X$ is flat at $x$ over $S$, then there exists an elementary \'etale neighbourhood $(S', s') \to (S, s)$ and an open subscheme $$ V \subset X \times_S \Spec(\mathcal{O}_{S', s'}) $$ which contains the unique point of $X \times_S \Spec(\mathcal{O}_{S', s'})$ mapping to $x$ such that $V \to \Spec(\mathcal{O}_{S', s'})$ is flat and of finite presentation. \end{lemma} 
\begin{lemma} \label{lemma-finite-type-flat-at-point-local} Let $f : X \to S$ be a morphism which is locally of finite presentation. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module of finite type. If $x \in X$ and $\mathcal{F}$ is flat at $x$ over $S$, then $\mathcal{F}_x$ is an $\mathcal{O}_{X, x}$-module of finite presentation. \end{lemma} 
\begin{lemma} \label{lemma-finite-type-flat-at-point-local-X} Let $f : X \to S$ be a morphism which is locally of finite type. Let $x \in X$ with image $s \in S$. If $f$ is flat at $x$ over $S$, then $\mathcal{O}_{X, x}$ is essentially of finite presentation over $\mathcal{O}_{S, s}$. \end{lemma} 
\begin{lemma} \label{lemma-flat-finite-type-finitely-presented-over-dense-open} \begin{slogan} $S$-flat and finite type extensions of finitely presented modules on a (good) open are also $X$-finitely presented. \end{slogan} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. Let $U \subset S$ be open. Assume \begin{enumerate} \item $f$ is locally of finite presentation, \item $\mathcal{F}$ is of finite type and flat over $S$, \item $U \subset S$ is retrocompact and scheme theoretically dense, \item $\mathcal{F}|_{f^{-1}U}$ is of finite presentation. \end{enumerate} Then $\mathcal{F}$ is of finite presentation. \end{lemma} 
\begin{lemma} \label{lemma-flat-finite-type-finitely-presented-over-dense-open-X} Let $f : X \to S$ be a morphism of schemes. Let $U \subset S$ be open. Assume \begin{enumerate} \item $f$ is locally of finite type and flat, \item $U \subset S$ is retrocompact and scheme theoretically dense, \item $f|_{f^{-1}U} : f^{-1}U \to U$ is locally of finite presentation. \end{enumerate} Then $f$ is of locally of finite presentation. \end{lemma} 
\begin{lemma} \label{lemma-flat-finite-presentation-dimension-over-dense-open} Let $f : X \to S$ be a morphism of schemes which is flat and locally of finite type. Let $U \subset S$ be a dense open such that $X_U \to U$ has relative dimension $\leq e$, see Morphisms, Definition \ref{morphisms-definition-relative-dimension-d}. If also either \begin{enumerate} \item $f$ is locally of finite presentation, or \item $U \subset S$ is retrocompact, \end{enumerate} then $f$ has relative dimension $\leq e$. \end{lemma} 
\begin{lemma} \label{lemma-proper-flat-finite-over-dense-open} Let $f : X \to S$ be a morphism of schemes which is flat and proper. Let $U \subset S$ be a dense open such that $X_U \to U$ is finite. If also either $f$ is locally of finite presentation or $U \subset S$ is retrocompact, then $f$ is finite. \end{lemma} 
\begin{lemma} \label{lemma-zariski} Let $f : X \to S$ be a morphism of schemes and $U \subset S$ an open. If \begin{enumerate} \item $f$ is separated, locally of finite type, and flat, \item $f^{-1}(U) \to U$ is an isomorphism, and \item $U \subset S$ is retrocompact and scheme theoretically dense, \end{enumerate} then $f$ is an open immersion. \end{lemma} 
\begin{lemma} \label{lemma-induction-step-fp} Let $R$ be a ring. Let $R \to S$ be a finitely presented flat ring map with geometrically integral fibres. Let $\mathfrak q \subset S$ be a prime ideal lying over the prime $\mathfrak r \subset R$. Set $\mathfrak p = \mathfrak r S$. Let $N$ be a finitely presented $S$-module. There exists $r \geq 0$ and an $S$-module map $$ \alpha : S^{\oplus r} \longrightarrow N $$ such that $\alpha : \kappa(\mathfrak p)^{\oplus r} \to N \otimes_S \kappa(\mathfrak p)$ is an isomorphism. For any such $\alpha$ the following are equivalent: \begin{enumerate} \item $N_{\mathfrak q}$ is $R$-flat, \item there exists an $f \in R$, $f \not \in \mathfrak r$ such that $\alpha_f : S_f^{\oplus r} \to N_f$ is $R_f$-universally injective and a $g \in S$, $g \not \in \mathfrak q$ such that $\Coker(\alpha)_g$ is $R$-flat, \item $\alpha_{\mathfrak r}$ is $R_{\mathfrak r}$-universally injective and $\Coker(\alpha)_{\mathfrak q}$ is $R$-flat \item $\alpha_{\mathfrak r}$ is injective and $\Coker(\alpha)_{\mathfrak q}$ is $R$-flat, \item $\alpha_{\mathfrak p}$ is an isomorphism and $\Coker(\alpha)_{\mathfrak q}$ is $R$-flat, and \item $\alpha_{\mathfrak q}$ is injective and $\Coker(\alpha)_{\mathfrak q}$ is $R$-flat. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-complete-devissage-flat-finitely-presented-module} Let $R \to S$ be a ring map of finite presentation. Let $N$ be a finitely presented $S$-module flat over $R$. Let $\mathfrak r \subset R$ be a prime ideal. Assume there exists a complete d\'evissage of $N/S/R$ over $\mathfrak r$. Then there exists an $f \in R$, $f \not \in \mathfrak r$ such that $$ N_f \cong B_1^{\oplus r_1} \oplus \ldots \oplus B_n^{\oplus r_n} $$ as $R$-modules where each $B_i$ is a smooth $R_f$-algebra with geometrically irreducible fibres. Moreover, $N_f$ is projective as an $R_f$-module. \end{lemma} 
\begin{proposition} \label{proposition-finite-presentation-flat-at-point} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent sheaf on $X$. Let $x \in X$ with image $s \in S$. Assume that \begin{enumerate} \item $f$ is locally of finite presentation, \item $\mathcal{F}$ is of finite presentation, and \item $\mathcal{F}$ is flat at $x$ over $S$. \end{enumerate} Then there exists a commutative diagram of pointed schemes $$ \xymatrix{ (X, x) \ar[d] & (X', x') \ar[l]^g \ar[d] \\ (S, s) & (S', s') \ar[l] } $$ whose horizontal arrows are elementary \'etale neighbourhoods such that $X'$, $S'$ are affine and such that $\Gamma(X', g^*\mathcal{F})$ is a projective $\Gamma(S', \mathcal{O}_{S'})$-module. \end{proposition} 
\begin{lemma} \label{lemma-finite-presentation-flat-along-fibre} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent sheaf on $X$. Let $s \in S$. Assume that \begin{enumerate} \item $f$ is of finite presentation, \item $\mathcal{F}$ is of finite presentation, and \item $\mathcal{F}$ is flat over $S$ at every point of the fibre $X_s$. \end{enumerate} Then there exists an elementary \'etale neighbourhood $(S', s') \to (S, s)$ and a commutative diagram of schemes $$ \xymatrix{ X \ar[d] & X' \ar[l]^g \ar[d] \\ S & S' \ar[l] } $$ such that $g$ is \'etale, $X_s \subset g(X')$, the schemes $X'$, $S'$ are affine, and such that $\Gamma(X', g^*\mathcal{F})$ is a projective $\Gamma(S', \mathcal{O}_{S'})$-module. \end{lemma} 
\begin{lemma} \label{lemma-finite-presentation-flat-at-point-X} Let $f : X \to S$ be locally of finite presentation. Let $x \in X$ with image $s \in S$. If $f$ is flat at $x$ over $S$, then there exists a commutative diagram of pointed schemes $$ \xymatrix{ (X, x) \ar[d] & (X', x') \ar[l]^g \ar[d] \\ (S, s) & (S', s') \ar[l] } $$ whose horizontal arrows are elementary \'etale neighbourhoods such that $X'$, $S'$ are affine and such that $\Gamma(X', \mathcal{O}_{X'})$ is a projective $\Gamma(S', \mathcal{O}_{S'})$-module. \end{lemma} 
\begin{lemma} \label{lemma-finite-presentation-flat-along-fibre-X} Let $f : X \to S$ be of finite presentation. Let $s \in S$. If $X$ is flat over $S$ at all points of $X_s$, then there exists an elementary \'etale neighbourhood $(S', s') \to (S, s)$ and a commutative diagram of schemes $$ \xymatrix{ X \ar[d] & X' \ar[l]^g \ar[d] \\ S & S' \ar[l] } $$ with $g$ \'etale, $X_s \subset g(X')$, such that $X'$, $S'$ are affine, and such that $\Gamma(X', \mathcal{O}_{X'})$ is a projective $\Gamma(S', \mathcal{O}_{S'})$-module. \end{lemma} 
\begin{lemma} \label{lemma-finite-type-flat-at-point-free} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent sheaf on $X$. Let $x \in X$ with image $s \in S$. Assume that \begin{enumerate} \item $f$ is locally of finite presentation, \item $\mathcal{F}$ is of finite type, and \item $\mathcal{F}$ is flat at $x$ over $S$. \end{enumerate} Then there exists an elementary \'etale neighbourhood $(S', s') \to (S, s)$ and a commutative diagram of pointed schemes $$ \xymatrix{ (X, x) \ar[d] & (X', x') \ar[l]^g \ar[d] \\ (S, s) & (\Spec(\mathcal{O}_{S', s'}), s') \ar[l] } $$ such that $X' \to X \times_S \Spec(\mathcal{O}_{S', s'})$ is \'etale, $\kappa(x) = \kappa(x')$, the scheme $X'$ is affine of finite presentation over $\mathcal{O}_{S', s'}$, the sheaf $g^*\mathcal{F}$ is of finite presentation over $\mathcal{O}_{X'}$, and such that $\Gamma(X', g^*\mathcal{F})$ is a free $\mathcal{O}_{S', s'}$-module. \end{lemma} 
\begin{lemma} \label{lemma-finite-type-flat-at-point-free-variant} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent sheaf on $X$. Let $x \in X$ with image $s \in S$. Assume that \begin{enumerate} \item $f$ is locally of finite type, \item $\mathcal{F}$ is of finite type, and \item $\mathcal{F}$ is flat at $x$ over $S$. \end{enumerate} Then there exists an elementary \'etale neighbourhood $(S', s') \to (S, s)$ and a commutative diagram of pointed schemes $$ \xymatrix{ (X, x) \ar[d] & (X', x') \ar[l]^g \ar[d] \\ (S, s) & (\Spec(\mathcal{O}_{S', s'}), s') \ar[l] } $$ such that $X' \to X \times_S \Spec(\mathcal{O}_{S', s'})$ is \'etale, $\kappa(x) = \kappa(x')$, the scheme $X'$ is affine, and such that $\Gamma(X', g^*\mathcal{F})$ is a free $\mathcal{O}_{S', s'}$-module. \end{lemma} 
\begin{lemma} \label{lemma-finite-type-flat-along-fibre-free} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent sheaf on $X$. Let $s \in S$. Assume that \begin{enumerate} \item $f$ is of finite presentation, \item $\mathcal{F}$ is of finite type, and \item $\mathcal{F}$ is flat over $S$ at all points of $X_s$. \end{enumerate} Then there exists an elementary \'etale neighbourhood $(S', s') \to (S, s)$ and a commutative diagram of schemes $$ \xymatrix{ X \ar[d] & X' \ar[l]^g \ar[d] \\ S & \Spec(\mathcal{O}_{S', s'}) \ar[l] } $$ such that $X' \to X \times_S \Spec(\mathcal{O}_{S', s'})$ is \'etale, $X_s = g((X')_{s'})$, the scheme $X'$ is affine of finite presentation over $\mathcal{O}_{S', s'}$, the sheaf $g^*\mathcal{F}$ is of finite presentation over $\mathcal{O}_{X'}$, and such that $\Gamma(X', g^*\mathcal{F})$ is a free $\mathcal{O}_{S', s'}$-module. \end{lemma} 
\begin{lemma} \label{lemma-finite-type-flat-along-fibre-free-variant} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent sheaf on $X$. Let $s \in S$. Assume that \begin{enumerate} \item $f$ is of finite type, \item $\mathcal{F}$ is of finite type, and \item $\mathcal{F}$ is flat over $S$ at all points of $X_s$. \end{enumerate} Then there exists an elementary \'etale neighbourhood $(S', s') \to (S, s)$ and a commutative diagram of schemes $$ \xymatrix{ X \ar[d] & X' \ar[l]^g \ar[d] \\ S & \Spec(\mathcal{O}_{S', s'}) \ar[l] } $$ such that $X' \to X \times_S \Spec(\mathcal{O}_{S', s'})$ is \'etale, $X_s = g((X')_{s'})$, the scheme $X'$ is affine, and such that $\Gamma(X', g^*\mathcal{F})$ is a free $\mathcal{O}_{S', s'}$-module. \end{lemma} 
\begin{lemma} \label{lemma-weak-bourbaki-pre-pre} Let $R \to S$ be a ring map of finite presentation. Let $N$ be a finitely presented $S$-module. Let $\mathfrak q \subset S$ be a prime ideal lying over $\mathfrak p \subset R$. Set $\overline{S} = S \otimes_R \kappa(\mathfrak p)$, $\overline{\mathfrak q} = \mathfrak q \overline{S}$, and $\overline{N} = N \otimes_R \kappa(\mathfrak p)$. Then we can find a $g \in S$ with $g \not \in \mathfrak q$ such that $\overline{g} \in \mathfrak r$ for all $\mathfrak r \in \text{Ass}_{\overline{S}}(\overline{N})$ such that $\mathfrak r \not \subset \overline{\mathfrak q}$. \end{lemma} 
\begin{lemma} \label{lemma-weak-bourbaki-pre} Let $R \to S$ be a ring map of finite presentation. Let $N$ be a finitely presented $S$-module which is flat as an $R$-module. Let $M$ be an $R$-module. Let $\mathfrak q$ be a prime of $S$ lying over $\mathfrak p \subset R$. Then $$ \mathfrak q \in \text{WeakAss}_S(M \otimes_R N) \Leftrightarrow \Big( \mathfrak p \in \text{WeakAss}_R(M) \text{ and } \overline{\mathfrak q} \in \text{Ass}_{\overline{S}}(\overline{N}) \Big) $$ Here $\overline{S} = S \otimes_R \kappa(\mathfrak p)$, $\overline{\mathfrak q} = \mathfrak q \overline{S}$, and $\overline{N} = N \otimes_R \kappa(\mathfrak p)$. \end{lemma} 
\begin{lemma} \label{lemma-bourbaki-finite-type-general-base-at-point} Let $S$ be a scheme. Let $f : X \to S$ be locally of finite type. Let $x \in X$ with image $s \in S$. Let $\mathcal{F}$ be a finite type quasi-coherent sheaf on $X$. Let $\mathcal{G}$ be a quasi-coherent sheaf on $S$. If $\mathcal{F}$ is flat at $x$ over $S$, then $$ x \in \text{WeakAss}_X(\mathcal{F} \otimes_{\mathcal{O}_X} f^*\mathcal{G}) \Leftrightarrow s \in \text{WeakAss}_S(\mathcal{G}) \text{ and } x \in \text{Ass}_{X_s}(\mathcal{F}_s). $$ \end{lemma} 
\begin{lemma} \label{lemma-weak-bourbaki} Let $R \to S$ be a ring map which is essentially of finite type. Let $N$ be a localization of a finite $S$-module flat over $R$. Let $M$ be an $R$-module. Then $$ \text{WeakAss}_S(M \otimes_R N) = \bigcup\nolimits_{\mathfrak p \in \text{WeakAss}_R(M)} \text{Ass}_{S \otimes_R \kappa(\mathfrak p)}(N \otimes_R \kappa(\mathfrak p)) $$ \end{lemma} 
\begin{lemma} \label{lemma-bourbaki-finite-type-general-base} Let $f : X \to S$ be a morphism which is locally of finite type. Let $\mathcal{F}$ be a finite type quasi-coherent sheaf on $X$ which is flat over $S$. Let $\mathcal{G}$ be a quasi-coherent sheaf on $S$. Then we have $$ \text{WeakAss}_X(\mathcal{F} \otimes_{\mathcal{O}_X} f^*\mathcal{G}) = \bigcup\nolimits_{s \in \text{WeakAss}_S(\mathcal{G})} \text{Ass}_{X_s}(\mathcal{F}_s) $$ \end{lemma} 
\begin{theorem} \label{theorem-finite-type-flat} \begin{slogan} The flat locus is open (non-Noetherian version). \end{slogan} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. Assume \begin{enumerate} \item $X \to S$ is locally of finite presentation, \item $\mathcal{F}$ is an $\mathcal{O}_X$-module of finite type, and \item the set of weakly associated points of $S$ is locally finite in $S$. \end{enumerate} Then $U = \{x \in X \mid \mathcal{F}\text{ flat at }x\text{ over }S\}$ is open in $X$ and $\mathcal{F}|_U$ is an $\mathcal{O}_U$-module of finite presentation and flat over $S$. \end{theorem} 
\begin{lemma} \label{lemma-finite-type-flat-algebra} Let $R \to S$ be a ring map of finite presentation. Let $M$ be a finite $S$-module. Assume $\text{WeakAss}_S(S)$ is finite. Then $$ U = \{\mathfrak q \subset S \mid M_{\mathfrak q}\text{ flat over }R\} $$ is open in $\Spec(S)$ and for every $g \in S$ such that $D(g) \subset U$ the localization $M_g$ is a finitely presented $S_g$-module flat over $R$. \end{lemma} 
\begin{lemma} \label{lemma-finite-type-flat-X} Let $f : X \to S$ be a morphism of schemes which is locally of finite type. Assume the set of weakly associated points of $S$ is locally finite in $S$. Then the set of points $x \in X$ where $f$ is flat is an open subscheme $U \subset X$ and $U \to S$ is flat and locally of finite presentation. \end{lemma} 
\begin{lemma} \label{lemma-finite-type-flat-over-integral} Let $f : X \to S$ be a morphism of schemes which is locally of finite type and flat. If $S$ is integral, then $f$ is locally of finite presentation. \end{lemma} 
\begin{proposition} \label{proposition-flat-finite-type-finite-presentation-domain} Let $R$ be a domain. Let $R \to S$ be a ring map of finite type. Let $M$ be a finite $S$-module. \begin{enumerate} \item If $S$ is flat over $R$, then $S$ is a finitely presented $R$-algebra. \item If $M$ is flat as an $R$-module, then $M$ is finitely presented as an $S$-module. \end{enumerate} \end{proposition} 
\begin{lemma}[Finite type version of Theorem \ref{theorem-finite-type-flat}] \label{lemma-finite-type-flat} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. Assume \begin{enumerate} \item $X \to S$ is locally of finite type, \item $\mathcal{F}$ is an $\mathcal{O}_X$-module of finite type, and \item the set of weakly associated points of $S$ is locally finite in $S$. \end{enumerate} Then $U = \{x \in X \mid \mathcal{F}\text{ flat at }x\text{ over }S\}$ is open in $X$ and $\mathcal{F}|_U$ is flat over $S$ and locally finitely presented relative to $S$ (see More on Morphisms, Definition \ref{more-morphisms-definition-relatively-finitely-presented-sheaf}). \end{lemma} 
\begin{lemma} \label{lemma-finite-type-flat-algebra-bis} Let $R \to S$ be a ring map of finite type. Let $M$ be a finite $S$-module. Assume $\text{WeakAss}_R(R)$ is finite. Then $$ U = \{\mathfrak q \subset S \mid M_{\mathfrak q}\text{ flat over }R\} $$ is open in $\Spec(S)$ and for every $g \in S$ such that $D(g) \subset U$ the localization $M_g$ is flat over $R$ and an $S_g$-module finitely presented relative to $R$ (see More on Algebra, Definition \ref{more-algebra-definition-relatively-finitely-presented}). \end{lemma} 
\begin{lemma} \label{lemma-explain-why-pure} Let $R$ be a local ring with maximal ideal $\mathfrak m$. Let $R \to S$ be a ring map. Let $N$ be an $S$-module. Assume \begin{enumerate} \item $N$ is projective as an $R$-module, and \item $S/\mathfrak mS$ is Noetherian and $N/\mathfrak mN$ is a finite $S/\mathfrak mS$-module. \end{enumerate} Then for any prime $\mathfrak q \subset S$ which is an associated prime of $N \otimes_R \kappa(\mathfrak p)$ where $\mathfrak p = R \cap \mathfrak q$ we have $\mathfrak q + \mathfrak m S \not = S$. \end{lemma} 
\begin{lemma} \label{lemma-explain-why-pure-complete} Let $R$ be a ring. Let $I \subset R$ be an ideal. Let $R \to S$ be a ring map. Let $N$ be an $S$-module. If $N$ is $I$-adically complete, then for any $R$-module $M$ and for any prime $\mathfrak q \subset S$ which is an associated prime of $N \otimes_R M$ we have $\mathfrak q + I S \not = S$. \end{lemma} 
\begin{lemma} \label{lemma-explain-why-pure-direct-sum-finite-modules} Let $R$ be a local ring with maximal ideal $\mathfrak m$. Let $R \to S$ be a ring map. Let $N$ be an $S$-module. Assume $N$ is isomorphic as an $R$-module to a direct sum of finite $R$-modules. Then for any $R$-module $M$ and for any prime $\mathfrak q \subset S$ which is an associated prime of $N \otimes_R M$ we have $\mathfrak q + \mathfrak m S \not = S$. \end{lemma} 
\begin{lemma} \label{lemma-explain-why-pure-ML} Let $R$ be a henselian local ring with maximal ideal $\mathfrak m$. Let $R \to S$ be a ring map. Let $N$ be an $S$-module. Assume $N$ is countably generated and Mittag-Leffler as an $R$-module. Then for any $R$-module $M$ and for any prime $\mathfrak q \subset S$ which is an associated prime of $N \otimes_R M$ we have $\mathfrak q + \mathfrak m S \not = S$. \end{lemma} 
\begin{definition} \label{definition-impurity} In Situation \ref{situation-pre-pure} we say a diagram (\ref{equation-impurity}) defines an {\it impurity of $\mathcal{F}$ above $s$} if $\xi \in \text{Ass}_{X_T/T}(\mathcal{F}_T)$ and $\overline{\{\xi\}} \cap X_t = \emptyset$. We will indicate this by saying ``let $(g : T \to S, t' \leadsto t, \xi)$ be an impurity of $\mathcal{F}$ above $s$''. \end{definition} 
\begin{lemma} \label{lemma-impure-finite-presentation} In Situation \ref{situation-pre-pure}. If there exists an impurity of $\mathcal{F}$ above $s$, then there exists an impurity $(g : T \to S, t' \leadsto t, \xi)$ of $\mathcal{F}$ above $s$ such that $g$ is locally of finite presentation and $t$ a closed point of the fibre of $g$ above $s$. \end{lemma} 
\begin{lemma} \label{lemma-impure-limit} In Situation \ref{situation-pre-pure}. Let $(g : T \to S, t' \leadsto t, \xi)$ be an impurity of $\mathcal{F}$ above $s$. Assume $T = \lim_{i \in I} T_i$ is a directed limit of affine schemes over $S$. Then for some $i$ the triple $(T_i \to S, t'_i \leadsto t_i, \xi_i)$ is an impurity of $\mathcal{F}$ above $s$. \end{lemma} 
\begin{lemma} \label{lemma-quasi-finite-impurity-elementary} In Situation \ref{situation-pre-pure}. If there exists an impurity $(g : T \to S, t' \leadsto t, \xi)$ of $\mathcal{F}$ above $s$ with $g$ quasi-finite at $t$, then there exists an impurity $(g : T \to S, t' \leadsto t, \xi)$ such that $(T, t) \to (S, s)$ is an elementary \'etale neighbourhood. \end{lemma} 
\begin{lemma} \label{lemma-Noetherian-impurity-quasi-finite} In Situation \ref{situation-pre-pure}. Assume that $S$ is locally Noetherian. If there exists an impurity of $\mathcal{F}$ above $s$, then there exists an impurity $(g : T \to S, t' \leadsto t, \xi)$ of $\mathcal{F}$ above $s$ such that $g$ is quasi-finite at $t$. \end{lemma} 
\begin{lemma} \label{lemma-impurity-on-henselization} In Situation \ref{situation-pre-pure}. If there exists an impurity $(S^h \to S, s' \leadsto s, \xi)$ of $\mathcal{F}$ above $s$ then there exists an impurity $(T \to S, t' \leadsto t, \xi)$ of $\mathcal{F}$ above $s$ where $(T, t) \to (S, s)$ is an elementary \'etale neighbourhood. \end{lemma} 
\begin{lemma} \label{lemma-pure-along-X-s} In Situation \ref{situation-pre-pure} the following are equivalent \begin{enumerate} \item there exists an impurity $(S^h \to S, s' \leadsto s, \xi)$ of $\mathcal{F}$ above $s$ where $S^h$ is the henselization of $S$ at $s$, \item there exists an impurity $(T \to S, t' \leadsto t, \xi)$ of $\mathcal{F}$ above $s$ such that $(T, t) \to (S, s)$ is an elementary \'etale neighbourhood, and \item there exists an impurity $(T \to S, t' \leadsto t, \xi)$ of $\mathcal{F}$ above $s$ such that $T \to S$ is quasi-finite at $t$. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-pure} Let $f : X \to S$ be a morphism of schemes which is of finite type. Let $\mathcal{F}$ be a finite type quasi-coherent $\mathcal{O}_X$-module. \begin{enumerate} \item Let $s \in S$. We say $\mathcal{F}$ is {\it pure along $X_s$} if there is no impurity $(g : T \to S, t' \leadsto t, \xi)$ of $\mathcal{F}$ above $s$ with $(T, t) \to (S, s)$ an elementary \'etale neighbourhood. \item We say $\mathcal{F}$ is {\it universally pure along $X_s$} if there does not exist any impurity of $\mathcal{F}$ above $s$. \item We say that $X$ is {\it pure along $X_s$} if $\mathcal{O}_X$ is pure along $X_s$. \item We say $\mathcal{F}$ is {\it universally $S$-pure}, or {\it universally pure relative to $S$} if $\mathcal{F}$ is universally pure along $X_s$ for every $s \in S$. \item We say $\mathcal{F}$ is {\it $S$-pure}, or {\it pure relative to $S$} if $\mathcal{F}$ is pure along $X_s$ for every $s \in S$. \item We say that $X$ is {\it $S$-pure} or {\it pure relative to $S$} if $\mathcal{O}_X$ is pure relative to $S$. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-base-change-universally} Let $f : X \to S$ be a morphism of schemes which is of finite type. Let $\mathcal{F}$ be a finite type quasi-coherent $\mathcal{O}_X$-module. Let $s \in S$. The following are equivalent \begin{enumerate} \item $\mathcal{F}$ is universally pure along $X_s$, and \item for every morphism of pointed schemes $(S', s') \to (S, s)$ the pullback $\mathcal{F}_{S'}$ is pure along $X_{s'}$. \end{enumerate} In particular, $\mathcal{F}$ is universally pure relative to $S$ if and only if every base change $\mathcal{F}_{S'}$ of $\mathcal{F}$ is pure relative to $S'$. \end{lemma} 
\begin{lemma} \label{lemma-quasi-finite-base-change} Let $f : X \to S$ be a morphism of schemes which is of finite type. Let $\mathcal{F}$ be a finite type quasi-coherent $\mathcal{O}_X$-module. Let $s \in S$. Let $(S', s') \to (S, s)$ be a morphism of pointed schemes. If $S' \to S$ is quasi-finite at $s'$ and $\mathcal{F}$ is pure along $X_s$, then $\mathcal{F}_{S'}$ is pure along $X_{s'}$. \end{lemma} 
\begin{lemma} \label{lemma-Noetherian-base-change} Let $f : X \to S$ be a morphism of schemes which is of finite type. Let $\mathcal{F}$ be a finite type quasi-coherent $\mathcal{O}_X$-module. Let $s \in S$. If $\mathcal{O}_{S, s}$ is Noetherian then $\mathcal{F}$ is pure along $X_s$ if and only if $\mathcal{F}$ is universally pure along $X_s$. \end{lemma} 
\begin{lemma} \label{lemma-flat-descend-pure} Let $f : X \to S$ be a morphism of schemes which is of finite type. Let $\mathcal{F}$ be a finite type quasi-coherent $\mathcal{O}_X$-module. Let $s \in S$. Let $(S', s') \to (S, s)$ be a morphism of pointed schemes. Assume $S' \to S$ is flat at $s'$. \begin{enumerate} \item If $\mathcal{F}_{S'}$ is pure along $X_{s'}$, then $\mathcal{F}$ is pure along $X_s$. \item If $\mathcal{F}_{S'}$ is universally pure along $X_{s'}$, then $\mathcal{F}$ is universally pure along $X_s$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-supported-on-closed} Let $i : Z \to X$ be a closed immersion of schemes of finite type over a scheme $S$. Let $s \in S$. Let $\mathcal{F}$ be a finite type, quasi-coherent sheaf on $Z$. Then $\mathcal{F}$ is (universally) pure along $Z_s$ if and only if $i_*\mathcal{F}$ is (universally) pure along $X_s$. \end{lemma} 
\begin{lemma} \label{lemma-proper-pure} Let $f : X \to S$ be a morphism of schemes which is of finite type. Let $\mathcal{F}$ be a finite type quasi-coherent $\mathcal{O}_X$-module. \begin{enumerate} \item If the support of $\mathcal{F}$ is proper over $S$, then $\mathcal{F}$ is universally pure relative to $S$. \item If $f$ is proper, then $\mathcal{F}$ is universally pure relative to $S$. \item If $f$ is proper, then $X$ is universally pure relative to $S$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-quasi-finite-pure} Let $f : X \to S$ be a separated, finite type morphism of schemes. Let $\mathcal{F}$ be a finite type, quasi-coherent $\mathcal{O}_X$-module. Assume that $\text{Supp}(\mathcal{F}_s)$ is finite for every $s \in S$. Then the following are equivalent \begin{enumerate} \item $\mathcal{F}$ is pure relative to $S$, \item the scheme theoretic support of $\mathcal{F}$ is finite over $S$, and \item $\mathcal{F}$ is universally pure relative to $S$. \end{enumerate} In particular, given a quasi-finite separated morphism $X \to S$ we see that $X$ is pure relative to $S$ if and only if $X \to S$ is finite. \end{lemma} 
\begin{lemma} \label{lemma-flat-geometrically-integral-fibres-pure} Let $f : X \to S$ be a finite type, flat morphism of schemes with geometrically integral fibres. Then $X$ is universally pure over $S$. \end{lemma} 
\begin{lemma} \label{lemma-affine-locally-projective-pure} Let $f : X \to S$ be a finite type, affine morphism of schemes. Let $\mathcal{F}$ be a finite type quasi-coherent $\mathcal{O}_X$-module such that $f_*\mathcal{F}$ is locally projective on $S$, see Properties, Definition \ref{properties-definition-locally-projective}. Then $\mathcal{F}$ is universally pure over $S$. \end{lemma} 
\begin{lemma} \label{lemma-associated-point-specializes} Let $f : X \to S$ be a morphism of schemes of finite type. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module of finite type. Let $s \in S$. Assume that $\mathcal{F}$ is flat over $S$ at all points of $X_s$. Let $x' \in \text{Ass}_{X/S}(\mathcal{F})$ with $f(x') = s'$ such that $s' \leadsto s$ is a specialization in $S$. If $x'$ specializes to a point of $X_s$, then $x' \leadsto x$ with $x \in \text{Ass}_{X_s}(\mathcal{F}_s)$. \end{lemma} 
\begin{lemma} \label{lemma-criterion} Let $f : X \to S$ be a morphism of schemes of finite type. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module of finite type. Let $s \in S$. Let $(S', s') \to (S, s)$ be an elementary \'etale neighbourhood and let $$ \xymatrix{ X \ar[d] & X' \ar[l]^g \ar[d] \\ S & S' \ar[l] } $$ be a commutative diagram of morphisms of schemes. Assume \begin{enumerate} \item $\mathcal{F}$ is flat over $S$ at all points of $X_s$, \item $X' \to S'$ is of finite type, \item $g^*\mathcal{F}$ is pure along $X'_{s'}$, \item $g : X' \to X$ is \'etale, and \item $g(X')$ contains $\text{Ass}_{X_s}(\mathcal{F}_s)$. \end{enumerate} In this situation $\mathcal{F}$ is pure along $X_s$ if and only if the image of $X' \to X \times_S S'$ contains the points of $\text{Ass}_{X \times_S S'/S'}(\mathcal{F} \times_S S')$ lying over points in $S'$ which specialize to $s'$. \end{lemma} 
\begin{lemma} \label{lemma-finite-type-flat-pure-along-fibre-is-universal} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. Let $s \in S$. Assume \begin{enumerate} \item $f$ is of finite type, \item $\mathcal{F}$ is of finite type, \item $\mathcal{F}$ is flat over $S$ at all points of $X_s$, and \item $\mathcal{F}$ is pure along $X_s$. \end{enumerate} Then $\mathcal{F}$ is universally pure along $X_s$. \end{lemma} 
\begin{lemma} \label{lemma-finite-type-flat-pure-is-universal} Let $f : X \to S$ be a finite type morphism of schemes. Let $\mathcal{F}$ be a finite type quasi-coherent $\mathcal{O}_X$-module. Assume $\mathcal{F}$ is flat over $S$. In this case $\mathcal{F}$ is pure relative to $S$ if and only if $\mathcal{F}$ is universally pure relative to $S$. \end{lemma} 
\begin{lemma} \label{lemma-limit-purity} Let $I$ be a directed set. Let $(S_i, g_{ii'})$ be an inverse system of affine schemes over $I$. Set $S = \lim_i S_i$ and $s \in S$. Denote $g_i : S \to S_i$ the projections and set $s_i = g_i(s)$. Suppose that $f : X \to S$ is a morphism of finite presentation, $\mathcal{F}$ a quasi-coherent $\mathcal{O}_X$-module of finite presentation which is pure along $X_s$ and flat over $S$ at all points of $X_s$. Then there exists an $i \in I$, a morphism of finite presentation $X_i \to S_i$, a quasi-coherent $\mathcal{O}_{X_i}$-module $\mathcal{F}_i$ of finite presentation which is pure along $(X_i)_{s_i}$ and flat over $S_i$ at all points of $(X_i)_{s_i}$ such that $X \cong X_i \times_{S_i} S$ and such that the pullback of $\mathcal{F}_i$ to $X$ is isomorphic to $\mathcal{F}$. \end{lemma} 
\begin{lemma} \label{lemma-flat-finite-presentation-purity-open} Let $f : X \to S$ be a morphism of finite presentation. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module of finite presentation flat over $S$. Then the set $$ U = \{s \in S \mid \mathcal{F}\text{ is pure along }X_s\} $$ is open in $S$. \end{lemma} 
\begin{lemma} \label{lemma-injectivity-map-source-flat-pure} Let $f : X \to S$ be a morphism of finite type. Let $\mathcal{F}$ be a quasi-coherent sheaf of finite type on $X$. Assume $S$ is local with closed point $s$. Assume $\mathcal{F}$ is pure along $X_s$ and that $\mathcal{F}$ is flat over $S$. Let $\varphi : \mathcal{F} \to \mathcal{G}$ of quasi-coherent $\mathcal{O}_X$-modules. Then the following are equivalent \begin{enumerate} \item the map on stalks $\varphi_x$ is injective for all $x \in \text{Ass}_{X_s}(\mathcal{F}_s)$, and \item $\varphi$ is injective. \end{enumerate} \end{lemma} 
\begin{proposition} \label{proposition-finite-presentation-flat-pure-is-projective} Let $f : X \to S$ be an affine, finitely presented morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module of finite presentation, flat over $S$. Then the following are equivalent \begin{enumerate} \item $f_*\mathcal{F}$ is locally projective on $S$, and \item $\mathcal{F}$ is pure relative to $S$. \end{enumerate} In particular, given a ring map $A \to B$ of finite presentation and a finitely presented $B$-module $N$ flat over $A$ we have: $N$ is projective as an $A$-module if and only if $\widetilde{N}$ on $\Spec(B)$ is pure relative to $\Spec(A)$. \end{proposition} 
\begin{lemma} \label{lemma-flat-finite-presentation-affine-neighbourhood-projective} Let $f : X \to S$ be a morphism which is locally of finite presentation. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module which is of finite presentation. Let $x \in X$ with $s = f(x) \in S$. If $\mathcal{F}$ is flat at $x$ over $S$ there exists an affine elementary \'etale neighbourhood $(S', s') \to (S, s)$ and an affine open $U' \subset X \times_S S'$ which contains $x' = (x, s')$ such that $\Gamma(U', \mathcal{F}|_{U'})$ is a projective $\Gamma(S', \mathcal{O}_{S'})$-module. \end{lemma} 
\begin{lemma} \label{lemma-flat-finite-type-affine-neighbourhood-projective} Let $f : X \to S$ be a morphism which is locally of finite type. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module which is of finite type. Let $x \in X$ with $s = f(x) \in S$. If $\mathcal{F}$ is flat at $x$ over $S$ there exists an affine elementary \'etale neighbourhood $(S', s') \to (S, s)$ and an affine open $U' \subset X \times_S \Spec(\mathcal{O}_{S', s'})$ which contains $x' = (x, s')$ such that $\Gamma(U', \mathcal{F}|_{U'})$ is a free $\mathcal{O}_{S', s'}$-module. \end{lemma} 
\begin{lemma} \label{lemma-flat-finite-type-local-colimit-free} Let $A \to B$ be a local ring map of local rings which is essentially of finite type. Let $N$ be a finite $B$-module which is flat as an $A$-module. If $A$ is henselian, then $N$ is a filtered colimit $$ N = \colim_i F_i $$ of free $A$-modules $F_i$ such that all transition maps $u_i : F_i \to F_{i'}$ of the system induce injective maps $\overline{u}_i : F_i/\mathfrak m_AF_i \to F_{i'}/\mathfrak m_AF_{i'}$. Also, $N$ is a Mittag-Leffler $A$-module. \end{lemma} 
\begin{lemma} \label{lemma-flat-finite-type-local-valuation-ring-has-content} Let $A \to B$ be a local ring map of local rings which is essentially of finite type. Let $N$ be a finite $B$-module which is flat as an $A$-module. If $A$ is a valuation ring, then any element of $N$ has a content ideal $I \subset A$ (More on Algebra, Definition \ref{more-algebra-definition-content-ideal}). Also, $I$ is a principal ideal. \end{lemma} 
\begin{lemma} \label{lemma-proper-flat-over-dvr-reduced-fibre} Let $X \to \Spec(R)$ be a proper flat morphism where $R$ is a valuation ring. If the special fibre is reduced, then $X$ and every fibre of $X \to \Spec(R)$ is reduced. \end{lemma} 
\begin{lemma} \label{lemma-iso-sheaf} In Situation \ref{situation-iso}. \begin{enumerate} \item Each of the functors $F_{iso}$, $F_{inj}$, $F_{surj}$, $F_{zero}$ satisfies the sheaf property for the fpqc topology. \item If $f$ is quasi-compact and $\mathcal{G}$ is of finite type, then $F_{surj}$ is limit preserving. \item If $f$ is quasi-compact and $\mathcal{F}$ of finite type, then $F_{zero}$ is limit preserving. \item If $f$ is quasi-compact, $\mathcal{F}$ is of finite type, and $\mathcal{G}$ is of finite presentation, then $F_{iso}$ is limit preserving. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-flat-at-point} In Situation \ref{situation-flat-at-point}. \begin{enumerate} \item If $A' \to A''$ is a flat morphism in $\mathcal{C}$ then $F_{lf}(A') = F_{lf}(A'')$. \item If $A \to B$ is essentially of finite presentation and $M$ is a $B$-module of finite presentation, then $F_{lf}$ is limit preserving: If $\{A_i\}_{i \in I}$ is a directed system of objects of $\mathcal{C}$, then $F_{lf}(\colim_i A_i) = \colim_i F_{lf}(A_i)$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-flat-at-point-finite} In Situation \ref{situation-flat-at-point}. Let $B \to C$ is a local map of local $A$-algebras and $N$ a $C$-module. Denote $F'_{lf} : \mathcal{C} \to \textit{Sets}$ the functor associated to the pair $(C, N)$. If $M \cong N$ as $B$-modules and $B \to C$ is finite, then $F_{lf} = F'_{lf}$. \end{lemma} 
\begin{lemma} \label{lemma-flat-at-point-go-up} In Situation \ref{situation-flat-at-point} suppose that $B \to C$ is a flat local homomorphism of local rings. Set $N = M \otimes_B C$. Denote $F'_{lf} : \mathcal{C} \to \textit{Sets}$ the functor associated to the pair $(C, N)$. Then $F_{lf} = F'_{lf}$. \end{lemma} 
\begin{lemma} \label{lemma-free-at-generic-points} In Situation \ref{situation-free-at-generic-points}. \begin{enumerate} \item The functor $H_p$ satisfies the sheaf property for the fpqc topology. \item If $\mathcal{F}$ is of finite presentation, then functor $H_p$ is limit preserving. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-pre-flat-dimension-n} Let $f : X \to S$ be a morphism of schemes which is locally of finite type. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module of finite type. Let $n \geq 0$. The following are equivalent \begin{enumerate} \item for $s \in S$ the closed subset $Z \subset X_s$ of points where $\mathcal{F}$ is not flat over $S$ (see Lemma \ref{lemma-open-in-fibre-where-flat}) satisfies $\dim(Z) < n$, and \item for $x \in X$ such that $\mathcal{F}$ is not flat at $x$ over $S$ we have $\text{trdeg}_{\kappa(f(x))}(\kappa(x)) < n$. \end{enumerate} If this is true, then it remains true after any base change. \end{lemma} 
\begin{definition} \label{definition-flat-dimension-n} Let $f : X \to S$ be a morphism of schemes which is locally of finite type. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module of finite type. Let $n \geq 0$. We say {\it $\mathcal{F}$ is flat over $S$ in dimensions $\geq n$} if the equivalent conditions of Lemma \ref{lemma-pre-flat-dimension-n} are satisfied. \end{definition} 
\begin{lemma} \label{lemma-flat-dimension-n} In Situation \ref{situation-flat-dimension-n}. \begin{enumerate} \item The functor $F_n$ satisfies the sheaf property for the fpqc topology. \item If $f$ is quasi-compact and locally of finite presentation and $\mathcal{F}$ is of finite presentation, then the functor $F_n$ is limit preserving. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-flat} In Situation \ref{situation-flat}. \begin{enumerate} \item The functor $F_{flat}$ satisfies the sheaf property for the fpqc topology. \item If $f$ is quasi-compact and locally of finite presentation and $\mathcal{F}$ is of finite presentation, then the functor $F_{flat}$ is limit preserving. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-flattening} Let $X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. We say that the {\it universal flattening of $\mathcal{F}$ exists} if the functor $F_{flat}$ defined in Situation \ref{situation-flat} is representable by a scheme $S'$ over $S$. We say that the {\it universal flattening of $X$ exists} if the universal flattening of $\mathcal{O}_X$ exists. \end{definition} 
\begin{definition} \label{definition-flattening-stratification} Let $X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. We say that $\mathcal{F}$ has a {\it flattening stratification} if the functor $F_{flat}$ defined in Situation \ref{situation-flat} is representable by a monomorphism $S' \to S$ associated to a stratification of $S$ by locally closed subschemes. We say that $X$ has a {\it flattening stratification} if $\mathcal{O}_X$ has a flattening stratification. \end{definition} 
\begin{lemma} \label{lemma-flattening-stratification-artinian} Let $S$ be the spectrum of an Artinian ring. For any scheme $X$ over $S$, and any quasi-coherent $\mathcal{O}_X$-module there exists a universal flattening. In fact the universal flattening is given by a closed immersion $S' \to S$, and hence is a flattening stratification for $\mathcal{F}$ as well. \end{lemma} 
\begin{lemma} \label{lemma-universally-separating} Let $S$ be a scheme. Let $g : X' \to X$ be a flat morphism of schemes over $S$ with $X$ locally of finite type over $S$. Let $\mathcal{F}$ be a finite type quasi-coherent $\mathcal{O}_X$-module which is flat over $S$. If $\text{Ass}_{X/S}(\mathcal{F}) \subset g(X')$ then the canonical map $$ \mathcal{F} \longrightarrow g_*g^*\mathcal{F} $$ is injective, and remains injective after any base change. \end{lemma} 
\begin{lemma} \label{lemma-flattening-module-map} Let $A$ be a ring. Let $u : M \to N$ be a surjective map of $A$-modules. If $M$ is projective as an $A$-module, then there exists an ideal $I \subset A$ such that for any ring map $\varphi : A \to B$ the following are equivalent \begin{enumerate} \item $u \otimes 1 : M \otimes_A B \to N \otimes_A B$ is an isomorphism, and \item $\varphi(I) = 0$. \end{enumerate} \end{lemma} 
\begin{theorem} \label{theorem-flattening-map} In Situation \ref{situation-iso} assume \begin{enumerate} \item $f$ is of finite presentation, \item $\mathcal{F}$ is of finite presentation, flat over $S$, and pure relative to $S$, and \item $u$ is surjective. \end{enumerate} Then $F_{iso}$ is representable by a closed immersion $Z \to S$. Moreover $Z \to S$ is of finite presentation if $\mathcal{G}$ is of finite presentation. \end{theorem} 
\begin{lemma} \label{lemma-Weil-restriction-closed-subschemes} Let $f:X\to S$ be a morphism of schemes which is of finite presentation, flat, and pure. Let $Y$ be a closed subscheme of $X$. Let $F=f_*Y$ be the Weil restriction functor of $Y$ along $f$, defined by $$ F : (\Sch/S)^{opp} \to \textit{Sets}, \quad T \mapsto \left\{ \begin{matrix} \{*\} & \text{if} & Y_T\to X_T \text{ is an isomorphism, }\\ \emptyset & \text{else.} & \end{matrix} \right. $$ Then $F$ is representable by a closed immersion $Z\to S$. Moreover $Z\to S$ is of finite presentation if $Y\to S$ is. \end{lemma} 
\begin{theorem} \label{theorem-flattening-local} In Situation \ref{situation-flat-at-point} assume $A$ is henselian, $B$ is essentially of finite type over $A$, and $M$ is a finite $B$-module. Then there exists an ideal $I \subset A$ such that $A/I$ corepresents the functor $F_{lf}$ on the category $\mathcal{C}$. In other words given a local homomorphism of local rings $\varphi : A \to A'$ with $B' = B \otimes_A A'$ and $M' = M \otimes_A A'$ the following are equivalent: \begin{enumerate} \item $\forall \mathfrak q \in V(\mathfrak m_{A'}B' + \mathfrak m_B B') \subset \Spec(B') : M'_{\mathfrak q}\text{ is flat over }A'$, and \item $\varphi(I) = 0$. \end{enumerate} If $B$ is essentially of finite presentation over $A$ and $M$ of finite presentation over $B$, then $I$ is a finitely generated ideal. \end{theorem} 
\begin{lemma} \label{lemma-freebie} Let $S$ be the spectrum of a henselian local ring with closed point $s$. Let $X \to S$ be a morphism of schemes which is locally of finite type. Let $\mathcal{F}$ be a finite type quasi-coherent $\mathcal{O}_X$-module. Let $E \subset X_s$ be a subset. There exists a closed subscheme $Z \subset S$ with the following property: for any morphism of pointed schemes $(T, t) \to (S, s)$ the following are equivalent \begin{enumerate} \item $\mathcal{F}_T$ is flat over $T$ at all points of the fibre $X_t$ which map to a point of $E \subset X_s$, and \item $\Spec(\mathcal{O}_{T, t}) \to S$ factors through $Z$. \end{enumerate} Moreover, if $X \to S$ is locally of finite presentation, $\mathcal{F}$ is of finite presentation, and $E \subset X_s$ is closed and quasi-compact, then $Z \to S$ is of finite presentation. \end{lemma} 
\begin{lemma} \label{lemma-Noetherian-finite-type-injective-into-flat-mod-m} If in Situation \ref{situation-mod-injective} the ring $A$ is Noetherian then the lemma holds. \end{lemma} 
\begin{lemma} \label{lemma-reduce-finite-type-injective-into-flat-mod-m} Let $A_0$ be a local ring. If the lemma holds for every Situation \ref{situation-mod-injective} with $A = A_0$, with $B$ a localization of a polynomial algebra over $A$, and $N$ of finite presentation over $B$, then the lemma holds for every Situation \ref{situation-mod-injective} with $A = A_0$. \end{lemma} 
\begin{lemma} \label{lemma-henselian-finite-type-injective-into-flat-mod-m} If in Situation \ref{situation-mod-injective} the ring $A$ is henselian then the lemma holds. \end{lemma} 
\begin{lemma} \label{lemma-upstairs-finite-type-injective-into-flat-mod-m} Let $A \to B$ be a local ring homomorphism of local rings which is essentially of finite type. Let $u : N \to M$ be a $B$-module map. If $N$ is a finite $B$-module, $M$ is flat over $A$, and $\overline{u} : N/\mathfrak m_A N \to M/\mathfrak m_A M$ is injective, then $u$ is $A$-universally injective, $N$ is of finite presentation over $B$, and $N$ is flat over $A$. \end{lemma} 
\begin{lemma} \label{lemma-valuation-ring-finite-type-injective-into-flat-mod-m} If in Situation \ref{situation-mod-injective} the ring $A$ is a valuation ring then the lemma holds. \end{lemma} 
\begin{lemma} \label{lemma-properties-pure-spreadout} In (\ref{equation-star}) if there exists a pure spreadout, then \begin{enumerate} \item elements of $N$ have content ideals in $A$, and \item if $u : N \to M$ is a morphism to a flat $A$-module $M$ such that $N/\mathfrak m N \to M/\mathfrak m M$ is injective for all maximal ideals $\mathfrak m$ of $A$, then $u$ is $A$-universally injective. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-find-pure-spreadout} In (\ref{equation-star}) for every $\mathfrak p \in \Spec(A)$ there is a finitely generated ideal $I \subset \mathfrak pA_\mathfrak p$ such that over $A_\mathfrak p/I$ we have a pure spreadout. \end{lemma} 
\begin{lemma} \label{lemma-universally-injective-if-flat} In (\ref{equation-star}) assume $N$ is $A$-flat, $M$ is a flat $A$-module, and $u : N \to M$ is an $A$-module map such that $u \otimes \text{id}_{\kappa(\mathfrak p)}$ is injective for all $\mathfrak p \in \Spec(A)$. Then $u$ is $A$-universally injective. \end{lemma} 
\begin{lemma} \label{lemma-big-intersection-is-zero} Let $A$ be a local domain which is not a field. Let $S$ be a set of finitely generated ideals of $A$. Assume that $S$ is closed under products and such that $\bigcup_{I \in S} V(I)$ is the complement of the generic point of $\Spec(A)$. Then $\bigcap_{I \in S} I = (0)$. \end{lemma} 
\begin{lemma} \label{lemma-closed-points-complement} Let $A$ be a local ring. Let $I, J \subset A$ be ideals. If $J$ is finitely generated and $I \subset J^n$ for all $n \geq 1$, then $V(I)$ contains the closed points of $\Spec(A) \setminus V(J)$. \end{lemma} 
\begin{lemma} \label{lemma-make-smaller-flatness-ideal} Let $A$ be a local ring. Let $I \subset A$ be an ideal. Let $U \subset \Spec(A)$ be quasi-compact open. Let $M$ be an $A$-module. Assume that \begin{enumerate} \item $M/IM$ is flat over $A/I$, \item $M$ is flat over $U$, \end{enumerate} Then $M/I_2M$ is flat over $A/I_2$ where $I_2 = \Ker(I \to \Gamma(U, I/I^2))$. \end{lemma} 
\begin{proposition} \label{proposition-finite-type-injective-into-flat-mod-m} Let $A \to B$ be a local ring homomorphism of local rings which is essentially of finite type. Let $M$ be a flat $A$-module, $N$ a finite $B$-module and $u : N \to M$ an $A$-module map such that $\overline{u} : N/\mathfrak m_AN \to M/\mathfrak m_AM$ is injective. Then $u$ is $A$-universally injective, $N$ is of finite presentation over $B$, and $N$ is flat over $A$. \end{proposition} 
\begin{theorem} \label{theorem-check-flatness-at-associated-points} Let $f : X \to S$ be locally of finite type. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module of finite type. Let $x \in X$ with image $s \in S$. The following are equivalent \begin{enumerate} \item $\mathcal{F}$ is flat at $x$ over $S$, and \item for every $x' \in \text{Ass}_{X_s}(\mathcal{F}_s)$ which specializes to $x$ we have that $\mathcal{F}$ is flat at $x'$ over $S$. \end{enumerate} \end{theorem} 
\begin{lemma} \label{lemma-check-along-closed-fibre} Let $S$ be a local scheme with closed point $s$. Let $f : X \to S$ be locally of finite type. Let $\mathcal{F}$ be a finite type quasi-coherent $\mathcal{O}_X$-module. Assume that \begin{enumerate} \item every point of $\text{Ass}_{X/S}(\mathcal{F})$ specializes to a point of the closed fibre $X_s$\footnote{For example this holds if $f$ is finite type and $\mathcal{F}$ is pure along $X_s$, or if $f$ is proper.}, \item $\mathcal{F}$ is flat over $S$ at every point of $X_s$. \end{enumerate} Then $\mathcal{F}$ is flat over $S$. \end{lemma} 
\begin{lemma} \label{lemma-free-at-generic-points-representable} In Situation \ref{situation-free-at-generic-points}. For each $p \geq 0$ the functor $H_p$ (\ref{equation-free-at-generic-points}) is representable by a locally closed immersion $S_p \to S$. If $\mathcal{F}$ is of finite presentation, then $S_p \to S$ is of finite presentation. \end{lemma} 
\begin{lemma} \label{lemma-localize-flat-dimension-n} In Situation \ref{situation-flat-dimension-n}. Let $h : X' \to X$ be an \'etale morphism. Set $\mathcal{F}' = h^*\mathcal{F}$ and $f' = f \circ h$. Let $F_n'$ be (\ref{equation-flat-dimension-n}) associated to $(f' : X' \to S, \mathcal{F}')$. Then $F_n$ is a subfunctor of $F_n'$ and if $h(X') \supset \text{Ass}_{X/S}(\mathcal{F})$, then $F_n = F'_n$. \end{lemma} 
\begin{lemma} \label{lemma-compare-H-F} Assume that $X \to S$ is a smooth morphism of affine schemes with geometrically irreducible fibres of dimension $d$ and that $\mathcal{F}$ is a quasi-coherent $\mathcal{O}_X$-module of finite presentation. Then $F_d = \coprod_{p = 0, \ldots, c} H_p$ for some $c \geq 0$ with $F_d$ as in (\ref{equation-flat-dimension-n}) and $H_p$ as in (\ref{equation-free-at-generic-points}). \end{lemma} 
\begin{lemma} \label{lemma-flat-dimension-n-representable} In Situation \ref{situation-flat-dimension-n}. Let $s \in S$ let $d \geq 0$. Assume \begin{enumerate} \item there exists a complete d\'evissage of $\mathcal{F}/X/S$ over some point $s \in S$, \item $X$ is of finite presentation over $S$, \item $\mathcal{F}$ is an $\mathcal{O}_X$-module of finite presentation, and \item $\mathcal{F}$ is flat in dimensions $\geq d + 1$ over $S$. \end{enumerate} Then after possibly replacing $S$ by an open neighbourhood of $s$ the functor $F_d$ (\ref{equation-flat-dimension-n}) is representable by a monomorphism $Z_d \to S$ of finite presentation. \end{lemma} 
\begin{theorem} \label{theorem-flat-dimension-n-representable} In Situation \ref{situation-flat-dimension-n}. Assume moreover that $f$ is of finite presentation, that $\mathcal{F}$ is an $\mathcal{O}_X$-module of finite presentation, and that $\mathcal{F}$ is pure relative to $S$. Then $F_n$ is representable by a monomorphism $Z_n \to S$ of finite presentation. \end{theorem} 
\begin{lemma} \label{lemma-when-universal-flattening} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. \begin{enumerate} \item If $f$ is of finite presentation, $\mathcal{F}$ is an $\mathcal{O}_X$-module of finite presentation, and $\mathcal{F}$ is pure relative to $S$, then there exists a universal flattening $S' \to S$ of $\mathcal{F}$. Moreover $S' \to S$ is a monomorphism of finite presentation. \item If $f$ is of finite presentation and $X$ is pure relative to $S$, then there exists a universal flattening $S' \to S$ of $X$. Moreover $S' \to S$ is a monomorphism of finite presentation. \item If $f$ is proper and of finite presentation and $\mathcal{F}$ is an $\mathcal{O}_X$-module of finite presentation, then there exists a universal flattening $S' \to S$ of $\mathcal{F}$. Moreover $S' \to S$ is a monomorphism of finite presentation. \item If $f$ is proper and of finite presentation then there exists a universal flattening $S' \to S$ of $X$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-compute-what-it-should-be} In Situation \ref{situation-existence} consider $$ K = R\lim_{D_\QCoh(\mathcal{O}_X)}(\mathcal{F}_n) = DQ_X(R\lim_{D(\mathcal{O}_X)}\mathcal{F}_n) $$ Then $K$ is in $D^b_{\QCoh}(\mathcal{O}_X)$ and in fact $K$ has nonzero cohomology sheaves only in degrees $\geq 0$. \end{lemma} 
\begin{lemma} \label{lemma-compute-against-perfect} In Situation \ref{situation-existence} let $K$ be as in Lemma \ref{lemma-compute-what-it-should-be}. For any perfect object $E$ of $D(\mathcal{O}_X)$ we have \begin{enumerate} \item $M = R\Gamma(X, K \otimes^\mathbf{L} E)$ is a perfect object of $D(A)$ and there is a canonical isomorphism $R\Gamma(X_n, \mathcal{F}_n \otimes^\mathbf{L} E|_{X_n}) = M \otimes_A^\mathbf{L} A_n$ in $D(A_n)$, \item $N = R\Hom_X(E, K)$ is a perfect object of $D(A)$ and there is a canonical isomorphism $R\Hom_{X_n}(E|_{X_n}, \mathcal{F}_n) = N \otimes_A^\mathbf{L} A_n$ in $D(A_n)$. \end{enumerate} In both statements $E|_{X_n}$ denotes the derived pullback of $E$ to $X_n$. \end{lemma} 
\begin{lemma} \label{lemma-relative-pseudo-coherence} In Situation \ref{situation-existence} let $K$ be as in Lemma \ref{lemma-compute-what-it-should-be}. Then $K$ is pseudo-coherent relative to $A$. \end{lemma} 
\begin{lemma} \label{lemma-compute-over-affine} In Situation \ref{situation-existence} let $K$ be as in Lemma \ref{lemma-compute-what-it-should-be}. For any quasi-compact open $U \subset X$ we have $$ R\Gamma(U, K) \otimes_A^\mathbf{L} A_n = R\Gamma(U_n, \mathcal{F}_n) $$ in $D(A_n)$ where $U_n = U \cap X_n$. \end{lemma} 
\begin{lemma} \label{lemma-finitely-presented} In Situation \ref{situation-existence} let $K$ be as in Lemma \ref{lemma-compute-what-it-should-be}. Denote $X_0 \subset X$ the closed subset consisting of points lying over the closed subset $\Spec(A_1) = \Spec(A_2) = \ldots$ of $\Spec(A)$. There exists an open $W \subset X$ containing $X_0$ such that \begin{enumerate} \item $H^i(K)|_W$ is zero unless $i = 0$, \item $\mathcal{F} = H^0(K)|_W$ is of finite presentation, and \item $\mathcal{F}_n = \mathcal{F} \otimes_{\mathcal{O}_X} \mathcal{O}_{X_n}$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-proper-support} In Situation \ref{situation-existence} let $K$ be as in Lemma \ref{lemma-compute-what-it-should-be}. Let $W \subset X$ be as in Lemma \ref{lemma-finitely-presented}. Set $\mathcal{F} = H^0(K)|_W$. Then, after possibly shrinking the open $W$, the support of $\mathcal{F}$ is proper over $A$. \end{lemma} 
\begin{lemma} \label{lemma-monomorphism-isomorphism} Let $A = \lim A_n$ be a limit of a system of rings whose transition maps are surjective and with locally nilpotent kernels. Let $S = \Spec(A)$. Let $T \to S$ be a monomorphism which is locally of finite type. If $\Spec(A_n) \to S$ factors through $T$ for all $n$, then $T = S$. \end{lemma} 
\begin{theorem}[Grothendieck Existence Theorem] \label{theorem-existence} In Situation \ref{situation-existence} there exists a finitely presented $\mathcal{O}_X$-module $\mathcal{F}$, flat over $A$, with support proper over $A$, such that $\mathcal{F}_n = \mathcal{F} \otimes_{\mathcal{O}_X} \mathcal{O}_{X_n}$ for all $n$ compatibly with the maps $\varphi_n$. \end{theorem} 
\begin{lemma} \label{lemma-compute-what-it-should-be-derived} In Situation \ref{situation-existence-derived} consider $$ K = R\lim_{D_\QCoh(\mathcal{O}_X)}(K_n) = DQ_X(R\lim_{D(\mathcal{O}_X)} K_n) $$ Then $K$ is in $D^-_{\QCoh}(\mathcal{O}_X)$. \end{lemma} 
\begin{lemma} \label{lemma-compute-against-perfect-derived} In Situation \ref{situation-existence-derived} let $K$ be as in Lemma \ref{lemma-compute-what-it-should-be-derived}. For any perfect object $E$ of $D(\mathcal{O}_X)$ the cohomology $$ M = R\Gamma(X, K \otimes^\mathbf{L} E) $$ is a pseudo-coherent object of $D(A)$ and there is a canonical isomorphism $$ R\Gamma(X_n, K_n \otimes^\mathbf{L} E|_{X_n}) = M \otimes_A^\mathbf{L} A_n $$ in $D(A_n)$. Here $E|_{X_n}$ denotes the derived pullback of $E$ to $X_n$. \end{lemma} 
\begin{lemma} \label{lemma-relative-pseudo-coherence-derived} In Situation \ref{situation-existence-derived} let $K$ be as in Lemma \ref{lemma-compute-what-it-should-be-derived}. Then $K$ is pseudo-coherent on $X$. \end{lemma} 
\begin{lemma} \label{lemma-compute-over-affine-derived} In Situation \ref{situation-existence-derived} let $K$ be as in Lemma \ref{lemma-compute-what-it-should-be-derived}. For any quasi-compact open $U \subset X$ we have $$ R\Gamma(U, K) \otimes_A^\mathbf{L} A_n = R\Gamma(U_n, K_n) $$ in $D(A_n)$ where $U_n = U \cap X_n$. \end{lemma} 
\begin{theorem}[Derived Grothendieck Existence Theorem] \label{theorem-existence-derived} In Situation \ref{situation-existence-derived} there exists a pseudo-coherent $K$ in $D(\mathcal{O}_X)$ such that $K_n = K \otimes_{\mathcal{O}_X}^\mathbf{L} \mathcal{O}_{X_n}$ for all $n$ compatibly with the maps $\varphi_n$. \end{theorem} 
\begin{lemma} \label{lemma-helper-blowup-affine-space} Let $R$ be a ring and let $f \in R$. Let $r\geq 0$ be an integer. Let $R \to S$ be a ring map and let $M$ be an $S$-module. Assume \begin{enumerate} \item $R \to S$ is of finite presentation and flat, \item every fibre ring $S \otimes_R \kappa(\mathfrak p)$ is geometrically integral over $R$, \item $M$ is a finite $S$-module, \item $M_f$ is a finitely presented $S_f$-module, \item for all $\mathfrak p \in R$, $f \not \in \mathfrak p$ with $\mathfrak q = \mathfrak pS$ the module $M_{\mathfrak q}$ is free of rank $r$ over $S_\mathfrak q$. \end{enumerate} Then there exists a finitely generated ideal $I \subset R$ with $V(f) = V(I)$ such that for all $a \in I$ with $R' = R[\frac{I}{a}]$ the quotient $$ M' = (M \otimes_R R')/a\text{-power torsion} $$ over $S' = S \otimes_R R'$ satisfies the following: for every prime $\mathfrak p' \subset R'$ there exists a $g \in S'$, $g \not \in \mathfrak p'S'$ such that $M'_g$ is a free $S'_g$-module of rank $r$. \end{lemma} 
\begin{lemma} \label{lemma-flatten-module-pre} Let $S$ be a quasi-compact and quasi-separated scheme. Let $X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent module on $X$. Let $U \subset S$ be a quasi-compact open. Assume \begin{enumerate} \item $X \to S$ is affine, of finite presentation, flat, geometrically integral fibres, \item $\mathcal{F}$ is a module of finite type, \item $\mathcal{F}_U$ is of finite presentation, \item $\mathcal{F}$ is flat over $S$ at all generic points of fibres lying over points of $U$. \end{enumerate} Then there exists a $U$-admissible blowup $S' \to S$ and an open subscheme $V \subset X_{S'}$ such that (a) the strict transform $\mathcal{F}'$ of $\mathcal{F}$ restricts to a finitely locally free $\mathcal{O}_V$-module and (b) $V \to S'$ is surjective. \end{lemma} 
\begin{lemma} \label{lemma-trick-fitting-ideal} Let $A \to C$ be a finite locally free ring map of rank $d$. Let $h \in C$ be an element such that $C_h$ is \'etale over $A$. Let $J \subset C$ be an ideal. Set $I = \text{Fit}_0(C/J)$ where we think of $C/J$ as a finite $A$-module. Then $IC_h = JJ'$ for some ideal $J' \subset C_h$. If $J$ is finitely generated so are $I$ and $J'$. \end{lemma} 
\begin{lemma} \label{lemma-push-ideal} Let $A \to B$ be an \'etale ring map. Let $a \in A$ be a nonzerodivisor. Let $J \subset B$ be a finite type ideal with $V(J) \subset V(aB)$. For every $\mathfrak q \subset B$ there exists a finite type ideal $I \subset A$ with $V(I) \subset V(a)$ and $g \in B$, $g \not \in \mathfrak q$ such that $IB_g = JJ'$ for some finite type ideal $J' \subset B_g$. \end{lemma} 
\begin{lemma} \label{lemma-flatten-module-etale-localize} Let $S$ be a quasi-compact and quasi-separated scheme. Let $X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent module on $X$. Let $U \subset S$ be a quasi-compact open. Assume there exist finitely many commutative diagrams $$ \xymatrix{ & X_i \ar[r]_{j_i} \ar[d] & X \ar[d] \\ S_i^* \ar[r] & S_i \ar[r]^{e_i} & S } $$ where \begin{enumerate} \item $e_i : S_i \to S$ are quasi-compact \'etale morphisms and $S = \bigcup e_i(S_i)$, \item $j_i : X_i \to X$ are \'etale morphisms and $X = \bigcup j_i(X_i)$, \item $S^*_i \to S_i$ is an $e_i^{-1}(U)$-admissible blowup such that the strict transform $\mathcal{F}_i^*$ of $j_i^*\mathcal{F}$ is flat over $S^*_i$. \end{enumerate} Then there exists a $U$-admissible blowup $S' \to S$ such that the strict transform of $\mathcal{F}$ is flat over $S'$. \end{lemma} 
\begin{theorem} \label{theorem-flatten-module} Let $S$ be a quasi-compact and quasi-separated scheme. Let $X$ be a scheme over $S$. Let $\mathcal{F}$ be a quasi-coherent module on $X$. Let $U \subset S$ be a quasi-compact open. Assume \begin{enumerate} \item $X$ is quasi-compact, \item $X$ is locally of finite presentation over $S$, \item $\mathcal{F}$ is a module of finite type, \item $\mathcal{F}_U$ is of finite presentation, and \item $\mathcal{F}_U$ is flat over $U$. \end{enumerate} Then there exists a $U$-admissible blowup $S' \to S$ such that the strict transform $\mathcal{F}'$ of $\mathcal{F}$ is an $\mathcal{O}_{X \times_S S'}$-module of finite presentation and flat over $S'$. \end{theorem} 
\begin{lemma} \label{lemma-flat-after-blowing-up} Let $S$ be a quasi-compact and quasi-separated scheme. Let $X$ be a scheme over $S$. Let $U \subset S$ be a quasi-compact open. Assume \begin{enumerate} \item $X \to S$ is of finite type and quasi-separated, and \item $X_U \to U$ is flat and locally of finite presentation. \end{enumerate} Then there exists a $U$-admissible blowup $S' \to S$ such that the strict transform of $X$ is flat and of finite presentation over $S'$. \end{lemma} 
\begin{lemma} \label{lemma-finite-after-blowing-up} Let $S$ be a quasi-compact and quasi-separated scheme. Let $X$ be a scheme over $S$. Let $U \subset S$ be a quasi-compact open. Assume \begin{enumerate} \item $X \to S$ is proper, and \item $X_U \to U$ is finite locally free. \end{enumerate} Then there exists a $U$-admissible blowup $S' \to S$ such that the strict transform of $X$ is finite locally free over $S'$. \end{lemma} 
\begin{lemma} \label{lemma-zariski-after-blowup} Let $\varphi : X \to S$ be a separated morphism of finite type with $S$ quasi-compact and quasi-separated. Let $U \subset S$ be a quasi-compact open such that $\varphi^{-1}U \to U$ is an isomorphism. Then there exists a $U$-admissible blowup $S' \to S$ such that the strict transform $X'$ of $X$ is isomorphic to an open subscheme of $S'$. \end{lemma} 
\begin{lemma} \label{lemma-dominate-modification-by-blowup} Let $\varphi : X \to S$ be a proper morphism with $S$ quasi-compact and quasi-separated. Let $U \subset S$ be a quasi-compact open such that $\varphi^{-1}U \to U$ is an isomorphism. Then there exists a $U$-admissible blowup $S' \to S$ which dominates $X$, i.e., such that there exists a factorization $S' \to X \to S$ of the blowup morphism. \end{lemma} 
\begin{lemma} \label{lemma-get-section-after-blowup} Let $S$ be a scheme. Let $U \subset W \subset S$ be open subschemes. Let $f : X \to W$ be a morphism and let $s : U \to X$ be a morphism such that $f \circ s = \text{id}_U$. Assume \begin{enumerate} \item $f$ is proper, \item $S$ is quasi-compact and quasi-separated, and \item $U$ and $W$ are quasi-compact. \end{enumerate} Then there exists a $U$-admissible blowup $b : S' \to S$ and a morphism $s' : b^{-1}(W) \to X$ extending $s$ with $f \circ s' = b|_{b^{-1}(W)}$. \end{lemma} 
\begin{lemma} \label{lemma-compactifications-cofiltered} Let $S$ be a quasi-compact and quasi-separated scheme. Let $X$ be a compactifyable scheme over $S$. \begin{enumerate} \item[(a)] The category of compactifications of $X$ over $S$ is cofiltered. \item[(b)] The full subcategory consisting of compactifications $j : X \to \overline{X}$ such that $j(X)$ is dense and scheme theoretically dense in $\overline{X}$ is initial (Categories, Definition \ref{categories-definition-initial}). \item[(c)] If $f : \overline{X}' \to \overline{X}$ is a morphism of compactifications of $X$ such that $j'(X)$ is dense in $\overline{X}'$, then $f^{-1}(j(X)) = j'(X)$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-compactifyable} Let $S$ be a quasi-compact and quasi-separated scheme. Let $f : X \to Y$ be a morphism of schemes over $S$ with $Y$ separated and of finite type over $S$ and $X$ compactifyable over $S$. Then $X$ has a compactification over $Y$. \end{lemma} 
\begin{lemma} \label{lemma-right-multiplicative-system} Let $S$ be a quasi-compact and quasi-separated scheme. The collection of morphisms $(u, \overline{u}) : (X', \overline{X}') \to (X, \overline{X})$ such that $u$ is an isomorphism forms a right multiplicative system (Categories, Definition \ref{categories-definition-multiplicative-system}) of arrows in the category of compactifications. \end{lemma} 
\begin{lemma} \label{lemma-invert-right-multiplicative-system} Let $S$ be a quasi-compact and quasi-separated scheme. The functor $(X, \overline{X}) \mapsto X$ defines an equivalence from the category of compactifications localized (Categories, Lemma \ref{categories-lemma-right-localization}) at the right multiplicative system of Lemma \ref{lemma-right-multiplicative-system} to the category of compactifyable schemes over $S$. \end{lemma} 
\begin{lemma} \label{lemma-check-separated} Let $X \to S$ be a morphism of schemes. If $X = U \cup V$ is an open cover such that $U \to S$ and $V \to S$ are separated and $U \cap V \to U \times_S V$ is closed, then $X \to S$ is separated. \end{lemma} 
\begin{lemma} \label{lemma-separate-disjoint-locally-closed-by-blowing-up} Let $X$ be a quasi-compact and quasi-separated scheme. Let $U \subset X$ be a quasi-compact open. \begin{enumerate} \item If $Z_1, Z_2 \subset X$ are closed subschemes of finite presentation such that $Z_1 \cap Z_2 \cap U = \emptyset$, then there exists a $U$-admissible blowing up $X' \to X$ such that the strict transforms of $Z_1$ and $Z_2$ are disjoint. \item If $T_1, T_2 \subset U$ are disjoint constructible closed subsets, then there is a $U$-admissible blowing up $X' \to X$ such that the closures of $T_1$ and $T_2$ are disjoint. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-blowup-iso-along} Let $f : X \to Y$ be a proper morphism of quasi-compact and quasi-separated schemes. Let $V \subset Y$ be a quasi-compact open and $U = f^{-1}(V)$. Let $T \subset V$ be a closed subset such that $f|_U : U \to V$ is an isomorphism over an open neighbourhood of $T$ in $V$. Then there exists a $V$-admissible blowing up $Y' \to Y$ such that the strict transform $f' : X' \to Y'$ of $f$ is an isomorphism over an open neighbourhood of the closure of $T$ in $Y'$. \end{lemma} 
\begin{lemma} \label{lemma-find-common-blowups} Let $S$ be a quasi-compact and quasi-separated scheme. Let $U \to X_1$ and $U \to X_2$ be open immersions of schemes over $S$ and assume $U$, $X_1$, $X_2$ of finite type and separated over $S$. Then there exists a commutative diagram $$ \xymatrix{ X_1' \ar[d] \ar[r] & X & X_2' \ar[l] \ar[d] \\ X_1 & U \ar[l] \ar[lu] \ar[u] \ar[ru] \ar[r] & X_2 } $$ of schemes over $S$ where $X_i' \to X_i$ is a $U$-admissible blowup, $X_i' \to X$ is an open immersion, and $X$ is separated and finite type over $S$. \end{lemma} 
\begin{lemma} \label{lemma-replaced-by-strict-transform} Let $X \to S$ and $Y \to S$ be morphisms of schemes. Let $U \subset X$ be an open subscheme. Let $V \to X \times_S Y$ be a quasi-compact morphism whose composition with the first projection maps into $U$. Let $Z \subset X \times_S Y$ be the scheme theoretic image of $V \to X \times_S Y$. Let $X' \to X$ be a $U$-admissible blowup. Then the scheme theoretic image of $V \to X' \times_S Y$ is the strict transform of $Z$ with respect to the blowing up. \end{lemma} 
\begin{lemma} \label{lemma-compactification-dominates} Let $S$ be a quasi-compact and quasi-separated scheme. Let $U$ be a scheme of finite type and separated over $S$. Let $V \subset U$ be a quasi-compact open. If $V$ has a compactification $V \subset Y$ over $S$, then there exists a $V$-admissible blowing up $Y' \to Y$ and an open $V \subset V' \subset Y'$ such that $V \to U$ extends to a proper morphism $V' \to U$. \end{lemma} 
\begin{lemma} \label{lemma-two-compactifications} Let $S$ be a Noetherian scheme. Let $U$ be a scheme of finite type and separated over $S$. Let $U = U_1 \cup U_2$ be opens such that $U_1$ and $U_2$ have compactifications over $S$ and such that $U_1 \cap U_2$ is dense in $U$. Then $U$ has a compactification over $S$. \end{lemma} 
\begin{theorem} \label{theorem-nagata} \begin{reference} See \cite{Lutkebohmert}, \cite{Conrad-Nagata}, \cite{Nagata-1}, \cite{Nagata-2}, \cite{Nagata-3}, and \cite{Nagata-4} \end{reference} Let $S$ be a quasi-compact and quasi-separated scheme. Let $X \to S$ be a separated, finite type morphism. Then $X$ has a compactification over $S$. \end{theorem} 
\begin{lemma} \label{lemma-equivalence-h-v-locally-finite-presentation} Let $\{f_i : X_i \to X\}_{i \in I}$ be a family of morphisms of schemes with fixed target with $f_i$ locally of finite presentation for all $i$. The following are equivalent \begin{enumerate} \item $\{X_i \to X\}$ is a ph covering, and \item $\{X_i \to X\}$ is a V covering. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-h-covering} Let $T$ be a scheme. A {\it h covering of $T$} is a family of morphisms $\{f_i : T_i \to T\}_{i \in I}$ such that each $f_i$ is locally of finite presentation and one of the equivalent conditions of Lemma \ref{lemma-equivalence-h-v-locally-finite-presentation} is satisfied. \end{definition} 
\begin{lemma} \label{lemma-Noetherian-h-covering} Let $X$ be a Noetherian scheme. Let $\{X_i \to X\}_{i \in I}$ be a finite family of finite type morphisms. The following are equivalent \begin{enumerate} \item $\coprod_{i \in I} X_i \to X$ is universally submersive (Morphisms, Definition \ref{morphisms-definition-submersive}), and \item $\{X_i \to X\}_{i \in I}$ is an h covering. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-Noetherian-h-ph} Let $X$ be a locally Noetherian scheme. A family of morphisms $\{f_i : X_i \to X\}_{i \in I}$ with target $X$ is an h covering if and only if it is a ph covering. \end{lemma} 
\begin{lemma} \label{lemma-approximate-h-cover} Let $X$ be an affine scheme. Let $\{X_i \to X\}_{i \in I}$ be an h covering. Then there exists a surjective proper morphism $$ Y \longrightarrow X $$ of finite presentation (!) and a finite affine open covering $Y = \bigcup_{j = 1, \ldots, m} Y_j$ such that $\{Y_j \to X\}_{j = 1, \ldots, m}$ refines $\{X_i \to X\}_{i \in I}$. \end{lemma} 
\begin{lemma} \label{lemma-zariski-h} An fppf covering is a h covering. Hence syntomic, smooth, \'etale, and Zariski coverings are h coverings as well. \end{lemma} 
\begin{lemma} \label{lemma-surjective-proper-finite-presentation-h} Let $f : Y \to X$ be a surjective proper morphism of schemes which is of finite presentation. Then $\{Y \to X\}$ is an h covering. \end{lemma} 
\begin{lemma} \label{lemma-refine-by-h} Let $T$ be a scheme. Let $\{f_i : T_i \to T\}_{i \in I}$ be a family of morphisms such that $f_i$ is locally of finite presentation for all $i$. The following are equivalent \begin{enumerate} \item $\{T_i \to T\}_{i \in I}$ is an h covering, \item there is an h covering which refines $\{T_i \to T\}_{i \in I}$, and \item $\{\coprod_{i \in I} T_i \to T\}$ is an h covering. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-h} Let $T$ be a scheme. \begin{enumerate} \item If $T' \to T$ is an isomorphism then $\{T' \to T\}$ is an h covering of $T$. \item If $\{T_i \to T\}_{i\in I}$ is an h covering and for each $i$ we have an h covering $\{T_{ij} \to T_i\}_{j\in J_i}$, then $\{T_{ij} \to T\}_{i \in I, j\in J_i}$ is an h covering. \item If $\{T_i \to T\}_{i\in I}$ is an h covering and $T' \to T$ is a morphism of schemes then $\{T' \times_T T_i \to T'\}_{i\in I}$ is an h covering. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-big-h-site} A {\it big h site} is any site $\Sch_h$ as in Sites, Definition \ref{sites-definition-site} constructed as follows: \begin{enumerate} \item Choose any set of schemes $S_0$, and any set of h coverings $\text{Cov}_0$ among these schemes. \item As underlying category take any category $\Sch_\alpha$ constructed as in Sets, Lemma \ref{sets-lemma-construct-category} starting with the set $S_0$. \item Choose any set of coverings as in Sets, Lemma \ref{sets-lemma-coverings-site} starting with the category $\Sch_\alpha$ and the class of h coverings, and the set $\text{Cov}_0$ chosen above. \end{enumerate} \end{definition} 
\begin{definition} \label{definition-standard-h} Let $T$ be an affine scheme. A {\it standard h covering} of $T$ is a family $\{f_i : T_i \to T\}_{i = 1, \ldots, n}$ with each $T_i$ affine, with $f_i$ of finite presentation satisfying either of the following equivalent conditions: (1) $\{T_i \to T\}$ can be refined by a standard ph covering or (2) $\{T_i \to T\}$ is a V covering. \end{definition} 
\begin{lemma} \label{lemma-h-induced} Let $\Sch_h$ be a big h site as in Definition \ref{definition-big-h-site}. Let $T \in \Ob(\Sch_h)$. Let $\{T_i \to T\}_{i \in I}$ be an arbitrary h covering of $T$. \begin{enumerate} \item There exists a covering $\{U_j \to T\}_{j \in J}$ of $T$ in the site $\Sch_h$ which refines $\{T_i \to T\}_{i \in I}$. \item If $\{T_i \to T\}_{i \in I}$ is a standard h covering, then it is tautologically equivalent to a covering of $\Sch_h$. \item If $\{T_i \to T\}_{i \in I}$ is a Zariski covering, then it is tautologically equivalent to a covering of $\Sch_h$. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-big-small-h} Let $S$ be a scheme. Let $\Sch_h$ be a big h site containing $S$. \begin{enumerate} \item The {\it big h site of $S$}, denoted $(\Sch/S)_h$, is the site $\Sch_h/S$ introduced in Sites, Section \ref{sites-section-localize}. \item The {\it big affine h site of $S$}, denoted $(\textit{Aff}/S)_h$, is the full subcategory of $(\Sch/S)_h$ whose objects are affine $U/S$. A covering of $(\textit{Aff}/S)_h$ is any covering $\{U_i \to U\}$ of $(\Sch/S)_h$ which is a standard h covering. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-verify-site-h} Let $S$ be a scheme. Let $\Sch_h$ be a big h site containing $S$. Then $(\textit{Aff}/S)_h$ is a site. \end{lemma} 
\begin{lemma} \label{lemma-fibre-products-h} Let $S$ be a scheme. Let $\Sch_h$ be a big h site containing $S$. The underlying categories of the sites $\Sch_h$, $(\Sch/S)_h$, and $(\textit{Aff}/S)_h$ have fibre products. In each case the obvious functor into the category $\Sch$ of all schemes commutes with taking fibre products. The category $(\Sch/S)_h$ has a final object, namely $S/S$. \end{lemma} 
\begin{lemma} \label{lemma-affine-big-site-h} Let $S$ be a scheme. Let $\Sch_h$ be a big h site containing $S$. The functor $(\textit{Aff}/S)_h \to (\Sch/S)_h$ is cocontinuous and induces an equivalence of topoi from $\Sh((\textit{Aff}/S)_h)$ to $\Sh((\Sch/S)_h)$. \end{lemma} 
\begin{lemma} \label{lemma-characterize-sheaf-h} Let $\mathcal{F}$ be a presheaf on $(\Sch/S)_h$. Then $\mathcal{F}$ is a sheaf if and only if \begin{enumerate} \item $\mathcal{F}$ satisfies the sheaf condition for Zariski coverings, and \item if $f : V \to U$ is proper, surjective, and of finite presentation, then $\mathcal{F}(U)$ maps bijectively to the equalizer of the two maps $\mathcal{F}(V) \to \mathcal{F}(V \times_U V)$. \end{enumerate} Moreover, in the presence of (1) property (2) is equivalent to property \begin{enumerate} \item[(2')] the sheaf property for $\{V \to U\}$ as in (2) with $U$ affine. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-morphism-big-h} Let $\Sch_h$ be a big h site. Let $f : T \to S$ be a morphism in $\Sch_h$. The functor $$ u : (\Sch/T)_h \longrightarrow (\Sch/S)_h, \quad V/T \longmapsto V/S $$ is cocontinuous, and has a continuous right adjoint $$ v : (\Sch/S)_h \longrightarrow (\Sch/T)_h, \quad (U \to S) \longmapsto (U \times_S T \to T). $$ They induce the same morphism of topoi $$ f_{big} : \Sh((\Sch/T)_h) \longrightarrow \Sh((\Sch/S)_h) $$ We have $f_{big}^{-1}(\mathcal{G})(U/T) = \mathcal{G}(U/S)$. We have $f_{big, *}(\mathcal{F})(U/S) = \mathcal{F}(U \times_S T/T)$. Also, $f_{big}^{-1}$ has a left adjoint $f_{big!}$ which commutes with fibre products and equalizers. \end{lemma} 
\begin{lemma} \label{lemma-composition-h} Given schemes $X$, $Y$, $Y$ in $(\Sch/S)_h$ and morphisms $f : X \to Y$, $g : Y \to Z$ we have $g_{big} \circ f_{big} = (g \circ f)_{big}$. \end{lemma} 
\begin{lemma} \label{lemma-limit-h-topology} Let $T$ be an affine scheme which is written as a limit $T = \lim_{i \in I} T_i$ of a directed inverse system of affine schemes. \begin{enumerate} \item Let $\mathcal{V} = \{V_j \to T\}_{j = 1, \ldots, m}$ be a standard h covering of $T$, see Definition \ref{definition-standard-h}. Then there exists an index $i$ and a standard h covering $\mathcal{V}_i = \{V_{i, j} \to T_i\}_{j = 1, \ldots, m}$ whose base change $T \times_{T_i} \mathcal{V}_i$ to $T$ is isomorphic to $\mathcal{V}$. \item Let $\mathcal{V}_i$, $\mathcal{V}'_i$ be a pair of standard h coverings of $T_i$. If $f : T \times_{T_i} \mathcal{V}_i \to T \times_{T_i} \mathcal{V}'_i$ is a morphism of coverings of $T$, then there exists an index $i' \geq i$ and a morphism $f_{i'} : T_{i'} \times_{T_i} \mathcal{V} \to T_{i'} \times_{T_i} \mathcal{V}'_i$ whose base change to $T$ is $f$. \item If $f, g : \mathcal{V} \to \mathcal{V}'_i$ are morphisms of standard h coverings of $T_i$ whose base changes $f_T, g_T$ to $T$ are equal then there exists an index $i' \geq i$ such that $f_{T_{i'}} = g_{T_{i'}}$. \end{enumerate} In other words, the category of standard h coverings of $T$ is the colimit over $I$ of the categories of standard h coverings of $T_i$. \end{lemma} 
\begin{lemma} \label{lemma-extend-sheaf-h} Let $S$ be a scheme contained in a big site $\Sch_h$. Let $F : (\Sch/S)_h^{opp} \to \textit{Sets}$ be an h sheaf satisfying property (b) of Topologies, Lemma \ref{topologies-lemma-extend} with $\mathcal{C} = (\Sch/S)_h$. Then the extension $F'$ of $F$ to the category of all schemes over $S$ satisfies the sheaf condition for all h coverings and is limit preserving (Limits, Remark \ref{limits-remark-limit-preserving}). \end{lemma} 
\begin{lemma} \label{lemma-blow-up-square-ph} Let $\mathcal{F}$ be a sheaf on a site $(\Sch/S)_{ph}$, see Topologies, Definition \ref{topologies-definition-big-small-ph}. Then for any blow up square (\ref{equation-blow-up-square}) in the category $(\Sch/S)_{ph}$ the diagram $$ \xymatrix{ \mathcal{F}(E) & \mathcal{F}(X') \ar[l] \\ \mathcal{F}(Z) \ar[u] & \mathcal{F}(X) \ar[u] \ar[l] } $$ is cartesian in the category of sets. \end{lemma} 
\begin{lemma} \label{lemma-thickening-ph} Let $\mathcal{F}$ be a sheaf on a site $(\Sch/S)_{ph}$ as in Topologies, Definition \ref{topologies-definition-big-small-ph}. Let $X \to X'$ be a morphism of $(\Sch/S)_{ph}$ which is a thickening. Then $\mathcal{F}(X') \to \mathcal{F}(X)$ is bijective. \end{lemma} 
\begin{lemma} \label{lemma-base-change-almost-blow-up} Consider an almost blow up square (\ref{equation-almost-blow-up-square}). Let $Y \to X$ be any morphism. Then the base change $$ \xymatrix{ Y \times_X E \ar[d] \ar[r] & Y \times_X X' \ar[d] \\ Y \times_X Z \ar[r] & Y } $$ is an almost blow up square too. \end{lemma} 
\begin{lemma} \label{lemma-shrink-almost-blow-up} Consider an almost blow up square (\ref{equation-almost-blow-up-square}). Let $W \to X'$ be a closed immersion of finite presentation. The following are equivalent \begin{enumerate} \item $X' \setminus E$ is scheme theoretically contained in $W$, \item the blowup $X''$ of $X$ in $Z$ is scheme theoretically contained in $W$, \item the diagram $$ \xymatrix{ E \cap W \ar[d] \ar[r] & W \ar[d] \\ Z \ar[r] & X } $$ is an almost blow up square. Here $E \cap W$ is the scheme theoretic intersection. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-blow-up-limit-almost-blow-up} Consider an almost blow up square (\ref{equation-almost-blow-up-square}) with $X$ quasi-compact and quasi-separated. Then the blowup $X''$ of $X$ in $Z$ can be written as $$ X'' = \lim X'_i $$ where the limit is over the directed system of closed subschemes $X'_i \subset X'$ of finite presentation satisfying the equivalent conditions of Lemma \ref{lemma-shrink-almost-blow-up}. \end{lemma} 
\begin{lemma} \label{lemma-almost-blow-up-square} Let $X$ be a quasi-compact and quasi-separated scheme. Let $Z \subset X$ be a closed subscheme cut out by a finite type quasi-coherent sheaf of ideals. Then there exists an almost blow up square as in (\ref{equation-almost-blow-up-square}). \end{lemma} 
\begin{lemma} \label{lemma-almost-blow-up-unique} Let $X$ be a quasi-compact and quasi-separated scheme and let $Z \subset X$ be a closed subscheme cut out by a finite type quasi-coherent sheaf of ideals. Suppose given almost blow up squares (\ref{equation-almost-blow-up-square}) $$ \xymatrix{ E_k \ar[r] \ar[d] & X_k' \ar[d] \\ Z \ar[r] & X } $$ for $k = 1, 2$, then there exists an almost blow up square $$ \xymatrix{ E \ar[r] \ar[d] & X' \ar[d] \\ Z \ar[r] & X } $$ and closed immersions $i_k : X' \to X'_k$ over $X$ with $E = i_k^{-1}(E_k)$. \end{lemma} 
\begin{lemma} \label{lemma-flat-after-almost-blowing-up} Let $Y$ be a quasi-compact and quasi-separated scheme. Let $X$ be a scheme of finite presentation over $Y$. Let $V \subset Y$ be a quasi-compact open such that $X_V \to V$ is flat. Then there exist a commutative diagram $$ \xymatrix{ E \ar[ddd] \ar[rd] & & & D \ar[lll] \ar[ddd] \ar[ld] \\ & Y' \ar[d] & X' \ar[l] \ar[d] \\ & Y & X \ar[l] \\ Z \ar[ru] & & & T \ar[lll] \ar[lu] } $$ whose right and left hand squares are almost blow up squares, whose lower and top squares are cartesian, such that $Z \cap V = \emptyset$, and such that $X' \to Y'$ is flat (and of finite presentation). \end{lemma} 
\begin{lemma} \label{lemma-blow-up-square-h} Let $\mathcal{F}$ be a sheaf on one of the sites $(\Sch/S)_h$ constructed in Definition \ref{definition-big-small-h}. Then for any almost blow up square (\ref{equation-almost-blow-up-square}) in the category $(\Sch/S)_h$ the diagram $$ \xymatrix{ \mathcal{F}(E) & \mathcal{F}(X') \ar[l] \\ \mathcal{F}(Z) \ar[u] & \mathcal{F}(X) \ar[u] \ar[l] } $$ is cartesian in the category of sets. \end{lemma} 
\begin{lemma} \label{lemma-thickening-h} Let $\mathcal{F}$ be a sheaf on one of the sites $(\Sch/S)_h$ constructed in Definition \ref{definition-big-small-h}. Let $X \to X'$ be a morphism of $(\Sch/S)_h$ which is a thickening and of finite presentation. Then $\mathcal{F}(X') \to \mathcal{F}(X)$ is bijective. \end{lemma} 
\begin{proposition} \label{proposition-check-h} Let $\mathcal{F}$ be a presheaf on one of the sites $(\Sch/S)_h$ constructed in Definition \ref{definition-big-small-h}. Then $\mathcal{F}$ is a sheaf if and only if the following conditions are satisfied \begin{enumerate} \item $\mathcal{F}$ is a sheaf for the Zariski topology, \item given a morphism $f : X \to Y$ of $(\Sch/S)_h$ with $Y$ affine and $f$ surjective, flat, proper, and of finite presentation, then $\mathcal{F}(Y)$ is the equalizer of the two maps $\mathcal{F}(X) \to \mathcal{F}(X \times_Y X)$, \item given an almost blow up square (\ref{equation-almost-blow-up-square}) with $X$ affine in the category $(\Sch/S)_h$ the diagram $$ \xymatrix{ \mathcal{F}(E) & \mathcal{F}(X') \ar[l] \\ \mathcal{F}(Z) \ar[u] & \mathcal{F}(X) \ar[u] \ar[l] } $$ is cartesian in the category of sets. \end{enumerate} \end{proposition} 
\begin{lemma} \label{lemma-refine-check-h} Let $\mathcal{F}$ be a presheaf on one of the sites $(\Sch/S)_h$ constructed in Definition \ref{definition-big-small-h}. Then $\mathcal{F}$ is a sheaf if and only if the following conditions are satisfied \begin{enumerate} \item $\mathcal{F}$ is a sheaf for the Zariski topology, \item given a morphism $f : X \to Y$ of $(\Sch/S)_h$ with $Y$ affine and $f$ surjective, flat, proper, and of finite presentation, then $\mathcal{F}(Y)$ is the equalizer of the two maps $\mathcal{F}(X) \to \mathcal{F}(X \times_Y X)$, \item $\mathcal{F}$ turns an almost blow up square as in Example \ref{example-one-generator} in the category $(\Sch/S)_h$ into a cartesian diagram of sets, and \item $\mathcal{F}$ turns an almost blow up square as in Example \ref{example-two-generators} in the category $(\Sch/S)_h$ into a cartesian diagram of sets. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-refine-check-h-stack} Let $p : \mathcal{S} \to (\Sch/S)_h$ be a category fibred in groupoids. Then $\mathcal{S}$ is a stack in groupoids if and only if the following conditions are satisfied \begin{enumerate} \item $\mathcal{S}$ is a stack in groupoids for the Zariski topology, \item given a morphism $f : X \to Y$ of $(\Sch/S)_h$ with $Y$ affine and $f$ surjective, flat, proper, and of finite presentation, then $$ \mathcal{S}_Y \longrightarrow \mathcal{S}_X \times_{\mathcal{S}_{X \times_Y X}} \mathcal{S}_X $$ is an equivalence of categories, \item for an almost blow up square as in Example \ref{example-one-generator} or \ref{example-two-generators} in the category $(\Sch/S)_h$ the functor $$ \mathcal{S}_X \longrightarrow \mathcal{S}_Z \times_{\mathcal{S}_E} \mathcal{S}_{X'} $$ is an equivalence of categories. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-funny-blow-up} Let $Z, X, X', E$ be an almost blow up square as in Example \ref{example-two-generators}. Then $H^p(X', \mathcal{O}_{X'}) = 0$ for $p > 0$ and $\Gamma(X, \mathcal{O}_X) \to \Gamma(X', \mathcal{O}_{X'})$ is a surjective map of rings whose kernel is an ideal of square zero. \end{lemma} 
\begin{lemma} \label{lemma-h-sheaf-colim-F} Let $p$ be a prime number. Let $S$ be a scheme over $\mathbf{F}_p$. Let $(\Sch/S)_h$ be a site as in Definition \ref{definition-big-small-h}. There is a unique sheaf $\mathcal{F}$ on $(\Sch/S)_h$ such that $$ \mathcal{F}(X) = \colim_F \Gamma(X, \mathcal{O}_X) $$ for any quasi-compact and quasi-separated object $X$ of $(\Sch/S)_h$. \end{lemma} 
\begin{lemma} \label{lemma-h-sheaf-lim-F} Let $p$ be a prime number. Let $S$ be a scheme over $\mathbf{F}_p$. Let $(\Sch/S)_h$ be a site as in Definition \ref{definition-big-small-h}. The rule $$ \mathcal{F}(X) = \lim_F \Gamma(X, \mathcal{O}_X) $$ defines a sheaf on $(\Sch/S)_h$. \end{lemma} 
\begin{lemma} \label{lemma-weak-normalization-ph-sheaf} Let $(\Sch/S)_{ph}$ be a site as in Topologies, Definition \ref{topologies-definition-big-small-ph}. The rule $$ X \longmapsto \Gamma(X^{awn}, \mathcal{O}_{X^{awn}}) $$ is a sheaf on $(\Sch/S)_{ph}$. \end{lemma} 
\begin{lemma} \label{lemma-weak-normalization-h-sheaf} Let $S$ be a scheme. Choose a site $(\Sch/S)_h$ as in Definition \ref{definition-big-small-h}. The rule $$ X \longmapsto \Gamma(X^{awn}, \mathcal{O}_{X^{awn}}) $$ is the sheafification of the ``structure sheaf'' $\mathcal{O}$ on $(\Sch/S)_h$. Similarly for the ph topology. \end{lemma} 
\begin{lemma} \label{lemma-perfect-weankly-normal} Let $p$ be a prime number. An $\mathbf{F}_p$-algebra $A$ is absolutely weakly normal if and only if it is perfect. \end{lemma} 
\begin{lemma} \label{lemma-char-p} Let $p$ be a prime number. \begin{enumerate} \item If $A$ is an $\mathbf{F}_p$-algebra, then $\colim_F A = A^{awn}$. \item If $S$ is a scheme over $\mathbf{F}_p$, then the h sheafification of $\mathcal{O}$ sends a quasi-compact and quasi-separated $X$ to $\colim_F \Gamma(X, \mathcal{O}_X)$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-colim-F-Vect} Let $p$ be a prime number. Let $S$ be a quasi-compact and quasi-separated scheme over $\mathbf{F}_p$. The category $\colim_F \textit{Vect}(S)$ is equivalent to the category of finite locally free modules over the sheaf of rings $\colim_F \mathcal{O}_S$ on $S$. \end{lemma} 
\begin{lemma} \label{lemma-vector-bundle-I} Let $p$ be a prime number. Consider an almost blowup square $X, X', Z, E$ in characteristic $p$ as in Example \ref{example-one-generator}. Then the functor $$ \colim_F \textit{Vect}(X) \longrightarrow \colim_F \textit{Vect}(Z) \times_{\colim_F \textit{Vect}(E)} \colim_F \textit{Vect}(X') $$ is an equivalence. \end{lemma} 
\begin{lemma} \label{lemma-vector-bundle-II} Let $p$ be a prime number. Consider an almost blowup square $X, X', Z, E$ in characteristic $p$ as in Example \ref{example-two-generators}. Then the functor $$ G : \colim_F \textit{Vect}(X) \longrightarrow \colim_F \textit{Vect}(Z) \times_{\colim_F \textit{Vect}(E)} \colim_F \textit{Vect}(X') $$ is an equivalence. \end{lemma} 
\begin{proposition} \label{proposition-h-descent-vector-bundles-p} Let $p$ be a prime number. Let $S$ be a scheme in characteristic $p$. Then the category fibred in groupoids $$ p : \mathcal{S} \longrightarrow (\Sch/S)_h $$ whose fibre category over $U$ is the category of finite locally free $\colim_F \mathcal{O}_U$-modules over $U$ is a stack in groupoids. Moreover, if $U$ is quasi-compact and quasi-separated, then $\mathcal{S}_U$ is $\colim_F \textit{Vect}(U)$. \end{proposition} 
\begin{lemma} \label{lemma-trivial-fibres-dvr} Let $f : X \to S$ be a proper morphism with geometrically connected fibres where $S$ is the spectrum of a discrete valuation ring. Denote $\eta \in S$ the generic point and denote $X_n \subset X$ the closed subscheme cutout by the $n$th power of a uniformizer on $S$. Then there exists an integer $n$ such that the following is true: any finite locally free $\mathcal{O}_X$-module $\mathcal{E}$ such that $\mathcal{E}|_{X_\eta}$ and $\mathcal{E}|_{X_n}$ are free, is free. \end{lemma} 
\begin{lemma} \label{lemma-trivial-over-dvrs} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{E}$ be a finite locally free $\mathcal{O}_X$-module. Assume \begin{enumerate} \item $f$ is flat and proper and $\mathcal{O}_S = f_*\mathcal{O}_X$, \item $S$ is a normal Noetherian scheme, \item the pullback of $\mathcal{E}$ to $X \times_S \Spec(\mathcal{O}_{S, s})$ is free for every codimension $1$ point $s \in S$. \end{enumerate} Then $\mathcal{E}$ is isomorphic to the pullback of a finite locally free $\mathcal{O}_S$-module. \end{lemma} 
\begin{theorem} \label{theorem-pullback-trivial-fibres} Let $p$ be a prime number. Let $Y$ be a quasi-compact and quasi-separated scheme over $\mathbf{F}_p$. Let $f : X \to Y$ be a proper, surjective morphism of finite presentation with geometrically connected fibres. Then the functor $$ \colim_F \textit{Vect}(Y) \longrightarrow \colim_F \textit{Vect}(X) $$ is fully faithful with essential image described as follows. Let $\mathcal{E}$ be a finite locally free $\mathcal{O}_X$-module. Assume for all $y \in Y$ there exists integers $n_y, r_y \geq 0$ such that $$ F^{n_y, *}\mathcal{E}|_{X_{y, red}} \cong \mathcal{O}_{X_{y, red}}^{\oplus r_y} $$ Then for some $n \geq 0$ the $n$th Frobenius power pullback $F^{n, *}\mathcal{E}$ is the pullback of a finite locally free $\mathcal{O}_Y$-module. \end{theorem} 
\begin{lemma} \label{lemma-fitting-ideals-complex} Let $X$ be a scheme. Let $E \in D(\mathcal{O}_X)$ be pseudo-coherent. For every $p, k \in \mathbf{Z}$ there is an finite type quasi-coherent sheaf of ideals $\text{Fit}_{p, k}(E) \subset \mathcal{O}_X$ with the following property: for $U \subset X$ open such that $E|_U$ is isomorphic to $$ \ldots \to \mathcal{O}_U^{\oplus n_{b - 2}} \xrightarrow{d_{b - 2}} \mathcal{O}_U^{\oplus n_{b - 1}} \xrightarrow{d_{b - 1}} \mathcal{O}_U^{\oplus n_b} \to 0 \to \ldots $$ the restriction $\text{Fit}_{p, k}(E)|_U$ is generated by the minors of the matrix of $d_p$ of size $$ - k + n_{p + 1} - n_{p + 2} + \ldots + (-1)^{b - p + 1} n_b $$ Convention: the ideal generated by $r \times r$-minors is $\mathcal{O}_U$ if $r \leq 0$ and the ideal generated by $r \times r$-minors where $r > \min(n_p, n_{p + 1})$ is zero. \end{lemma} 
\begin{lemma} \label{lemma-blowup-complex} Let $X$ be a scheme. Let $E \in D(\mathcal{O}_X)$ be perfect. Let $U \subset X$ be a scheme theoretically dense open subscheme such that $H^i(E|_U)$ is finite locally free of constant rank $r_i$ for all $i \in \mathbf{Z}$. Then there exists a $U$-admissible blowup $b : X' \to X$ such that $H^i(Lb^*E)$ is a perfect $\mathcal{O}_{X'}$-module of tor dimension $\leq 1$ for all $i \in \mathbf{Z}$. \end{lemma} 
\begin{lemma} \label{lemma-blowup-complex-integral} Let $X$ be an integral scheme. Let $E \in D(\mathcal{O}_X)$ be perfect. Then there exists a nonempty open $U \subset X$ such that $H^i(E|_U)$ is finite locally free of constant rank $r_i$ for all $i \in \mathbf{Z}$ and there exists a $U$-admissible blowup $b : X' \to X$ such that $H^i(Lb^*E)$ is a perfect $\mathcal{O}_{X'}$-module of tor dimension $\leq 1$ for all $i \in \mathbf{Z}$. \end{lemma} 
\begin{lemma} \label{lemma-blowup-pd1-derived} Let $X$ be a scheme. Let $\mathcal{F}$ be a perfect $\mathcal{O}_X$-module of tor dimension $\leq 1$. For any blowup $b : X' \to X$ we have $Lb^*\mathcal{F} = b^*\mathcal{F}$ and $b^*\mathcal{F}$ is a perfect $\mathcal{O}_X$-module of tor dimension $\leq 1$. \end{lemma} 
\begin{lemma} \label{lemma-blowup-pd1} Let $X$ be a scheme. Let $\mathcal{F}$ be a perfect $\mathcal{O}_X$-module of tor dimension $\leq 1$. Let $U \subset X$ be a scheme theoretically dense open such that $\mathcal{F}|_U$ is finite locally free of constant rank $r$. Then there exists a $U$-admissible blowup $b : X' \to X$ such that there is a canonical short exact sequence $$ 0 \to \mathcal{K} \to b^*\mathcal{F} \to \mathcal{Q} \to 0 $$ where $\mathcal{Q}$ is finite locally free of rank $r$ and $\mathcal{K}$ is a perfect $\mathcal{O}_X$-module of tor dimension $\leq 1$ whose restriction to $U$ is zero. \end{lemma} 
\begin{lemma} \label{lemma-canonical-blowup-torsion-pd1} Let $X$ be a scheme. Let $\mathcal{F}$ be a perfect $\mathcal{O}_X$-module of tor dimension $\leq 1$. Let $U \subset X$ be an open such that $\mathcal{F}|_U = 0$. Then there is a $U$-admissible blowup $$ b : X' \to X $$ such that $\mathcal{F}' = b^*\mathcal{F}$ is equipped with two canonical locally finite filtrations $$ 0 = F^0 \subset F^1 \subset F^2 \subset \ldots \subset \mathcal{F}' \quad\text{and}\quad \mathcal{F}' = F_1 \supset F_2 \supset F_3 \supset \ldots \supset 0 $$ such that for each $n \geq 1$ there is an effective Cartier divisor $D_n \subset X'$ with the property that $$ F^i/F^{i - 1} \quad\text{and}\quad F_i/F_{i + 1} $$ are finite locally free of rank $i$ on $D_i$. \end{lemma} 
\begin{lemma} \label{lemma-blowup-map-pd1} Let $X$ be a scheme. Let $\varphi : \mathcal{F} \to \mathcal{G}$ be a homorphism of perfect $\mathcal{O}_X$-modules of tor dimension $\leq 1$. Let $U \subset X$ be a scheme theoretically dense open such that $\mathcal{F}|_U = 0$ and $\mathcal{G}|_U = 0$. Then there is a $U$-admissible blowup $b : X' \to X$ such that the kernel, image, and cokernel of $b^*\varphi$ are perfect $\mathcal{O}_{X'}$-modules of tor dimension $\leq 1$. \end{lemma} 
\begin{lemma} \label{lemma-eta-stalks} Let $X$ be a scheme. Let $D \subset X$ be an effective Cartier divisor with ideal sheaf $\mathcal{I} \subset \mathcal{O}_X$. Let $\mathcal{F}^\bullet$ be a complex of quasi-coherent $\mathcal{O}_X$-modules such that $\mathcal{F}^i$ is $\mathcal{I}$-torsion free for all $i$. Then $\eta_\mathcal{I}\mathcal{F}^\bullet$ is a complex of quasi-coherent $\mathcal{O}_X$-modules. Moreover, if $U = \Spec(A) \subset X$ is affine open and $D \cap U = V(f)$, then $\eta_f(\mathcal{F}^\bullet(U))$ is canonically isomorphic to $(\eta_\mathcal{I}\mathcal{F}^\bullet)(U)$. \end{lemma} 
\begin{lemma} \label{lemma-Leta} Let $X$ be a scheme. Let $D \subset X$ be an effective Cartier divisor with ideal sheaf $\mathcal{I} \subset \mathcal{O}_X$. The functor $L\eta_\mathcal{I} : D(\mathcal{O}_X) \to D(\mathcal{O}_X)$ of Cohomology, Lemma \ref{cohomology-lemma-Leta} sends $D_\QCoh(\mathcal{O}_X)$ into itself. Moreover, if $X = \Spec(A)$ is affine and $D = V(f)$, then the functor $L\eta_f$ on $D(A)$ defined in More on Algebra, Lemma \ref{more-algebra-lemma-Leta} and the functor $L\eta_\mathcal{I}$ on $D_\QCoh(\mathcal{O}_X)$ correspond via the equivalence of Derived Categories of Schemes, Lemma \ref{perfect-lemma-affine-compare-bounded}. \end{lemma} 
\begin{lemma} \label{lemma-pullback-triple-ideals-good} In Situation \ref{situation-complex-and-divisor} let $h : Y \to X$ be a morphism of schemes such that the pullback $E = h^{-1}D$ of $D$ is defined (Divisors, Definition \ref{divisors-definition-pullback-effective-Cartier-divisor}). Let $(U, A, f, M^\bullet)$ is an affine chart for $(X, D, M)$. Let $V = \Spec(B) \subset Y$ is an affine open with $h(V) \subset U$. Denote $g \in B$ the image of $f \in A$. Then \begin{enumerate} \item $(V, B, g, M^\bullet \otimes_A B)$ is an affine chart for $(Y, E, Lh^*M)$, \item $I_i(M^\bullet, f)B = I_i(M^\bullet \otimes_A B, g)$ in $B$, and \item if $(X, D, M)$ is a good triple, then $(Y, E, Lh^*M)$ is a good triple. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-good-triple} Let $X, D, \mathcal{I}, M$ be as in Situation \ref{situation-complex-and-divisor}. If $(X, D, M)$ is a good triple, then $L\eta_\mathcal{I}M$ is a perfect object of $D(\mathcal{O}_X)$. \end{lemma} 
\begin{lemma} \label{lemma-good-triple-bdd-loc-free} Let $X, D, \mathcal{I}, M$ be as in Situation \ref{situation-complex-and-divisor}. Assume $(X, D, M)$ is a good triple. If there exists a locally bounded complex $\mathcal{M}^\bullet$ of finite locally free $\mathcal{O}_X$-modules representing $M$, then there exists a locally bounded complex $\mathcal{Q}^\bullet$ of finite locally free $\mathcal{O}_{X'}$-modules representing $L\eta_\mathcal{I}M$. \end{lemma} 
\begin{lemma} \label{lemma-complex-and-divisor-eta-pull} In Situation \ref{situation-complex-and-divisor} let $h : Y \to X$ be a morphism of schemes such that the pullback $E = h^{-1}D$ is defined. If $(X, D, M)$ is a good triple, then $$ Lh^*(L\eta_\mathcal{I}M) = L\eta_\mathcal{J}(Lh^*M) $$ in $D(\mathcal{O}_Y)$ where $\mathcal{J}$ is the ideal sheaf of $E$. \end{lemma} 
\begin{lemma} \label{lemma-complex-and-divisor-blowup-pre} In Situation \ref{situation-complex-and-divisor} there is a unique morphism $b : X' \to X$ such that \begin{enumerate} \item the pullback $D' = b^{-1}D$ is defined and $(X', D', M')$ is a good triple where $M' = Lb^*M$, and \item for any morphism of schemes $h : Y \to X$ such that the pullback $E = h^{-1}D$ is defined and $(Y, E, Lh^*M)$ is a good triple, there is a unique factorization of $h$ through $b$. \end{enumerate} Moreover, for any affine chart $(U, A, f, M^\bullet)$ the restriction $b^{-1}(U) \to U$ is the blowing up in the product of the ideals $I_i(M^\bullet, f)$ and for any quasi-compact open $W \subset X$ the restriction $b|_{b^{-1}(W)} : b^{-1}(W) \to W$ is a $W \setminus D$-admissible blowing up. \end{lemma} 
\begin{lemma} \label{lemma-complex-and-divisor-blowup} In Situation \ref{situation-complex-and-divisor} let $b : X' \to X$ be the morphism of Lemma \ref{lemma-complex-and-divisor-blowup-pre}. Consider the effective Cartier divisor $D' = b^{-1}D$ with ideal sheaf $\mathcal{I}' \subset \mathcal{O}_{X'}$. Then $Q = L\eta_{\mathcal{I}'}Lb^*M$ is a perfect object of $D(\mathcal{O}_{X'})$. \end{lemma} 
\begin{lemma} \label{lemma-complex-and-divisor-blowup-base-change} In Situation \ref{situation-complex-and-divisor} let $h : Y \to X$ be a morphism of schemes such that the pullback $E = h^{-1}D$ is defined. Let $b : X' \to X$, resp.\ $c : Y' \to Y$ be as constructed in Lemma \ref{lemma-complex-and-divisor-blowup-pre} for $D \subset X$ and $M$, resp.\ $E \subset Y$ and $Lh^*M$. Then $Y'$ is the strict transform of $Y$ with respect to $b : X' \to X$ (see proof for a precise formulation of this) and $$ L\eta_{\mathcal{J}'}L(h \circ c)^*M = L(Y' \to X')^*Q $$ where $Q = L\eta_{\mathcal{I}'}Lb^*M$ as in Lemma \ref{lemma-complex-and-divisor-blowup}. In particular, if $(Y, E, Lh^*M)$ is a good triple and $k : Y \to X'$ is the unique morphism such that $h = b \circ k$, then $L\eta_\mathcal{J}Lh^*M = Lk^*Q$. \end{lemma} 
\begin{lemma} \label{lemma-complex-and-divisor-blowup-good} In Situation \ref{situation-complex-and-divisor} let $W \subset X$ be the maximal open subscheme over which the cohomology sheaves of $M$ are locally free. Then the morphism $b : X' \to X$ of Lemma \ref{lemma-complex-and-divisor-blowup-pre} is an isomorphism over $W$. \end{lemma} 
\begin{lemma} \label{lemma-complex-and-divisor-blowup-good-T} Let $X, D, \mathcal{I}, M$ be as in Situation \ref{situation-complex-and-divisor}. If $(X, D, M)$ is a good triple, then there exists a closed immersion $$ i : T \longrightarrow D $$ of finite presentation with the following properties \begin{enumerate} \item $T$ scheme theoretically contains $D \cap W$ where $W \subset X$ is the maximal open over which the cohomology sheaves of $M$ are locally free, \item the cohomology sheaves of $Li^*L\eta_\mathcal{I}M$ are locally free, and \item for any point $t \in T$ with image $x = i(t) \in W$ the rank of $H^i(M)_x$ over $\mathcal{O}_{X, x}$ and the rank of $H^i(Li^*L\eta_\mathcal{I}M)_t$ over $\mathcal{O}_{T, t}$ agree. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-complex-and-divisor-blowup-T} In Situation \ref{situation-complex-and-divisor}. Let $b : X' \to X$ and $D'$ be as in Lemma \ref{lemma-complex-and-divisor-blowup-pre}. Let $Q = L\eta_{\mathcal{I}'}Lb^*M$ be as in Lemma \ref{lemma-complex-and-divisor-blowup}. Let $W \subset X$ be the maximal open where $M$ has locally free cohomology modules. Then there exists a closed immersion $i : T \to D'$ of finite presentation such that \begin{enumerate} \item $D' \cap b^{-1}(W) \subset T$ scheme theoretically, \item $Li^*Q$ has locally free cohomology sheaves, and \item for $t \in T$ mapping to $w \in W$ the rank of $H^i(Li^*Q)_t$ over $\mathcal{O}_{T, t}$ is equal to the rank of $H^i(M)_x$ over $\mathcal{O}_{X, x}$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-complex-and-divisor-blowup-T-ranks} In Situation \ref{situation-complex-and-divisor}. Let $b : X' \to X$, $D' \subset X'$, and $Q$ be as in Lemma \ref{lemma-complex-and-divisor-blowup}. Let $\rho = (\rho_i)_{i \in \mathbf{Z}}$ be integers. Let $W(\rho) \subset X$ be the maximal open subscheme where $H^i(M)$ is locally free of rank $\rho_i$ for all $i$. Let $i : T \to D'$ be as in Lemma \ref{lemma-complex-and-divisor-blowup-T}. Then there exists an open and closed subscheme $T(\rho) \subset T$ containing $D' \cap b^{-1}(W(\rho))$ scheme theoretically such that $H^i(Li^*Q|_{T(\rho)})$ is locally free of rank $\rho_i$ for all $i$. \end{lemma} 
\begin{lemma} \label{lemma-complex-and-divisor-blowup-T-represented-bdd-loc-free} In Situation \ref{situation-complex-and-divisor}. Let $b : X' \to X$, $D' \subset X'$, and $Q$ be as in Lemma \ref{lemma-complex-and-divisor-blowup}. If there exists a locally bounded complex $\mathcal{M}^\bullet$ of finite locally free $\mathcal{O}_X$-modules representing $M$, then there exists a locally bounded complex $\mathcal{Q}^\bullet$ of finite locally free $\mathcal{O}_{X'}$-modules representing $Q$. \end{lemma} 
\begin{lemma} \label{lemma-complex-and-divisor-derived} Let $X$ be a scheme and let $D \subset X$ be an effective Cartier divisor. Let $M \in D(\mathcal{O}_X)$ be a perfect object. Let $W \subset X$ be the maximal open over which the cohomology sheaves $H^i(M)$ are locally free. There exists a proper morphism $b : X' \longrightarrow X$ and an object $Q$ in $D(\mathcal{O}_{X'})$ with the following properties \begin{enumerate} \item $b : X' \to X$ is an isomorphism over $X \setminus D$, \item $b : X' \to X$ is an isomorphism over $W$, \item $D' = b^{-1}D$ is an effective Cartier divisor, \item $Q = L\eta_{\mathcal{I}'}Lb^*M$ where $\mathcal{I}'$ is the ideal sheaf of $D'$, \item $Q$ is a perfect object of $D(\mathcal{O}_{X'})$, \item there exists a closed immersion $i : T \to D'$ of finite presentation such that \begin{enumerate} \item $D' \cap b^{-1}(W) \subset T$ scheme theoretically, \item $Li^*Q$ has finite locally free cohomology sheaves, \item for $t \in T$ with image $w \in W$ the rank of $H^i(Li^*Q)_t$ over $\mathcal{O}_{T, t}$ is equal to the rank of $H^i(M)_x$ over $\mathcal{O}_{X, x}$, \end{enumerate} \item for any affine chart $(U, A, f, M^\bullet)$ for $(X, D, M)$ the restriction of $b$ to $U$ is the blowing up of $U = \Spec(A)$ in the ideal $I = \prod I_i(M^\bullet, f)$, and \item for any affine chart $(V, B, g, N^\bullet)$ for $(X', D', Lb^*N)$ such that $I_i(N^\bullet, g)$ is principal, we have \begin{enumerate} \item $Q|_V$ corresponds to $\eta_gN^\bullet$, \item $T \subset V \cap D'$ corresponds to the ideal $J(N^\bullet, g) = \sum J_i(N^\bullet, g) \subset B/gB$ studied in More on Algebra, Lemma \ref{more-algebra-lemma-eta-vanishing-beta-plus}. \end{enumerate} \item If $M$ can be represented by a locally bounded complex of finite locally free $\mathcal{O}_X$-modules, then $Q$ can be represented by a bounded complex of finite locally free $\mathcal{O}_{X'}$-modules. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-graph-construction} The construction above has the following properties: \begin{enumerate} \item $b$ is an isomorphism over $\mathbf{P}^1_U \cup \mathbf{A}^1_X$, \item the restriction of $Q$ to $\mathbf{A}^1_X$ is equal to the pullback of $E$, \item there exists a closed immersion $i : T \to W_\infty$ of finite presentation such that $(W_\infty \to X)^{-1}U \subset T$ scheme theoretically and such that $Li^*Q$ has locally free cohomology sheaves, \item for $t \in T$ with image $u \in U$ we have that the rank $H^i(Li^*Q)_t$ over $\mathcal{O}_{T, t}$ is equal to the rank of $H^i(M)_u$ over $\mathcal{O}_{U, u}$, \item if $E$ can be represented by a locally bounded complex of finite locally free $\mathcal{O}_X$-modules, then $Q$ can be represented by a locally bounded complex of finite locally free $\mathcal{O}_W$-modules. \end{enumerate} \end{lemma} 
