\begin{definition} \label{definition-divided-powers} Let $A$ be a ring. Let $I$ be an ideal of $A$. A collection of maps $\gamma_n : I \to I$, $n > 0$ is called a {\it divided power structure} on $I$ if for all $n \geq 0$, $m > 0$, $x, y \in I$, and $a \in A$ we have \begin{enumerate} \item $\gamma_1(x) = x$, we also set $\gamma_0(x) = 1$, \item $\gamma_n(x)\gamma_m(x) = \frac{(n + m)!}{n! m!} \gamma_{n + m}(x)$, \item $\gamma_n(ax) = a^n \gamma_n(x)$, \item $\gamma_n(x + y) = \sum_{i = 0, \ldots, n} \gamma_i(x)\gamma_{n - i}(y)$, \item $\gamma_n(\gamma_m(x)) = \frac{(nm)!}{n! (m!)^n} \gamma_{nm}(x)$. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-silly} Let $A$ be a ring. Let $I$ be an ideal of $A$. \begin{enumerate} \item If $\gamma$ is a divided power structure\footnote{Here and in the following, $\gamma$ stands short for a sequence of maps $\gamma_1, \gamma_2, \gamma_3, \ldots$ from $I$ to $I$.} on $I$, then $n! \gamma_n(x) = x^n$ for $n \geq 1$, $x \in I$. \end{enumerate} Assume $A$ is torsion free as a $\mathbf{Z}$-module. \begin{enumerate} \item[(2)] A divided power structure on $I$, if it exists, is unique. \item[(3)] If $\gamma_n : I \to I$ are maps then $$ \gamma\text{ is a divided power structure} \Leftrightarrow n! \gamma_n(x) = x^n\ \forall x \in I, n \geq 1. $$ \item[(4)] The ideal $I$ has a divided power structure if and only if there exists a set of generators $x_i$ of $I$ as an ideal such that for all $n \geq 1$ we have $x_i^n \in (n!)I$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-check-on-generators} Let $A$ be a ring. Let $I$ be an ideal of $A$. Let $\gamma_n : I \to I$, $n \geq 1$ be a sequence of maps. Assume \begin{enumerate} \item[(a)] (1), (3), and (4) of Definition \ref{definition-divided-powers} hold for all $x, y \in I$, and \item[(b)] properties (2) and (5) hold for $x$ in some set of generators of $I$ as an ideal. \end{enumerate} Then $\gamma$ is a divided power structure on $I$. \end{lemma} 
\begin{lemma} \label{lemma-two-ideals} Let $A$ be a ring with two ideals $I, J \subset A$. Let $\gamma$ be a divided power structure on $I$ and let $\delta$ be a divided power structure on $J$. Then \begin{enumerate} \item $\gamma$ and $\delta$ agree on $IJ$, \item if $\gamma$ and $\delta$ agree on $I \cap J$ then they are the restriction of a unique divided power structure $\epsilon$ on $I + J$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-nil} Let $p$ be a prime number. Let $A$ be a ring, let $I \subset A$ be an ideal, and let $\gamma$ be a divided power structure on $I$. Assume $p$ is nilpotent in $A/I$. Then $I$ is locally nilpotent if and only if $p$ is nilpotent in $A$. \end{lemma} 
\begin{definition} \label{definition-divided-power-ring} A {\it divided power ring} is a triple $(A, I, \gamma)$ where $A$ is a ring, $I \subset A$ is an ideal, and $\gamma = (\gamma_n)_{n \geq 1}$ is a divided power structure on $I$. A {\it homomorphism of divided power rings} $\varphi : (A, I, \gamma) \to (B, J, \delta)$ is a ring homomorphism $\varphi : A \to B$ such that $\varphi(I) \subset J$ and such that $\delta_n(\varphi(x)) = \varphi(\gamma_n(x))$ for all $x \in I$ and $n \geq 1$. \end{definition} 
\begin{lemma} \label{lemma-limits} The category of divided power rings has all limits and they agree with limits in the category of rings. \end{lemma} 
\begin{lemma} \label{lemma-a-version-of-brown} Let $\mathcal{C}$ be the category of divided power rings. Let $F : \mathcal{C} \to \textit{Sets}$ be a functor. Assume that \begin{enumerate} \item there exists a cardinal $\kappa$ such that for every $f \in F(A, I, \gamma)$ there exists a morphism $(A', I', \gamma') \to (A, I, \gamma)$ of $\mathcal{C}$ such that $f$ is the image of $f' \in F(A', I', \gamma')$ and $|A'| \leq \kappa$, and \item $F$ commutes with limits. \end{enumerate} Then $F$ is representable, i.e., there exists an object $(B, J, \delta)$ of $\mathcal{C}$ such that $$ F(A, I, \gamma) = \Hom_\mathcal{C}((B, J, \delta), (A, I, \gamma)) $$ functorially in $(A, I, \gamma)$. \end{lemma} 
\begin{lemma} \label{lemma-colimits} The category of divided power rings has all colimits. \end{lemma} 
\begin{definition} \label{definition-extends} Given a divided power ring $(A, I, \gamma)$ and a ring map $A \to B$ we say $\gamma$ {\it extends} to $B$ if there exists a divided power structure $\bar \gamma$ on $IB$ such that $(A, I, \gamma) \to (B, IB, \bar\gamma)$ is a homomorphism of divided power rings. \end{definition} 
\begin{lemma} \label{lemma-gamma-extends} Let $(A, I, \gamma)$ be a divided power ring. Let $A \to B$ be a ring map. If $\gamma$ extends to $B$ then it extends uniquely. Assume (at least) one of the following conditions holds \begin{enumerate} \item $IB = 0$, \item $I$ is principal, or \item $A \to B$ is flat. \end{enumerate} Then $\gamma$ extends to $B$. \end{lemma} 
\begin{lemma} \label{lemma-kernel} Let $(A, I, \gamma)$ be a divided power ring. \begin{enumerate} \item If $\varphi : (A, I, \gamma) \to (B, J, \delta)$ is a homomorphism of divided power rings, then $\Ker(\varphi) \cap I$ is preserved by $\gamma_n$ for all $n \geq 1$. \item Let $\mathfrak a \subset A$ be an ideal and set $I' = I \cap \mathfrak a$. The following are equivalent \begin{enumerate} \item $I'$ is preserved by $\gamma_n$ for all $n > 0$, \item $\gamma$ extends to $A/\mathfrak a$, and \item there exist a set of generators $x_i$ of $I'$ as an ideal such that $\gamma_n(x_i) \in I'$ for all $n > 0$. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-sub-dp-ideal} Let $(A, I, \gamma)$ be a divided power ring. Let $E \subset I$ be a subset. Then the smallest ideal $J \subset I$ preserved by $\gamma$ and containing all $f \in E$ is the ideal $J$ generated by $\gamma_n(f)$, $n \geq 1$, $f \in E$. \end{lemma} 
\begin{lemma} \label{lemma-extend-to-completion} Let $(A, I, \gamma)$ be a divided power ring. Let $p$ be a prime. If $p$ is nilpotent in $A/I$, then \begin{enumerate} \item the $p$-adic completion $A^\wedge = \lim_e A/p^eA$ surjects onto $A/I$, \item the kernel of this map is the $p$-adic completion $I^\wedge$ of $I$, and \item each $\gamma_n$ is continuous for the $p$-adic topology and extends to $\gamma_n^\wedge : I^\wedge \to I^\wedge$ defining a divided power structure on $I^\wedge$. \end{enumerate} If moreover $A$ is a $\mathbf{Z}_{(p)}$-algebra, then \begin{enumerate} \item[(4)] for $e$ large enough the ideal $p^eA \subset I$ is preserved by the divided power structure $\gamma$ and $$ (A^\wedge, I^\wedge, \gamma^\wedge) = \lim_e (A/p^eA, I/p^eA, \bar\gamma) $$ in the category of divided power rings. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-divided-power-polynomial-algebra} Let $(A, I, \gamma)$ be a divided power ring. There exists a unique divided power structure $\delta$ on $$ J = IA\langle x_1, \ldots, x_t \rangle + A\langle x_1, \ldots, x_t \rangle_{+} $$ such that \begin{enumerate} \item $\delta_n(x_i) = x_i^{[n]}$, and \item $(A, I, \gamma) \to (A\langle x_1, \ldots, x_t \rangle, J, \delta)$ is a homomorphism of divided power rings. \end{enumerate} Moreover, $(A\langle x_1, \ldots, x_t \rangle, J, \delta)$ has the following universal property: A homomorphism of divided power rings $\varphi : (A\langle x_1, \ldots, x_t \rangle, J, \delta) \to (C, K, \epsilon)$ is the same thing as a homomorphism of divided power rings $A \to C$ and elements $k_1, \ldots, k_t \in K$. \end{lemma} 
\begin{lemma} \label{lemma-need-only-gamma-p} Let $p$ be a prime number. Let $A$ be a ring such that every integer $n$ not divisible by $p$ is invertible, i.e., $A$ is a $\mathbf{Z}_{(p)}$-algebra. Let $I \subset A$ be an ideal. Two divided power structures $\gamma, \gamma'$ on $I$ are equal if and only if $\gamma_p = \gamma'_p$. Moreover, given a map $\delta : I \to I$ such that \begin{enumerate} \item $p!\delta(x) = x^p$ for all $x \in I$, \item $\delta(ax) = a^p\delta(x)$ for all $a \in A$, $x \in I$, and \item $\delta(x + y) = \delta(x) + \sum\nolimits_{i + j = p, i,j \geq 1} \frac{1}{i!j!} x^i y^j + \delta(y)$ for all $x, y \in I$, \end{enumerate} then there exists a unique divided power structure $\gamma$ on $I$ such that $\gamma_p = \delta$. \end{lemma} 
\begin{definition} \label{definition-divided-powers-graded} Let $R$ be a ring. Let $A = \bigoplus_{d \geq 0} A_d$ be a graded $R$-algebra which is strictly graded commutative. A collection of maps $\gamma_n : A_{even, +} \to A_{even, +}$ defined for all $n > 0$ is called a {\it divided power structure} on $A$ if we have \begin{enumerate} \item $\gamma_n(x) \in A_{2nd}$ if $x \in A_{2d}$, \item $\gamma_1(x) = x$ for any $x$, we also set $\gamma_0(x) = 1$, \item $\gamma_n(x)\gamma_m(x) = \frac{(n + m)!}{n! m!} \gamma_{n + m}(x)$, \item $\gamma_n(xy) = x^n \gamma_n(y)$ for all $x \in A_{even}$ and $y \in A_{even, +}$, \item $\gamma_n(xy) = 0$ if $x, y \in A_{odd}$ homogeneous and $n > 1$ \item if $x, y \in A_{even, +}$ then $\gamma_n(x + y) = \sum_{i = 0, \ldots, n} \gamma_i(x)\gamma_{n - i}(y)$, \item $\gamma_n(\gamma_m(x)) = \frac{(nm)!}{n! (m!)^n} \gamma_{nm}(x)$ for $x \in A_{even, +}$. \end{enumerate} \end{definition} 
\begin{definition} \label{definition-divided-powers-dga} Let $R$ be a ring. Let $A = \bigoplus_{d \geq 0} A_d$ be a differential graded $R$-algebra which is strictly graded commutative. A divided power structure $\gamma$ on $A$ is {\it compatible with the differential graded structure} if $\text{d}(\gamma_n(x)) = \text{d}(x) \gamma_{n - 1}(x)$ for all $x \in A_{even, +}$. \end{definition} 
\begin{lemma} \label{lemma-dpdga-good} Let $(A, \text{d}, \gamma)$ and $(B, \text{d}, \gamma)$ be as in Definition \ref{definition-divided-powers-dga}. Let $f : A \to B$ be a map of differential graded algebras compatible with divided power structures. Assume \begin{enumerate} \item $H_k(A) = 0$ for $k > 0$, and \item $f$ is surjective. \end{enumerate} Then $\gamma$ induces a divided power structure on the graded $R$-algebra $H(B)$. \end{lemma} 
\begin{lemma} \label{lemma-base-change-div} Let $(A, \text{d}, \gamma)$ be as in Definition \ref{definition-divided-powers-dga}. Let $R \to R'$ be a ring map. Then $\text{d}$ and $\gamma$ induce similar structures on $A' = A \otimes_R R'$ such that $(A', \text{d}, \gamma)$ is as in Definition \ref{definition-divided-powers-dga}. \end{lemma} 
\begin{lemma} \label{lemma-extend-differential} Let $(A, \text{d}, \gamma)$ be as in Definition \ref{definition-divided-powers-dga}. Let $d \geq 1$ be an integer. Let $A\langle T \rangle$ be the graded divided power polynomial algebra on $T$ with $\deg(T) = d$ constructed in Example \ref{example-adjoining-odd} or \ref{example-adjoining-even}. Let $f \in A_{d - 1}$ be an element with $\text{d}(f) = 0$. There exists a unique differential $\text{d}$ on $A\langle T\rangle$ such that $\text{d}(T) = f$ and such that $\text{d}$ is compatible with the divided power structure on $A\langle T \rangle$. \end{lemma} 
\begin{lemma} \label{lemma-tate-resolution} Let $R \to S$ be a homomorphism of commutative rings. There exists a factorization $$ R \to A \to S $$ with the following properties: \begin{enumerate} \item $(A, \text{d}, \gamma)$ is as in Definition \ref{definition-divided-powers-dga}, \item $A \to S$ is a quasi-isomorphism (if we endow $S$ with the zero differential), \item $A_0 = R[x_j: j\in J] \to S$ is any surjection of a polynomial ring onto $S$, and \item $A$ is a graded divided power polynomial algebra over $R$. \end{enumerate} The last condition means that $A$ is constructed out of $A_0$ by successively adjoining a set of variables $T$ in each degree $> 0$ as in Example \ref{example-adjoining-odd} or \ref{example-adjoining-even}. Moreover, if $R$ is Noetherian and $R\to S$ is of finite type, then $A$ can be taken to have only finitely many generators in each degree. \end{lemma} 
\begin{lemma} \label{lemma-tate-resoluton-pseudo-coherent-ring-map} Let $R \to S$ be a pseudo-coherent ring map (More on Algebra, Definition \ref{more-algebra-definition-pseudo-coherent-perfect}). Then Lemma \ref{lemma-tate-resolution} holds, with the resolution $A$ of $S$ having finitely many generators in each degree. \end{lemma} 
\begin{lemma} \label{lemma-uniqueness-tate-resolution} Let $R$ be a commutative ring. Suppose that $(A, \text{d}, \gamma)$ and $(B, \text{d}, \gamma)$ are as in Definition \ref{definition-divided-powers-dga}. Let $\overline{\varphi} : H_0(A) \to H_0(B)$ be an $R$-algebra map. Assume \begin{enumerate} \item $A$ is a graded divided power polynomial algebra over $R$. \item $H_k(B) = 0$ for $k > 0$. \end{enumerate} Then there exists a map $\varphi : A \to B$ of differential graded $R$-algebras compatible with divided powers that lifts $\overline{\varphi}$. \end{lemma} 
\begin{lemma} \label{lemma-divided-powers-on-tor} Let $R$ be a commutative ring. Let $S$ and $T$ be commutative $R$-algebras. Then there is a canonical structure of a strictly graded commutative $R$-algebra with divided powers on $$ \operatorname{Tor}_*^R(S, T). $$ \end{lemma} 
\begin{lemma} \label{lemma-get-derivation} Let $R$ be a ring. Let $(A, \text{d}, \gamma)$ be as in Definition \ref{definition-divided-powers-dga}. Let $R' \to R$ be a surjection of rings whose kernel has square zero and is generated by one element $f$. If $A$ is a graded divided power polynomial algebra over $R$ with finitely many variables in each degree, then we obtain a derivation $\theta : A/IA \to A/IA$ where $I$ is the annihilator of $f$ in $R$. \end{lemma} 
\begin{lemma} \label{lemma-compute-theta} Assumption and notation as in Lemma \ref{lemma-get-derivation}. Suppose $S = H_0(A)$ is isomorphic to $R[x_1, \ldots, x_n]/(f_1, \ldots, f_m)$ for some $n$, $m$, and $f_j \in R[x_1, \ldots, x_n]$. Moreover, suppose given a relation $$ \sum r_j f_j = 0 $$ with $r_j \in R[x_1, \ldots, x_n]$. Choose $r'_j, f'_j \in R'[x_1, \ldots, x_n]$ lifting $r_j, f_j$. Write $\sum r'_j f'_j = gf$ for some $g \in R/I[x_1, \ldots, x_n]$. If $H_1(A) = 0$ and all the coefficients of each $r_j$ are in $I$, then there exists an element $\xi \in H_2(A/IA)$ such that $\theta(\xi) = g$ in $S/IS$. \end{lemma} 
\begin{lemma} \label{lemma-not-finite-pd} Let $R' \to R$ be a surjection of Noetherian rings whose kernel has square zero and is generated by one element $f$. Let $S = R[x_1, \ldots, x_n]/(f_1, \ldots, f_m)$. Let $\sum r_j f_j = 0$ be a relation in $R[x_1, \ldots, x_n]$. Assume that \begin{enumerate} \item each $r_j$ has coefficients in the annihilator $I$ of $f$ in $R$, \item for some lifts $r'_j, f'_j \in R'[x_1, \ldots, x_n]$ we have $\sum r'_j f'_j = gf$ where $g$ is not nilpotent in $S/IS$. \end{enumerate} Then $S$ does not have finite tor dimension over $R$ (i.e., $S$ is not a perfect $R$-algebra). \end{lemma} 
\begin{lemma} \label{lemma-injective} Let $(A, \mathfrak m)$ be a Noetherian local ring. Let $I \subset J \subset A$ be proper ideals. If $A/J$ has finite tor dimension over $A/I$, then $I/\mathfrak m I \to J/\mathfrak m J$ is injective. \end{lemma} 
\begin{lemma} \label{lemma-regular-sequence} Let $(A, \mathfrak m)$ be a Noetherian local ring. Let $I \subset J \subset A$ be proper ideals. Assume \begin{enumerate} \item $A/J$ has finite tor dimension over $A/I$, and \item $J$ is generated by a regular sequence. \end{enumerate} Then $I$ is generated by a regular sequence and $J/I$ is generated by a regular sequence. \end{lemma} 
\begin{lemma} \label{lemma-perfect-map-ci} Let $R \to S$ be a local ring map of Noetherian local rings. Let $I \subset R$ and $J \subset S$ be ideals with $IS \subset J$. If $R \to S$ is flat and $S/\mathfrak m_RS$ is regular, then the following are equivalent \begin{enumerate} \item $J$ is generated by a regular sequence and $S/J$ has finite tor dimension as a module over $R/I$, \item $J$ is generated by a regular sequence and $\text{Tor}^{R/I}_p(S/J, R/\mathfrak m_R)$ is nonzero for only finitely many $p$, \item $I$ is generated by a regular sequence and $J/IS$ is generated by a regular sequence in $S/IS$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-ci-well-defined} Let $(A, \mathfrak m)$ be a Noetherian complete local ring. The following are equivalent \begin{enumerate} \item for every surjection of local rings $R \to A$ with $R$ a regular local ring, the kernel of $R \to A$ is generated by a regular sequence, and \item for some surjection of local rings $R \to A$ with $R$ a regular local ring, the kernel of $R \to A$ is generated by a regular sequence. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-quotient-regular-ring-by-regular-sequence} Let $R$ be a regular ring. Let $\mathfrak p \subset R$ be a prime. Let $f_1, \ldots, f_r \in \mathfrak p$ be a regular sequence. Then the completion of $$ A = (R/(f_1, \ldots, f_r))_\mathfrak p = R_\mathfrak p/(f_1, \ldots, f_r)R_\mathfrak p $$ is a complete intersection in the sense defined above. \end{lemma} 
\begin{lemma} \label{lemma-quotient-regular-ring} Let $R$ be a regular ring. Let $\mathfrak p \subset R$ be a prime. Let $I \subset \mathfrak p$ be an ideal. Set $A = (R/I)_\mathfrak p = R_\mathfrak p/I_\mathfrak p$. The following are equivalent \begin{enumerate} \item the completion of $A$ is a complete intersection in the sense above, \item $I_\mathfrak p \subset R_\mathfrak p$ is generated by a regular sequence, \item the module $(I/I^2)_\mathfrak p$ can be generated by $\dim(R_\mathfrak p) - \dim(A)$ elements, \item add more here. \end{enumerate} \end{lemma} 
\begin{proposition} \label{proposition-avramov} Let $A \to B$ be a flat local homomorphism of Noetherian local rings. Then the following are equivalent \begin{enumerate} \item $B^\wedge$ is a complete intersection, \item $A^\wedge$ and $(B/\mathfrak m_A B)^\wedge$ are complete intersections. \end{enumerate} \end{proposition} 
\begin{definition} \label{definition-lci} Let $A$ be a Noetherian ring. \begin{enumerate} \item If $A$ is local, then we say $A$ is a {\it complete intersection} if its completion is a complete intersection in the sense above. \item In general we say $A$ is a {\it local complete intersection} if all of its local rings are complete intersections. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-ci-good} Let $(A, \mathfrak m)$ be a Noetherian local ring. Let $\mathfrak p \subset A$ be a prime ideal. If $A$ is a complete intersection, then $A_\mathfrak p$ is a complete intersection too. \end{lemma} 
\begin{lemma} \label{lemma-check-lci-at-maximal-ideals} Let $A$ be a Noetherian ring. Then $A$ is a local complete intersection if and only if $A_\mathfrak m$ is a complete intersection for every maximal ideal $\mathfrak m$ of $A$. \end{lemma} 
\begin{lemma} \label{lemma-check-lci-agrees} Let $S$ be a finite type algebra over a field $k$. \begin{enumerate} \item for a prime $\mathfrak q \subset S$ the local ring $S_\mathfrak q$ is a complete intersection in the sense of Algebra, Definition \ref{algebra-definition-lci-local-ring} if and only if $S_\mathfrak q$ is a complete intersection in the sense of Definition \ref{definition-lci}, and \item $S$ is a local complete intersection in the sense of Algebra, Definition \ref{algebra-definition-lci-field} if and only if $S$ is a local complete intersection in the sense of Definition \ref{definition-lci}. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-avramov} Let $A \to B$ be a flat local homomorphism of Noetherian local rings. Then the following are equivalent \begin{enumerate} \item $B$ is a complete intersection, \item $A$ and $B/\mathfrak m_A B$ are complete intersections. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-ci-map-well-defined} Let $A \to B$ be a local homomorphism of Noetherian complete local rings. The following are equivalent \begin{enumerate} \item for some good factorization $A \to S \to B$ the kernel of $S \to B$ is generated by a regular sequence, and \item for every good factorization $A \to S \to B$ the kernel of $S \to B$ is generated by a regular sequence. \end{enumerate} \end{lemma} 
\begin{proposition} \label{proposition-avramov-map} Let $A \to B$ be a local homomorphism of Noetherian local rings. Then the following are equivalent \begin{enumerate} \item $B$ is a complete intersection and $\text{Tor}^A_p(B, A/\mathfrak m_A)$ is nonzero for only finitely many $p$, \item $A$ is a complete intersection and $A^\wedge \to B^\wedge$ is a complete intersection homomorphism in the sense defined above. \end{enumerate} \end{proposition} 
\begin{lemma} \label{lemma-well-defined-if-you-can-find-good-factorization} Consider a commutative diagram $$ \xymatrix{ S \ar[r] & B \\ & A \ar[lu] \ar[u] } $$ of Noetherian local rings with $S \to B$ surjective, $A \to S$ flat, and $S/\mathfrak m_A S$ a regular local ring. The following are equivalent \begin{enumerate} \item $\Ker(S \to B)$ is generated by a regular sequence, and \item $A^\wedge \to B^\wedge$ is a complete intersection homomorphism as defined above. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-finite-type-lci-map} Let $A$ be a Noetherian ring. Let $A \to B$ be a finite type ring map. The following are equivalent \begin{enumerate} \item $A \to B$ is a local complete intersection in the sense of More on Algebra, Definition \ref{more-algebra-definition-local-complete-intersection}, \item for every prime $\mathfrak q \subset B$ and with $\mathfrak p = A \cap \mathfrak q$ the ring map $(A_\mathfrak p)^\wedge \to (B_\mathfrak q)^\wedge$ is a complete intersection homomorphism in the sense defined above. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-avramov-map-finite-type} Let $A$ be a Noetherian ring. Let $A \to B$ be a finite type ring map such that the image of $\Spec(B) \to \Spec(A)$ contains all closed points of $\Spec(A)$. Then the following are equivalent \begin{enumerate} \item $B$ is a complete intersection and $A \to B$ has finite tor dimension, \item $A$ is a complete intersection and $A \to B$ is a local complete intersection in the sense of More on Algebra, Definition \ref{more-algebra-definition-local-complete-intersection}. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-local-perfect-diagonal} Let $A \to B$ be a local ring homomorphism of Noetherian local rings such that $B$ is flat and essentially of finite type over $A$. If $$ B \otimes_A B \longrightarrow B $$ is a perfect ring map, i.e., if $B$ has finite tor dimension over $B \otimes_A B$, then $B$ is the localization of a smooth $A$-algebra. \end{lemma} 
\begin{lemma} \label{lemma-perfect-diagonal} Let $A \to B$ be a flat finite type ring map of Noetherian rings. If $$ B \otimes_A B \longrightarrow B $$ is a perfect ring map, i.e., if $B$ has finite tor dimension over $B \otimes_A B$, then $B$ is a smooth $A$-algebra. \end{lemma} 
\begin{lemma} \label{lemma-free-summand-in-ideal-finite-proj-dim} \begin{reference} \cite{Vasconcelos} \end{reference} Let $R$ be a Noetherian local ring. Let $I \subset R$ be an ideal of finite projective dimension over $R$. If $F \subset I/I^2$ is a direct summand isomorphic to $R/I$, then there exists a nonzerodivisor $x \in I$ such that the image of $x$ in $I/I^2$ generates $F$. \end{lemma} 
\begin{lemma} \label{lemma-vasconcelos} \begin{reference} Local version of \cite[Theorem 1.1]{Vasconcelos} \end{reference} Let $R$ be a Noetherian local ring. Let $I \subset R$ be an ideal of finite projective dimension over $R$. If $F \subset I/I^2$ is a direct summand free of rank $r$, then there exists a regular sequence $x_1, \ldots, x_r \in I$ such that $x_1 \bmod I^2, \ldots, x_r \bmod I^2$ generate $F$. \end{lemma} 
\begin{proposition} \label{proposition-regular-ideal} \begin{reference} Variant of \cite[Corollary 1]{Vasconcelos}. See also \cite{Iyengar} and \cite{Ferrand-lci}. \end{reference} Let $R$ be a Noetherian ring. Let $I \subset R$ be an ideal which has finite projective dimension and such that $I/I^2$ is finite locally free over $R/I$. Then $I$ is a regular ideal (More on Algebra, Definition \ref{more-algebra-definition-regular-ideal}). \end{proposition} 
\begin{lemma} \label{lemma-perfect-NL-lci} Let $A \to B$ be a perfect (More on Algebra, Definition \ref{more-algebra-definition-pseudo-coherent-perfect}) ring homomorphism of Noetherian rings. Then the following are equivalent \begin{enumerate} \item $\NL_{B/A}$ has tor-amplitude in $[-1, 0]$, \item $\NL_{B/A}$ is a perfect object of $D(B)$ with tor-amplitude in $[-1, 0]$, and \item $A \to B$ is a local complete intersection (More on Algebra, Definition \ref{more-algebra-definition-local-complete-intersection}). \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-flat-fp-NL-lci} Let $A \to B$ be a flat ring map of finite presentation. Then the following are equivalent \begin{enumerate} \item $\NL_{B/A}$ has tor-amplitude in $[-1, 0]$, \item $\NL_{B/A}$ is a perfect object of $D(B)$ with tor-amplitude in $[-1, 0]$, \item $A \to B$ is syntomic (Algebra, Definition \ref{algebra-definition-lci}), and \item $A \to B$ is a local complete intersection (More on Algebra, Definition \ref{more-algebra-definition-local-complete-intersection}). \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-lift-tate-to-koszul} In the situation above, if $R$ is Noetherian, then for every $n$ there exists an $N \geq n$ and maps $$ K_N \to A \to R/(f_1^N, \ldots, f_r^N)\quad\text{and}\quad A \to K_n $$ with the following properties \begin{enumerate} \item $(A, \text{d}, \gamma)$ is as in Definition \ref{definition-divided-powers-dga}, \item $A \to R/(f_1^N, \ldots, f_r^N)$ is a quasi-isomorphism, \item the composition $K_N \to A \to R/(f_1^N, \ldots, f_r^N)$ is the canonical map, \item the composition $K_N \to A \to K_n$ is the transition map, \item $A_0 = R \to R/(f_1^N, \ldots, f_r^N)$ is the canonical surjection, \item $A$ is a graded divided power polynomial algebra over $R$ with finitely many generators in each degree, and \item $A \to K_n$ is a homomorphism of differential graded $R$-algebras compatible with divided powers which induces the canonical map $R/(f_1^N, \ldots, f_r^N) \to R/(f_1^n, \ldots, f_r^n)$ on homology in degree $0$. \end{enumerate} Condition (4) means that $A$ is constructed out of $A_0$ by successively adjoining a finite set of variables $T$ in each degree $> 0$ as in Example \ref{example-adjoining-odd} or \ref{example-adjoining-even}. \end{lemma} 
\begin{lemma} \label{lemma-compute-cohomology-adjoin-variable} Let $(A, \text{d}, \gamma)$, $d \geq 1$, $f \in A_{d - 1}$, and $A\langle T \rangle$ be as in Lemma \ref{lemma-extend-differential}. \begin{enumerate} \item If $d = 1$, then there is a long exact sequences $$ \ldots \to H_0(A) \xrightarrow{f} H_0(A) \to H_0(A\langle T \rangle) \to 0 $$ \item For $d = 2$ there is a bounded spectral sequence $(E_1)_{i, j} = H_{j - i}(A) \cdot T^{[i]}$ converging to $H_{i + j}(A\langle T \rangle)$. The differential $(d_1)_{i, j} : H_{j - i}(A) \cdot T^{[i]} \to H_{j - i + 1}(A) \cdot T^{[i - 1]}$ sends $\xi \cdot T^{[i]}$ to the class of $f \xi \cdot T^{[i - 1]}$. \item Add more here for other degrees as needed. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-construct-some-maps} In the situation above, for all $n \geq t \geq 1$ there exists an $N > n$ and a map $$ K_t \longrightarrow K_n \otimes_R K_t $$ in the derived category of left differential graded $K_N$-modules whose composition with the multiplication map is the transition map (in either direction). \end{lemma} 
