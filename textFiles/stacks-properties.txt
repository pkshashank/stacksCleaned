\begin{lemma} \label{lemma-check-representable-covering} Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks. Let $W$ be an algebraic space and let $W \to \mathcal{Y}$ be surjective, locally of finite presentation, and flat. The following are equivalent \begin{enumerate} \item $f$ is representable by algebraic spaces, and \item $W \times_\mathcal{Y} \mathcal{X}$ is an algebraic space. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-property-spaces-too} Let $P$ be a property of morphisms of algebraic spaces as above. Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks representable by algebraic spaces. The following are equivalent: \begin{enumerate} \item $f$ has $P$, \item for every algebraic space $Z$ and morphism $Z \to \mathcal{Y}$ the morphism $Z \times_\mathcal{Y} \mathcal{X} \to Z$ has $P$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-check-property-covering} Let $P$ be a property of morphisms of algebraic spaces as above. Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks representable by algebraic spaces. Let $W$ be an algebraic space and let $W \to \mathcal{Y}$ be surjective, locally of finite presentation, and flat. Set $V = W \times_\mathcal{Y} \mathcal{X}$. Then $$ (f\text{ has }P) \Leftrightarrow (\text{the projection }V \to W\text{ has }P). $$ \end{lemma} 
\begin{lemma} \label{lemma-check-property-weak-covering} Let $P$ be a property of morphisms of algebraic spaces as above. Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks representable by algebraic spaces. Let $\mathcal{Z} \to \mathcal{Y}$ be a morphism of algebraic stacks which is representable by algebraic spaces, surjective, flat, and locally of finite presentation. Set $\mathcal{W} = \mathcal{Z} \times_\mathcal{Y} \mathcal{X}$. Then $$ (f\text{ has }P) \Leftrightarrow (\text{the projection }\mathcal{W} \to \mathcal{Z}\text{ has }P). $$ \end{lemma} 
\begin{lemma} \label{lemma-check-property-after-precomposing} Let $P$ be a property of morphisms of algebraic spaces as above. Let $\tau \in \{\etale, smooth, syntomic, fppf\}$. Let $\mathcal{X} \to \mathcal{Y}$ and $\mathcal{Y} \to \mathcal{Z}$ be morphisms of algebraic stacks representable by algebraic spaces. Assume \begin{enumerate} \item $\mathcal{X} \to \mathcal{Y}$ is surjective and \'etale, smooth, syntomic, or flat and locally of finite presentation, \item the composition has $P$, and \item $P$ is local on the source in the $\tau$ topology. \end{enumerate} Then $\mathcal{Y} \to \mathcal{Z}$ has property $P$. \end{lemma} 
\begin{lemma} \label{lemma-representable-in-terms-presentations} Let $g : \mathcal{X}' \to \mathcal{X}$ be a morphism of algebraic stacks which is representable by algebraic spaces. Let $[U/R] \to \mathcal{X}$ be a presentation. Set $U' = U \times_\mathcal{X} \mathcal{X}'$, and $R' = R \times_\mathcal{X} \mathcal{X}'$. Then there exists a groupoid in algebraic spaces of the form $(U', R', s', t', c')$, a presentation $[U'/R'] \to \mathcal{X}'$, and the diagram $$ \xymatrix{ [U'/R'] \ar[d]_{[\text{pr}]} \ar[r] & \mathcal{X}' \ar[d]^g \\ [U/R] \ar[r] & \mathcal{X} } $$ is $2$-commutative where the morphism $[\text{pr}]$ comes from a morphism of groupoids $\text{pr} : (U', R', s', t', c') \to (U, R, s, t, c)$. \end{lemma} 
\begin{lemma} \label{lemma-equivalence} The notion above does indeed define an equivalence relation on morphisms from spectra of fields into the algebraic stack $\mathcal{X}$. \end{lemma} 
\begin{definition} \label{definition-points} Let $\mathcal{X}$ be an algebraic stack. A {\it point} of $\mathcal{X}$ is an equivalence class of morphisms from spectra of fields into $\mathcal{X}$. The set of points of $\mathcal{X}$ is denoted $|\mathcal{X}|$. \end{definition} 
\begin{lemma} \label{lemma-points-cartesian} Let $$ \xymatrix{ \mathcal{Z} \times_\mathcal{Y} \mathcal{X} \ar[r] \ar[d] & \mathcal{X} \ar[d] \\ \mathcal{Z} \ar[r] & \mathcal{Y} } $$ be a fibre product of algebraic stacks. Then the map of sets of points $$ |\mathcal{Z} \times_\mathcal{Y} \mathcal{X}| \longrightarrow |\mathcal{Z}| \times_{|\mathcal{Y}|} |\mathcal{X}| $$ is surjective. \end{lemma} 
\begin{lemma} \label{lemma-characterize-surjective} Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks which is representable by algebraic spaces. The following are equivalent: \begin{enumerate} \item $|f| : |\mathcal{X}| \to |\mathcal{Y}|$ is surjective, and \item $f$ is surjective (in the sense of Section \ref{section-properties-morphisms}). \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-points-presentation} Let $\mathcal{X}$ be an algebraic stack. Let $\mathcal{X} = [U/R]$ be a presentation of $\mathcal{X}$, see Algebraic Stacks, Definition \ref{algebraic-definition-presentation}. Then the image of $|R| \to |U| \times |U|$ is an equivalence relation and $|\mathcal{X}|$ is the quotient of $|U|$ by this equivalence relation. \end{lemma} 
\begin{lemma} \label{lemma-topology-points} There exists a unique topology on the sets of points of algebraic stacks with the following properties: \begin{enumerate} \item for every morphism of algebraic stacks $\mathcal{X} \to \mathcal{Y}$ the map $|\mathcal{X}| \to |\mathcal{Y}|$ is continuous, and \item for every morphism $U \to \mathcal{X}$ which is flat and locally of finite presentation with $U$ an algebraic space the map of topological spaces $|U| \to |\mathcal{X}|$ is continuous and open. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-topological-space} Let $\mathcal{X}$ be an algebraic stack. The underlying {\it topological space} of $\mathcal{X}$ is the set of points $|\mathcal{X}|$ endowed with the topology constructed in Lemma \ref{lemma-topology-points}. \end{definition} 
\begin{lemma} \label{lemma-space-locally-quasi-compact} Let $\mathcal{X}$ be an algebraic stack. Every point of $|\mathcal{X}|$ has a fundamental system of quasi-compact open neighbourhoods. In particular $|\mathcal{X}|$ is locally quasi-compact in the sense of Topology, Definition \ref{topology-definition-locally-quasi-compact}. \end{lemma} 
\begin{definition} \label{definition-surjective} Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks. We say $f$ is {\it surjective} if the map $|f| : |\mathcal{X}| \to |\mathcal{Y}|$ of associated topological spaces is surjective. \end{definition} 
\begin{lemma} \label{lemma-composition-surjective} The composition of surjective morphisms is surjective. \end{lemma} 
\begin{lemma} \label{lemma-base-change-surjective} The base change of a surjective morphism is surjective. \end{lemma} 
\begin{lemma} \label{lemma-descent-surjective} Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks. Let $\mathcal{Y}' \to \mathcal{Y}$ be a surjective morphism of algebraic stacks. If the base change $f' : \mathcal{Y}' \times_\mathcal{Y} \mathcal{X} \to \mathcal{Y}'$ of $f$ is surjective, then $f$ is surjective. \end{lemma} 
\begin{lemma} \label{lemma-surjective-permanence} Let $\mathcal{X} \to \mathcal{Y} \to \mathcal{Z}$ be morphisms of algebraic stacks. If $\mathcal{X} \to \mathcal{Z}$ is surjective so is $\mathcal{Y} \to \mathcal{Z}$. \end{lemma} 
\begin{definition} \label{definition-quasi-compact} Let $\mathcal{X}$ be an algebraic stack. We say $\mathcal{X}$ is {\it quasi-compact} if and only if $|\mathcal{X}|$ is quasi-compact. \end{definition} 
\begin{lemma} \label{lemma-quasi-compact-stack} Let $\mathcal{X}$ be an algebraic stack. The following are equivalent: \begin{enumerate} \item $\mathcal{X}$ is quasi-compact, \item there exists a surjective smooth morphism $U \to \mathcal{X}$ with $U$ an affine scheme, \item there exists a surjective smooth morphism $U \to \mathcal{X}$ with $U$ a quasi-compact scheme, \item there exists a surjective smooth morphism $U \to \mathcal{X}$ with $U$ a quasi-compact algebraic space, and \item there exists a surjective morphism $\mathcal{U} \to \mathcal{X}$ of algebraic stacks such that $\mathcal{U}$ is quasi-compact. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-finite-disjoint-quasi-compact} A finite disjoint union of quasi-compact algebraic stacks is a quasi-compact algebraic stack. \end{lemma} 
\begin{lemma} \label{lemma-type-property} Let $\mathcal{P}$ be a property of schemes which is local in the smooth topology, see Descent, Definition \ref{descent-definition-property-local}. Let $\mathcal{X}$ be an algebraic stack. The following are equivalent \begin{enumerate} \item for some scheme $U$ and some surjective smooth morphism $U \to \mathcal{X}$ the scheme $U$ has property $\mathcal{P}$, \item for every scheme $U$ and every smooth morphism $U \to \mathcal{X}$ the scheme $U$ has property $\mathcal{P}$, \item for some algebraic space $U$ and some surjective smooth morphism $U \to \mathcal{X}$ the algebraic space $U$ has property $\mathcal{P}$, and \item for every algebraic space $U$ and every smooth morphism $U \to \mathcal{X}$ the algebraic space $U$ has property $\mathcal{P}$. \end{enumerate} If $\mathcal{X}$ is a scheme this is equivalent to $\mathcal{P}(U)$. If $\mathcal{X}$ is an algebraic space this is equivalent to $X$ having property $\mathcal{P}$. \end{lemma} 
\begin{definition} \label{definition-type-property} Let $\mathcal{X}$ be an algebraic stack. Let $\mathcal{P}$ be a property of schemes which is local in the smooth topology. We say $\mathcal{X}$ {\it has property $\mathcal{P}$} if any of the equivalent conditions of Lemma \ref{lemma-type-property} hold. \end{definition} 
\begin{lemma} \label{lemma-local-source-target-at-point} Let $\mathcal{X}$ be an algebraic stack. Let $x \in |\mathcal{X}|$ be a point of $\mathcal{X}$. Let $\mathcal{P}$ be a property of germs of schemes which is smooth local, see Descent, Definition \ref{descent-definition-local-at-point}. The following are equivalent \begin{enumerate} \item for any smooth morphism $U \to \mathcal{X}$ with $U$ a scheme and $u \in U$ with $a(u) = x$ we have $\mathcal{P}(U, u)$, \item for some smooth morphism $U \to \mathcal{X}$ with $U$ a scheme and some $u \in U$ with $a(u) = x$ we have $\mathcal{P}(U, u)$, \item for any smooth morphism $U \to \mathcal{X}$ with $U$ an algebraic space and $u \in |U|$ with $a(u) = x$ the algebraic space $U$ has property $\mathcal{P}$ at $u$, and \item for some smooth morphism $U \to \mathcal{X}$ with $U$ a an algebraic space and some $u \in |U|$ with $a(u) = x$ the algebraic space $U$ has property $\mathcal{P}$ at $u$. \end{enumerate} If $\mathcal{X}$ is representable, then this is equivalent to $\mathcal{P}(\mathcal{X}, x)$. If $\mathcal{X}$ is an algebraic space then this is equivalent to $\mathcal{X}$ having property $\mathcal{P}$ at $x$. \end{lemma} 
\begin{definition} \label{definition-property-at-point} Let $\mathcal{P}$ be a property of germs of schemes which is smooth local. Let $\mathcal{X}$ be an algebraic stack. Let $x \in |\mathcal{X}|$. We say $\mathcal{X}$ {\it has property $\mathcal{P}$ at $x$} if any of the equivalent conditions of Lemma \ref{lemma-local-source-target-at-point} holds. \end{definition} 
\begin{definition} \label{definition-monomorphism} Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks. We say $f$ is a {\it monomorphism} if it is representable by algebraic spaces and a monomorphism in the sense of Section \ref{section-properties-morphisms}. \end{definition} 
\begin{lemma} \label{lemma-base-change-monomorphism} Let $\mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks. Let $\mathcal{Z} \to \mathcal{Y}$ be a monomorphism. Then $\mathcal{Z} \times_\mathcal{Y} \mathcal{X} \to \mathcal{X}$ is a monomorphism. \end{lemma} 
\begin{lemma} \label{lemma-composition-monomorphism} Compositions of monomorphisms of algebraic stacks are monomorphisms. \end{lemma} 
\begin{lemma} \label{lemma-monomorphism} Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks. The following are equivalent: \begin{enumerate} \item $f$ is a monomorphism, \item $f$ is fully faithful, \item the diagonal $\Delta_f : \mathcal{X} \to \mathcal{X} \times_\mathcal{Y} \mathcal{X}$ is an equivalence, and \item there exists an algebraic space $W$ and a surjective, flat morphism $W \to \mathcal{Y}$ which is locally of finite presentation such that $V = \mathcal{X} \times_\mathcal{Y} W$ is an algebraic space, and the morphism $V \to W$ is a monomorphism of algebraic spaces. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-monomorphism-injective-points} \begin{slogan} Monomorphisms of stacks are injective on points. \end{slogan} A monomorphism of algebraic stacks induces an injective map of sets of points. \end{lemma} 
\begin{lemma} \label{lemma-monomorphism-diagonal} Let $\mathcal{X} \to \mathcal{X}' \to \mathcal{Y}$ be morphisms of algebraic stacks. If $\mathcal{X} \to \mathcal{X}'$ is a monomorphism then the canonical diagram $$ \xymatrix{ \mathcal{X} \ar[r] \ar[d] & \mathcal{X} \times_\mathcal{Y} \mathcal{X} \ar[d] \\ \mathcal{X}' \ar[r] & \mathcal{X}' \times_\mathcal{Y} \mathcal{X}' } $$ is a fibre product square. \end{lemma} 
\begin{definition} \label{definition-immersion} Immersions. \begin{enumerate} \item A morphism of algebraic stacks is called an {\it open immersion} if it is representable, and an open immersion in the sense of Section \ref{section-properties-morphisms}. \item A morphism of algebraic stacks is called a {\it closed immersion} if it is representable, and a closed immersion in the sense of Section \ref{section-properties-morphisms}. \item A morphism of algebraic stacks is called an {\it immersion} if it is representable, and an immersion in the sense of Section \ref{section-properties-morphisms}. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-base-change-immersion} Let $\mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks. Let $\mathcal{Z} \to \mathcal{Y}$ be a (closed, resp.\ open) immersion. Then $\mathcal{Z} \times_\mathcal{Y} \mathcal{X} \to \mathcal{X}$ is a (closed, resp.\ open) immersion. \end{lemma} 
\begin{lemma} \label{lemma-composition-immersion} Compositions of immersions of algebraic stacks are immersions. Similarly for closed immersions and open immersions. \end{lemma} 
\begin{lemma} \label{lemma-check-immersion-covering} Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks. Let $W$ be an algebraic space and let $W \to \mathcal{Y}$ be a surjective, flat morphism which is locally of finite presentation. The following are equivalent: \begin{enumerate} \item $f$ is an (open, resp.\ closed) immersion, and \item $V = W \times_\mathcal{Y} \mathcal{X}$ is an algebraic space, and $V \to W$ is an (open, resp.\ closed) immersion. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-immersion-monomorphism} An immersion is a monomorphism. \end{lemma} 
\begin{lemma} \label{lemma-subspace-induced-topology} If $f : \mathcal{X} \to \mathcal{Y}$ is an immersion, then $|f| : |\mathcal{X}| \to |\mathcal{Y}|$ is a homeomorphism onto a locally closed subset. If $f$ is a closed, resp.\ open immersion, then $|f|$ is closed, resp.\ open. \end{lemma} 
\begin{lemma} \label{lemma-immersion-into-presentation} Let $(U, R, s, t, c)$ be a smooth groupoid in algebraic spaces. Let $i : \mathcal{Z} \to [U/R]$ be an immersion. Then there exists an $R$-invariant locally closed subspace $Z \subset U$ and a presentation $[Z/R_Z] \to \mathcal{Z}$ where $R_Z$ is the restriction of $R$ to $Z$ such that $$ \xymatrix{ [Z/R_Z] \ar[dr] \ar[rr] & & \mathcal{Z} \ar[ld]^i \\ & [U/R] } $$ is $2$-commutative. If $i$ is a closed (resp.\ open) immersion then $Z$ is a closed (resp.\ open) subspace of $U$. \end{lemma} 
\begin{lemma} \label{lemma-immersion-presentation} Let $(U, R, s, t, c)$ be a smooth groupoid in algebraic spaces. Let $\mathcal{X} = [U/R]$ be the associated algebraic stack, see Algebraic Stacks, Theorem \ref{algebraic-theorem-smooth-groupoid-gives-algebraic-stack}. Let $Z \subset U$ be an $R$-invariant locally closed subspace. Then $$ [Z/R_Z] \longrightarrow [U/R] $$ is an immersion of algebraic stacks, where $R_Z$ is the restriction of $R$ to $Z$. If $Z \subset U$ is open (resp.\ closed) then the morphism is an open (resp.\ closed) immersion of algebraic stacks. \end{lemma} 
\begin{definition} \label{definition-substacks} Let $\mathcal{X}$ be an algebraic stack. \begin{enumerate} \item An {\it open substack} of $\mathcal{X}$ is a strictly full subcategory $\mathcal{X}' \subset \mathcal{X}$ such that $\mathcal{X}'$ is an algebraic stack and $\mathcal{X}' \to \mathcal{X}$ is an open immersion. \item A {\it closed substack} of $\mathcal{X}$ is a strictly full subcategory $\mathcal{X}' \subset \mathcal{X}$ such that $\mathcal{X}'$ is an algebraic stack and $\mathcal{X}' \to \mathcal{X}$ is a closed immersion. \item A {\it locally closed substack} of $\mathcal{X}$ is a strictly full subcategory $\mathcal{X}' \subset \mathcal{X}$ such that $\mathcal{X}'$ is an algebraic stack and $\mathcal{X}' \to \mathcal{X}$ is an immersion. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-substack-image} For any immersion $i : \mathcal{Z} \to \mathcal{X}$ there exists a unique locally closed substack $\mathcal{X}' \subset \mathcal{X}$ such that $i$ factors as the composition of an equivalence $i' : \mathcal{Z} \to \mathcal{X}'$ followed by the inclusion morphism $\mathcal{X}' \to \mathcal{X}$. If $i$ is a closed (resp.\ open) immersion, then $\mathcal{X}'$ is a closed (resp.\ open) substack of $\mathcal{X}$. \end{lemma} 
\begin{lemma} \label{lemma-substacks-presentation} Let $[U/R] \to \mathcal{X}$ be a presentation of an algebraic stack. There is a canonical bijection $$ \text{locally closed substacks }\mathcal{Z}\text{ of }\mathcal{X} \longrightarrow R\text{-invariant locally closed subspaces }Z\text{ of }U $$ which sends $\mathcal{Z}$ to $U \times_\mathcal{X} \mathcal{Z}$. Moreover, a morphism of algebraic stacks $f : \mathcal{Y} \to \mathcal{X}$ factors through $\mathcal{Z}$ if and only if $\mathcal{Y} \times_\mathcal{X} U \to U$ factors through $Z$. Similarly for closed substacks and open substacks. \end{lemma} 
\begin{lemma} \label{lemma-open-substacks} Let $\mathcal{X}$ be an algebraic stack. The rule $\mathcal{U} \mapsto |\mathcal{U}|$ defines an inclusion preserving bijection between open substacks of $\mathcal{X}$ and open subsets of $|\mathcal{X}|$. \end{lemma} 
\begin{lemma} \label{lemma-open-image-substack} Let $\mathcal X$ be an algebraic stack. Let $U$ be an algebraic space and $U \to \mathcal X$ a surjective smooth morphism. For an open immersion $V \hookrightarrow U$, there exists an algebraic stack $\mathcal Y$, an open immersion $\mathcal Y \to \mathcal X$, and a surjective smooth morphism $V \to \mathcal Y$. \end{lemma} 
\begin{lemma} \label{lemma-union-open-substacks} Let $\mathcal X$ be an algebraic stack and $\mathcal{X}_i \subset \mathcal X$ a collection of open substacks indexed by $i \in I$. Then there exists an open substack, which we denote $\bigcup_{i\in I} \mathcal{X}_i \subset \mathcal X$, such that the $\mathcal{X}_i$ are open substacks covering it. \end{lemma} 
\begin{lemma} \label{lemma-quasi-compact-finite-subcover} Let $\mathcal X$ be an algebraic stack and $\mathcal X' \subset \mathcal X$ a quasi-compact open substack. Suppose that we have a collection of open substacks $\mathcal{X}_i \subset \mathcal X$  indexed by $i \in I$ such that $\mathcal{X}' \subset \bigcup_{i \in I} \mathcal{X}_i$, where we define the union as in Lemma \ref{lemma-union-open-substacks}. Then there exists a finite subset $I' \subset I$ such that $\mathcal{X}' \subset \bigcup_{i \in I'} \mathcal{X}_i$. \end{lemma} 
\begin{lemma} \label{lemma-zariski-open-cover-stack-is-space} Let $\mathcal X$ be an algebraic stack. Let $\mathcal{X}_i$, $i \in I$ be a set of open substacks of $\mathcal{X}$. Assume \begin{enumerate} \item $\mathcal{X} = \bigcup_{i \in I} \mathcal{X}_i$, and \item each $\mathcal{X}_i$ is an algebraic space. \end{enumerate} Then $\mathcal{X}$ is an algebraic space. \end{lemma} 
\begin{lemma} \label{lemma-zariski-open-cover-stack-is-scheme} Let $\mathcal X$ be an algebraic stack. Let $\mathcal{X}_i$, $i \in I$ be a set of open substacks of $\mathcal{X}$. Assume \begin{enumerate} \item $\mathcal{X} = \bigcup_{i \in I} \mathcal{X}_i$, and \item each $\mathcal{X}_i$ is a scheme \end{enumerate} Then $\mathcal{X}$ is a scheme. \end{lemma} 
\begin{lemma} \label{lemma-local-source} Let $\mathcal{P}, \mathcal{Q}, \mathcal{R}$ be properties of morphisms of algebraic spaces. Assume \begin{enumerate} \item $\mathcal{P}, \mathcal{Q}, \mathcal{R}$ are fppf local on the target and stable under arbitrary base change, \item $\text{smooth} \Rightarrow \mathcal{R}$, \item for any morphism $f : X \to Y$ which has $\mathcal{Q}$ there exists a largest open subspace $W(\mathcal{P}, f) \subset X$ such that $f|_{W(\mathcal{P}, f)}$ has $\mathcal{P}$, and \item for any morphism $f : X \to Y$ which has $\mathcal{Q}$, and any morphism $Y' \to Y$ which has $\mathcal{R}$ we have $Y' \times_Y W(\mathcal{P}, f) = W(\mathcal{P}, f')$, where $f' : X_{Y'} \to Y'$ is the base change of $f$. \end{enumerate} Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks representable by algebraic spaces. Assume $f$ has $\mathcal{Q}$. Then \begin{enumerate} \item[(A)] there exists a largest open substack $\mathcal{X}' \subset \mathcal{X}$ such that $f|_{\mathcal{X}'}$ has $\mathcal{P}$, and \item[(B)] if $\mathcal{Z} \to \mathcal{Y}$ is a morphism of algebraic stacks representable by algebraic spaces which has $\mathcal{R}$ then $\mathcal{Z} \times_\mathcal{Y} \mathcal{X}'$ is the largest open substack of $\mathcal{Z} \times_\mathcal{Y} \mathcal{X}$ over which the base change $\text{id}_\mathcal{Z} \times f$ has property $\mathcal{P}$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-reduced-closed-substack} Let $\mathcal{X}$ be an algebraic stack. Let $T \subset |\mathcal{X}|$ be a closed subset. There exists a unique closed substack $\mathcal{Z} \subset \mathcal{X}$ with the following properties: (a) we have $|\mathcal{Z}| = T$, and (b) $\mathcal{Z}$ is reduced. \end{lemma} 
\begin{lemma} \label{lemma-reduced-stack-determined-by-points} Let $\mathcal{X}$ be an algebraic stack. If $\mathcal{X}' \subset \mathcal{X}$ is a closed substack, $\mathcal{X}$ is reduced and $|\mathcal{X}'| = |\mathcal{X}|$, then $\mathcal{X}' = \mathcal{X}$. \end{lemma} 
\begin{lemma} \label{lemma-map-into-reduction} Let $\mathcal{X}$, $\mathcal{Y}$ be algebraic stacks. Let $\mathcal{Z} \subset \mathcal{X}$ be a closed substack Assume $\mathcal{Y}$ is reduced. A morphism $f : \mathcal{Y} \to \mathcal{X}$ factors through $\mathcal{Z}$ if and only if $f(|\mathcal{Y}|) \subset |\mathcal{Z}|$. \end{lemma} 
\begin{definition} \label{definition-reduced-induced-stack} Let $\mathcal{X}$ be an algebraic stack. Let $Z \subset |\mathcal{X}|$ be a closed subset. An {\it algebraic stack structure on $Z$} is given by a closed substack $\mathcal{Z}$ of $\mathcal{X}$ with $|\mathcal{Z}|$ equal to $Z$. The {\it reduced induced algebraic stack structure} on $Z$ is the one constructed in Lemma \ref{lemma-reduced-closed-substack}. The {\it reduction $\mathcal{X}_{red}$ of $\mathcal{X}$} is the reduced induced algebraic stack structure on $|\mathcal{X}|$. \end{definition} 
\begin{lemma} \label{lemma-flat-cover-by-field} Let $\mathcal{Z}$ be an algebraic stack. Let $k$ be a field and let $\Spec(k) \to \mathcal{Z}$ be surjective and flat. Then any morphism $\Spec(k') \to \mathcal{Z}$ where $k'$ is a field is surjective and flat. \end{lemma} 
\begin{lemma} \label{lemma-unique-point} Let $\mathcal{Z}$ be an algebraic stack. The following are equivalent \begin{enumerate} \item $\mathcal{Z}$ is reduced and $|\mathcal{Z}|$ is a singleton, \item there exists a surjective flat morphism $\Spec(k) \to \mathcal{Z}$ where $k$ is a field, and \item there exists a locally of finite type, surjective, flat morphism $\Spec(k) \to \mathcal{Z}$ where $k$ is a field. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-unique-point-better} Let $\mathcal{Z}$ be an algebraic stack. The following are equivalent \begin{enumerate} \item $\mathcal{Z}$ is reduced, locally Noetherian, and $|\mathcal{Z}|$ is a singleton, and \item there exists a locally finitely presented, surjective, flat morphism $\Spec(k) \to \mathcal{Z}$ where $k$ is a field. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-monomorphism-into-point} Let $\mathcal{Z}' \to \mathcal{Z}$ be a monomorphism of algebraic stacks. Assume there exists a field $k$ and a locally finitely presented, surjective, flat morphism $\Spec(k) \to \mathcal{Z}$. Then either $\mathcal{Z}'$ is empty or $\mathcal{Z}' \to \mathcal{Z}$ is an equivalence. \end{lemma} 
\begin{lemma} \label{lemma-improve-unique-point} Let $\mathcal{Z}$ be an algebraic stack. Assume $\mathcal{Z}$ satisfies the equivalent conditions of Lemma \ref{lemma-unique-point}. Then there exists a unique strictly full subcategory $\mathcal{Z}' \subset \mathcal{Z}$ such that $\mathcal{Z}'$ is an algebraic stack which satisfies the equivalent conditions of Lemma \ref{lemma-unique-point-better}. The inclusion morphism $\mathcal{Z}' \to \mathcal{Z}$ is a monomorphism of algebraic stacks. \end{lemma} 
\begin{lemma} \label{lemma-residual-gerbe} Let $\mathcal{X}$ be an algebraic stack. Let $x \in |\mathcal{X}|$ be a point. The following are equivalent \begin{enumerate} \item there exists an algebraic stack $\mathcal{Z}$ and a monomorphism $\mathcal{Z} \to \mathcal{X}$ such that $|\mathcal{Z}|$ is a singleton and such that the image of $|\mathcal{Z}|$ in $|\mathcal{X}|$ is $x$, \item there exists a reduced algebraic stack $\mathcal{Z}$ and a monomorphism $\mathcal{Z} \to \mathcal{X}$ such that $|\mathcal{Z}|$ is a singleton and such that the image of $|\mathcal{Z}|$ in $|\mathcal{X}|$ is $x$, \item there exists an algebraic stack $\mathcal{Z}$, a monomorphism $f : \mathcal{Z} \to \mathcal{X}$, and a surjective flat morphism $z : \Spec(k) \to \mathcal{Z}$ where $k$ is a field such that $x = f(z)$. \end{enumerate} Moreover, if these conditions hold, then there exists a unique strictly full subcategory $\mathcal{Z}_x \subset \mathcal{X}$ such that $\mathcal{Z}_x$ is a reduced, locally Noetherian algebraic stack and $|\mathcal{Z}_x|$ is a singleton which maps to $x$ via the map $|\mathcal{Z}_x| \to |\mathcal{X}|$. \end{lemma} 
\begin{definition} \label{definition-residual-gerbe} Let $\mathcal{X}$ be an algebraic stack. Let $x \in |\mathcal{X}|$. \begin{enumerate} \item We say the {\it residual gerbe of $\mathcal{X}$ at $x$ exists} if the equivalent conditions (1), (2), and (3) of Lemma \ref{lemma-residual-gerbe} hold. \item If the residual gerbe of $\mathcal{X}$ at $x$ exists, then the {\it residual gerbe of $\mathcal{X}$ at $x$}\footnote{This clashes with \cite{LM-B} in spirit, but not in fact. Namely, in Chapter 11 they associate to any point on any quasi-separated algebraic stack a gerbe (not necessarily algebraic) which they call the residual gerbe. We will see in Morphisms of Stacks, Lemma \ref{stacks-morphisms-lemma-every-point-residual-gerbe} that on a quasi-separated algebraic stack every point has a residual gerbe in our sense which is then equivalent to theirs. For more information on this topic see \cite[Appendix B]{rydh_etale_devissage}.} is the strictly full subcategory $\mathcal{Z}_x \subset \mathcal{X}$ constructed in Lemma \ref{lemma-residual-gerbe}. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-residual-gerbe-regular} A reduced, locally Noetherian algebraic stack $\mathcal{Z}$ such that $|\mathcal{Z}|$ is a singleton is regular. \end{lemma} 
\begin{lemma} \label{lemma-residual-gerbe-points} Let $\mathcal{X}$ be an algebraic stack. Let $x \in |\mathcal{X}|$. Assume that the residual gerbe $\mathcal{Z}_x$ of $\mathcal{X}$ exists. Let $f : \Spec(K) \to \mathcal{X}$ be a morphism where $K$ is a field in the equivalence class of $x$. Then $f$ factors through the inclusion morphism $\mathcal{Z}_x \to \mathcal{X}$. \end{lemma} 
\begin{lemma} \label{lemma-residual-gerbe-unique} Let $\mathcal{X}$ be an algebraic stack. Let $x \in |\mathcal{X}|$. Let $\mathcal{Z}$ be an algebraic stack satisfying the equivalent conditions of Lemma \ref{lemma-unique-point-better} and let $\mathcal{Z} \to \mathcal{X}$ be a monomorphism such that the image of $|\mathcal{Z}| \to |\mathcal{X}|$ is $x$. Then the residual gerbe $\mathcal{Z}_x$ of $\mathcal{X}$ at $x$ exists and $\mathcal{Z} \to \mathcal{X}$ factors as $\mathcal{Z} \to \mathcal{Z}_x \to \mathcal{X}$ where the first arrow is an equivalence. \end{lemma} 
\begin{lemma} \label{lemma-residual-gerbe-functorial} Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks. Let $x \in |\mathcal{X}|$ with image $y \in |\mathcal{Y}|$. If the residual gerbes $\mathcal{Z}_x \subset \mathcal{X}$ and $\mathcal{Z}_y \subset \mathcal{Y}$ of $x$ and $y$ exist, then $f$ induces a commutative diagram $$ \xymatrix{ \mathcal{X} \ar[d]_f & \mathcal{Z}_x \ar[l] \ar[d] \\ \mathcal{Y} & \mathcal{Z}_y \ar[l] } $$ \end{lemma} 
\begin{lemma} \label{lemma-residual-gerbe-isomorphic} Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks. Let $x \in |\mathcal{X}|$ with image $y \in |\mathcal{Y}|$. Assume the residual gerbes $\mathcal{Z}_x \subset \mathcal{X}$ and $\mathcal{Z}_y \subset \mathcal{Y}$ of $x$ and $y$ exist and that there exists a morphism $\Spec(k) \to \mathcal{X}$ in the equivalence class of $x$ such that $$ \Spec(k) \times_\mathcal{X} \Spec(k) \longrightarrow \Spec(k) \times_\mathcal{Y} \Spec(k) $$ is an isomorphism. Then $\mathcal{Z}_x \to \mathcal{Z}_y$ is an isomorphism. \end{lemma} 
\begin{lemma} \label{lemma-dimension-at-point-well-defined} Let $\mathcal{X}$ be a locally Noetherian algebraic stack over a scheme $S$. Let $x \in |\mathcal{X}|$ be a point of $\mathcal{X}$. Let $[U/R] \to \mathcal{X}$ be a presentation (Algebraic Stacks, Definition \ref{algebraic-definition-presentation}) where $U$ is a scheme. Let $u \in U$ be a point that maps to $x$. Let $e : U \to R$ be the ``identity'' map and let $s : R \to U$ be the ``source'' map, which is a smooth morphism of algebraic spaces. Let $R_u$ be the fiber of $s : R \to U$ over $u$. The element $$ \dim_x(\mathcal{X}) = \dim_u(U) - \dim_{e(u)}(R_u) \in \mathbf{Z} \cup \infty $$ is independent of the choice of presentation and the point $u$ over $x$. \end{lemma} 
\begin{definition} \label{definition-dimension-at-point} Let $\mathcal{X}$ be a locally Noetherian algebraic stack over a scheme $S$. Let $x \in |\mathcal{X}|$ be a point of $\mathcal{X}$. Let $[U/R] \to \mathcal{X}$ be a presentation (Algebraic Stacks, Definition \ref{algebraic-definition-presentation}) where $U$ is a scheme and let $u \in U$ be a point that maps to $x$. We define the {\it dimension of $\mathcal{X}$ at $x$} to be the element $\dim_x(\mathcal{X}) \in \mathbf{Z} \cup \infty$ such that  $$ \dim_x(\mathcal{X}) = \dim_u(U)-\dim_{e(u)}(R_u). $$ with notation as in Lemma \ref{lemma-dimension-at-point-well-defined}. \end{definition} 
\begin{definition} \label{definition-dimension} Let $S$ be a scheme. Let $\mathcal{X}$ be a locally Noetherian algebraic stack over $S$. The {\it dimension} $\dim(\mathcal{X})$ of $\mathcal{X}$ is defined to be $$ \dim(\mathcal{X}) = \sup\nolimits_{x \in |\mathcal{X}|} \dim_x(\mathcal{X}) $$ \end{definition} 
\begin{definition} \label{definition-number-of-geometric-branches} Let $\mathcal{X}$ be an algebraic stack. Let $x \in |\mathcal{X}|$. \begin{enumerate} \item The {\it number of geometric branches of $\mathcal{X}$ at $x$} is either $n \in \mathbf{N}$ if the equivalent conditions of Lemma \ref{lemma-local-source-target-at-point} hold for $\mathcal{P}_n$ defined above, or else $\infty$. \item We say $\mathcal{X}$ is {\it geometrically unibranch at $x$} if the number of geometric branches of $\mathcal{X}$ at $x$ is $1$. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-UR-quasi-compact-above-x} Let $\mathcal{X}$ be an algebraic stack. Let $x \in |\mathcal{X}|$ be a point. The following are equivalent \begin{enumerate} \item some morphism $\Spec(k) \to \mathcal{X}$ in the equivalence class of $x$ is quasi-compact, and \item any morphism $\Spec(k) \to \mathcal{X}$ in the equivalence class of $x$ is quasi-compact. \end{enumerate} \end{lemma} 
