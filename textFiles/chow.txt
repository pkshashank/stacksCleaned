\begin{definition} \label{definition-periodic-complex} Let $R$ be a ring. \begin{enumerate} \item A {\it $2$-periodic complex} over $R$ is given by a quadruple $(M, N, \varphi, \psi)$ consisting of $R$-modules $M$, $N$ and $R$-module maps $\varphi : M \to N$, $\psi : N \to M$ such that $$ \xymatrix{ \ldots \ar[r] & M \ar[r]^\varphi & N \ar[r]^\psi & M \ar[r]^\varphi & N \ar[r] & \ldots } $$ is a complex. In this setting we define the {\it cohomology modules} of the complex to be the $R$-modules $$ H^0(M, N, \varphi, \psi) = \Ker(\varphi)/\Im(\psi) \quad\text{and}\quad H^1(M, N, \varphi, \psi) = \Ker(\psi)/\Im(\varphi). $$ We say the $2$-periodic complex is {\it exact} if the cohomology groups are zero. \item A {\it $(2, 1)$-periodic complex} over $R$ is given by a triple $(M, \varphi, \psi)$ consisting of an $R$-module $M$ and $R$-module maps $\varphi : M \to M$, $\psi : M \to M$ such that $$ \xymatrix{ \ldots \ar[r] & M \ar[r]^\varphi & M \ar[r]^\psi & M \ar[r]^\varphi & M \ar[r] & \ldots } $$ is a complex. Since this is a special case of a $2$-periodic complex we have its {\it cohomology modules} $H^0(M, \varphi, \psi)$, $H^1(M, \varphi, \psi)$ and a notion of exactness. \end{enumerate} \end{definition} 
\begin{definition} \label{definition-periodic-length} Let $(M, N, \varphi, \psi)$ be a $2$-periodic complex over a ring $R$ whose cohomology modules have finite length. In this case we define the {\it multiplicity} of $(M, N, \varphi, \psi)$ to be the integer $$ e_R(M, N, \varphi, \psi) = \text{length}_R(H^0(M, N, \varphi, \psi)) - \text{length}_R(H^1(M, N, \varphi, \psi)) $$ In the case of a $(2, 1)$-periodic complex $(M, \varphi, \psi)$, we denote this by $e_R(M, \varphi, \psi)$ and we will sometimes call this the {\it (additive) Herbrand quotient}. \end{definition} 
\begin{lemma} \label{lemma-additivity-periodic-length} Let $R$ be a ring. Suppose that we have a short exact sequence of $2$-periodic complexes $$ 0 \to (M_1, N_1, \varphi_1, \psi_1) \to (M_2, N_2, \varphi_2, \psi_2) \to (M_3, N_3, \varphi_3, \psi_3) \to 0 $$ If two out of three have cohomology modules of finite length so does the third and we have $$ e_R(M_2, N_2, \varphi_2, \psi_2) = e_R(M_1, N_1, \varphi_1, \psi_1) + e_R(M_3, N_3, \varphi_3, \psi_3). $$ \end{lemma} 
\begin{lemma} \label{lemma-finite-periodic-length} Let $R$ be a ring. If $(M, N, \varphi, \psi)$ is a $2$-periodic complex such that $M$, $N$ have finite length, then $e_R(M, N, \varphi, \psi) = \text{length}_R(M) - \text{length}_R(N)$. In particular, if $(M, \varphi, \psi)$ is a $(2, 1)$-periodic complex such that $M$ has finite length, then $e_R(M, \varphi, \psi) = 0$. \end{lemma} 
\begin{lemma} \label{lemma-compare-periodic-lengths} Let $R$ be a ring. Let $f : (M, \varphi, \psi) \to (M', \varphi', \psi')$ be a map of $(2, 1)$-periodic complexes whose cohomology modules have finite length. If $\Ker(f)$ and $\Coker(f)$ have finite length, then $e_R(M, \varphi, \psi) = e_R(M', \varphi', \psi')$. \end{lemma} 
\begin{lemma} \label{lemma-length-multiplication} Let $R$ be a Noetherian local ring. Let $M$ be a finite $R$-module. Let $x \in R$. Assume that \begin{enumerate} \item $\dim(\text{Supp}(M)) \leq 1$, and \item $\dim(\text{Supp}(M/xM)) \leq 0$. \end{enumerate} Write $\text{Supp}(M) = \{\mathfrak m, \mathfrak q_1, \ldots, \mathfrak q_t\}$. Then $$ e_R(M, 0, x) = \sum\nolimits_{i = 1, \ldots, t} \text{ord}_{R/\mathfrak q_i}(x) \text{length}_{R_{\mathfrak q_i}}(M_{\mathfrak q_i}). $$ \end{lemma} 
\begin{lemma} \label{lemma-additivity-divisors-restricted} Let $R$ be a Noetherian local ring. Let $x \in R$. If $M$ is a finite Cohen-Macaulay module over $R$ with $\dim(\text{Supp}(M)) = 1$ and $\dim(\text{Supp}(M/xM)) = 0$, then $$ \text{length}_R(M/xM) = \sum\nolimits_i \text{length}_R(R/(x, \mathfrak q_i)) \text{length}_{R_{\mathfrak q_i}}(M_{\mathfrak q_i}). $$ where $\mathfrak q_1, \ldots, \mathfrak q_t$ are the minimal primes of the support of $M$. If $I \subset R$ is an ideal such that $x$ is a nonzerodivisor on $R/I$ and $\dim(R/I) = 1$, then $$ \text{length}_R(R/(x, I)) = \sum\nolimits_i \text{length}_R(R/(x, \mathfrak q_i)) \text{length}_{R_{\mathfrak q_i}}((R/I)_{\mathfrak q_i}) $$ where $\mathfrak q_1, \ldots, \mathfrak q_n$ are the minimal primes over $I$. \end{lemma} 
\begin{lemma} \label{lemma-powers-period-length-zero} Let $R$ be a ring. Let $M$ be an $R$-module. Let $\varphi : M \to M$ be an endomorphism and $n > 0$ such that $\varphi^n = 0$ and such that $\Ker(\varphi)/\Im(\varphi^{n - 1})$ has finite length as an $R$-module. Then $$ e_R(M, \varphi^i, \varphi^{n - i}) = 0 $$ for $i = 0, \ldots, n$. \end{lemma} 
\begin{lemma} \label{lemma-multiply-period-length} Let $(R, \mathfrak m)$ be a Noetherian local ring. Let $(M, \varphi, \psi)$ be a $(2, 1)$-periodic complex over $R$ with $M$ finite and with cohomology groups of finite length over $R$. Let $x \in R$ be such that $\dim(\text{Supp}(M/xM)) \leq 0$. Then $$ e_R(M, x\varphi, \psi) = e_R(M, \varphi, \psi) - e_R(\Im(\varphi), 0, x) $$ and $$ e_R(M, \varphi, x\psi) = e_R(M, \varphi, \psi) + e_R(\Im(\psi), 0, x) $$ \end{lemma} 
\begin{lemma} \label{lemma-glue-at-max} Let $A$ be a Noetherian ring. Let $\mathfrak m_1, \ldots, \mathfrak m_r$ be pairwise distinct maximal ideals of $A$. For $i = 1, \ldots, r$ let $\varphi_i : A_{\mathfrak m_i} \to B_i$ be a ring map whose kernel and cokernel are annihilated by a power of $\mathfrak m_i$. Then there exists a ring map $\varphi : A \to B$ such that \begin{enumerate} \item the localization of $\varphi$ at $\mathfrak m_i$ is isomorphic to $\varphi_i$, and \item $\Ker(\varphi)$ and $\Coker(\varphi)$ are annihilated by a power of $\mathfrak m_1 \cap \ldots \cap \mathfrak m_r$. \end{enumerate} Moreover, if each $\varphi_i$ is finite, injective, or surjective then so is $\varphi$. \end{lemma} 
\begin{lemma} \label{lemma-Noetherian-domain-dim-1-two-elements} Let $(R, \mathfrak m)$ be a Noetherian local ring of dimension $1$. Let $a, b \in R$ be nonzerodivisors. There exists a finite ring extension $R \subset R'$ with $R'/R$ annihilated by a power of $\mathfrak m$ and nonzerodivisors $t, a', b' \in R'$ such that $a = ta'$ and $b = tb'$ and $R' = a'R' + b'R'$. \end{lemma} 
\begin{lemma} \label{lemma-not-infinitely-divisible} Let $(R, \mathfrak m)$ be a Noetherian local ring of dimension $1$. Let $a, b \in R$ be nonzerodivisors with $a \in \mathfrak m$. There exists an integer $n = n(R, a, b)$ such that for a finite ring extension $R \subset R'$ if $b = a^m c$ for some $c \in R'$, then $m \leq n$. \end{lemma} 
\begin{lemma} \label{lemma-prepare-tame-symbol} Let $(A, \mathfrak m)$ be a Noetherian local ring of dimension $1$. Let $r \geq 2$ and let $a_1, \ldots, a_r \in A$ be nonzerodivisors not all units. Then there exist \begin{enumerate} \item a finite ring extension $A \subset B$ with $B/A$ annihilated by a power of $\mathfrak m$, \item for each maximal ideal $\mathfrak m_j \subset B$ a nonzerodivisor $\pi_j \in B_j = B_{\mathfrak m_j}$, and \item factorizations $a_i = u_{i, j} \pi_j^{e_{i, j}}$ in $B_j$ with $u_{i, j} \in B_j$ units and $e_{i, j} \geq 0$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-well-defined-tame-symbol} The formula (\ref{equation-tame-symbol}) determines a well defined element of $\kappa(\mathfrak m)^*$. In other words, the right hand side does not depend on the choice of the local factorizations or the choice of $B$. \end{lemma} 
\begin{lemma} \label{lemma-tame-symbol} The tame symbol (\ref{equation-tame-symbol}) satisfies (\ref{item-bilinear-better}), (\ref{item-skew-better}), (\ref{item-normalization}), (\ref{item-1-x-better}) and hence gives a map $\partial_A : Q(A)^* \times Q(A)^* \to \kappa(\mathfrak m)^*$ satisfying (\ref{item-bilinear}), (\ref{item-skew}), (\ref{item-1-x}). \end{lemma} 
\begin{lemma} \label{lemma-norm-down-tame-symbol} Let $(A, \mathfrak m)$ be a Noetherian local ring of dimension $1$. Let $A \subset B$ be a finite ring extension with $B/A$ annihilated by a power of $\mathfrak m$ and $\mathfrak m$ not an associated prime of $B$. For $a, b \in A$ nonzerodivisors we have $$ \partial_A(a, b) = \prod \text{Norm}_{\kappa(\mathfrak m_j)/\kappa(\mathfrak m)}(\partial_{B_j}(a, b)) $$ where the product is over the maximal ideals $\mathfrak m_j$ of $B$ and $B_j = B_{\mathfrak m_j}$. \end{lemma} 
\begin{lemma} \label{lemma-tame-symbol-formally-smooth} Let $(A, \mathfrak m, \kappa) \to (A', \mathfrak m', \kappa')$ be a local homomorphism of Noetherian local rings. Assume $A \to A'$ is flat and $\dim(A) = \dim(A') = 1$. Set $m = \text{length}_{A'}(A'/\mathfrak mA')$. For $a_1, a_2 \in A$ nonzerodivisors $\partial_A(a_1, a_2)^m$ maps to $\partial_{A'}(a_1, a_2)$ via $\kappa \to \kappa'$. \end{lemma} 
\begin{lemma} \label{lemma-perpare-key} Let $(A, \mathfrak m)$ be a $2$-dimensional Noetherian local ring. Let $t \in \mathfrak m$ be a nonzerodivisor. Say $V(t) = \{\mathfrak m, \mathfrak q_1, \ldots, \mathfrak q_r\}$. Let $A_{\mathfrak q_i} \subset B_i$ be a finite ring extension with $B_i/A_{\mathfrak q_i}$ annihilated by a power of $t$. Then there exists a finite extension $A \subset B$ of local rings identifying residue fields with $B_i \cong B_{\mathfrak q_i}$ and $B/A$ annihilated by a power of $t$. \end{lemma} 
\begin{lemma} \label{lemma-key-nonzerodivisors} Let $(A, \mathfrak m)$ be a $2$-dimensional Noetherian local ring. Let $a, b \in A$ be nonzerodivisors. Then we have $$ \sum \text{ord}_{A/\mathfrak q}(\partial_{A_{\mathfrak q}}(a, b)) = 0 $$ where the sum is over the height $1$ primes $\mathfrak q$ of $A$. \end{lemma} 
\begin{lemma}[Key Lemma] \label{lemma-milnor-gersten-low-degree} \begin{reference} When $A$ is an excellent ring this is \cite[Proposition 1]{Kato-Milnor-K}. \end{reference} Let $A$ be a $2$-dimensional Noetherian local domain with fraction field $K$. Let $f, g \in K^*$. Let $\mathfrak q_1, \ldots, \mathfrak q_t$ be the height $1$ primes $\mathfrak q$ of $A$ such that either $f$ or $g$ is not an element of $A^*_{\mathfrak q}$. Then we have $$ \sum\nolimits_{i = 1, \ldots, t} \text{ord}_{A/\mathfrak q_i}(\partial_{A_{\mathfrak q_i}}(f, g)) = 0 $$ We can also write this as $$ \sum\nolimits_{\text{height}(\mathfrak q) = 1} \text{ord}_{A/\mathfrak q}(\partial_{A_{\mathfrak q}}(f, g)) = 0 $$ since at any height $1$ prime $\mathfrak q$ of $A$ where $f, g \in A^*_{\mathfrak q}$ we have $\partial_{A_{\mathfrak q}}(f, g) = 1$. \end{lemma} 
\begin{lemma} \label{lemma-delta-is-dimension} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Assume in addition $S$ is a Jacobson scheme, and $\delta(s) = 0$ for every closed point $s$ of $S$. Let $X$ be locally of finite type over $S$. Let $Z \subset X$ be an integral closed subscheme and let $\xi \in Z$ be its generic point. The following integers are the same: \begin{enumerate} \item $\delta_{X/S}(\xi)$, \item $\dim(Z)$, and \item $\dim(\mathcal{O}_{Z, z})$ where $z$ is a closed point of $Z$. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-delta-dimension} Let $(S, \delta)$ as in Situation \ref{situation-setup}. For any scheme $X$ locally of finite type over $S$ and any irreducible closed subset $Z \subset X$ we define $$ \dim_\delta(Z) = \delta(\xi) $$ where $\xi \in Z$ is the generic point of $Z$. We will call this the {\it $\delta$-dimension of $Z$}. If $Z$ is a closed subscheme of $X$, then we define $\dim_\delta(Z)$ as the supremum of the $\delta$-dimensions of its irreducible components. \end{definition} 
\begin{definition} \label{definition-cycles} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $k \in \mathbf{Z}$. \begin{enumerate} \item A {\it cycle on $X$} is a formal sum $$ \alpha = \sum n_Z [Z] $$ where the sum is over integral closed subschemes $Z \subset X$, each $n_Z \in \mathbf{Z}$, and the collection $\{Z; n_Z \not = 0\}$ is locally finite (Topology, Definition \ref{topology-definition-locally-finite}). \item A {\it $k$-cycle} on $X$ is a cycle $$ \alpha = \sum n_Z [Z] $$ where $n_Z \not = 0 \Rightarrow \dim_\delta(Z) = k$. \item The abelian group of all $k$-cycles on $X$ is denoted $Z_k(X)$. \end{enumerate} \end{definition} 
\begin{definition} \label{definition-support-cycle} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. The {\it support} of a cycle $\alpha = \sum n_Z [Z]$ on $X$ is $$ \text{Supp}(\alpha) = \bigcup\nolimits_{n_Z \not = 0} Z \subset X $$ \end{definition} 
\begin{definition} \label{definition-effective-cycle} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. A cycle $\alpha$ on $X$ is {\it effective} if it can be written as $\alpha =\sum n_Z [Z]$ with $n_Z \geq 0$ for all $Z$. \end{definition} 
\begin{lemma} \label{lemma-multiplicity-finite} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $Z \subset X$ be a closed subscheme. \begin{enumerate} \item Let $Z' \subset Z$ be an irreducible component and let $\xi \in Z'$ be its generic point. Then $$ \text{length}_{\mathcal{O}_{X, \xi}} \mathcal{O}_{Z, \xi} < \infty $$ \item If $\dim_\delta(Z) \leq k$ and $\xi \in Z$ with $\delta(\xi) = k$, then $\xi$ is a generic point of an irreducible component of $Z$. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-cycle-associated-to-closed-subscheme} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $Z \subset X$ be a closed subscheme. \begin{enumerate} \item For any irreducible component $Z' \subset Z$ with generic point $\xi$ the integer $m_{Z', Z} = \text{length}_{\mathcal{O}_{X, \xi}} \mathcal{O}_{Z, \xi}$ (Lemma \ref{lemma-multiplicity-finite}) is called the {\it multiplicity of $Z'$ in $Z$}. \item Assume $\dim_\delta(Z) \leq k$. The {\it $k$-cycle associated to $Z$} is $$ [Z]_k = \sum m_{Z', Z}[Z'] $$ where the sum is over the irreducible components of $Z$ of $\delta$-dimension $k$. (This is a $k$-cycle by Divisors, Lemma \ref{divisors-lemma-components-locally-finite}.) \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-length-finite} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module. \begin{enumerate} \item The collection of irreducible components of the support of $\mathcal{F}$ is locally finite. \item Let $Z' \subset \text{Supp}(\mathcal{F})$ be an irreducible component and let $\xi \in Z'$ be its generic point. Then $$ \text{length}_{\mathcal{O}_{X, \xi}} \mathcal{F}_\xi < \infty $$ \item If $\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$ and $\xi \in \text{Supp}(\mathcal{F})$ with $\delta(\xi) = k$, then $\xi$ is a generic point of an irreducible component of $\text{Supp}(\mathcal{F})$. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-cycle-associated-to-coherent-sheaf} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module. \begin{enumerate} \item For any irreducible component $Z' \subset \text{Supp}(\mathcal{F})$ with generic point $\xi$ the integer $m_{Z', \mathcal{F}} = \text{length}_{\mathcal{O}_{X, \xi}} \mathcal{F}_\xi$ (Lemma \ref{lemma-length-finite}) is called the {\it multiplicity of $Z'$ in $\mathcal{F}$}. \item Assume $\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$. The {\it $k$-cycle associated to $\mathcal{F}$} is $$ [\mathcal{F}]_k = \sum m_{Z', \mathcal{F}}[Z'] $$ where the sum is over the irreducible components of $\text{Supp}(\mathcal{F})$ of $\delta$-dimension $k$. (This is a $k$-cycle by Lemma \ref{lemma-length-finite}.) \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-cycle-closed-coherent} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $Z \subset X$ be a closed subscheme. If $\dim_\delta(Z) \leq k$, then $[Z]_k = [{\mathcal O}_Z]_k$. \end{lemma} 
\begin{lemma} \label{lemma-additivity-sheaf-cycle} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $0 \to \mathcal{F} \to \mathcal{G} \to \mathcal{H} \to 0$ be a short exact sequence of coherent sheaves on $X$. Assume that the $\delta$-dimension of the supports of $\mathcal{F}$, $\mathcal{G}$, and $\mathcal{H}$ is $\leq k$. Then $[\mathcal{G}]_k = [\mathcal{F}]_k + [\mathcal{H}]_k$. \end{lemma} 
\begin{lemma} \label{lemma-equal-dimension} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$ be locally of finite type over $S$. Let $f : X \to Y$ be a morphism. Assume $X$, $Y$ integral and $\dim_\delta(X) = \dim_\delta(Y)$. Then either $f(X)$ is contained in a proper closed subscheme of $Y$, or $f$ is dominant and the extension of function fields $R(X)/R(Y)$ is finite. \end{lemma} 
\begin{lemma} \label{lemma-quasi-compact-locally-finite} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$ be locally of finite type over $S$. Let $f : X \to Y$ be a morphism. Assume $f$ is quasi-compact, and $\{Z_i\}_{i \in I}$ is a locally finite collection of closed subsets of $X$. Then $\{\overline{f(Z_i)}\}_{i \in I}$ is a locally finite collection of closed subsets of $Y$. \end{lemma} 
\begin{definition} \label{definition-proper-pushforward} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$ be locally of finite type over $S$. Let $f : X \to Y$ be a morphism. Assume $f$ is proper. \begin{enumerate} \item Let $Z \subset X$ be an integral closed subscheme with $\dim_\delta(Z) = k$. We define $$ f_*[Z] = \left\{ \begin{matrix} 0 & \text{if} & \dim_\delta(f(Z))< k, \\ \deg(Z/f(Z)) [f(Z)] & \text{if} & \dim_\delta(f(Z)) = k. \end{matrix} \right. $$ Here we think of $f(Z) \subset Y$ as an integral closed subscheme. The degree of $Z$ over $f(Z)$ is finite if $\dim_\delta(f(Z)) = \dim_\delta(Z)$ by Lemma \ref{lemma-equal-dimension}. \item Let $\alpha = \sum n_Z [Z]$ be a $k$-cycle on $X$. The {\it pushforward} of $\alpha$ as the sum $$ f_* \alpha = \sum n_Z f_*[Z] $$ where each $f_*[Z]$ is defined as above. The sum is locally finite by Lemma \ref{lemma-quasi-compact-locally-finite} above. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-compose-pushforward} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$, and $Z$ be locally of finite type over $S$. Let $f : X \to Y$ and $g : Y \to Z$ be proper morphisms. Then $g_* \circ f_* = (g \circ f)_*$ as maps $Z_k(X) \to Z_k(Z)$. \end{lemma} 
\begin{lemma} \label{lemma-exact-sequence-closed} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $X_1, X_2 \subset X$ be closed subschemes such that $X = X_1 \cup X_2$ set theoretically. For every $k \in \mathbf{Z}$ the sequence of abelian groups $$ \xymatrix{ Z_k(X_1 \cap X_2) \ar[r] & Z_k(X_1) \oplus Z_k(X_2) \ar[r] & Z_k(X) \ar[r] & 0 } $$ is exact. Here $X_1 \cap X_2$ is the scheme theoretic intersection and the maps are the pushforward maps with one multiplied by $-1$. \end{lemma} 
\begin{lemma} \label{lemma-cycle-push-sheaf} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $f : X \to Y$ be a proper morphism of schemes which are locally of finite type over $S$. \begin{enumerate} \item Let $Z \subset X$ be a closed subscheme with $\dim_\delta(Z) \leq k$. Then $$ f_*[Z]_k = [f_*{\mathcal O}_Z]_k. $$ \item Let $\mathcal{F}$ be a coherent sheaf on $X$ such that $\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$. Then $$ f_*[\mathcal{F}]_k = [f_*{\mathcal F}]_k. $$ \end{enumerate} Note that the statement makes sense since $f_*\mathcal{F}$ and $f_*\mathcal{O}_Z$ are coherent $\mathcal{O}_Y$-modules by Cohomology of Schemes, Proposition \ref{coherent-proposition-proper-pushforward-coherent}. \end{lemma} 
\begin{lemma} \label{lemma-flat-inverse-image-dimension} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$ be locally of finite type over $S$. Let $f : X \to Y$ be a morphism. Assume $f$ is flat of relative dimension $r$. For any closed subset $Z \subset Y$ we have $$ \dim_\delta(f^{-1}(Z)) = \dim_\delta(Z) + r. $$ provided $f^{-1}(Z)$ is nonempty. If $Z$ is irreducible and $Z' \subset f^{-1}(Z)$ is an irreducible component, then $Z'$ dominates $Z$ and $\dim_\delta(Z') = \dim_\delta(Z) + r$. \end{lemma} 
\begin{lemma} \label{lemma-inverse-image-locally-finite} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$ be locally of finite type over $S$. Let $f : X \to Y$ be a morphism. Assume $\{Z_i\}_{i \in I}$ is a locally finite collection of closed subsets of $Y$. Then $\{f^{-1}(Z_i)\}_{i \in I}$ is a locally finite collection of closed subsets of $X$. \end{lemma} 
\begin{definition} \label{definition-flat-pullback} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$ be locally of finite type over $S$. Let $f : X \to Y$ be a morphism. Assume $f$ is flat of relative dimension $r$. \begin{enumerate} \item Let $Z \subset Y$ be an integral closed subscheme of $\delta$-dimension $k$. We define $f^*[Z]$ to be the $(k+r)$-cycle on $X$ to the scheme theoretic inverse image $$ f^*[Z] = [f^{-1}(Z)]_{k+r}. $$ This makes sense since $\dim_\delta(f^{-1}(Z)) = k + r$ by Lemma \ref{lemma-flat-inverse-image-dimension}. \item Let $\alpha = \sum n_i [Z_i]$ be a $k$-cycle on $Y$. The {\it flat pullback of $\alpha$ by $f$} is the sum $$ f^* \alpha = \sum n_i f^*[Z_i] $$ where each $f^*[Z_i]$ is defined as above. The sum is locally finite by Lemma \ref{lemma-inverse-image-locally-finite}. \item We denote $f^* : Z_k(Y) \to Z_{k + r}(X)$ the map of abelian groups so obtained. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-exact-sequence-open} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $U \subset X$ be an open subscheme, and denote $i : Y = X \setminus U \to X$ as a reduced closed subscheme of $X$. For every $k \in \mathbf{Z}$ the sequence $$ \xymatrix{ Z_k(Y) \ar[r]^{i_*} & Z_k(X) \ar[r]^{j^*} & Z_k(U) \ar[r] & 0 } $$ is an exact complex of abelian groups. \end{lemma} 
\begin{lemma} \label{lemma-compose-flat-pullback} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X, Y, Z$ be locally of finite type over $S$. Let $f : X \to Y$ and $g : Y \to Z$ be flat morphisms of relative dimensions $r$ and $s$. Then $g \circ f$ is flat of relative dimension $r + s$ and $$ f^* \circ g^* = (g \circ f)^* $$ as maps $Z_k(Z) \to Z_{k + r + s}(X)$. \end{lemma} 
\begin{lemma} \label{lemma-pullback-coherent} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X, Y$ be locally of finite type over $S$. Let $f : X \to Y$ be a flat morphism of relative dimension $r$. \begin{enumerate} \item Let $Z \subset Y$ be a closed subscheme with $\dim_\delta(Z) \leq k$. Then we have $\dim_\delta(f^{-1}(Z)) \leq k + r$ and $[f^{-1}(Z)]_{k + r} = f^*[Z]_k$ in $Z_{k + r}(X)$. \item Let $\mathcal{F}$ be a coherent sheaf on $Y$ with $\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$. Then we have $\dim_\delta(\text{Supp}(f^*\mathcal{F})) \leq k + r$ and $$ f^*[{\mathcal F}]_k = [f^*{\mathcal F}]_{k+r} $$ in $Z_{k + r}(X)$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-flat-pullback-proper-pushforward} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $$ \xymatrix{ X' \ar[r]_{g'} \ar[d]_{f'} & X \ar[d]^f \\ Y' \ar[r]^g & Y } $$ be a fibre product diagram of schemes locally of finite type over $S$. Assume $f : X \to Y$ proper and $g : Y' \to Y$ flat of relative dimension $r$. Then also $f'$ is proper and $g'$ is flat of relative dimension $r$. For any $k$-cycle $\alpha$ on $X$ we have $$ g^*f_*\alpha = f'_*(g')^*\alpha $$ in $Z_{k + r}(Y')$. \end{lemma} 
\begin{lemma} \label{lemma-finite-flat} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$ be locally of finite type over $S$. Let $f : X \to Y$ be a finite locally free morphism of degree $d$ (see Morphisms, Definition \ref{morphisms-definition-finite-locally-free}). Then $f$ is both proper and flat of relative dimension $0$, and $$ f_*f^*\alpha = d\alpha $$ for every $\alpha \in Z_k(Y)$. \end{lemma} 
\begin{lemma} \label{lemma-divisor-delta-dimension} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Assume $X$ is integral. \begin{enumerate} \item If $Z \subset X$ is an integral closed subscheme, then the following are equivalent: \begin{enumerate} \item $Z$ is a prime divisor, \item $Z$ has codimension $1$ in $X$, and \item $\dim_\delta(Z) = \dim_\delta(X) - 1$. \end{enumerate} \item If $Z$ is an irreducible component of an effective Cartier divisor on $X$, then $\dim_\delta(Z) = \dim_\delta(X) - 1$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-finite-in-codimension-one} Let $f : X \to Y$ be a morphism of schemes. Let $\xi \in Y$ be a point. Assume that \begin{enumerate} \item $X$, $Y$ are integral, \item $Y$ is locally Noetherian \item $f$ is proper, dominant and $R(Y) \subset R(X)$ is finite, and \item $\dim(\mathcal{O}_{Y, \xi}) = 1$. \end{enumerate} Then there exists an open neighbourhood $V \subset Y$ of $\xi$ such that $f|_{f^{-1}(V)} : f^{-1}(V) \to V$ is finite. \end{lemma} 
\begin{definition} \label{definition-principal-divisor} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Assume $X$ is integral with $\dim_\delta(X) = n$. Let $f \in R(X)^*$. The {\it principal divisor associated to $f$} is the $(n - 1)$-cycle $$ \text{div}(f) = \text{div}_X(f) = \sum \text{ord}_Z(f) [Z] $$ defined in Divisors, Definition \ref{divisors-definition-principal-divisor}. This makes sense because prime divisors have $\delta$-dimension $n - 1$ by Lemma \ref{lemma-divisor-delta-dimension}. \end{definition} 
\begin{lemma} \label{lemma-flat-pullback-principal-divisor} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$ be locally of finite type over $S$. Assume $X$, $Y$ are integral and $n = \dim_\delta(Y)$. Let $f : X \to Y$ be a flat morphism of relative dimension $r$. Let $g \in R(Y)^*$. Then $$ f^*(\text{div}_Y(g)) = \text{div}_X(g) $$ in $Z_{n + r - 1}(X)$. \end{lemma} 
\begin{lemma} \label{lemma-proper-pushforward-alteration} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$ be locally of finite type over $S$. Assume $X$, $Y$ are integral and $n = \dim_\delta(X) = \dim_\delta(Y)$. Let $p : X \to Y$ be a dominant proper morphism. Let $f \in R(X)^*$. Set $$ g = \text{Nm}_{R(X)/R(Y)}(f). $$ Then we have $p_*\text{div}(f) = \text{div}(g)$. \end{lemma} 
\begin{lemma} \label{lemma-rational-function} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Assume $X$ is integral and $n = \dim_\delta(X)$. Let $f \in R(X)^*$. Let $U \subset X$ be a nonempty open such that $f$ corresponds to a section $f \in \Gamma(U, \mathcal{O}_X^*)$. Let $Y \subset X \times_S \mathbf{P}^1_S$ be the closure of the graph of $f : U \to \mathbf{P}^1_S$. Then \begin{enumerate} \item the projection morphism $p : Y \to X$ is proper, \item $p|_{p^{-1}(U)} : p^{-1}(U) \to U$ is an isomorphism, \item the pullbacks $Y_0 = q^{-1}D_0$ and $Y_\infty = q^{-1}D_\infty$ via the morphism $q : Y \to \mathbf{P}^1_S$ are defined (Divisors, Definition \ref{divisors-definition-pullback-effective-Cartier-divisor}), \item we have $$ \text{div}_Y(f) = [Y_0]_{n - 1} - [Y_\infty]_{n - 1} $$ \item we have $$ \text{div}_X(f) = p_*\text{div}_Y(f) $$ \item if we view $Y_0$ and $Y_\infty$ as closed subschemes of $X$ via the morphism $p$ then we have $$ \text{div}_X(f) = [Y_0]_{n - 1} - [Y_\infty]_{n - 1} $$ \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-curve-principal-divisor} Let $K$ be any field. Let $X$ be a $1$-dimensional integral scheme endowed with a proper morphism $c : X \to \Spec(K)$. Let $f \in K(X)^*$ be an invertible rational function. Then $$ \sum\nolimits_{x \in X \text{ closed}} [\kappa(x) : K] \text{ord}_{\mathcal{O}_{X, x}}(f) = 0 $$ where $\text{ord}$ is as in Algebra, Definition \ref{algebra-definition-ord}. In other words, $c_*\text{div}(f) = 0$. \end{lemma} 
\begin{definition} \label{definition-rational-equivalence} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be a scheme locally of finite type over $S$. Let $k \in \mathbf{Z}$. \begin{enumerate} \item Given any locally finite collection $\{W_j \subset X\}$ of integral closed subschemes with $\dim_\delta(W_j) = k + 1$, and any $f_j \in R(W_j)^*$ we may consider $$ \sum (i_j)_*\text{div}(f_j) \in Z_k(X) $$ where $i_j : W_j \to X$ is the inclusion morphism. This makes sense as the morphism $\coprod i_j : \coprod W_j \to X$ is proper. \item We say that $\alpha \in Z_k(X)$ is {\it rationally equivalent to zero} if $\alpha$ is a cycle of the form displayed above. \item We say $\alpha, \beta \in Z_k(X)$ are {\it rationally equivalent} and we write $\alpha \sim_{rat} \beta$ if $\alpha - \beta$ is rationally equivalent to zero. \item We define $$ \CH_k(X) = Z_k(X) / \sim_{rat} $$ to be the {\it Chow group of $k$-cycles on $X$}. This is sometimes called the {\it Chow group of $k$-cycles modulo rational equivalence on $X$}. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-restrict-to-open} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be a scheme locally of finite type over $S$. Let $U \subset X$ be an open subscheme, and denote $i : Y = X \setminus U \to X$ as a reduced closed subscheme of $X$. Let $k \in \mathbf{Z}$. Suppose $\alpha, \beta \in Z_k(X)$. If $\alpha|_U \sim_{rat} \beta|_U$ then there exist a cycle $\gamma \in Z_k(Y)$ such that $$ \alpha \sim_{rat} \beta + i_*\gamma. $$ In other words, the sequence $$ \xymatrix{ \CH_k(Y) \ar[r]^{i_*} & \CH_k(X) \ar[r]^{j^*} & \CH_k(U) \ar[r] & 0 } $$ is an exact complex of abelian groups. \end{lemma} 
\begin{lemma} \label{lemma-exact-sequence-closed-chow} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $X_1, X_2 \subset X$ be closed subschemes such that $X = X_1 \cup X_2$ set theoretically. For every $k \in \mathbf{Z}$ the sequence of abelian groups $$ \xymatrix{ \CH_k(X_1 \cap X_2) \ar[r] & \CH_k(X_1) \oplus \CH_k(X_2) \ar[r] & \CH_k(X) \ar[r] & 0 } $$ is exact. Here $X_1 \cap X_2$ is the scheme theoretic intersection and the maps are the pushforward maps with one multiplied by $-1$. \end{lemma} 
\begin{lemma} \label{lemma-prepare-flat-pullback-rational-equivalence} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$ be schemes locally of finite type over $S$. Assume $Y$ integral with $\dim_\delta(Y) = k$. Let $f : X \to Y$ be a flat morphism of relative dimension $r$. Then for $g \in R(Y)^*$ we have $$ f^*\text{div}_Y(g) = \sum n_j i_{j, *}\text{div}_{X_j}(g \circ f|_{X_j}) $$ as $(k + r - 1)$-cycles on $X$ where the sum is over the irreducible components $X_j$ of $X$ and $n_j$ is the multiplicity of $X_j$ in $X$. \end{lemma} 
\begin{lemma} \label{lemma-flat-pullback-rational-equivalence} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$ be schemes locally of finite type over $S$. Let $f : X \to Y$ be a flat morphism of relative dimension $r$. Let $\alpha \sim_{rat} \beta$ be rationally equivalent $k$-cycles on $Y$. Then $f^*\alpha \sim_{rat} f^*\beta$ as $(k + r)$-cycles on $X$. \end{lemma} 
\begin{lemma} \label{lemma-proper-pushforward-rational-equivalence} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$ be schemes locally of finite type over $S$. Let $p : X \to Y$ be a proper morphism. Suppose $\alpha, \beta \in Z_k(X)$ are rationally equivalent. Then $p_*\alpha$ is rationally equivalent to $p_*\beta$. \end{lemma} 
\begin{lemma} \label{lemma-rational-equivalence-family} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be a scheme locally of finite type over $S$. Let $W \subset X \times_S \mathbf{P}^1_S$ be an integral closed subscheme of $\delta$-dimension $k + 1$. Assume $W \not = W_0$, and $W \not = W_\infty$. Then \begin{enumerate} \item $W_0$, $W_\infty$ are effective Cartier divisors of $W$, \item $W_0$, $W_\infty$ can be viewed as closed subschemes of $X$ and $$ [W_0]_k \sim_{rat} [W_\infty]_k, $$ \item for any locally finite family of integral closed subschemes $W_i \subset X \times_S \mathbf{P}^1_S$ of $\delta$-dimension $k + 1$ with $W_i \not = (W_i)_0$ and $W_i \not = (W_i)_\infty$ we have $\sum ([(W_i)_0]_k - [(W_i)_\infty]_k) \sim_{rat} 0$ on $X$, and \item for any $\alpha \in Z_k(X)$ with $\alpha \sim_{rat} 0$ there exists a locally finite family of integral closed subschemes $W_i \subset X \times_S \mathbf{P}^1_S$ as above such that $\alpha = \sum ([(W_i)_0]_k - [(W_i)_\infty]_k)$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-closed-subscheme-cross-p1} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be a scheme locally of finite type over $S$. Let $Z$ be a closed subscheme of $X \times \mathbf{P}^1$. Assume \begin{enumerate} \item $\dim_\delta(Z) \leq k + 1$, \item $\dim_\delta(Z_0) \leq k$, $\dim_\delta(Z_\infty) \leq k$, and \item for any embedded point $\xi$ (Divisors, Definition \ref{divisors-definition-embedded}) of $Z$ either $\xi \not \in Z_0 \cup Z_\infty$ or $\delta(\xi) < k$. \end{enumerate} Then $[Z_0]_k \sim_{rat} [Z_\infty]_k$ as $k$-cycles on $X$. \end{lemma} 
\begin{lemma} \label{lemma-coherent-sheaf-cross-p1} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be a scheme locally of finite type over $S$. Let $\mathcal{F}$ be a coherent sheaf on $X \times \mathbf{P}^1$. Let $i_0, i_\infty : X \to X \times \mathbf{P}^1$ be the closed immersion such that $i_t(x) = (x, t)$. Denote $\mathcal{F}_0 = i_0^*\mathcal{F}$ and $\mathcal{F}_\infty = i_\infty^*\mathcal{F}$. Assume \begin{enumerate} \item $\dim_\delta(\text{Supp}(\mathcal{F})) \leq k + 1$, \item $\dim_\delta(\text{Supp}(\mathcal{F}_0)) \leq k$, $\dim_\delta(\text{Supp}(\mathcal{F}_\infty)) \leq k$, and \item for any embedded associated point $\xi$ of $\mathcal{F}$ either $\xi \not \in (X \times \mathbf{P}^1)_0 \cup (X \times \mathbf{P}^1)_\infty$ or $\delta(\xi) < k$. \end{enumerate} Then $[\mathcal{F}_0]_k \sim_{rat} [\mathcal{F}_\infty]_k$ as $k$-cycles on $X$. \end{lemma} 
\begin{definition} \label{definition-envelope} \begin{reference} \cite[Definition 18.3]{F} \end{reference} Let $X$ be a scheme. An {\it envelope} is a proper morphism $f : Y \to X$ which is completely decomposed (More on Morphisms, Definition \ref{more-morphisms-definition-cd-morphism}). \end{definition} 
\begin{lemma} \label{lemma-composition-envelope} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be a scheme locally of finite type over $S$. If $f : Y \to X$ and $g : Z \to Y$ are envelopes, then $f \circ g$ is an envelope. \end{lemma} 
\begin{lemma} \label{lemma-base-change-envelope} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X' \to X$ be a morphism of schemes locally of finite type over $S$. If $f : Y \to X$ is an envelope, then the base change $f' : Y' \to X'$ of $f$ is an envelope too. \end{lemma} 
\begin{lemma} \label{lemma-envelope} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be a scheme locally of finite type over $S$. Let $f : Y \to X$ be an envelope. Then we have an exact sequence $$ \CH_k(Y \times_X Y) \xrightarrow{p_* - q_*} \CH_k(Y) \xrightarrow{f_*} \CH_k(X) \to 0 $$ for all $k \in \mathbf{Z}$. Here $p, q : Y \times_X Y \to Y$ are the projections. \end{lemma} 
\begin{lemma} \label{lemma-Serre-subcategories} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be a scheme locally of finite type over $S$. The categories $\textit{Coh}_{\leq k}(X)$ are Serre subcategories of the abelian category $\textit{Coh}(X)$. \end{lemma} 
\begin{lemma} \label{lemma-cycles-k-group} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be a scheme locally of finite type over $S$. The maps $$ Z_k(X) \longrightarrow K_0(\textit{Coh}_{\leq k}(X)/\textit{Coh}_{\leq k - 1}(X)), \quad \sum n_Z[Z] \mapsto \left[\bigoplus\nolimits_{n_Z > 0} \mathcal{O}_Z^{\oplus n_Z}\right] - \left[\bigoplus\nolimits_{n_Z < 0} \mathcal{O}_Z^{\oplus -n_Z}\right] $$ and $$ K_0(\textit{Coh}_{\leq k}(X)/\textit{Coh}_{\leq k - 1}(X)) \longrightarrow Z_k(X),\quad \mathcal{F} \longmapsto [\mathcal{F}]_k $$ are mutually inverse isomorphisms. \end{lemma} 
\begin{lemma} \label{lemma-finite-cycles-k-group} Let $\pi : X \to Y$ be a finite morphism of schemes locally of finite type over $(S, \delta)$ as in Situation \ref{situation-setup}. Then $\pi_* : \textit{Coh}(X) \to \textit{Coh}(Y)$ is an exact functor which sends $\textit{Coh}_{\leq k}(X)$ into $\textit{Coh}_{\leq k}(Y)$ and induces homomorphisms on $K_0$ of these categories and their quotients. The maps of Lemma \ref{lemma-cycles-k-group} fit into a commutative diagram $$ \xymatrix{ Z_k(X) \ar[d]^{\pi_*} \ar[r] & K_0(\textit{Coh}_{\leq k}(X)/\textit{Coh}_{\leq k - 1}(X)) \ar[d]^{\pi_*} \ar[r] & Z_k(X) \ar[d]^{\pi_*} \\ Z_k(Y) \ar[r] & K_0(\textit{Coh}_{\leq k}(Y)/\textit{Coh}_{\leq k - 1}(Y)) \ar[r] & Z_k(Y) } $$ \end{lemma} 
\begin{lemma} \label{lemma-from-chow-to-K} Let $X$ be a scheme locally of finite type over $(S, \delta)$ as in Situation \ref{situation-setup}. There is a canonical map $$ \CH_k(X) \longrightarrow K_0(\textit{Coh}_{\leq k + 1}(X)/\textit{Coh}_{\leq k - 1}(X)) $$ induced by the map $Z_k(X) \to K_0(\textit{Coh}_{\leq k}(X)/\textit{Coh}_{\leq k - 1}(X))$ from Lemma \ref{lemma-cycles-k-group}. \end{lemma} 
\begin{lemma} \label{lemma-K-coherent-supported-on-closed} Let $X$ be a locally Noetherian scheme. Let $Z \subset X$ be a closed subscheme. Denote $\textit{Coh}_Z(X) \subset \textit{Coh}(X)$ the Serre subcategory of coherent $\mathcal{O}_X$-modules whose set theoretic support is contained in $Z$. Then the exact inclusion functor $\textit{Coh}(Z) \to \textit{Coh}_Z(X)$ induces an isomorphism $$ K'_0(Z) = K_0(\textit{Coh}(Z)) \longrightarrow K_0(\textit{Coh}_Z(X)) $$ \end{lemma} 
\begin{definition} \label{definition-divisor-invertible-sheaf} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Assume $X$ is integral and $n = \dim_\delta(X)$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. \begin{enumerate} \item For any nonzero meromorphic section $s$ of $\mathcal{L}$ we define the {\it Weil divisor associated to $s$} is the $(n - 1)$-cycle $$ \text{div}_\mathcal{L}(s) = \sum \text{ord}_{Z, \mathcal{L}}(s) [Z] $$ defined in Divisors, Definition \ref{divisors-definition-divisor-invertible-sheaf}. This makes sense because Weil divisors have $\delta$-dimension $n - 1$ by Lemma \ref{lemma-divisor-delta-dimension}. \item We define {\it Weil divisor associated to $\mathcal{L}$} as $$ c_1(\mathcal{L}) \cap [X] = \text{class of }\text{div}_\mathcal{L}(s) \in \CH_{n - 1}(X) $$ where $s$ is any nonzero meromorphic section of $\mathcal{L}$ over $X$. This is well defined by Divisors, Lemma \ref{divisors-lemma-divisor-meromorphic-well-defined}. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-compute-c1} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Assume $X$ is integral and $n = \dim_\delta(X)$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Let $s \in \Gamma(X, \mathcal{L})$ be a nonzero global section. Then $$ \text{div}_\mathcal{L}(s) = [Z(s)]_{n - 1} $$ in $Z_{n - 1}(X)$ and $$ c_1(\mathcal{L}) \cap [X] = [Z(s)]_{n - 1} $$ in $\CH_{n - 1}(X)$. \end{lemma} 
\begin{lemma} \label{lemma-flat-pullback-divisor-invertible-sheaf} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$ be locally of finite type over $S$. Assume $X$, $Y$ are integral and $n = \dim_\delta(Y)$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_Y$-module. Let $f : X \to Y$ be a flat morphism of relative dimension $r$. Then $$ f^*(c_1(\mathcal{L}) \cap [Y]) = c_1(f^*\mathcal{L}) \cap [X] $$ in $\CH_{n + r - 1}(X)$. \end{lemma} 
\begin{definition} \label{definition-cap-c1} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. We define, for every integer $k$, an operation $$ c_1(\mathcal{L}) \cap - : Z_{k + 1}(X) \to \CH_k(X) $$ called {\it intersection with the first Chern class of $\mathcal{L}$}. \begin{enumerate} \item Given an integral closed subscheme $i : W \to X$ with $\dim_\delta(W) = k + 1$ we define $$ c_1(\mathcal{L}) \cap [W] = i_*(c_1({i^*\mathcal{L}}) \cap [W]) $$ where the right hand side is defined in Definition \ref{definition-divisor-invertible-sheaf}. \item For a general $(k + 1)$-cycle $\alpha = \sum n_i [W_i]$ we set $$ c_1(\mathcal{L}) \cap \alpha = \sum n_i c_1(\mathcal{L}) \cap [W_i] $$ \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-c1-cap-additive} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{L}$, $\mathcal{N}$ be an invertible sheaves on $X$. Then $$ c_1(\mathcal{L}) \cap \alpha  + c_1(\mathcal{N}) \cap \alpha = c_1(\mathcal{L} \otimes_{\mathcal{O}_X} \mathcal{N}) \cap \alpha $$ in $\CH_k(X)$ for every $\alpha \in Z_{k + 1}(X)$. Moreover, $c_1(\mathcal{O}_X) \cap \alpha = 0$ for all $\alpha$. \end{lemma} 
\begin{lemma} \label{lemma-prepare-geometric-cap} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $Y$ be locally of finite type over $S$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_Y$-module. Let $s \in \Gamma(Y, \mathcal{L})$. Assume \begin{enumerate} \item $\dim_\delta(Y) \leq k + 1$, \item $\dim_\delta(Z(s)) \leq k$, and \item for every generic point $\xi$ of an irreducible component of $Z(s)$ of $\delta$-dimension $k$ the multiplication by $s$ induces an injection $\mathcal{O}_{Y, \xi} \to \mathcal{L}_\xi$. \end{enumerate} Write $[Y]_{k + 1} = \sum n_i[Y_i]$ where $Y_i \subset Y$ are the irreducible components of $Y$ of $\delta$-dimension $k + 1$. Set $s_i = s|_{Y_i} \in \Gamma(Y_i, \mathcal{L}|_{Y_i})$. Then \begin{equation} \label{equation-equal-as-cycles} [Z(s)]_k =  \sum n_i[Z(s_i)]_k \end{equation} as $k$-cycles on $Y$. \end{lemma} 
\begin{lemma} \label{lemma-geometric-cap} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Let $Y \subset X$ be a closed subscheme. Let $s \in \Gamma(Y, \mathcal{L}|_Y)$. Assume \begin{enumerate} \item $\dim_\delta(Y) \leq k + 1$, \item $\dim_\delta(Z(s)) \leq k$, and \item for every generic point $\xi$ of an irreducible component of $Z(s)$ of $\delta$-dimension $k$ the multiplication by $s$ induces an injection $\mathcal{O}_{Y, \xi} \to (\mathcal{L}|_Y)_\xi$\footnote{For example, this holds if $s$ is a regular section of $\mathcal{L}|_Y$.}. \end{enumerate} Then $$ c_1(\mathcal{L}) \cap [Y]_{k + 1} = [Z(s)]_k $$ in $\CH_k(X)$. \end{lemma} 
\begin{lemma} \label{lemma-prepare-flat-pullback-cap-c1} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$ be locally of finite type over $S$. Let $f : X \to Y$ be a flat morphism of relative dimension $r$. Let $\mathcal{L}$ be an invertible sheaf on $Y$. Assume $Y$ is integral and $n = \dim_\delta(Y)$. Let $s$ be a nonzero meromorphic section of $\mathcal{L}$. Then we have $$ f^*\text{div}_\mathcal{L}(s) = \sum n_i\text{div}_{f^*\mathcal{L}|_{X_i}}(s_i) $$ in $Z_{n + r - 1}(X)$. Here the sum is over the irreducible components $X_i \subset X$ of $\delta$-dimension $n + r$, the section $s_i = f|_{X_i}^*(s)$ is the pullback of $s$, and $n_i = m_{X_i, X}$ is the multiplicity of $X_i$ in $X$. \end{lemma} 
\begin{lemma} \label{lemma-flat-pullback-cap-c1} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$ be locally of finite type over $S$. Let $f : X \to Y$ be a flat morphism of relative dimension $r$. Let $\mathcal{L}$ be an invertible sheaf on $Y$. Let $\alpha$ be a $k$-cycle on $Y$. Then $$ f^*(c_1(\mathcal{L}) \cap \alpha) = c_1(f^*\mathcal{L}) \cap f^*\alpha $$ in $\CH_{k + r - 1}(X)$. \end{lemma} 
\begin{lemma} \label{lemma-equal-c1-as-cycles} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$ be locally of finite type over $S$. Let $f : X \to Y$ be a proper morphism. Let $\mathcal{L}$ be an invertible sheaf on $Y$. Let $s$ be a nonzero meromorphic section $s$ of $\mathcal{L}$ on $Y$. Assume $X$, $Y$ integral, $f$ dominant, and $\dim_\delta(X) = \dim_\delta(Y)$. Then $$ f_*\left(\text{div}_{f^*\mathcal{L}}(f^*s)\right) = [R(X) : R(Y)]\text{div}_\mathcal{L}(s). $$ as cycles on $Y$. In particular $$ f_*(c_1(f^*\mathcal{L}) \cap [X]) = [R(X) : R(Y)] c_1(\mathcal{L}) \cap [Y] = c_1(\mathcal{L}) \cap f_*[X] $$ \end{lemma} 
\begin{lemma} \label{lemma-pushforward-cap-c1} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$ be locally of finite type over $S$. Let $p : X \to Y$ be a proper morphism. Let $\alpha \in Z_{k + 1}(X)$. Let $\mathcal{L}$ be an invertible sheaf on $Y$. Then $$ p_*(c_1(p^*\mathcal{L}) \cap \alpha) = c_1(\mathcal{L}) \cap p_*\alpha $$ in $\CH_k(Y)$. \end{lemma} 
\begin{lemma}[Key formula] \label{lemma-key-formula} In the situation above the cycle $$ \sum (Z_i \to X)_*\left( \text{ord}_{B_i}(f_i) \text{div}_{\mathcal{N}|_{Z_i}}(t_i|_{Z_i}) - \text{ord}_{B_i}(g_i) \text{div}_{\mathcal{L}|_{Z_i}}(s_i|_{Z_i}) \right) $$ is equal to the cycle $$ \sum (Z_i \to X)_*\text{div}(\partial_{B_i}(f_i, g_i)) $$ \end{lemma} 
\begin{lemma} \label{lemma-commutativity-on-integral} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Assume $X$ integral and $\dim_\delta(X) = n$. Let $\mathcal{L}$, $\mathcal{N}$ be invertible on $X$. Choose a nonzero meromorphic section $s$ of $\mathcal{L}$ and a nonzero meromorphic section $t$ of $\mathcal{N}$. Set $\alpha = \text{div}_\mathcal{L}(s)$ and $\beta = \text{div}_\mathcal{N}(t)$. Then $$ c_1(\mathcal{N}) \cap \alpha = c_1(\mathcal{L}) \cap \beta $$ in $\CH_{n - 2}(X)$. \end{lemma} 
\begin{lemma} \label{lemma-factors} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{L}$ be invertible on $X$. The operation $\alpha \mapsto c_1(\mathcal{L}) \cap \alpha$ factors through rational equivalence to give an operation $$ c_1(\mathcal{L}) \cap - : \CH_{k + 1}(X) \to \CH_k(X) $$ \end{lemma} 
\begin{lemma} \label{lemma-cap-commutative} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{L}$, $\mathcal{N}$ be invertible on $X$. For any $\alpha \in \CH_{k + 2}(X)$ we have $$ c_1(\mathcal{L}) \cap c_1(\mathcal{N}) \cap \alpha = c_1(\mathcal{N}) \cap c_1(\mathcal{L}) \cap \alpha $$ as elements of $\CH_k(X)$. \end{lemma} 
\begin{definition} \label{definition-gysin-homomorphism} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $(\mathcal{L}, s)$ be a pair consisting of an invertible sheaf and a global section $s \in \Gamma(X, \mathcal{L})$. Let $D = Z(s)$ be the zero scheme of $s$, and denote $i : D \to X$ the closed immersion. We define, for every integer $k$, a {\it Gysin homomorphism} $$ i^* : Z_{k + 1}(X) \to \CH_k(D). $$ by the following rules: \begin{enumerate} \item Given a integral closed subscheme $W \subset X$ with $\dim_\delta(W) = k + 1$ we define \begin{enumerate} \item if $W \not \subset D$, then $i^*[W] = [D \cap W]_k$ as a $k$-cycle on $D$, and \item if $W \subset D$, then $i^*[W] = i'_*(c_1(\mathcal{L}|_W) \cap [W])$, where $i' : W \to D$ is the induced closed immersion. \end{enumerate} \item For a general $(k + 1)$-cycle $\alpha = \sum n_j[W_j]$ we set $$ i^*\alpha = \sum n_j i^*[W_j] $$ \item If $D$ is an effective Cartier divisor, then we denote $D \cdot \alpha = i_*i^*\alpha$ the pushforward of the class $i^*\alpha$ to a class on $X$. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-support-cap-effective-Cartier} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $(\mathcal{L}, s, i : D \to X)$ be as in Definition \ref{definition-gysin-homomorphism}. Let $\alpha$ be a $(k + 1)$-cycle on $X$. Then $i_*i^*\alpha = c_1(\mathcal{L}) \cap \alpha$ in $\CH_k(X)$. In particular, if $D$ is an effective Cartier divisor, then $D \cdot \alpha = c_1(\mathcal{O}_X(D)) \cap \alpha$. \end{lemma} 
\begin{lemma} \label{lemma-easy-gysin} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $(\mathcal{L}, s, i : D \to X)$ be as in Definition \ref{definition-gysin-homomorphism}. \begin{enumerate} \item Let $Z \subset X$ be a closed subscheme such that $\dim_\delta(Z) \leq k + 1$ and such that $D \cap Z$ is an effective Cartier divisor on $Z$. Then $i^*[Z]_{k + 1} = [D \cap Z]_k$. \item Let $\mathcal{F}$ be a coherent sheaf on $X$ such that $\dim_\delta(\text{Supp}(\mathcal{F})) \leq k + 1$ and $s : \mathcal{F} \to \mathcal{F} \otimes_{\mathcal{O}_X} \mathcal{L}$ is injective. Then $$ i^*[\mathcal{F}]_{k + 1} = [i^*\mathcal{F}]_k $$ in $\CH_k(D)$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-closed-in-X-gysin} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $f : X' \to X$ be a proper morphism of schemes locally of finite type over $S$. Let $(\mathcal{L}, s, i : D \to X)$ be as in Definition \ref{definition-gysin-homomorphism}. Form the diagram $$ \xymatrix{ D' \ar[d]_g \ar[r]_{i'} & X' \ar[d]^f \\ D \ar[r]^i & X } $$ as in Remark \ref{remark-pullback-pairs}. For any $(k + 1)$-cycle $\alpha'$ on $X'$ we have $i^*f_*\alpha' = g_*(i')^*\alpha'$ in $\CH_k(D)$ (this makes sense as $f_*$ is defined on the level of cycles). \end{lemma} 
\begin{lemma} \label{lemma-gysin-flat-pullback} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $f : X' \to X$ be a flat morphism of relative dimension $r$ of schemes locally of finite type over $S$. Let $(\mathcal{L}, s, i : D \to X)$ be as in Definition \ref{definition-gysin-homomorphism}. Form the diagram $$ \xymatrix{ D' \ar[d]_g \ar[r]_{i'} & X' \ar[d]^f \\ D \ar[r]^i & X } $$ as in Remark \ref{remark-pullback-pairs}. For any $(k + 1)$-cycle $\alpha$ on $X$ we have $(i')^*f^*\alpha = g^*i^*\alpha$ in $\CH_{k + r}(D')$ (this makes sense as $f^*$ is defined on the level of cycles). \end{lemma} 
\begin{lemma} \label{lemma-gysin-factors-general} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $X$ be integral and $n = \dim_\delta(X)$. Let $i : D \to X$ be an effective Cartier divisor. Let $\mathcal{N}$ be an invertible $\mathcal{O}_X$-module and let $t$ be a nonzero meromorphic section of $\mathcal{N}$. Then $i^*\text{div}_\mathcal{N}(t) = c_1(\mathcal{N}|_D) \cap [D]_{n - 1}$ in $\CH_{n - 2}(D)$. \end{lemma} 
\begin{lemma} \label{lemma-gysin-factors} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $(\mathcal{L}, s, i : D \to X)$ be as in Definition \ref{definition-gysin-homomorphism}. The Gysin homomorphism factors through rational equivalence to give a map $i^* : \CH_{k + 1}(X) \to \CH_k(D)$. \end{lemma} 
\begin{lemma} \label{lemma-gysin-back} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $(\mathcal{L}, s, i : D \to X)$ be as in Definition \ref{definition-gysin-homomorphism}. Then $i^*i_* : \CH_k(D) \to \CH_{k - 1}(D)$ sends $\alpha$ to $c_1(\mathcal{L}|_D) \cap \alpha$. \end{lemma} 
\begin{lemma} \label{lemma-gysin-commutes-cap-c1} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $(\mathcal{L}, s, i : D \to X)$ be a triple as in Definition \ref{definition-gysin-homomorphism}. Let $\mathcal{N}$ be an invertible $\mathcal{O}_X$-module. Then $i^*(c_1(\mathcal{N}) \cap \alpha) = c_1(i^*\mathcal{N}) \cap i^*\alpha$ in $\CH_{k - 2}(D)$ for all $\alpha \in \CH_k(X)$. \end{lemma} 
\begin{lemma} \label{lemma-gysin-commutes-gysin} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $(\mathcal{L}, s, i : D \to X)$ and $(\mathcal{L}', s', i' : D' \to X)$ be two triples as in Definition \ref{definition-gysin-homomorphism}. Then the diagram $$ \xymatrix{ \CH_k(X) \ar[r]_{i^*} \ar[d]_{(i')^*} & \CH_{k - 1}(D) \ar[d]^{j^*} \\ \CH_{k - 1}(D') \ar[r]^{(j')^*} & \CH_{k - 2}(D \cap D') } $$ commutes where each of the maps is a gysin map. \end{lemma} 
\begin{lemma} \label{lemma-relative-effective-cartier} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$ be locally of finite type over $S$. Let $p : X \to Y$ be a flat morphism of relative dimension $r$. Let $i : D \to X$ be a relative effective Cartier divisor (Divisors, Definition \ref{divisors-definition-relative-effective-Cartier-divisor}). Let $\mathcal{L} = \mathcal{O}_X(D)$. For any $\alpha \in \CH_{k + 1}(Y)$ we have $$ i^*p^*\alpha = (p|_D)^*\alpha $$ in $\CH_{k + r}(D)$ and $$ c_1(\mathcal{L}) \cap p^*\alpha = i_* ((p|_D)^*\alpha) $$ in $\CH_{k + r}(X)$. \end{lemma} 
\begin{lemma} \label{lemma-pullback-affine-fibres-surjective} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$ be locally of finite type over $S$. Let $f : X \to Y$ be a flat morphism of relative dimension $r$. Assume that for every $y \in Y$, there exists an open neighbourhood $U \subset Y$ such that $f|_{f^{-1}(U)} : f^{-1}(U) \to U$ is identified with the morphism $U \times \mathbf{A}^r \to U$. Then $f^* : \CH_k(Y) \to \CH_{k + r}(X)$ is surjective for all $k \in \mathbf{Z}$. \end{lemma} 
\begin{lemma} \label{lemma-linebundle} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Let $$ p : L = \underline{\Spec}(\text{Sym}^*(\mathcal{L})) \longrightarrow X $$ be the associated vector bundle over $X$. Then $p^* : \CH_k(X) \to \CH_{k + 1}(L)$ is an isomorphism for all $k$. \end{lemma} 
\begin{lemma} \label{lemma-linebundle-formulae} In the situation of Lemma \ref{lemma-linebundle} denote $o : X \to L$ the zero section (see proof of the lemma). Then we have \begin{enumerate} \item $o(X)$ is the zero scheme of a regular global section of $p^*\mathcal{L}^{\otimes -1}$, \item $o_* : \CH_k(X) \to \CH_k(L)$ as $o$ is a closed immersion, \item $o^* : \CH_{k + 1}(L) \to \CH_k(X)$ as $o(X)$ is an effective Cartier divisor, \item $o^* p^* : \CH_k(X) \to \CH_k(X)$ is the identity map, \item $o_*\alpha = - p^*(c_1(\mathcal{L}) \cap \alpha)$ for any $\alpha \in \CH_k(X)$, and \item $o^* o_* : \CH_k(X) \to \CH_{k - 1}(X)$ is equal to the map $\alpha \mapsto - c_1(\mathcal{L}) \cap \alpha$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-decompose-section} Let $Y$ be a scheme. Let $\mathcal{L}_i$, $i = 1, 2$ be invertible $\mathcal{O}_Y$-modules. Let $s$ be a global section of $\mathcal{L}_1 \otimes_{\mathcal{O}_X} \mathcal{L}_2$. Denote $i : D \to X$ the zero scheme of $s$. Then there exists a commutative diagram $$ \xymatrix{ D_1 \ar[r]_{i_1} \ar[d]_{p_1} & L \ar[d]^p & D_2 \ar[l]^{i_2} \ar[d]^{p_2} \\ D \ar[r]^i & Y & D \ar[l]_i } $$ and sections $s_i$ of $p^*\mathcal{L}_i$ such that the following hold: \begin{enumerate} \item $p^*s = s_1 \otimes s_2$, \item $p$ is of finite type and flat of relative dimension $1$, \item $D_i$ is the zero scheme of $s_i$, \item $D_i \cong \underline{\Spec}(\text{Sym}^*(\mathcal{L}_{1 - i}^{\otimes -1})|_D))$ over $D$ for $i = 1, 2$, \item $p^{-1}D = D_1 \cup D_2$ (scheme theoretic union), \item $D_1 \cap D_2$ (scheme theoretic intersection) maps isomorphically to $D$, and \item $D_1 \cap D_2 \to D_i$ is the zero section of the line bundle $D_i \to D$ for $i = 1, 2$. \end{enumerate} Moreover, the formation of this diagram and the sections $s_i$ commutes with arbitrary base change. \end{lemma} 
\begin{lemma} \label{lemma-decompose-section-formulae} In the situation of Lemma \ref{lemma-decompose-section} assume $Y$ is locally of finite type over $(S, \delta)$ as in Situation \ref{situation-setup}. Then we have $i_1^*p^*\alpha = p_1^*i^*\alpha$ in $\CH_k(D_1)$ for all $\alpha \in \CH_k(Y)$. \end{lemma} 
\begin{lemma} \label{lemma-normal-cone-effective-Cartier} In Situation \ref{situation-setup} let $X$ be a scheme locally of finite type over $S$. Let $(\mathcal{L}, s, i : D \to X)$ be a triple as in Definition \ref{definition-gysin-homomorphism}. There exists a commutative diagram $$ \xymatrix{ D' \ar[r]_{i'} \ar[d]_p & X' \ar[d]^g \\ D \ar[r]^i & X } $$ such that \begin{enumerate} \item $p$ and $g$ are of finite type and flat of relative dimension $1$, \item $p^* : \CH_k(D) \to \CH_{k + 1}(D')$ is injective for all $k$, \item $D' \subset X'$ is the zero scheme of a global section $s' \in \Gamma(X', \mathcal{O}_{X'})$, \item $p^*i^* = (i')^*g^*$ as maps $\CH_k(X) \to \CH_k(D')$. \end{enumerate} Moreover, these properties remain true after arbitrary base change by morphisms $Y \to X$ which are locally of finite type. \end{lemma} 
\begin{definition} \label{definition-bivariant-class} \begin{reference} Similar to \cite[Definition 17.1]{F} \end{reference} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $f : X \to Y$ be a morphism of schemes locally of finite type over $S$. Let $p \in \mathbf{Z}$. A {\it bivariant class $c$ of degree $p$ for $f$} is given by a rule which assigns to every locally of finite type morphism $Y' \to Y$ and every $k$ a map $$ c \cap - : \CH_k(Y') \longrightarrow \CH_{k - p}(X') $$ where $X' = Y' \times_Y X$, satisfying the following conditions \begin{enumerate} \item if $Y'' \to Y'$ is a proper, then $c \cap (Y'' \to Y')_*\alpha'' = (X'' \to X')_*(c \cap \alpha'')$ for all $\alpha''$ on $Y''$ where $X'' = Y'' \times_Y X$, \item if $Y'' \to Y'$ is flat locally of finite type of fixed relative dimension, then $c \cap (Y'' \to Y')^*\alpha' = (X'' \to X')^*(c \cap \alpha')$ for all $\alpha'$ on $Y'$, and \item if $(\mathcal{L}', s', i' : D' \to Y')$ is as in Definition \ref{definition-gysin-homomorphism} with pullback $(\mathcal{N}', t', j' : E' \to X')$ to $X'$, then we have $c \cap (i')^*\alpha' = (j')^*(c \cap \alpha')$ for all $\alpha'$ on $Y'$. \end{enumerate} The collection of all bivariant classes of degree $p$ for $f$ is denoted $A^p(X \to Y)$. \end{definition} 
\begin{lemma} \label{lemma-flat-pullback-bivariant} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $f : X \to Y$ be a flat morphism of relative dimension $r$ between schemes locally of finite type over $S$. Then the rule that to $Y' \to Y$ assigns $(f')^* : \CH_k(Y') \to \CH_{k + r}(X')$ where $X' = X \times_Y Y'$ is a bivariant class of degree $-r$. \end{lemma} 
\begin{lemma} \label{lemma-gysin-bivariant} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $(\mathcal{L}, s, i : D \to X)$ be a triple as in Definition \ref{definition-gysin-homomorphism}. Then the rule that to $f : X' \to X$ assigns $(i')^* : \CH_k(X') \to \CH_{k - 1}(D')$ where $D' = D \times_X X'$ is a bivariant class of degree $1$. \end{lemma} 
\begin{lemma} \label{lemma-push-proper-bivariant} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $f : X \to Y$ and $g : Y \to Z$ be morphisms of schemes locally of finite type over $S$. Let $c \in A^p(X \to Z)$ and assume $f$ is proper. Then the rule that to $Z' \to Z$ assigns $\alpha \longmapsto f'_*(c \cap \alpha)$ is a bivariant class denoted $f_* \circ c \in A^p(Y \to Z)$. \end{lemma} 
\begin{definition} \label{definition-chow-cohomology} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. The {\it Chow cohomology} of $X$ is the graded $\mathbf{Z}$-algebra $A^*(X)$ whose degree $p$ component is $A^p(X \to X)$. \end{definition} 
\begin{lemma} \label{lemma-cap-c1-bivariant} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Then the rule that to $f : X' \to X$ assigns $c_1(f^*\mathcal{L}) \cap - : \CH_k(X') \to \CH_{k - 1}(X')$ is a bivariant class of degree $1$. \end{lemma} 
\begin{definition} \label{definition-first-chern-class} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. The {\it first Chern class} $c_1(\mathcal{L}) \in A^1(X)$ of $\mathcal{L}$ is the bivariant class of Lemma \ref{lemma-cap-c1-bivariant}. \end{definition} 
\begin{lemma} \label{lemma-c1-center} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Then \begin{enumerate} \item $c_1(\mathcal{L}) \in A^1(X)$ is in the center of $A^*(X)$ and \item if $f : X' \to X$ is locally of finite type and $c \in A^*(X' \to X)$, then $c \circ c_1(\mathcal{L}) = c_1(f^*\mathcal{L}) \circ c$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-vanish-above-dimension} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be a finite type scheme over $S$ which has an ample invertible sheaf. Assume $d = \dim(X) < \infty$ (here we really mean dimension and not $\delta$-dimension). Then for any invertible sheaves $\mathcal{L}_1, \ldots, \mathcal{L}_{d + 1}$ on $X$ we have $c_1(\mathcal{L}_1) \circ \ldots \circ c_1(\mathcal{L}_{d + 1}) = 0$ in $A^{d + 1}(X)$. \end{lemma} 
\begin{lemma} \label{lemma-factors-through-rational-equivalence} \begin{reference} Very weak form of \cite[Theorem 17.1]{F} \end{reference} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $f : X \to Y$ be a morphism of schemes locally of finite type over $S$. Let $p \in \mathbf{Z}$. Suppose given a rule which assigns to every locally of finite type morphism $Y' \to Y$ and every $k$ a map $$ c \cap - : Z_k(Y') \longrightarrow \CH_{k - p}(X') $$ where $Y' = X' \times_X Y$, satisfying condition (3) of Definition \ref{definition-bivariant-class} whenever $\mathcal{L}'|_{D'} \cong \mathcal{O}_{D'}$. Then $c \cap -$ factors through rational equivalence. \end{lemma} 
\begin{lemma} \label{lemma-bivariant-weaker} \begin{reference} Weak form of \cite[Theorem 17.1]{F} \end{reference} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $f : X \to Y$ be a morphism of schemes locally of finite type over $S$. Let $p \in \mathbf{Z}$. Suppose given a rule which assigns to every locally of finite type morphism $Y' \to Y$ and every $k$ a map $$ c \cap - : \CH_k(Y') \longrightarrow \CH_{k - p}(X') $$ where $Y' = X' \times_X Y$, satisfying conditions (1), (2) of Definition \ref{definition-bivariant-class} and condition (3) whenever $\mathcal{L}'|_{D'} \cong \mathcal{O}_{D'}$. Then $c \cap -$ is a bivariant class. \end{lemma} 
\begin{lemma} \label{lemma-bivariant-zero} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $f : X \to Y$ be a morphism of schemes locally of finite type over $S$. Let $c \in A^p(X \to Y)$. For $Y'' \to Y' \to Y$ set $X'' = Y'' \times_Y X$ and $X' = Y' \times_Y X$. The following are equivalent \begin{enumerate} \item $c$ is zero, \item $c \cap [Y'] = 0$ in $\CH_*(X')$ for every integral scheme $Y'$ locally of finite type over $Y$, and \item for every integral scheme $Y'$ locally of finite type over $Y$, there exists a proper birational morphism $Y'' \to Y'$ such that $c \cap [Y''] = 0$ in $\CH_*(X'')$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-disjoint-decomposition-bivariant} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $f : X \to Y$ be a morphism of schemes locally of finite type over $S$. Assume we have disjoint union decompositions $X = \coprod_{i \in I} X_i$ and $Y = \coprod_{j \in J} Y_j$ by open and closed subschemes and a map $a : I \to J$ of sets such that $f(X_i) \subset Y_{a(i)}$. Then $$ A^p(X \to Y) = \prod\nolimits_{i \in I} A^p(X_i \to Y_{a(i)}) $$ \end{lemma} 
\begin{lemma} \label{lemma-envelope-bivariant} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $f : X \to Y$ be a morphism of schemes locally of finite type over $S$. Let $g : Y' \to Y$ be an envelope (Definition \ref{definition-envelope}) and denote $X' = Y' \times_Y X$. Let $p \in \mathbf{Z}$ and let $c' \in A^p(X' \to Y')$. If the two restrictions $$ res_1(c') = res_2(c') \in A^p(X' \times_X X' \to Y' \times_Y Y') $$ are equal (see proof), then there exists a unique $c \in A^p(X \to Y)$ whose restriction $res(c) = c'$ in $A^p(X' \to Y')$. \end{lemma} 
\begin{lemma} \label{lemma-cap-projective-bundle} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{E}$ be a finite locally free $\mathcal{O}_X$-module $\mathcal{E}$ of rank $r$. Let $(\pi : P \to X, \mathcal{O}_P(1))$ be the projective bundle associated to $\mathcal{E}$. For any $\alpha \in \CH_k(X)$ the element $$ \pi_*\left( c_1(\mathcal{O}_P(1))^s \cap \pi^*\alpha \right) \in \CH_{k + r - 1 - s}(X) $$ is $0$ if $s < r - 1$ and is equal to $\alpha$ when $s = r - 1$. \end{lemma} 
\begin{lemma}[Projective space bundle formula] \label{lemma-chow-ring-projective-bundle} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{E}$ be a finite locally free $\mathcal{O}_X$-module $\mathcal{E}$ of rank $r$. Let $(\pi : P \to X, \mathcal{O}_P(1))$ be the projective bundle associated to $\mathcal{E}$. The map $$ \bigoplus\nolimits_{i = 0}^{r - 1} \CH_{k + i}(X) \longrightarrow \CH_{k + r - 1}(P), $$ $$ (\alpha_0, \ldots, \alpha_{r-1}) \longmapsto \pi^*\alpha_0 + c_1(\mathcal{O}_P(1)) \cap \pi^*\alpha_1 + \ldots + c_1(\mathcal{O}_P(1))^{r - 1} \cap \pi^*\alpha_{r-1} $$ is an isomorphism. \end{lemma} 
\begin{lemma} \label{lemma-vectorbundle} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{E}$ be a finite locally free sheaf of rank $r$ on $X$. Let $$ p : E = \underline{\Spec}(\text{Sym}^*(\mathcal{E})) \longrightarrow X $$ be the associated vector bundle over $X$. Then $p^* : \CH_k(X) \to \CH_{k + r}(E)$ is an isomorphism for all $k$. \end{lemma} 
\begin{definition} \label{definition-chern-classes} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Assume $X$ is integral and $n = \dim_\delta(X)$. Let $\mathcal{E}$ be a finite locally free sheaf of rank $r$ on $X$. Let $(\pi : P \to X, \mathcal{O}_P(1))$ be the projective space bundle associated to $\mathcal{E}$. \begin{enumerate} \item By Lemma \ref{lemma-chow-ring-projective-bundle} there are elements $c_i \in \CH_{n - i}(X)$, $i = 0, \ldots, r$ such that $c_0 = [X]$, and \begin{equation} \label{equation-chern-classes} \sum\nolimits_{i = 0}^r (-1)^i c_1(\mathcal{O}_P(1))^i \cap \pi^*c_{r - i} = 0. \end{equation} \item With notation as above we set $c_i(\mathcal{E}) \cap [X] = c_i$ as an element of $\CH_{n - i}(X)$. We call these the {\it Chern classes of $\mathcal{E}$ on $X$}. \item The {\it total Chern class of $\mathcal{E}$ on $X$} is the combination $$ c({\mathcal E}) \cap [X] = c_0({\mathcal E}) \cap [X] + c_1({\mathcal E}) \cap [X] + \ldots + c_r({\mathcal E}) \cap [X] $$ which is an element of $\CH_*(X) = \bigoplus_{k \in \mathbf{Z}} \CH_k(X)$. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-first-chern-class} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Assume $X$ is integral and $n = \dim_\delta(X)$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. The first Chern class of $\mathcal{L}$ on $X$ of Definition \ref{definition-chern-classes} is equal to the Weil divisor associated to $\mathcal{L}$ by Definition \ref{definition-divisor-invertible-sheaf}. \end{lemma} 
\begin{definition} \label{definition-cap-chern-classes} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{E}$ be a finite locally free sheaf of rank $r$ on $X$. We define, for every integer $k$ and any $0 \leq j \leq r$, an operation $$ c_j(\mathcal{E}) \cap - : Z_k(X) \to \CH_{k - j}(X) $$ called {\it intersection with the $j$th Chern class of $\mathcal{E}$}. \begin{enumerate} \item Given an integral closed subscheme $i : W \to X$ of $\delta$-dimension $k$ we define $$ c_j(\mathcal{E}) \cap [W] = i_*(c_j({i^*\mathcal{E}}) \cap [W]) \in \CH_{k - j}(X) $$ where $c_j({i^*\mathcal{E}}) \cap [W]$ is as defined in Definition \ref{definition-chern-classes}. \item For a general $k$-cycle $\alpha = \sum n_i [W_i]$ we set $$ c_j(\mathcal{E}) \cap \alpha = \sum n_i c_j(\mathcal{E}) \cap [W_i] $$ \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-determine-intersections} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{E}$ be a finite locally free sheaf of rank $r$ on $X$. Let $(\pi : P \to X, \mathcal{O}_P(1))$ be the projective bundle associated to $\mathcal{E}$. For $\alpha \in Z_k(X)$ the elements $c_j(\mathcal{E}) \cap \alpha$ are the unique elements $\alpha_j$ of $\CH_{k - j}(X)$ such that $\alpha_0 = \alpha$ and $$ \sum\nolimits_{i = 0}^r (-1)^i c_1(\mathcal{O}_P(1))^i \cap \pi^*(\alpha_{r - i}) = 0 $$ holds in the Chow group of $P$. \end{lemma} 
\begin{lemma} \label{lemma-cap-chern-class-factors-rational-equivalence} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{E}$ be a finite locally free sheaf of rank $r$ on $X$. If $\alpha \sim_{rat} \beta$ are rationally equivalent $k$-cycles on $X$ then $c_j(\mathcal{E}) \cap \alpha = c_j(\mathcal{E}) \cap \beta$ in $\CH_{k - j}(X)$. \end{lemma} 
\begin{lemma} \label{lemma-pushforward-cap-cj} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$ be locally of finite type over $S$. Let $\mathcal{E}$ be a finite locally free sheaf of rank $r$ on $X$. Let $p : X \to Y$ be a proper morphism. Let $\alpha$ be a $k$-cycle on $X$. Let $\mathcal{E}$ be a finite locally free sheaf on $Y$. Then $$ p_*(c_j(p^*\mathcal{E}) \cap \alpha) = c_j(\mathcal{E}) \cap p_*\alpha $$ \end{lemma} 
\begin{lemma} \label{lemma-flat-pullback-cap-cj} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$, $Y$ be locally of finite type over $S$. Let $\mathcal{E}$ be a finite locally free sheaf of rank $r$ on $Y$. Let $f : X \to Y$ be a flat morphism of relative dimension $r$. Let $\alpha$ be a $k$-cycle on $Y$. Then $$ f^*(c_j(\mathcal{E}) \cap \alpha) = c_j(f^*\mathcal{E}) \cap f^*\alpha $$ \end{lemma} 
\begin{lemma} \label{lemma-cap-chern-class-commutes-with-gysin} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{E}$ be a finite locally free sheaf of rank $r$ on $X$. Let $(\mathcal{L}, s, i : D \to X)$ be as in Definition \ref{definition-gysin-homomorphism}. Then $c_j(\mathcal{E}|_D) \cap i^*\alpha = i^*(c_j(\mathcal{E}) \cap \alpha)$ for all $\alpha \in \CH_k(X)$. \end{lemma} 
\begin{lemma} \label{lemma-cap-cp-bivariant} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{E}$ be a locally free $\mathcal{O}_X$-module of rank $r$. Let $0 \leq p \leq r$. Then the rule that to $f : X' \to X$ assigns $c_p(f^*\mathcal{E}) \cap - : \CH_k(X') \to \CH_{k - p}(X')$ is a bivariant class of degree $p$. \end{lemma} 
\begin{definition} \label{definition-chern-classes-final} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{E}$ be a locally free $\mathcal{O}_X$-module of rank $r$. For $i = 0, \ldots, r$ the {\it $i$th Chern class} of $\mathcal{E}$ is the bivariant class $c_i(\mathcal{E}) \in A^i(X)$ of degree $i$ constructed in Lemma \ref{lemma-cap-cp-bivariant}. The {\it total Chern class} of $\mathcal{E}$ is the formal sum $$ c(\mathcal{E}) =  c_0(\mathcal{E}) + c_1(\mathcal{E}) + \ldots + c_r(\mathcal{E}) $$ which is viewed as a nonhomogeneous bivariant class on $X$. \end{definition} 
\begin{lemma} \label{lemma-cap-commutative-chern} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{E}$ be a locally free $\mathcal{O}_X$-module of rank $r$. Then \begin{enumerate} \item $c_j(\mathcal{E}) \in A^j(X)$ is in the center of $A^*(X)$ and \item if $f : X' \to X$ is locally of finite type and $c \in A^*(X' \to X)$, then $c \circ c_j(\mathcal{E}) = c_j(f^*\mathcal{E}) \circ c$. \end{enumerate} In particular, if $\mathcal{F}$ is a second locally free $\mathcal{O}_X$-module on $X$ of rank $s$, then $$ c_i(\mathcal{E}) \cap c_j(\mathcal{F}) \cap \alpha = c_j(\mathcal{F}) \cap c_i(\mathcal{E}) \cap \alpha $$ as elements of $\CH_{k - i - j}(X)$ for all $\alpha \in \CH_k(X)$. \end{lemma} 
\begin{lemma} \label{lemma-chern-classes-E-tensor-L} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{E}$ be a finite locally free sheaf of rank $r$ on $X$. Let $\mathcal{L}$ be an invertible sheaf on $X$. Then we have \begin{equation} \label{equation-twist} c_i({\mathcal E} \otimes {\mathcal L}) = \sum\nolimits_{j = 0}^i \binom{r - i + j}{j} c_{i - j}({\mathcal E}) c_1({\mathcal L})^j \end{equation} in $A^*(X)$. \end{lemma} 
\begin{lemma} \label{lemma-get-rid-of-trivial-subbundle} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{E}$, $\mathcal{F}$ be finite locally free sheaves on $X$ of ranks $r$, $r - 1$ which fit into a short exact sequence $$ 0 \to \mathcal{O}_X \to \mathcal{E} \to \mathcal{F} \to 0 $$ Then we have $$ c_r(\mathcal{E}) = 0, \quad c_j(\mathcal{E}) = c_j(\mathcal{F}), \quad j = 0, \ldots, r - 1 $$ in $A^*(X)$. \end{lemma} 
\begin{lemma} \label{lemma-additivity-invertible-subsheaf} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{E}$, $\mathcal{F}$ be finite locally free sheaves on $X$ of ranks $r$, $r - 1$ which fit into a short exact sequence $$ 0 \to \mathcal{L} \to \mathcal{E} \to \mathcal{F} \to 0 $$ where $\mathcal{L}$ is an invertible sheaf. Then $$ c(\mathcal{E}) = c(\mathcal{L}) c(\mathcal{F}) $$ in $A^*(X)$. \end{lemma} 
\begin{lemma} \label{lemma-additivity-chern-classes} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be a scheme locally of finite type over $S$. Suppose that ${\mathcal E}$ sits in an exact sequence $$ 0 \to {\mathcal E}_1 \to {\mathcal E} \to {\mathcal E}_2 \to 0 $$ of finite locally free sheaves $\mathcal{E}_i$ of rank $r_i$. The total Chern classes satisfy $$ c({\mathcal E}) = c({\mathcal E}_1) c({\mathcal E}_2) $$ in $A^*(X)$. \end{lemma} 
\begin{lemma} \label{lemma-chern-filter-by-linebundles} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let ${\mathcal L}_i$, $i = 1, \ldots, r$ be invertible $\mathcal{O}_X$-modules on $X$. Let $\mathcal{E}$ be a locally free rank $\mathcal{O}_X$-module endowed with a filtration $$ 0 = \mathcal{E}_0 \subset \mathcal{E}_1 \subset \mathcal{E}_2 \subset \ldots \subset \mathcal{E}_r = \mathcal{E} $$ such that $\mathcal{E}_i/\mathcal{E}_{i - 1} \cong \mathcal{L}_i$. Set $c_1({\mathcal L}_i) = x_i$. Then $$ c(\mathcal{E}) = \prod\nolimits_{i = 1}^r (1 + x_i) $$ in $A^*(X)$. \end{lemma} 
\begin{definition} \label{definition-degree-zero-cycle} Let $k$ be a field (Example \ref{example-field}). Let $p : X \to \Spec(k)$ be proper. The {\it degree of a zero cycle} on $X$ is given by proper pushforward $$ p_* : \CH_0(X) \to \CH_0(\Spec(k)) $$ (Lemma \ref{lemma-proper-pushforward-rational-equivalence}) combined with the natural isomorphism $\CH_0(\Spec(k)) = \mathbf{Z}$ which maps $[\Spec(k)]$ to $1$. Notation: $\deg(\alpha)$. \end{definition} 
\begin{lemma} \label{lemma-spell-out-degree-zero-cycle} Let $k$ be a field. Let $X$ be proper over $k$. Let $\alpha = \sum n_i[Z_i]$ be in $Z_0(X)$. Then $$ \deg(\alpha) = \sum n_i\deg(Z_i) $$ where $\deg(Z_i)$ is the degree of $Z_i \to \Spec(k)$, i.e., $\deg(Z_i) = \dim_k \Gamma(Z_i, \mathcal{O}_{Z_i})$. \end{lemma} 
\begin{lemma} \label{lemma-degree-vector-bundle} Let $k$ be a field. Let $X$ be a proper scheme over $k$ of dimension $\leq 1$. Let $\mathcal{E}$ be a finite locally free $\mathcal{O}_X$-module of constant rank. Then $$ \deg(\mathcal{E}) = \deg(c_1(\mathcal{E}) \cap [X]_1) $$ where the left hand side is defined in Varieties, Definition \ref{varieties-definition-degree-invertible-sheaf}. \end{lemma} 
\begin{lemma} \label{lemma-degrees-and-numerical-intersections} Let $k$ be a field. Let $X$ be a proper scheme over $k$. Let $Z \subset X$ be a closed subscheme of dimension $d$. Let $\mathcal{L}_1, \ldots, \mathcal{L}_d$ be invertible $\mathcal{O}_X$-modules. Then $$ (\mathcal{L}_1 \cdots \mathcal{L}_d \cdot Z) = \deg( c_1(\mathcal{L}_1) \cap \ldots \cap c_1(\mathcal{L}_d) \cap [Z]_d) $$ where the left hand side is defined in Varieties, Definition \ref{varieties-definition-intersection-number}. In particular, $$ \deg_\mathcal{L}(Z) = \deg(c_1(\mathcal{L})^d \cap [Z]_d) $$ if $\mathcal{L}$ is an ample invertible $\mathcal{O}_X$-module. \end{lemma} 
\begin{lemma} \label{lemma-locally-equidimensional} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Write $\delta = \delta_{X/S}$ as in Section \ref{section-setup}. The following are equivalent \begin{enumerate} \item There exists a decomposition $X = \coprod_{n \in \mathbf{Z}} X_n$ into open and closed subschemes such that $\delta(\xi) = n$ whenever $\xi \in X_n$ is a generic point of an irreducible component of $X_n$. \item For all $x \in X$ there exists an open neighbourhood $U \subset X$ of $x$ and an integer $n$ such that $\delta(\xi) = n$ whenever $\xi \in U$ is a generic point of an irreducible component of $U$. \item For all $x \in X$ there exists an integer $n_x$ such that $\delta(\xi) = n_x$ for any generic point $\xi$ of an irreducible component of $X$ containing $x$. \end{enumerate} The conditions are satisfied if $X$ is either normal or Cohen-Macaulay\footnote{In fact, it suffices if $X$ is $(S_2)$. Compare with Local Cohomology, Lemma \ref{local-cohomology-lemma-catenary-S2-equidimensional}.}. \end{lemma} 
\begin{lemma} \label{lemma-splitting-principle} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{E}_i$ be a finite collection of locally free $\mathcal{O}_X$-modules of rank $r_i$. There exists a projective flat morphism $\pi : P \to X$ of relative dimension $d$ such that \begin{enumerate} \item for any morphism $f : Y \to X$ the map $\pi_Y^* : \CH_*(Y) \to \CH_{* + d}(Y \times_X P)$ is injective, and \item each $\pi^*\mathcal{E}_i$ has a filtration whose successive quotients $\mathcal{L}_{i, 1}, \ldots, \mathcal{L}_{i, r_i}$ are invertible ${\mathcal O}_P$-modules. \end{enumerate} Moreover, when (1) holds the restriction map $A^*(X) \to A^*(P)$ (Remark \ref{remark-pullback-cohomology}) is injective. \end{lemma} 
\begin{lemma} \label{lemma-chern-classes-dual} In Situation \ref{situation-setup} let $X$ be locally of finite type over $S$. Let $\mathcal{E}$ be a finite locally free $\mathcal{O}_X$-module with dual $\mathcal{E}^\vee$. Then $$ c_i(\mathcal{E}^\vee) = (-1)^i c_i(\mathcal{E}) $$ in $A^i(X)$. \end{lemma} 
\begin{lemma} \label{lemma-chern-classes-tensor-product} In Situation \ref{situation-setup} let $X$ be locally of finite type over $S$. Let $\mathcal{E}$ and $\mathcal{F}$ be a finite locally free $\mathcal{O}_X$-modules of ranks $r$ and $s$. Then we have $$ c_1(\mathcal{E} \otimes \mathcal{F}) = r c_1(\mathcal{F}) + s c_1(\mathcal{E}) $$ $$ c_2(\mathcal{E} \otimes \mathcal{F}) = r c_2(\mathcal{F}) + s c_2(\mathcal{E}) + {r \choose 2} c_1(\mathcal{F})^2 + (rs - 1) c_1(\mathcal{F})c_1(\mathcal{E}) + {s \choose 2} c_1(\mathcal{E})^2 $$ and so on in $A^*(X)$. \end{lemma} 
\begin{lemma} \label{lemma-top-chern-class} In the situation described just above assume $\dim_\delta(X') = n$, that $f^*\mathcal{E}$ has constant rank $r$, that $\dim_\delta(Z(s)) \leq n - r$, and that for every generic point $\xi \in Z(s)$ with $\delta(\xi) = n - r$ the ideal of $Z(s)$ in $\mathcal{O}_{X', \xi}$ is generated by a regular sequence of length $r$. Then $$ c_r(\mathcal{E}) \cap [X']_n = [Z(s)]_{n - r} $$ in $\CH_*(X')$. \end{lemma} 
\begin{lemma} \label{lemma-easy-virtual-class} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be a scheme locally of finite type over $S$. Let $$ 0 \to \mathcal{N}' \to \mathcal{N} \to \mathcal{E} \to 0 $$ be a short exact sequence of finite locally free $\mathcal{O}_X$-modules. Consider the closed embedding $$ i : N' = \underline{\Spec}_X(\text{Sym}((\mathcal{N}')^\vee)) \longrightarrow N = \underline{\Spec}_X(\text{Sym}(\mathcal{N}^\vee)) $$ For $\alpha \in \CH_k(X)$ we have $$ i_*(p')^*\alpha = p^*(c_{top}(\mathcal{E}) \cap \alpha) $$ where $p' : N' \to X$ and $p : N \to X$ are the structure morphisms. \end{lemma} 
\begin{lemma} \label{lemma-chern-character-additive} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $ 0 \to \mathcal{E}_1 \to \mathcal{E} \to \mathcal{E}_2 \to 0 $ be a short exact sequence of finite locally free $\mathcal{O}_X$-modules. Then we have the equality $$ ch(\mathcal{E}) = ch(\mathcal{E}_1) + ch(\mathcal{E}_2) $$ More precisely, we have $P_p(\mathcal{E}) = P_p(\mathcal{E}_1) + P_p(\mathcal{E}_2)$ in $A^p(X)$ where $P_p$ is as in Example \ref{example-power-sum}. \end{lemma} 
\begin{lemma} \label{lemma-chern-character-multiplicative} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{E}_1$ and $\mathcal{E}_2$ be finite locally free $\mathcal{O}_X$-modules. Then we have the equality $$ ch(\mathcal{E}_1 \otimes_{\mathcal{O}_X} \mathcal{E}_2) = ch(\mathcal{E}_1) ch(\mathcal{E}_2) $$ More precisely, we have $$ P_p(\mathcal{E}_1 \otimes_{\mathcal{O}_X} \mathcal{E}_2) = \sum\nolimits_{p_1 + p_2 = p} {p \choose p_1} P_{p_1}(\mathcal{E}_1) P_{p_2}(\mathcal{E}_2) $$ in $A^p(X)$ where $P_p$ is as in Example \ref{example-power-sum}. \end{lemma} 
\begin{lemma} \label{lemma-chern-character-dual} In Situation \ref{situation-setup} let $X$ be locally of finite type over $S$. Let $\mathcal{E}$ be a finite locally free $\mathcal{O}_X$-module with dual $\mathcal{E}^\vee$. Then $ch_i(\mathcal{E}^\vee) = (-1)^i ch_i(\mathcal{E})$ in $A^i(X) \otimes \mathbf{Q}$. \end{lemma} 
\begin{lemma} \label{lemma-pre-derived-chern-class} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $E \in D(\mathcal{O}_X)$ be an object such that there exists a locally bounded complex $\mathcal{E}^\bullet$ of finite locally free $\mathcal{O}_X$-modules representing $E$. Then a slight generalization of the above constructions $$ c(\mathcal{E}^\bullet) \in \prod\nolimits_{p \geq 0} A^p(X),\quad ch(\mathcal{E}^\bullet) \in \prod\nolimits_{p \geq 0} A^p(X) \otimes \mathbf{Q},\quad P_p(\mathcal{E}^\bullet) \in A^p(X) $$ are independent of the choice of the complex $\mathcal{E}^\bullet$. \end{lemma} 
\begin{lemma} \label{lemma-defined-by-envelope} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $E \in D(\mathcal{O}_X)$ be a perfect object. Assume there exists an envelope $f : Y \to X$ (Definition \ref{definition-envelope}) such that $Lf^*E$ is isomorphic in $D(\mathcal{O}_Y)$ to a locally bounded complex $\mathcal{E}^\bullet$ of finite locally free $\mathcal{O}_Y$-modules. Then there exists unique bivariant classes $c(E) \in \prod_{p \geq 0} A^p(X)$, $ch(E) \in \prod_{p \geq 0} A^p(X) \otimes \mathbf{Q}$, and $P_p(E) \in A^p(X)$, independent of the choice of $f : Y \to X$ and $\mathcal{E}^\bullet$, such that the restriction of these classes to $Y$ are equal to $c(\mathcal{E}^\bullet)$, $ch(\mathcal{E}^\bullet)$, and $P_p(\mathcal{E}^\bullet)$. \end{lemma} 
\begin{definition} \label{definition-defined-on-perfect} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $E \in D(\mathcal{O}_X)$ be a perfect object. \begin{enumerate} \item We say the {\it Chern classes of $E$ are defined}\footnote{See Lemma \ref{lemma-chern-classes-defined} for some criteria.} if there exists an envelope $f : Y \to X$ such that $Lf^*E$ is isomorphic in $D(\mathcal{O}_Y)$ to a locally bounded complex of finite locally free $\mathcal{O}_Y$-modules. \item If the Chern classes of $E$ are defined, then we define $$ c(E) \in \prod\nolimits_{p \geq 0} A^p(X),\quad ch(E) \in \prod\nolimits_{p \geq 0} A^p(X) \otimes \mathbf{Q},\quad P_p(E) \in A^p(X) $$ by an application of Lemma \ref{lemma-defined-by-envelope}. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-chern-classes-defined} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $E \in D(\mathcal{O}_X)$ be a perfect object. If one of the following conditions hold, then the Chern classes of $E$ are defined: \begin{enumerate} \item there exists an envelope $f : Y \to X$ such that $Lf^*E$ is isomorphic in $D(\mathcal{O}_Y)$ to a locally bounded complex of finite locally free $\mathcal{O}_Y$-modules, \item $E$ can be represented by a bounded complex of finite locally free $\mathcal{O}_X$-modules, \item the irreducible components of $X$ are quasi-compact, \item $X$ is quasi-compact, \item there exists a morphism $X \to X'$ of schemes locally of finite type over $S$ such that $E$ is the pullback of a perfect object $E'$ on $X'$ whose chern classes are defined, or \item add more here. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-chern-classes-computed} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $E \in D(\mathcal{O}_X)$ be a perfect object. Assume the Chern classes of $E$ are defined. For $g : W \to X$ locally of finite type with $W$ integral, there exists a commutative diagram $$ \xymatrix{ W' \ar[rd]_{g'} \ar[rr]_b & & W \ar[ld]^g \\ & X } $$ with $W'$ integral and $b : W' \to W$ proper birational such that $L(g')^*E$ is represented by a bounded complex $\mathcal{E}^\bullet$ of locally free $\mathcal{O}_{W'}$-modules of constant rank and we have $res(c_p(E)) = c_p(\mathcal{E}^\bullet)$ in $A^p(W')$. \end{lemma} 
\begin{lemma} \label{lemma-commutative-chern-perfect} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $E \in D(\mathcal{O}_X)$ be perfect. If the Chern classes of $E$ are defined then \begin{enumerate} \item $c_p(E)$ is in the center of the algebra $A^*(X)$, and \item if $g : X' \to X$ is locally of finite type and $c \in A^*(X' \to X)$, then $c \circ c_p(E) = c_p(Lg^*E) \circ c$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-additivity-on-perfect} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $$ E_1 \to E_2 \to E_3 \to E_1[1] $$ be a distinguished triangle of perfect objects in $D(\mathcal{O}_X)$. If one of the following conditions holds \begin{enumerate} \item there exists an envelope $f : Y \to X$ such that $Lf^*E_1 \to Lf^*E_2$ can be represented by a map of locally bounded complexes of finite locally free $\mathcal{O}_Y$-modules, \item $E_1 \to E_2$ can be represented be a map of locally bounded complexes of finite locally free $\mathcal{O}_X$-modules, \item the irreducible components of $X$ are quasi-compact, \item $X$ is quasi-compact, or \item add more here, \end{enumerate} then the Chern classes of $E_1$, $E_2$, $E_3$ are defined and we have $c(E_2) = c(E_1) c(E_3)$, $ch(E_2) = ch(E_1) + ch(E_3)$, and $P_p(E_2) = P_p(E_1) + P_p(E_3)$. \end{lemma} 
\begin{lemma} \label{lemma-chern-classes-perfect-dual} In Situation \ref{situation-setup} let $X$ be locally of finite type over $S$. Let $E \in D(\mathcal{O}_X)$ be a perfect object whose Chern classes are defined. Then $c_i(E^\vee) = (-1)^i c_i(E)$, $P_i(E^\vee) = (-1)^iP_i(E)$, and $ch_i(E^\vee) = (-1)^ich_i(E)$ in $A^i(X)$. \end{lemma} 
\begin{lemma} \label{lemma-chern-class-perfect-tensor-invertible} In Situation \ref{situation-setup} let $X$ be locally of finite type over $S$. Let $E$ be a perfect object of $D(\mathcal{O}_X)$ whose Chern classes are defined. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Then $$ c_i(E \otimes \mathcal{L}) = \sum\nolimits_{j = 0}^i \binom{r - i + j}{j} c_{i - j}(E) c_1(\mathcal{L})^j $$ provided $E$ has constant rank $r \in \mathbf{Z}$. \end{lemma} 
\begin{lemma} \label{lemma-chern-classes-perfect-tensor-product} In Situation \ref{situation-setup} let $X$ be locally of finite type over $S$. Let $E$ and $F$ be perfect objects of $D(\mathcal{O}_X)$ whose Chern classes are defined. Then we have $$ c_1(E \otimes_{\mathcal{O}_X}^\mathbf{L} F) = r(E) c_1(\mathcal{F}) + r(F) c_1(\mathcal{E}) $$ and for $c_2(E \otimes_{\mathcal{O}_X}^\mathbf{L} F)$ we have the expression $$ r(E) c_2(F) + r(F) c_2(E) + {r(E) \choose 2} c_1(F)^2 + (r(E)r(F) - 1) c_1(F)c_1(E) + {r(F) \choose 2} c_1(E)^2 $$ and so on for higher Chern classes in $A^*(X)$. Similarly, we have $ch(E \otimes_{\mathcal{O}_X}^\mathbf{L} F) = ch(E) ch(F)$ in $A^*(X) \otimes \mathbf{Q}$. More precisely, we have $$ P_p(E \otimes_{\mathcal{O}_X}^\mathbf{L} F) = \sum\nolimits_{p_1 + p_2 = p} {p \choose p_1} P_{p_1}(E) P_{p_2}(F) $$ in $A^p(X)$. \end{lemma} 
\begin{lemma} \label{lemma-silly} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $i_j : X_j \to X$, $j = 1, 2$ be closed immersions such that $X = X_1 \cup X_2$ set theoretically. Let $E_2 \in D(\mathcal{O}_{X_2})$ be a perfect object. Assume \begin{enumerate} \item Chern classes of $E_2$ are defined, \item the restriction $E_2|_{X_1 \cap X_2}$ is zero, resp.\ isomorphic to a finite locally free $\mathcal{O}_{X_1 \cap X_2}$-module of rank $< p$ sitting in cohomological degree $0$. \end{enumerate} Then there is a canonical bivariant class $$ P'_p(E_2),\text{ resp. }c'_p(E_2) \in A^p(X_2 \to X) $$ characterized by the property $$ P'_p(E_2) \cap i_{2, *} \alpha_2 = P_p(E_2) \cap \alpha_2 \quad\text{and}\quad P'_p(E_2) \cap i_{1, *} \alpha_1 = 0, $$ respectively $$ c'_p(E_2) \cap i_{2, *} \alpha_2 = c_p(E_2) \cap \alpha_2 \quad\text{and}\quad c'_p(E_2) \cap i_{1, *} \alpha_1 = 0 $$ for $\alpha_i \in \CH_k(X_i)$ and similarly after any base change $X' \to X$ locally of finite type. \end{lemma} 
\begin{lemma} \label{lemma-silly-independent} In Lemma \ref{lemma-silly} the bivariant class $P'_p(E_2)$, resp.\ $c'_p(E_2)$ in $A^p(X_2 \to X)$ does not depend on the choice of $X_1$. \end{lemma} 
\begin{lemma} \label{lemma-base-change-silly} In Lemma \ref{lemma-silly} let $X' \to X$ be a morphism which is locally of finite type. Denote $X' = X'_1 \cup X'_2$ and $E'_2 \in D(\mathcal{O}_{X'_2})$ the pullbacks to $X'$. Then the class $P'_p(E_2')$, resp.\ $c'_p(E_2')$ in $A^p(X_2' \to X')$ constructed in Lemma \ref{lemma-silly} using $X' = X'_1 \cup X'_2$ and $E_2'$ is the restriction (Remark \ref{remark-restriction-bivariant}) of the class $P'_p(E_2)$, resp.\ $c'_p(E_2)$ in $A^p(X_2 \to X)$. \end{lemma} 
\begin{lemma} \label{lemma-silly-silly} In Lemma \ref{lemma-silly} say $E_2$ is the restriction of a perfect $E \in D(\mathcal{O}_X)$ such that $E|_{X_1}$ is zero, resp.\ isomorphic to a finite locally free $\mathcal{O}_{X_1}$-module of rank $< p$ sitting in cohomological degree $0$. If Chern classes of $E$ are defined, then $i_{2, *} \circ P'_p(E_2) = P_p(E)$, resp.\ $i_{2, *} \circ c'_p(E_2) = c_p(E)$ (with $\circ$ as in Lemma \ref{lemma-push-proper-bivariant}). \end{lemma} 
\begin{lemma} \label{lemma-silly-shrink} In Lemma \ref{lemma-silly} suppose we have closed subschemes $X'_2 \subset X_2$ and $X_1 \subset X'_1 \subset X$ such that $X = X'_1 \cup X'_2$ set theoretically. Assume $E_2|_{X'_1 \cap X_2}$ is zero, resp.\ isomorphic to a finite locally free module of rank $< p$ placed in degree $0$. Then we have $(X'_2 \to X_2)_* \circ P'_p(E_2|_{X'_2}) = P'_p(E_2)$, resp.\  $(X'_2 \to X_2)_* \circ c'_p(E_2|_{X'_2}) = c_p(E_2)$ (with $\circ$ as in Lemma \ref{lemma-push-proper-bivariant}). \end{lemma} 
\begin{lemma} \label{lemma-silly-commutes} In Lemma \ref{lemma-silly} let $f : Y \to X$ be locally of finite type and say $c \in A^*(Y \to X)$. Then $$ c \circ P'_p(E_2) = P'_p(Lf_2^*E_2) \circ c \quad\text{resp.}\quad c \circ c'_p(E_2) = c'_p(Lf_2^*E_2) \circ c $$ in $A^*(Y_2 \to Y)$ where $f_2 : Y_2 \to X_2$ is the base change of $f$. \end{lemma} 
\begin{lemma} \label{lemma-silly-compose} In Lemma \ref{lemma-silly} assume $E_2|_{X_1 \cap X_2}$ is zero. Then \begin{align*} P'_1(E_2) & = c'_1(E_2), \\ P'_2(E_2) & = c'_1(E_2)^2 - 2c'_2(E_2), \\ P'_3(E_2) & = c'_1(E_2)^3 - 3c'_1(E_2)c'_2(E_2) + 3c'_3(E_2), \\ P'_4(E_2) & = c'_1(E_2)^4 - 4c'_1(E_2)^2c'_2(E_2) + 4c'_1(E_2)c'_3(E_2) + 2c'_2(E_2)^2 - 4c'_4(E_2), \end{align*} and so on with multiplication as in Remark \ref{remark-ring-loc-classes}. \end{lemma} 
\begin{lemma} \label{lemma-silly-sum-c} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $i_j : X_j \to X$, $j = 1, 2$ be closed immersions such that $X = X_1 \cup X_2$ set theoretically. Let $E, F \in D(\mathcal{O}_X)$ be perfect objects. Assume \begin{enumerate} \item Chern classes of $E$ and $F$ are defined, \item the restrictions $E|_{X_1 \cap X_2}$ and $F|_{X_1 \cap X_2}$ are isomorphic to a finite locally free $\mathcal{O}_{X_1}$-modules of rank $< p$ and $< q$ sitting in cohomological degree $0$. \end{enumerate} With notation as in Remark \ref{remark-ring-loc-classes} set $$ c^{(p)}(E) = 1 + c_1(E) + \ldots + c_{p - 1}(E) + c'_p(E|_{X_2}) + c'_{p + 1}(E|_{X_2}) + \ldots \in A^{(p)}(X_2 \to X) $$ with $c'_p(E|_{X_2})$ as in Lemma \ref{lemma-silly}. Similarly for $c^{(q)}(F)$ and $c^{(p + q)}(E \oplus F)$. Then $c^{(p + q)}(E \oplus F) = c^{(p)}(E)c^{(q)}(F)$ in $A^{(p + q)}(X_2 \to X)$. \end{lemma} 
\begin{lemma} \label{lemma-silly-sum-P} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $i_j : X_j \to X$, $j = 1, 2$ be closed immersions such that $X = X_1 \cup X_2$ set theoretically. Let $E, F \in D(\mathcal{O}_{X_2})$ be perfect objects. Assume \begin{enumerate} \item Chern classes of $E$ and $F$ are defined, \item the restrictions $E|_{X_1 \cap X_2}$ and $F|_{X_1 \cap X_2}$ are zero, \end{enumerate} Denote $P'_p(E), P'_p(F), P'_p(E \oplus F) \in A^p(X_2 \to X)$ for $p \geq 0$ the classes constructed in Lemma \ref{lemma-silly}. Then $P'_p(E \oplus F) = P'_p(E) + P'_p(F)$. \end{lemma} 
\begin{lemma} \label{lemma-silly-tensor-invertible} In Lemma \ref{lemma-silly} assume $E_2$ has constant rank $0$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Then $$ c'_i(E_2 \otimes \mathcal{L}) = \sum\nolimits_{j = 0}^i \binom{- i + j}{j} c'_{i - j}(E_2) c_1(\mathcal{L})^j $$ \end{lemma} 
\begin{lemma} \label{lemma-silly-tensor-product} In Situation \ref{situation-setup} let $X$ be locally of finite type over $S$. Let $$ X = X_1 \cup X_2 = X'_1 \cup X'_2 $$ be two ways of writing $X$ as a set theoretic union of closed subschemes. Let $E$, $E'$ be perfect objects of $D(\mathcal{O}_X)$ whose Chern classes are defined. Assume that $E|_{X_1}$ and $E'|_{X'_1}$ are zero\footnote{Presumably there is a variant of this lemma where we only assume these restrictions are isomorphic to a finite locally free modules of rank $< p$ and $< p'$.} for $i = 1, 2$. Denote \begin{enumerate} \item $r = P'_0(E) \in A^0(X_2 \to X)$ and $r' = P'_0(E') \in A^0(X'_2 \to X)$, \item $\gamma_p = c'_p(E|_{X_2}) \in A^p(X_2 \to X)$ and $\gamma'_p = c'_p(E'|_{X'_2}) \in A^p(X'_2 \to X)$, \item $\chi_p = P'_p(E|_{X_2}) \in A^p(X_2 \to X)$ and $\chi'_p = P'_p(E'|_{X'_2}) \in A^p(X'_2 \to X)$ \end{enumerate} the classes constructed in Lemma \ref{lemma-silly}. Then we have $$ c'_1((E \otimes_{\mathcal{O}_X}^\mathbf{L} E')|_{X_2 \cap X'_2}) = r \gamma'_1 + r' \gamma_1 $$ in $A^1(X_2 \cap X'_2 \to X)$ and $$ c'_2((E \otimes_{\mathcal{O}_X}^\mathbf{L} E')|_{X_2 \cap X'_2}) = r \gamma'_2 + r' \gamma_2 + {r \choose 2} (\gamma'_1)^2 + (rr' - 1) \gamma'_1\gamma_1 + {r' \choose 2} \gamma_1^2 $$ in $A^2(X_2 \cap X'_2 \to X)$ and so on for higher Chern classes. Similarly, we have $$ P'_p((E \otimes_{\mathcal{O}_X}^\mathbf{L} E')|_{X_2 \cap X'_2}) = \sum\nolimits_{p_1 + p_2 = p} {p \choose p_1} \chi_{p_1} \chi'_{p_2} $$ in $A^p(X_2 \cap X'_2 \to X)$. \end{lemma} 
\begin{lemma} \label{lemma-gysin-at-infty} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $b : W \to \mathbf{P}^1_X$ be a proper morphism of schemes which is an isomorphism over $\mathbf{A}^1_X$. Denote $i_\infty : W_\infty \to W$ the inverse image of the divisor $D_\infty \subset \mathbf{P}^1_X$ with complement $\mathbf{A}^1_X$. Then there is a canonical bivariant class $$ C \in A^0(W_\infty \to X) $$ with the property that $i_{\infty, *}(C \cap \alpha) = i_{0, *}\alpha$ for $\alpha \in \CH_k(X)$ and similarly after any base change by $X' \to X$ locally of finite type. \end{lemma} 
\begin{lemma} \label{lemma-base-change-gysin-at-infty} In Lemma \ref{lemma-gysin-at-infty} let $X' \to X$ be a morphism which is locally of finite type. Denote $b' : W' \to \mathbf{P}^1_{X'}$ and $i'_\infty : W'_\infty \to W'$ the base changes of $b$ and $i_\infty$. Then the class $C' \in A^0(W'_\infty \to X')$ constructed as in Lemma \ref{lemma-gysin-at-infty} using $b'$ is the restriction (Remark \ref{remark-restriction-bivariant}) of $C$. \end{lemma} 
\begin{lemma} \label{lemma-gysin-at-infty-independent} In Lemma \ref{lemma-gysin-at-infty} let $g : W' \to W$ be a proper morphism which is an isomorphism over $\mathbf{A}^1_X$. Let $C' \in A^0(W'_\infty \to X)$ and $C \in A^0(W_\infty \to X)$ be the classes constructed in Lemma \ref{lemma-gysin-at-infty}. Then $g_{\infty, *} \circ C' = C$ in $A^0(W_\infty \to X)$. \end{lemma} 
\begin{lemma} \label{lemma-homomorphism-pre} In Lemma \ref{lemma-gysin-at-infty} we have $C \circ (W_\infty \to X)_* \circ i_\infty^* = i_\infty^*$. \end{lemma} 
\begin{lemma} \label{lemma-gysin-at-infty-commutes} In Lemma \ref{lemma-gysin-at-infty} let $f : Y \to X$ be a morphism locally of finite type and $c \in A^*(Y \to X)$. Then $C \circ c = c \circ C$ in $A^*(W_\infty \times_X Y \to X)$. \end{lemma} 
\begin{lemma} \label{lemma-localized-chern-pre} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $Z \subset X$ be a closed subscheme. Let $$ b : W \longrightarrow \mathbf{P}^1_X $$ be a proper morphism of schemes. Let $Q \in D(\mathcal{O}_W)$ be a perfect object. Denote $W_\infty \subset W$ the inverse image of the divisor $D_\infty \subset \mathbf{P}^1_X$ with complement $\mathbf{A}^1_X$. We assume \begin{enumerate} \item[(A0)] Chern classes of $Q$ are defined (Section \ref{section-pre-derived}), \item[(A1)] $b$ is an isomorphism over $\mathbf{A}^1_X$, \item[(A2)] there exists a closed subscheme $T \subset W_\infty$ containing all points of $W_\infty$ lying over $X \setminus Z$ such that $Q|_T$ is zero, resp.\ isomorphic to a finite locally free $\mathcal{O}_T$-module of rank $< p$ sitting in cohomological degree $0$. \end{enumerate} Then there exists a canonical bivariant class $$ P'_p(Q),\text{ resp. }c'_p(Q) \in A^p(Z \to X) $$ with $(Z \to X)_* \circ P'_p(Q) = P_p(Q|_{X \times \{0\}})$, resp.\ $(Z \to X)_* \circ c'_p(Q) = c_p(Q|_{X \times \{0\}})$. \end{lemma} 
\begin{lemma} \label{lemma-base-change-localized-chern-pre} In Lemma \ref{lemma-localized-chern-pre} let $X' \to X$ be a morphism which is locally of finite type. Denote $Z'$, $b' : W' \to \mathbf{P}^1_{X'}$, and $T' \subset W'_\infty$ the base changes of $Z$, $b : W \to \mathbf{P}^1_X$, and $T \subset W_\infty$. Set $Q' = (W' \to W)^*Q$. Then the class $P'_p(Q')$, resp.\ $c'_p(Q')$ in $A^p(Z' \to X')$ constructed as in Lemma \ref{lemma-localized-chern-pre} using $b'$, $Q'$, and $T'$ is the restriction (Remark \ref{remark-restriction-bivariant}) of the class $P'_p(Q)$, resp.\ $c'_p(Q)$ in $A^p(Z \to X)$. \end{lemma} 
\begin{lemma} \label{lemma-localized-chern-pre-independent} In Lemma \ref{lemma-localized-chern-pre} the bivariant class $P'_p(Q)$, resp.\ $c'_p(Q)$ is independent of the choice of the closed subscheme $T$. Moreover, given a proper morphism $g : W' \to W$ which is an isomorphism over $\mathbf{A}^1_X$, then setting $Q' = g^*Q$ we have $P'_p(Q) = P'_p(Q')$, resp.\ $c'_p(Q) = c'_p(Q')$. \end{lemma} 
\begin{lemma} \label{lemma-homomorphism} In Lemma \ref{lemma-localized-chern-pre} assume $Q|_T$ is isomorphic to a finite locally free $\mathcal{O}_T$-module of rank $< p$. Denote $C \in A^0(W_\infty \to X)$ the class of Lemma \ref{lemma-gysin-at-infty}. Then $$ C \circ c_p(Q|_{X \times \{0\}}) = C \circ (Z \to X)_* \circ c'_p(Q) = c_p(Q|_{W_\infty}) \circ C $$ \end{lemma} 
\begin{lemma} \label{lemma-homomorphism-commute} In Lemma \ref{lemma-localized-chern-pre} let $Y \to X$ be a morphism locally of finite type and let $c \in A^*(Y \to X)$ be a bivariant class. Then $$ P'_p(Q) \circ c = c \circ P'_p(Q) \quad\text{resp.}\quad c'_p(Q) \circ c = c \circ c'_p(Q) $$ in $A^*(Y \times_X Z \to X)$. \end{lemma} 
\begin{lemma} \label{lemma-localized-chern-pre-compose} In Lemma \ref{lemma-localized-chern-pre} assume $Q|_T$ is zero. In $A^*(Z \to X)$ we have \begin{align*} P'_1(Q) & = c'_1(Q), \\ P'_2(Q) & = c'_1(Q)^2 - 2c'_2(Q), \\ P'_3(Q) & = c'_1(Q)^3 - 3c'_1(Q)c'_2(Q) + 3c'_3(Q), \\ P'_4(Q) & = c'_1(Q)^4 - 4c'_1(Q)^2c'_2(Q) + 4c'_1(Q)c'_3(Q) + 2c'_2(Q)^2 - 4c'_4(Q), \end{align*} and so on with multiplication as in Remark \ref{remark-ring-loc-classes}. \end{lemma} 
\begin{lemma} \label{lemma-localized-chern-pre-sum-c} In Lemma \ref{lemma-localized-chern-pre} assume $Q|_T$ is isomorphic to a finite locally free $\mathcal{O}_T$-module of rank $< p$. Assume we have another perfect object $Q' \in D(\mathcal{O}_W)$ whose Chern classes are defined with $Q'|_T$ isomorphic to a finite locally free $\mathcal{O}_T$-module of rank $< p'$ placed in cohomological degree $0$. With notation as in Remark \ref{remark-ring-loc-classes} set $$ c^{(p)}(Q) = 1 + c_1(Q|_{X \times \{0\}}) + \ldots + c_{p - 1}(Q|_{X \times \{0\}}) + c'_{p}(Q) + c'_{p + 1}(Q) + \ldots $$ in $A^{(p)}(Z \to X)$ with $c'_i(Q)$ for $i \geq p$ as in Lemma \ref{lemma-localized-chern-pre}. Similarly for $c^{(p')}(Q')$ and $c^{(p + p')}(Q \oplus Q')$. Then $c^{(p + p')}(Q \oplus Q') = c^{(p)}(Q)c^{(p')}(Q')$ in $A^{(p + p')}(Z \to X)$. \end{lemma} 
\begin{lemma} \label{lemma-localized-chern-pre-sum-P} In Lemma \ref{lemma-localized-chern-pre} assume $Q|_T$ is zero. Assume we have another perfect object $Q' \in D(\mathcal{O}_W)$ whose Chern classes are defined such that the restriction $Q'|_T$ is zero. In this case the classes $P'_p(Q), P'_p(Q'), P'_p(Q \oplus Q') \in A^p(Z \to X)$ constructed in Lemma \ref{lemma-localized-chern-pre} satisfy $P'_p(Q \oplus Q') = P'_p(Q) + P'_p(Q')$. \end{lemma} 
\begin{lemma} \label{lemma-independent-loc-chern} In Situation \ref{situation-loc-chern} there exists a canonical bivariant class $$ P_p(Z \to X, E) \in A^p(Z \to X), \quad\text{resp.}\quad c_p(Z \to X, E) \in A^p(Z \to X) $$ with the property that \begin{equation} \label{equation-defining-property-localized-classes} i_* \circ P_p(Z \to X, E) = P_p(E), \quad\text{resp.}\quad i_* \circ c_p(Z \to X, E) = c_p(E) \end{equation} as bivariant classes on $X$ (with $\circ$ as in Lemma \ref{lemma-push-proper-bivariant}). \end{lemma} 
\begin{definition} \label{definition-localized-chern} With $(S, \delta)$, $X$, $E \in D(\mathcal{O}_X)$, and $i : Z \to X$ as in Situation \ref{situation-loc-chern}. \begin{enumerate} \item If the restriction $E|_{X \setminus Z}$ is zero, then for all $p \geq 0$ we define $$ P_p(Z \to X, E) \in A^p(Z \to X) $$ by the construction in Lemma \ref{lemma-independent-loc-chern} and we define the {\it localized Chern character} by the formula $$ ch(Z \to X, E) = \sum\nolimits_{p = 0, 1, 2, \ldots} \frac{P_p(Z \to X, E)}{p!} \quad\text{in}\quad \prod\nolimits_{p \geq 0} A^p(Z \to X) \otimes \mathbf{Q} $$ \item If the restriction $E|_{X \setminus Z}$ is isomorphic to a finite locally free $\mathcal{O}_{X \setminus Z}$-module of rank $< p$ sitting in cohomological degree $0$, then we define the {\it localized $p$th Chern class} $c_p(Z \to X, E)$ by the construction in Lemma \ref{lemma-independent-loc-chern}. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-base-change-loc-chern} In Situation \ref{situation-loc-chern} let $f : X' \to X$ be a morphism of schemes which is locally of finite type. Denote $E' = f^*E$ and $Z' = f^{-1}(Z)$. Then the bivariant class of Definition \ref{definition-localized-chern} $$ P_p(Z' \to X', E') \in A^p(Z' \to X'), \quad\text{resp.}\quad c_p(Z' \to X', E') \in A^p(Z' \to X') $$ constructed as in Lemma \ref{lemma-independent-loc-chern} using $X', Z', E'$ is the restriction (Remark \ref{remark-restriction-bivariant}) of the bivariant class $P_p(Z \to X, E) \in A^p(Z \to X)$, resp.\ $c_p(Z \to X, E) \in A^p(Z \to X)$. \end{lemma} 
\begin{lemma} \label{lemma-loc-chern-after-pushforward} In Situation \ref{situation-loc-chern} we have $$ P_p(Z \to X, E) \cap i_*\alpha = P_p(E|_Z) \cap \alpha, \quad\text{resp.}\quad c_p(Z \to X, E) \cap i_*\alpha = c_p(E|_Z) \cap \alpha $$ in $\CH_*(Z)$ for any $\alpha \in \CH_*(Z)$. \end{lemma} 
\begin{lemma} \label{lemma-loc-chern-disjoint} In Situation \ref{situation-loc-chern} if $\alpha \in \CH_k(X)$ has support disjoint from $Z$, then $P_p(Z \to X, E) \cap \alpha = 0$, resp.\ $c_p(Z \to X, E) \cap \alpha = 0$. \end{lemma} 
\begin{lemma} \label{lemma-loc-chern-shrink-Z} In Situation \ref{situation-loc-chern} assume $Z \subset Z' \subset X$ where $Z'$ is a closed subscheme of $X$. Then $P_p(Z' \to X, E) = (Z \to Z')_* \circ P_p(Z \to X, E)$, resp.\ $c_p(Z' \to X, E) = (Z \to Z')_* \circ c_p(Z \to X, E)$ (with $\circ$ as in Lemma \ref{lemma-push-proper-bivariant}). \end{lemma} 
\begin{lemma} \label{lemma-loc-chern-agree} In Lemma \ref{lemma-silly} say $E_2$ is the restriction of a perfect $E \in D(\mathcal{O}_X)$ whose restriction to $X_1$ is zero, resp.\ isomorphic to a finite locally free $\mathcal{O}_{X_1}$-module of rank $< p$ sitting in cohomological degree $0$. Then the class $P'_p(E_2)$, resp.\ $c'_p(E_2)$ of Lemma \ref{lemma-silly} agrees with $P_p(X_2 \to X, E)$, resp.\ $c_p(X_2 \to X, E)$ of Definition \ref{definition-localized-chern} provided $E$ satisfies assumption (3) of Situation \ref{situation-loc-chern}. \end{lemma} 
\begin{lemma} \label{lemma-homomorphism-final} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $b : W \longrightarrow \mathbf{P}^1_X$ be a proper morphism of schemes. Let $n \geq 1$. For $i = 1, \ldots, n$ let $Z_i \subset X$ be a closed subscheme, let $Q_i \in D(\mathcal{O}_W)$ be a perfect object, let $p_i \geq 0$ be an integer, and let $T_i \subset W_\infty$, $i = 1, \ldots, n$ be closed. Denote $W_i = b^{-1}(\mathbf{P}^1_{Z_i})$. Assume \begin{enumerate} \item for $i = 1, \ldots, n$ the assumption of Lemma \ref{lemma-localized-chern-pre} hold for $b, Z_i, Q_i, T_i, p_i$, \item $Q_i|_{W \setminus W_i}$ is zero, resp.\ isomorphic to a finite locally free module of rank $< p_i$ placed in cohomological degree $0$, \item $Q_i$ on $W$ satisfies assumption (3) of Situation \ref{situation-loc-chern}. \end{enumerate} Then $P'_{p_n}(Q_n) \circ \ldots \circ P'_{p_1}(Q_1)$ is equal to $$ (W_{n, \infty} \cap \ldots \cap W_{1, \infty} \to Z_n \cap \ldots \cap Z_1)_* \circ P'_{p_n}(Q_n|_{W_{n, \infty}}) \circ \ldots \circ P'_{p_1}(Q_1|_{W_{1, \infty}}) \circ C $$ in $A^{p_n + \ldots + p_1}(Z_n \cap \ldots \cap Z_1 \to X)$, resp.\ $c'_{p_n}(Q_n) \circ \ldots \circ c'_{p_1}(Q_1)$ is equal to $$ (W_{n, \infty} \cap \ldots \cap W_{1, \infty} \to Z_n \cap \ldots \cap Z_1)_* \circ c'_{p_n}(Q_n|_{W_{n, \infty}}) \circ \ldots \circ c'_{p_1}(Q_1|_{W_{1, \infty}}) \circ C $$ in $A^{p_n + \ldots + p_1}(Z_n \cap \ldots \cap Z_1 \to X)$. \end{lemma} 
\begin{lemma} \label{lemma-independent-loc-chern-bQ} Assume $(S, \delta), X, Z, b : W \to \mathbf{P}^1_X, Q, T, p$ satisfy the assumptions of Lemma \ref{lemma-localized-chern-pre}. Let $F \in D(\mathcal{O}_X)$ be a perfect object such that \begin{enumerate} \item the restriction of $Q$ to $b^{-1}(\mathbf{A}^1_X)$ is isomorphic to the pullback of $F$, \item $F|_{X \setminus Z}$ is zero, resp.\ isomorphic to a finite locally free $\mathcal{O}_{X \setminus Z}$-module of rank $< p$ sitting in cohomological degree $0$, and \item $Q$ on $W$ and $F$ on $X$ satisfy assumption (3) of Situation \ref{situation-loc-chern}. \end{enumerate} Then the class $P'_p(Q)$, resp.\ $c'_p(Q)$ in $A^p(Z \to X)$ constructed in Lemma \ref{lemma-localized-chern-pre} is equal to $P_p(Z \to X, F)$, resp.\ $c_p(Z \to X, F)$ from Definition \ref{definition-localized-chern}. \end{lemma} 
\begin{lemma} \label{lemma-loc-chern-character} In Situation \ref{situation-loc-chern} assume $E|_{X \setminus Z}$ is zero. Then \begin{align*} P_1(Z \to X, E) & = c_1(Z \to X, E), \\ P_2(Z \to X, E) & = c_1(Z \to X, E)^2 - 2c_2(Z \to X, E), \\ P_3(Z \to X, E) & = c_1(Z \to X, E)^3 - 3c_1(Z \to X, E)c_2(Z \to X, E) + 3c_3(Z \to X, E), \end{align*} and so on where the products are taken in the algebra $A^{(1)}(Z \to X)$ of Remark \ref{remark-ring-loc-classes}. \end{lemma} 
\begin{lemma} \label{lemma-loc-chern-classes-commute} In Situation \ref{situation-loc-chern} let $Y \to X$ be locally of finite type and $c \in A^*(Y \to X)$. Then $$ P_p(Z \to X, E) \circ c = c \circ P_p(Z \to X, E), $$ respectively $$ c_p(Z \to X, E) \circ c = c \circ c_p(Z \to X, E) $$ in $A^*(Y \times_X Z \to X)$. \end{lemma} 
\begin{lemma} \label{lemma-additivity-loc-chern-c} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $Z \to X$ be a closed immersion. Let $$ E_1 \to E_2 \to E_3 \to E_1[1] $$ be a distinguished triangle of perfect objects in $D(\mathcal{O}_X)$. Assume \begin{enumerate} \item the restrictions $E_1|_{X \setminus Z}$ and $E_3|_{X \setminus Z}$ are isomorphic to finite locally free $\mathcal{O}_{X \setminus Z}$-modules of rank $< p_1$ and $< p_3$ placed in degree $0$, and \item at least one of the following is true: (a) $X$ is quasi-compact, (b) $X$ has quasi-compact irreducible components, (c) $E_3 \to E_1[1]$ can be represented by a map of locally bounded complexes of finite locally free $\mathcal{O}_X$-modules, or (d) there exists an envelope $f : Y \to X$ such that $Lf^*E_3 \to Lf^*E_1[1]$ can be represented by a map of locally bounded complexes of finite locally free $\mathcal{O}_Y$-modules. \end{enumerate} With notation as in Remark \ref{remark-loc-chern-classes} we have $$ c^{(p_1 + p_3)}(Z \to X, E_2) = c^{(p_1)}(Z \to X, E_1)c^{(p_3)}(Z \to X, E_3) $$ in $A^{(p_1 + p_3)}(Z \to X)$. \end{lemma} 
\begin{lemma} \label{lemma-additivity-loc-chern-P} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $Z \to X$ be a closed immersion. Let $$ E_1 \to E_2 \to E_3 \to E_1[1] $$ be a distinguished triangle of perfect objects in $D(\mathcal{O}_X)$. Assume \begin{enumerate} \item the restrictions $E_1|_{X \setminus Z}$ and $E_3|_{X \setminus Z}$ are zero, and \item at least one of the following is true: (a) $X$ is quasi-compact, (b) $X$ has quasi-compact irreducible components, (c) $E_3 \to E_1[1]$ can be represented by a map of locally bounded complexes of finite locally free $\mathcal{O}_X$-modules, or (d) there exists an envelope $f : Y \to X$ such that $Lf^*E_3 \to Lf^*E_1[1]$ can be represented by a map of locally bounded complexes of finite locally free $\mathcal{O}_Y$-modules. \end{enumerate} Then we have $$ P_p(Z \to X, E_2) = P_p(Z \to X, E_1) + P_p(Z \to X, E_3) $$ for all $p \in \mathbf{Z}$ and consequently $ch(Z \to X, E_2) = ch(Z \to X, E_1) + ch(Z \to X, E_3)$. \end{lemma} 
\begin{lemma} \label{lemma-loc-chern-tensor-product} In Situation \ref{situation-setup} let $X$ be locally of finite type over $S$. Let $Z_i \subset X$, $i = 1, 2$ be closed subschemes. Let $F_i$, $i = 1, 2$ be perfect objects of $D(\mathcal{O}_X)$. Assume for $i = 1, 2$ that $F_i|_{X \setminus Z_i}$ is zero\footnote{Presumably there is a variant of this lemma where we only assume $F_i|_{X \setminus Z_i}$ is isomorphic to a finite locally free $\mathcal{O}_{X \setminus Z_i}$-module of rank $< p_i$.} and that $F_i$ on $X$ satisfies assumption (3) of Situation \ref{situation-loc-chern}. Denote $r_i = P_0(Z_i \to X, F_i) \in A^0(Z_i \to X)$. Then we have $$ c_1(Z_1 \cap Z_2 \to X, F_1 \otimes_{\mathcal{O}_X}^\mathbf{L} F_2) = r_1 c_1(Z_2 \to X, F_2) + r_2 c_1(Z_1 \to X, F_1) $$ in $A^1(Z_1 \cap Z_2 \to X)$ and \begin{align*} c_2(Z_1 \cap Z_2 \to X, F_1 \otimes_{\mathcal{O}_X}^\mathbf{L} F_2) & = r_1 c_2(Z_2 \to X, F_2) + r_2 c_2(Z_1 \to X, F_1) + \\ & {r_1 \choose 2} c_1(Z_2 \to X, F_2)^2 + \\ & (r_1r_2 - 1) c_1(Z_2 \to X, F_2)c_1(Z_1 \to X, F_1) + \\ & {r_2 \choose 2} c_1(Z_1 \to X, F_1)^2 \end{align*} in $A^2(Z_1 \cap Z_2 \to X)$ and so on for higher Chern classes. Similarly, we have $$ ch(Z_1 \cap Z_2 \to X, F_1 \otimes_{\mathcal{O}_X}^\mathbf{L} F_2) = ch(Z_1 \to X, F_1) ch(Z_2 \to X, F_2) $$ in $\prod_{p \geq 0} A^p(Z_1 \cap Z_2 \to X) \otimes \mathbf{Q}$. More precisely, we have $$ P_p(Z_1 \cap Z_2 \to X, F_1 \otimes_{\mathcal{O}_X}^\mathbf{L} F_2) = \sum\nolimits_{p_1 + p_2 = p} {p \choose p_1} P_{p_1}(Z_1 \to X, F_1) P_{p_2}(Z_2 \to X, F_2) $$ in $A^p(Z_1 \cap Z_2 \to X)$. \end{lemma} 
\begin{lemma} \label{lemma-pullback-virtual-normal-sheaf} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $$ \xymatrix{ Z' \ar[r] \ar[d]_g & X' \ar[d]^f \\ Z \ar[r] & X } $$ be a cartesian diagram of schemes locally of finite type over $S$ whose horizontal arrows are closed immersions. If $\mathcal{N}$ is a virtual normal sheaf for $Z$ in $X$, then $\mathcal{N}' = g^*\mathcal{N}$ is a virtual normal sheaf for $Z'$ in $X'$. \end{lemma} 
\begin{lemma} \label{lemma-construction-gysin} The construction above defines a bivariant class\footnote{The notation $A^*(Z \to X)^\wedge$ is discussed in Remark \ref{remark-completion-bivariant}. If $X$ is quasi-compact, then $A^*(Z \to X)^\wedge = A^*(Z \to X)$.} $$ c(Z \to X, \mathcal{N}) \in A^*(Z \to X)^\wedge $$ and moreover the construction is compatible with base change as in Lemma \ref{lemma-pullback-virtual-normal-sheaf}. If $\mathcal{N}$ has constant rank $r$, then $c(Z \to X, \mathcal{N}) \in A^r(Z \to X)$. \end{lemma} 
\begin{lemma} \label{lemma-gysin-decompose} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be a scheme locally of finite type over $S$. Let $\mathcal{N}$ be a virtual normal sheaf for a closed subscheme $Z$ of $X$. Suppose that we have a short exact sequence $0 \to \mathcal{N}' \to \mathcal{N} \to \mathcal{E} \to 0$ of finite locally free $\mathcal{O}_Z$-modules such that the given surjection $\sigma : \mathcal{N}^\vee \to \mathcal{C}_{Z/X}$ factors through a map $\sigma' : (\mathcal{N}')^\vee \to \mathcal{C}_{Z/X}$. Then $$ c(Z \to X, \mathcal{N}) = c_{top}(\mathcal{E}) \circ c(Z \to X, \mathcal{N}') $$ as bivariant classes. \end{lemma} 
\begin{lemma} \label{lemma-gysin-excess} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Consider a cartesian diagram $$ \xymatrix{ Z' \ar[r] \ar[d]_g & X' \ar[d]^f \\ Z \ar[r] & X } $$ of schemes locally of finite type over $S$ whose horizontal arrows are closed immersions. Let $\mathcal{N}$, resp.\ $\mathcal{N}'$ be a virtual normal sheaf for $Z \subset X$, resp.\ $Z' \to X'$. Assume given a short exact sequence $0 \to \mathcal{N}' \to g^*\mathcal{N} \to \mathcal{E} \to 0$ of finite locally free modules on $Z'$ such that the diagram $$ \xymatrix{ g^*\mathcal{N}^\vee \ar[r] \ar[d] & (\mathcal{N}')^\vee \ar[d] \\ g^*\mathcal{C}_{Z/X} \ar[r] & \mathcal{C}_{Z'/X'} } $$ commutes. Then we have $$ res(c(Z \to X, \mathcal{N})) = c_{top}(\mathcal{E}) \circ c(Z' \to X', \mathcal{N}') $$ in $A^*(Z' \to X')^\wedge$. \end{lemma} 
\begin{lemma} \label{lemma-gysin-fundamental} In the situation described just above assume $\dim_\delta(Y) = n$ and that $\mathcal{C}_{Y \times_X Z/Z}$ has constant rank $r$. Then $$ c(Z \to X, \mathcal{N}) \cap [Y]_n = c_{top}(\mathcal{E}) \cap [Z \times_X Y]_{n - r} $$ in $\CH_*(Z \times_X Y)$. \end{lemma} 
\begin{lemma} \label{lemma-gysin-easy} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be a scheme locally of finite type over $S$. Let $\mathcal{N}$ be a virtual normal sheaf for a closed subscheme $Z$ of $X$. Let $Y \to X$ be a morphism which is locally of finite type. Given integers $r$, $n$ assume \begin{enumerate} \item $\mathcal{N}$ is locally free of rank $r$, \item every irreducible component of $Y$ has $\delta$-dimension $n$, \item $\dim_\delta(Z \times_X Y) \leq n - r$, and \item for $\xi \in Z \times_X Y$ with $\delta(\xi) = n - r$ the local ring $\mathcal{O}_{Y, \xi}$ is Cohen-Macaulay. \end{enumerate} Then $c(Z \to X, \mathcal{N}) \cap [Y]_n = [Z \times_X Y]_{n - r}$ in $\CH_{n - r}(Z \times_X Y)$. \end{lemma} 
\begin{lemma} \label{lemma-gysin-agrees} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be a scheme locally of finite type over $S$. Let $(\mathcal{L}, s, i : D \to X)$ be a triple as in Definition \ref{definition-gysin-homomorphism}. The gysin homomorphism $i^*$ viewed as an element of $A^1(D \to X)$ (see Lemma \ref{lemma-gysin-bivariant}) is the same as the bivariant class $c(D \to X, \mathcal{N}) \in A^1(D \to X)$ constructed using $\mathcal{N} = i^*\mathcal{L}$ viewed as a virtual normal sheaf for $D$ in $X$. \end{lemma} 
\begin{lemma} \label{lemma-gysin-commutes} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be a scheme locally of finite type over $S$. Let $Z \subset X$ be a closed subscheme with virtual normal sheaf $\mathcal{N}$. Let $Y \to X$ be locally of finite type and $c \in A^*(Y \to X)$. Then $c$ and $c(Z \to X, \mathcal{N})$ commute (Remark \ref{remark-bivariant-commute}). \end{lemma} 
\begin{lemma} \label{lemma-relation-normal-cones} With notation as above we have $$ o^*[C_ZX]_n = [C_Z Y]_{n - 1} $$ in $\CH_{n - 1}(Y \times_{o, C_Y X} C_ZX)$. \end{lemma} 
\begin{lemma} \label{lemma-gysin-composition} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $Z \subset Y \subset X$ be closed subschemes of a scheme locally of finite type over $S$. Let $\mathcal{N}$ be a virtual normal sheaf for $Z \subset X$. Let $\mathcal{N}'$ be a virtual normal sheaf for $Z \subset Y$. Let $\mathcal{N}''$ be a virtual normal sheaf for $Y \subset X$. Assume there is a commutative diagram $$ \xymatrix{ (\mathcal{N}'')^\vee|_Z \ar[r] \ar[d] & \mathcal{N}^\vee \ar[r] \ar[d] & (\mathcal{N}')^\vee \ar[d] \\ \mathcal{C}_{Y/X}|_Z \ar[r] & \mathcal{C}_{Z/X} \ar[r] & \mathcal{C}_{Z/Y} } $$ where the sequence at the bottom is from More on Morphisms, Lemma \ref{more-morphisms-lemma-transitivity-conormal} and the top sequence is a short exact sequence. Then $$ c(Z \to X, \mathcal{N}) = c(Z \to Y, \mathcal{N}') \circ c(Y \to X, \mathcal{N}'') $$ in $A^*(Z \to X)^\wedge$. \end{lemma} 
\begin{lemma} \label{lemma-compute-koszul} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be a scheme locally of finite type over $S$. Let $\mathcal{E}$ be a locally free $\mathcal{O}_X$-module of rank $r$. Then $$ \prod\nolimits_{n = 0, \ldots, r} c(\wedge^n \mathcal{E})^{(-1)^n} = 1 - (r - 1)! c_r(\mathcal{E}) + \ldots $$ \end{lemma} 
\begin{lemma} \label{lemma-compute-section} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be a scheme locally of finite type over $S$. Let $\mathcal{C}$ be a locally free $\mathcal{O}_X$-module of rank $r$. Consider the morphisms $$ X = \underline{\text{Proj}}_X(\mathcal{O}_X[T]) \xrightarrow{i} E = \underline{\text{Proj}}_X(\text{Sym}^*(\mathcal{C})[T]) \xrightarrow{\pi} X $$ Then $c_t(i_*\mathcal{O}_X) = 0$ for $t = 1, \ldots, r - 1$ and in $A^0(C \to E)$ we have $$ p^* \circ \pi_* \circ c_r(i_*\mathcal{O}_X) = (-1)^{r - 1}(r - 1)! j^* $$ where $j : C \to E$ and $p : C \to X$ are the inclusion and structure morphism of the vector bundle $C = \underline{\Spec}(\text{Sym}^*(\mathcal{C}))$. \end{lemma} 
\begin{lemma} \label{lemma-agreement-with-loc-chern} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $i : Z \to X$ be a regular closed immersion of codimension $r$ between schemes locally of finite type over $S$. Let $\mathcal{N} = \mathcal{C}_{Z/X}^\vee$ be the normal sheaf. If $X$ is quasi-compact (or has quasi-compact irreducible components), then $c_t(Z \to X, i_*\mathcal{O}_Z) = 0$ for $t = 1, \ldots, r - 1$ and $$ c_r(Z \to X, i_*\mathcal{O}_Z) = (-1)^{r - 1} (r - 1)! c(Z \to X, \mathcal{N}) \quad\text{in}\quad A^r(Z \to X) $$ where $c_t(Z \to X, i_*\mathcal{O}_Z)$ is the localized Chern class of Definition \ref{definition-localized-chern}. \end{lemma} 
\begin{lemma} \label{lemma-actual-computation} In the situation of Lemma \ref{lemma-agreement-with-loc-chern} say $\dim_\delta(X) = n$. Then we have \begin{enumerate} \item $c_t(Z \to X, i_*\mathcal{O}_Z) \cap [X]_n = 0$ for $t = 1, \ldots, r - 1$, \item $c_r(Z \to X, i_*\mathcal{O}_Z) \cap [X]_n = (-1)^{r - 1}(r - 1)![Z]_{n - r}$, \item $ch_t(Z \to X, i_*\mathcal{O}_Z) \cap [X]_n = 0$ for $t = 0, \ldots, r - 1$, and \item $ch_r(Z \to X, i_*\mathcal{O}_Z) \cap [X]_n = [Z]_{n - r}$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-second-adams-operator} Let $X$ be a scheme. There is a ring map $$ \psi^2 : K_0(\textit{Vect}(X)) \longrightarrow K_0(\textit{Vect}(X)) $$ which sends $[\mathcal{L}]$ to $[\mathcal{L}^{\otimes 2}]$ when $\mathcal{L}$ is invertible and is compatible with pullbacks. \end{lemma} 
\begin{lemma} \label{lemma-minus-adams-operator} Let $X$ be a scheme. There is a ring map $\psi^{-1} : K_0(\textit{Vect}(X)) \to K_0(\textit{Vect}(X))$ which sends $[\mathcal{E}]$ to $[\mathcal{E}^\vee]$ when $\mathcal{E}$ is finite locally free and is compatible with pullbacks. \end{lemma} 
\begin{lemma} \label{lemma-adams-and-chern} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. If $\psi^2$ is as in Lemma \ref{lemma-second-adams-operator} and $c$ and $ch$ are as in Remarks \ref{remark-chern-classes-K} and \ref{remark-chern-character-K} then we have $c_i(\psi^2(\alpha)) = 2^i c_i(\alpha)$ and $ch_i(\psi^2(\alpha)) = 2^i ch_i(\alpha)$ for all $\alpha \in K_0(\textit{Vect}(X))$. \end{lemma} 
\begin{lemma} \label{lemma-perf-Z-regular} Let $X$ be a Noetherian regular scheme. Let $Z \subset X$ be a closed subscheme. The maps constructed in Remarks \ref{remark-perf-Z-cohomology-K} and \ref{remark-perf-Z-regular} are mutually inverse and we get $K'_0(Z) = K_0(D_{Z, perf}(\mathcal{O}_X))$. \end{lemma} 
\begin{proposition} \label{proposition-K-tensor-Q} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Assume given a closed immersion $X \to Y$ of schemes locally of finite type over $S$ with $Y$ regular and quasi-compact. Then the composition $$ K'_0(X) \to K_0(D_{X, perf}(\mathcal{O}_Y)) \to A^*(X \to Y) \otimes \mathbf{Q} \to \CH_*(X) \otimes \mathbf{Q} $$ of the map $\mathcal{F} \mapsto \mathcal{F}[0]$ from Remark \ref{remark-perf-Z-regular}, the map $ch(X \to Y, -)$ from Remark \ref{remark-localized-chern-character-K}, and the map $c \mapsto c \cap [Y]$ induces an isomorphism $$ K'_0(X) \otimes \mathbf{Q} \longrightarrow \CH_*(X) \otimes \mathbf{Q} $$ which depends on the choice of $Y$. Moreover, the canonical map $$ \CH_k(X) \otimes \mathbf{Q} \longrightarrow \text{gr}_k K'_0(X) \otimes \mathbf{Q} $$ (see above) is an isomorphism of $\mathbf{Q}$-vector spaces for all $k \in \mathbf{Z}$. \end{proposition} 
\begin{lemma} \label{lemma-K-tensor-Q} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be a quasi-compact regular scheme of finite type over $S$ with affine diagonal and $\delta_{X/S} : X \to \mathbf{Z}$ bounded. Then the composition $$ K_0(\textit{Vect}(X)) \otimes \mathbf{Q} \longrightarrow A^*(X) \otimes \mathbf{Q} \longrightarrow \CH_*(X) \otimes \mathbf{Q} $$ of the map $ch$ from Remark \ref{remark-chern-character-K} and the map $c \mapsto c \cap [X]$ is an isomorphism. \end{lemma} 
\begin{lemma} \label{lemma-composition-regular-immersion} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $i : X \to Y$ and $j : Y \to Z$ be regular immersions of schemes locally of finite type over $S$. Then $j \circ i$ is a regular immersion and $(j \circ i)^! = i^! \circ j^!$. \end{lemma} 
\begin{lemma} \label{lemma-section-smooth} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $p : P \to X$ be a smooth morphism of schemes locally of finite type over $S$ and let $s : X \to P$ be a section. Then $s$ is a regular immersion and $1 = s^! \circ p^*$ in $A^*(X)^\wedge$ where $p^* \in A^*(P \to X)^\wedge$ is the bivariant class of Lemma \ref{lemma-flat-pullback-bivariant}. \end{lemma} 
\begin{lemma} \label{lemma-lci-gysin-well-defined} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $f : X \to Y$ be a local complete intersection morphism of schemes locally of finite type over $S$. The bivariant class $f^!$ is independent of the choice of the factorization $f = g \circ i$ with $g$ smooth (provided one exists). \end{lemma} 
\begin{definition} \label{definition-lci-gysin} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $f : X \to Y$ be a local complete intersection morphism of schemes locally of finite type over $S$. We say {\it the gysin map for $f$ exists} if we can write $f = g \circ i$ with $g$ smooth and $i$ an immersion. In this case we define the {\it gysin map} $f^! = i^! \circ g^* \in A^*(X \to Y)$ as above. \end{definition} 
\begin{lemma} \label{lemma-lci-gysin-flat} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $f : X \to Y$ be a local complete intersection morphism of schemes locally of finite type over $S$. If the gysin map exists for $f$ and $f$ is flat, then $f^!$ is equal to the bivariant class of Lemma \ref{lemma-flat-pullback-bivariant}. \end{lemma} 
\begin{lemma} \label{lemma-lci-gysin-composition} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $f : X \to Y$ and $g : Y \to Z$ be local complete intersection morphisms of schemes locally of finite type over $S$. Assume the gysin map exists for $g \circ f$ and $g$. Then the gysin map exists for $f$ and $(g \circ f)^! = f^! \circ g^!$. \end{lemma} 
\begin{lemma} \label{lemma-lci-gysin-commutes} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Consider a commutative diagram $$ \xymatrix{ X'' \ar[d] \ar[r] & X' \ar[d] \ar[r] & X \ar[d]^f \\ Y'' \ar[r] & Y' \ar[r] & Y } $$ of schemes locally of finite type over $S$ with both square cartesian. Assume $f : X \to Y$ is a local complete intersection morphism such that the gysin map exists for $f$. Let $c \in A^*(Y'' \to Y')$. Denote $res(f^!) \in A^*(X' \to Y')$ the restriction of $f^!$ to $Y'$ (Remark \ref{remark-restriction-bivariant}). Then $c$ and $res(f^!)$ commute (Remark \ref{remark-bivariant-commute}). \end{lemma} 
\begin{lemma} \label{lemma-lci-gysin-easy} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Consider a cartesian diagram $$ \xymatrix{ X' \ar[d]_{f'} \ar[r] & X \ar[d]^f \\ Y' \ar[r] & Y } $$ of schemes locally of finite type over $S$. Assume \begin{enumerate} \item $f$ is a local complete intersection morphism and the gysin map exists for $f$, \item $X$, $X'$, $Y$, $Y'$ satisfy the equivalent conditions of Lemma \ref{lemma-locally-equidimensional}, \item for $x' \in X'$ with images $x$, $y'$, and $y$ in $X$, $Y'$, and $Y$ we have $n_{x'} - n_{y'} = n_x - n_y$ where $n_{x'}$, $n_x$, $n_{y'}$, and $n_y$ are as in the lemma, and \item for every generic point $\xi \in X'$ the local ring $\mathcal{O}_{Y', f'(\xi)}$ is Cohen-Macaulay. \end{enumerate} Then $f^![Y'] = [X']$ where $[Y']$ and $[X']$ are as in Remark \ref{remark-fundamental-class}. \end{lemma} 
\begin{lemma} \label{lemma-compare-gysin-base-change} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Consider a cartesian square $$ \xymatrix{ X' \ar[d]_{f'} \ar[r]_{g'} & X \ar[d]^f \\ Y' \ar[r]^g & Y } $$ of schemes locally of finite type over $S$. Assume \begin{enumerate} \item both $f$ and $f'$ are local complete intersection morphisms, and \item the gysin map exists for $f$ \end{enumerate} Then $\mathcal{C} = \Ker(H^{-1}((g')^*\NL_{X/Y}) \to H^{-1}(\NL_{X'/Y'}))$ is a finite locally free $\mathcal{O}_{X'}$-module, the gysin map exists for $f'$, and we have $$ res(f^!) = c_{top}(\mathcal{C}^\vee) \circ (f')^! $$ in $A^*(X' \to Y')$. \end{lemma} 
\begin{lemma}[Blow up formula] \label{lemma-blow-up-formula} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $i : Z \to X$ be a regular closed immersion of schemes locally of finite type over $S$. Let $b : X' \to X$ be the blowing up with center $Z$. Picture $$ \xymatrix{ E \ar[r]_j \ar[d]_\pi & X' \ar[d]^b \\ Z \ar[r]^i & X } $$ Assume that the gysin map exists for $b$. Then we have $$ res(b^!) = c_{top}(\mathcal{F}^\vee) \circ \pi^* $$ in $A^*(E \to Z)$ where $\mathcal{F}$ is the kernel of the canonical map $\pi^*\mathcal{C}_{Z/X} \to \mathcal{C}_{E/X'}$. \end{lemma} 
\begin{lemma} \label{lemma-lci-gysin-product-regular} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $f : X \to Y$ be a morphism of schemes locally of finite type over $S$ such that both $X$ and $Y$ are quasi-compact, regular, have affine diagonal, and finite dimension. Then $f$ is a local complete intersection morphism. Assume moreover the gysin map exists for $f$. Then $$ f^!(\alpha \cdot \beta) = f^!\alpha \cdot f^!\beta $$ in $\CH^*(X) \otimes \mathbf{Q}$ where the intersection product is as in Section \ref{section-intersection-regular}. \end{lemma} 
\begin{lemma} \label{lemma-projection-formula-regular} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $f : X \to Y$ be a morphism of schemes locally of finite type over $S$ such that both $X$ and $Y$ are quasi-compact, regular, have affine diagonal, and finite dimension. Then $f$ is a local complete intersection morphism. Assume moreover the gysin map exists for $f$ and that $f$ is proper. Then $$ f_*(\alpha \cdot f^!\beta) = f_*\alpha \cdot \beta $$ in $\CH^*(Y) \otimes \mathbf{Q}$ where the intersection product is as in Section \ref{section-intersection-regular}. \end{lemma} 
\begin{lemma} \label{lemma-diagonal-identity} In the situation above we have $\Delta^! \circ \text{pr}_i^! = 1$ in $A^0(X)$. \end{lemma} 
\begin{proposition} \label{proposition-compute-bivariant} \begin{reference} \cite[Proposition 17.4.2]{F} \end{reference} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $f : X \to Y$ and $g : Y \to Z$ be morphisms of schemes locally of finite type over $S$. If $g$ is smooth of relative dimension $d$, then $A^p(X \to Y) = A^{p - d}(X \to Z)$. \end{proposition} 
\begin{lemma} \label{lemma-exterior-product-well-defined} The map $\times : \CH_n(X) \otimes_{\mathbf{Z}} \CH_m(Y) \to \CH_{n + m}(X \times_k Y)$ is well defined. \end{lemma} 
\begin{lemma} \label{lemma-chow-cohomology-towards-point} Let $k$ be a field. Let $X$ be a scheme locally of finite type over $k$. Then we have a canonical identification $$ A^p(X \to \Spec(k)) = \CH_{-p}(X) $$ for all $p \in \mathbf{Z}$. \end{lemma} 
\begin{lemma} \label{lemma-chow-cohomology-towards-point-commutes} Let $k$ be a field. Let $X$ be a scheme locally of finite type over $k$. Let $c \in A^p(X \to \Spec(k))$. Let $Y \to Z$ be a morphism of schemes locally of finite type over $k$. Let $c' \in A^q(Y \to Z)$. Then $c \circ c' = c' \circ c$ in $A^{p + q}(X \times_k Y \to Z)$. \end{lemma} 
\begin{lemma} \label{lemma-exterior-product-associative} Exterior product is associative. More precisely, let $k$ be a field, let $X, Y, Z$ be schemes locally of finite type over $k$, let $\alpha \in \CH_*(X)$, $\beta \in \CH_*(Y)$, $\gamma \in \CH_*(Z)$. Then $(\alpha \times \beta) \times \gamma = \alpha \times (\beta \times \gamma)$ in $\CH_*(X \times_k Y \times_k Z)$. \end{lemma} 
\begin{lemma} \label{lemma-associative} The product defined above is associative. More precisely, let $k$ be a field, let $X$ be smooth over $k$, let $Y, Z, W$ be schemes locally of finite type over $X$, let $\alpha \in \CH_*(Y)$, $\beta \in \CH_*(Z)$, $\gamma \in \CH_*(W)$. Then $(\alpha \cdot \beta) \cdot \gamma = \alpha \cdot (\beta \cdot \gamma)$ in $\CH_*(Y \times_X Z \times_X W)$. \end{lemma} 
\begin{lemma} \label{lemma-identify-chow-for-smooth} Let $k$ be a field. Let $X$ be a smooth scheme over $k$, equidimensional of dimension $d$. The map $$ A^p(X) \longrightarrow \CH_{d - p}(X),\quad c \longmapsto c \cap [X]_d $$ is an isomorphism. Via this isomorphism composition of bivariant classes turns into the intersection product defined above. \end{lemma} 
\begin{lemma} \label{lemma-lci-gysin-product} Let $k$ be a field. Let $f : X \to Y$ be a morphism of schemes smooth over $k$. Then the gysin map exists for $f$ and $f^!(\alpha \cdot \beta) = f^!\alpha \cdot f^!\beta$. \end{lemma} 
\begin{lemma} \label{lemma-projection-formula} Let $k$ be a field. Let $f : X \to Y$ be a proper morphism of schemes smooth over $k$. Then the gysin map exists for $f$ and $f_*(\alpha \cdot f^!\beta) = f_*\alpha \cdot \beta$. \end{lemma} 
\begin{lemma} \label{lemma-intersect-properly} Let $k$ be a field. Let $X$ be an integral scheme smooth over $k$. Let $Y, Z \subset X$ be integral closed subschemes. Set $d = \dim(Y) + \dim(Z) - \dim(X)$. Assume \begin{enumerate} \item $\dim(Y \cap Z) \leq d$, and \item $\mathcal{O}_{Y, \xi}$ and $\mathcal{O}_{Z, \xi}$ are Cohen-Macaulay for every $\xi \in Y \cap Z$ with $\delta(\xi) = d$. \end{enumerate} Then $[Y] \cdot [Z] = [Y \cap Z]_d$ in $\CH_d(X)$. \end{lemma} 
\begin{lemma} \label{lemma-intersect-regularly-embedded} Let $k$ be a field. Let $X$ be a scheme smooth over $k$. Let $i : Y \to X$ be a regular closed immersion. Let $\alpha \in \CH_*(X)$. If $Y$ is equidimensional of dimension $e$, then $\alpha \cdot [Y]_e = i_*(i^!(\alpha))$ in $\CH_*(X)$. \end{lemma} 
\begin{lemma} \label{lemma-intersection-regular-smooth} Let $k$ be a field. Let $X$ be a smooth scheme over $k$ which is quasi-compact and has affine diagonal. Then the intersection product on $\CH^*(X)$ constructed in this section agrees after tensoring with $\mathbf{Q}$ with the intersection product constructed in Section \ref{section-intersection-regular}. \end{lemma} 
\begin{lemma} \label{lemma-exterior-product-well-defined-dim-1} The map $\times : \CH_n(X) \otimes_{\mathbf{Z}} \CH_m(Y) \to \CH_{n + m - 1}(X \times_S Y)$ is well defined. \end{lemma} 
\begin{lemma} \label{lemma-chow-cohomology-towards-base-dim-1} Let $(S, \delta)$ be as above. Let $X$ be a scheme locally of finite type over $S$. Then we have a canonical identification $$ A^p(X \to S) = \CH_{1 - p}(X) $$ for all $p \in \mathbf{Z}$. \end{lemma} 
\begin{lemma} \label{lemma-chow-cohomology-towards-base-dim-1-commutes} Let $(S, \delta)$ be as above. Let $X$ be a scheme locally of finite type over $S$. Let $c \in A^p(X \to S)$. Let $Y \to Z$ be a morphism of schemes locally of finite type over $S$. Let $c' \in A^q(Y \to Z)$. Then $c \circ c' = c' \circ c$ in $A^{p + q}(X \times_S Y \to X \times_S Z)$. \end{lemma} 
\begin{lemma} \label{lemma-exterior-product-associative-dim-1} Exterior product is associative. More precisely, let $(S, \delta)$ be as above, let $X, Y, Z$ be schemes locally of finite type over $S$, let $\alpha \in \CH_*(X)$, $\beta \in \CH_*(Y)$, $\gamma \in \CH_*(Z)$. Then $(\alpha \times \beta) \times \gamma = \alpha \times (\beta \times \gamma)$ in $\CH_*(X \times_S Y \times_S Z)$. \end{lemma} 
\begin{lemma} \label{lemma-associative-dim-1} The product defined above is associative. More precisely, with $(S, \delta)$ as above, let $X$ be smooth over $S$, let $Y, Z, W$ be schemes locally of finite type over $X$, let $\alpha \in \CH_*(Y)$, $\beta \in \CH_*(Z)$, $\gamma \in \CH_*(W)$. Then $(\alpha \cdot \beta) \cdot \gamma = \alpha \cdot (\beta \cdot \gamma)$ in $\CH_*(Y \times_X Z \times_X W)$. \end{lemma} 
\begin{lemma} \label{lemma-identify-chow-for-smooth-dim-1} Let $(S, \delta)$ be as above. Let $X$ be a smooth scheme over $S$, equidimensional of dimension $d$. The map $$ A^p(X) \longrightarrow \CH_{d - p}(X),\quad c \longmapsto c \cap [X]_d $$ is an isomorphism. Via this isomorphism composition of bivariant classes turns into the intersection product defined above. \end{lemma} 
\begin{lemma} \label{lemma-dimension-base-change} In Situation \ref{situation-setup-base-change} let $X \to S$ be locally of finite type. Denote $X' \to S'$ the base change by $S' \to S$. If $X$ is integral with $\dim_\delta(X) = k$, then every irreducible component $Z'$ of $X'$ has $\dim_{\delta'}(Z') = k + c$, \end{lemma} 
\begin{lemma} \label{lemma-pullback-coherent-base-change} In Situation \ref{situation-setup-base-change} let $X \to S$ locally of finite type and let $X' \to S$ be the base change by $S' \to S$. \begin{enumerate} \item Let $Z \subset X$ be a closed subscheme with $\dim_\delta(Z) \leq k$ and base change $Z' \subset X'$. Then we have $\dim_{\delta'}(Z')) \leq k + c$ and $[Z']_{k + c} = g^*[Z]_k$ in $Z_{k + c}(X')$. \item Let $\mathcal{F}$ be a coherent sheaf on $X$ with $\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$ and base change $\mathcal{F}'$ on $X'$. Then we have $\dim_\delta(\text{Supp}(\mathcal{F}')) \leq k + c$ and $g^*[\mathcal{F}]_k = [\mathcal{F}']_{k + c}$ in $Z_{k + c}(X')$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-pullback-base-change} In Situation \ref{situation-setup-base-change} let $X \to S$ be locally of finite type and let $X' \to S'$ be the base change by $S' \to S$. The map $g^* : Z_k(X) \to Z_{k + c}(X')$ above factors through rational equivalence to give a map $$ g^* : \CH_k(X) \longrightarrow \CH_{k + c}(X') $$ of chow groups. \end{lemma} 
\begin{lemma} \label{lemma-pullback-base-change-pullback} In Situation \ref{situation-setup-base-change} let $Y \to X \to S$ be locally of finite type and let $Y' \to X' \to S'$ be the base change by $S' \to S$. Assume $f : Y \to X$ is flat of relative dimension $r$. Then $f' : Y' \to X'$ is flat of relative dimension $r$ and the diagrams $$ \vcenter{ \xymatrix{ Z_{k + r}(Y) \ar[r]_{g^*} & Z_{k + c + r}(Y') \\ Z_k(X) \ar[r]^{g^*} \ar[u]^{(f')^*} & Z_{k + c}(X') \ar[u]_{f^*} } } \quad\text{and}\quad \vcenter{ \xymatrix{ \CH_{k + r}(Y) \ar[r]_{g^*} & \CH_{k + c + r}(Y') \\ \CH_k(X) \ar[r]^{g^*} \ar[u]^{(f')^*} & \CH_{k + c}(X') \ar[u]_{f^*} } } $$ of cycle and chow groups commutes. \end{lemma} 
\begin{lemma} \label{lemma-pullback-base-change-pushforward} In Situation \ref{situation-setup-base-change} let $Y \to X \to S$ be locally of finite type and let $Y' \to X' \to S'$ be the base change by $S' \to S$. Assume $f : Y \to X$ is proper. Then $f' : Y' \to X'$ is proper and the diagram $$ \vcenter{ \xymatrix{ Z_k(Y) \ar[r]_{g^*} \ar[d]_{f_*} & Z_{k + c}(Y') \ar[d]^{f'_*} \\ Z_k(X) \ar[r]^{g^*} & Z_{k + c}(X') } } \quad\text{and}\quad \vcenter{ \xymatrix{ \CH_k(Y) \ar[r]_{g^*} \ar[d]_{f_*} & \CH_{k + c}(Y') \ar[d]^{f'_*} \\ \CH_k(X) \ar[r]^{g^*} & \CH_{k + c}(X') } } $$ of cycle and chow groups commutes. \end{lemma} 
\begin{lemma} \label{lemma-pullback-base-change-c1} In Situation \ref{situation-setup-base-change} let $X \to S$ be locally of finite type and let $X' \to S'$ be the base change by $S' \to S$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module with base change $\mathcal{L}'$ on $X'$. Then the diagram $$ \xymatrix{ \CH_k(X) \ar[r]_{g^*} \ar[d]_{c_1(\mathcal{L}) \cap -} & \CH_{k + c}(X') \ar[d]^{c_1(\mathcal{L}') \cap -} \\ \CH_{k - 1}(X) \ar[r]^{g^*} & \CH_{k + c - 1}(X') } $$ of chow groups commutes. \end{lemma} 
\begin{lemma} \label{lemma-pullback-base-change-chern-classes} In Situation \ref{situation-setup-base-change} let $X \to S$ be locally of finite type and let $X' \to S'$ be the base change by $S' \to S$. Let $\mathcal{E}$ be a finite locally free $\mathcal{O}_X$-module of rank $r$ with base change $\mathcal{E}'$ on $X'$. Then the diagram $$ \xymatrix{ \CH_k(X) \ar[r]_{g^*} \ar[d]_{c_i(\mathcal{E}) \cap -} & \CH_{k + c}(X') \ar[d]^{c_i(\mathcal{E}') \cap -} \\ \CH_{k - i}(X) \ar[r]^{g^*} & \CH_{k + c - i}(X') } $$ of chow groups commutes for all $i$. \end{lemma} 
\begin{lemma} \label{lemma-compose-base-change} Let $(S, \delta)$, $(S', \delta')$, $(S'', \delta'')$ be as in Situation \ref{situation-setup}. Let $g : S' \to S$ and $g' : S'' \to S'$ be flat morphisms of schemes and let $c, c' \in \mathbf{Z}$ be integers such that $S, \delta, S', \delta', g, c$ and $S', \delta', S'', g', c'$ are as in Situation \ref{situation-setup-base-change}. Let $X \to S$ be locally of finite type and denote $X' \to S'$ and $X'' \to S''$ the base changes by $S' \to S$ and $S'' \to S$. Then \begin{enumerate} \item $S, \delta, S'', \delta'', g \circ g', c + c'$ is as in Situation \ref{situation-setup-base-change}, \item the maps $g^* : Z_k(X) \to Z_{k + c}(X')$ and $(g')^* : Z_{k + c}(X') \to Z_{k + c + c'}(X'')$ of compose to give the map $(g \circ g')^* : Z_k(X) \to Z_{k + c + c'}(X'')$, and \item the maps $g^* : \CH_k(X) \to \CH_{k + c}(X')$ and $(g')^* : \CH_{k + c}(X') \to \CH_{k + c + c'}(X'')$ of Lemma \ref{lemma-pullback-base-change} compose to give the map $(g \circ g')^* : \CH_k(X) \to \CH_{k + c + c'}(X'')$ of Lemma \ref{lemma-pullback-base-change}. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-chow-limit} In Situation \ref{situation-setup-base-change} assume $c = 0$ and assume that $S' = \lim_{i \in I} S_i$ is a filtered limit of schemes $S_i$ affine over $S$ such that \begin{enumerate} \item with $\delta_i$ equal to $S_i \to S \xrightarrow{\delta} \mathbf{Z}$ the pair $(S_i, \delta_i)$ is as in Situation \ref{situation-setup}, \item $S_i, \delta_i, S, \delta, S \to S_i, c = 0$ is as in Situation \ref{situation-setup-base-change}, \item $S_i, \delta_i, S_{i'}, \delta_{i'}, S_i \to S_{i'}, c = 0$  for $i \geq i'$ is as in Situation \ref{situation-setup-base-change}. \end{enumerate} Then for a quasi-compact scheme $X$ of finite type over $S$ with base change $X'$ and $X_i$ by $S' \to S$ and $S_i \to S$ we have $Z_k(X') = \colim Z_k(X_i)$ and $\CH_k(X') = \colim \CH_k(X_i)$. \end{lemma} 
\begin{definition} \label{definition-determinant} Let $R$ be a local ring with maximal ideal $\mathfrak m$ and residue field $\kappa$. Let $M$ be a finite length $R$-module. Say $l = \text{length}_R(M)$. \begin{enumerate} \item Given elements $x_1, \ldots, x_r \in M$ we denote $\langle x_1, \ldots, x_r \rangle = Rx_1 + \ldots + Rx_r$ the $R$-submodule of $M$ generated by $x_1, \ldots, x_r$. \item We will say an $l$-tuple of elements $(e_1, \ldots, e_l)$ of $M$ is {\it admissible} if $\mathfrak m e_i \subset \langle e_1, \ldots, e_{i - 1} \rangle$ for $i = 1, \ldots, l$. \item A {\it symbol} $[e_1, \ldots, e_l]$ will mean $(e_1, \ldots, e_l)$ is an admissible $l$-tuple. \item An {\it admissible relation} between symbols is one of the following: \begin{enumerate} \item if $(e_1, \ldots, e_l)$ is an admissible sequence and for some $1 \leq a \leq l$ we have $e_a \in \langle e_1, \ldots, e_{a - 1}\rangle$, then $[e_1, \ldots, e_l] = 0$, \item if $(e_1, \ldots, e_l)$ is an admissible sequence and for some $1 \leq a \leq l$ we have $e_a = \lambda e'_a + x$ with $\lambda \in R^*$, and $x \in \langle e_1, \ldots, e_{a - 1}\rangle$, then $$ [e_1, \ldots, e_l] = \overline{\lambda} [e_1, \ldots, e_{a - 1}, e'_a, e_{a + 1}, \ldots, e_l] $$ where $\overline{\lambda} \in \kappa^*$ is the image of $\lambda$ in the residue field, and \item if $(e_1, \ldots, e_l)$ is an admissible sequence and $\mathfrak m e_a \subset \langle e_1, \ldots, e_{a - 2}\rangle$ then $$ [e_1, \ldots, e_l] = - [e_1, \ldots, e_{a - 2}, e_a, e_{a - 1}, e_{a + 1}, \ldots, e_l]. $$ \end{enumerate} \item We define the {\it determinant of the finite length $R$-module $M$} to be $$ \det\nolimits_\kappa(M) = \left\{ \frac{\kappa\text{-vector space generated by symbols}} {\kappa\text{-linear combinations of admissible relations}} \right\} $$ \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-dimension-at-most-one} With notations as above we have $\dim_\kappa(\det_\kappa(M)) \leq 1$. \end{lemma} 
\begin{lemma} \label{lemma-compare-det} Let $R$ be a local ring with maximal ideal $\mathfrak m$ and residue field $\kappa$. Let $M$ be a finite length $R$-module which is annihilated by $\mathfrak m$. Let $l = \dim_\kappa(M)$. Then the map $$ \det\nolimits_\kappa(M) \longrightarrow \wedge^l_\kappa(M), \quad [e_1, \ldots, e_l] \longmapsto e_1 \wedge \ldots \wedge e_l $$ is an isomorphism. \end{lemma} 
\begin{lemma} \label{lemma-determinant-dimension-one} Let $R$ be a local ring with maximal ideal $\mathfrak m$ and residue field $\kappa$. Let $M$ be a finite length $R$-module. The determinant $\det_\kappa(M)$ defined above is a $\kappa$-vector space of dimension $1$. It is generated by the symbol $[f_1, \ldots, f_l]$ for any admissible sequence such that $\langle f_1, \ldots f_l \rangle = M$. \end{lemma} 
\begin{lemma} \label{lemma-det-exact-sequences} Let $(R, \mathfrak m, \kappa)$ be a local ring. For every short exact sequence $$ 0 \to K \to L \to M \to 0 $$ of finite length $R$-modules there exists a canonical isomorphism $$ \gamma_{K \to L \to M} : \det\nolimits_\kappa(K) \otimes_\kappa \det\nolimits_\kappa(M) \longrightarrow \det\nolimits_\kappa(L) $$ defined by the rule on nonzero symbols $$ [e_1, \ldots, e_k] \otimes [\overline{f}_1, \ldots, \overline{f}_m] \longrightarrow [e_1, \ldots, e_k, f_1, \ldots, f_m] $$ with the following properties: \begin{enumerate} \item For every isomorphism of short exact sequences, i.e., for every commutative diagram $$ \xymatrix{ 0 \ar[r] & K \ar[r] \ar[d]^u & L \ar[r] \ar[d]^v & M \ar[r] \ar[d]^w & 0 \\ 0 \ar[r] & K' \ar[r] & L' \ar[r] & M' \ar[r] & 0 } $$ with short exact rows and isomorphisms $u, v, w$ we have $$ \gamma_{K' \to L' \to M'} \circ (\det\nolimits_\kappa(u) \otimes \det\nolimits_\kappa(w)) = \det\nolimits_\kappa(v) \circ \gamma_{K \to L \to M}, $$ \item for every commutative square of finite length $R$-modules with exact rows and columns $$ \xymatrix{ & 0 \ar[d] & 0 \ar[d] & 0 \ar[d] & \\ 0 \ar[r] & A \ar[r] \ar[d] & B \ar[r] \ar[d] & C \ar[r] \ar[d] & 0 \\ 0 \ar[r] & D \ar[r] \ar[d] & E \ar[r] \ar[d] & F \ar[r] \ar[d] & 0 \\ 0 \ar[r] & G \ar[r] \ar[d] & H \ar[r] \ar[d] & I \ar[r] \ar[d] & 0 \\ & 0  & 0  & 0  & } $$ the following diagram is commutative $$ \xymatrix{ \det\nolimits_\kappa(A) \otimes \det\nolimits_\kappa(C) \otimes \det\nolimits_\kappa(G) \otimes \det\nolimits_\kappa(I) \ar[dd]_{\epsilon} \ar[rrr]_-{\gamma_{A \to B \to C} \otimes \gamma_{G \to H \to I}} & & & \det\nolimits_\kappa(B) \otimes \det\nolimits_\kappa(H) \ar[d]^{\gamma_{B \to E \to H}} \\ & & & \det\nolimits_\kappa(E) \\ \det\nolimits_\kappa(A) \otimes \det\nolimits_\kappa(G) \otimes \det\nolimits_\kappa(C) \otimes \det\nolimits_\kappa(I) \ar[rrr]^-{\gamma_{A \to D \to G} \otimes \gamma_{C \to F \to I}} & & & \det\nolimits_\kappa(D) \otimes \det\nolimits_\kappa(F) \ar[u]_{\gamma_{D \to E \to F}} } $$ where $\epsilon$ is the switch of the factors in the tensor product times $(-1)^{cg}$ with $c = \text{length}_R(C)$ and $g = \text{length}_R(G)$, and \item the map $\gamma_{K \to L \to M}$ agrees with the usual isomorphism if $0 \to K \to L \to M \to 0$ is actually a short exact sequence of $\kappa$-vector spaces. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-uniqueness-det} Let $(R, \mathfrak m, \kappa)$ be any local ring. The functor $$ \det\nolimits_\kappa : \left\{ \begin{matrix} \text{finite length }R\text{-modules} \\ \text{with isomorphisms} \end{matrix} \right\} \longrightarrow \left\{ \begin{matrix} 1\text{-dimensional }\kappa\text{-vector spaces} \\ \text{with isomorphisms} \end{matrix} \right\} $$ endowed with the maps $\gamma_{K \to L \to M}$ is characterized by the following properties \begin{enumerate} \item its restriction to the subcategory of modules annihilated by $\mathfrak m$ is isomorphic to the usual determinant functor (see Lemma \ref{lemma-compare-det}), and \item (1), (2) and (3) of Lemma \ref{lemma-det-exact-sequences} hold. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-determinant-quotient-ring} Let $(R', \mathfrak m') \to (R, \mathfrak m)$ be a local ring homomorphism which induces an isomorphism on residue fields $\kappa$. Then for every finite length $R$-module the restriction $M_{R'}$ is a finite length $R'$-module and there is a canonical isomorphism $$ \det\nolimits_{R, \kappa}(M) \longrightarrow \det\nolimits_{R', \kappa}(M_{R'}) $$ This isomorphism is functorial in $M$ and compatible with the isomorphisms $\gamma_{K \to L \to M}$ of Lemma \ref{lemma-det-exact-sequences} defined for $\det_{R, \kappa}$ and $\det_{R', \kappa}$. \end{lemma} 
\begin{lemma} \label{lemma-times-u-determinant} Let $R$ be a local ring with residue field $\kappa$. Let $u \in R^*$ be a unit. Let $M$ be a module of finite length over $R$. Denote $u_M : M \to M$ the map multiplication by $u$. Then $$ \det\nolimits_\kappa(u_M) : \det\nolimits_\kappa(M) \longrightarrow \det\nolimits_\kappa(M) $$ is multiplication by $\overline{u}^l$ where $l = \text{length}_R(M)$ and $\overline{u} \in \kappa^*$ is the image of $u$. \end{lemma} 
\begin{definition} \label{definition-periodic-determinant} Let $R$ be a local ring with residue field $\kappa$. Let $(M, \varphi, \psi)$ be a $(2, 1)$-periodic complex over $R$. Assume that $M$ has finite length and that $(M, \varphi, \psi)$ is exact. The {\it determinant of $(M, \varphi, \psi)$} is the element $$ \det\nolimits_\kappa(M, \varphi, \psi) \in \kappa^* $$ such that the composition $$ \det\nolimits_\kappa(M) \xrightarrow{\gamma_\psi \circ \sigma \circ \gamma_\varphi^{-1}} \det\nolimits_\kappa(M) $$ is multiplication by $(-1)^{\text{length}_R(I_\varphi)\text{length}_R(I_\psi)} \det\nolimits_\kappa(M, \varphi, \psi)$. \end{definition} 
\begin{lemma} \label{lemma-periodic-determinant-shift} Let $R$ be a local ring with residue field $\kappa$. Let $(M, \varphi, \psi)$ be a $(2, 1)$-periodic complex over $R$. Assume that $M$ has finite length and that $(M, \varphi, \psi)$ is exact. Then $$ \det\nolimits_\kappa(M, \varphi, \psi) \det\nolimits_\kappa(M, \psi, \varphi) = 1. $$ \end{lemma} 
\begin{lemma} \label{lemma-periodic-determinant-sign} Let $R$ be a local ring with residue field $\kappa$. Let $(M, \varphi, \varphi)$ be a $(2, 1)$-periodic complex over $R$. Assume that $M$ has finite length and that $(M, \varphi, \varphi)$ is exact. Then $\text{length}_R(M) = 2 \text{length}_R(\Im(\varphi))$ and $$ \det\nolimits_\kappa(M, \varphi, \varphi) = (-1)^{\text{length}_R(\Im(\varphi))} = (-1)^{\frac{1}{2}\text{length}_R(M)} $$ \end{lemma} 
\begin{lemma} \label{lemma-periodic-determinant-easy-case} Let $R$ be a local ring with residue field $\kappa$. Let $M$ be a finite length $R$-module. \begin{enumerate} \item if $\varphi : M \to M$ is an isomorphism then $\det_\kappa(M, \varphi, 0) = \det_\kappa(\varphi)$. \item if $\psi : M \to M$ is an isomorphism then $\det_\kappa(M, 0, \psi) = \det_\kappa(\psi)^{-1}$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-periodic-determinant} Let $R$ be a local ring with residue field $\kappa$. Suppose that we have a short exact sequence of $(2, 1)$-periodic complexes $$ 0 \to (M_1, \varphi_1, \psi_1) \to (M_2, \varphi_2, \psi_2) \to (M_3, \varphi_3, \psi_3) \to 0 $$ with all $M_i$ of finite length, and each $(M_1, \varphi_1, \psi_1)$ exact. Then $$ \det\nolimits_\kappa(M_2, \varphi_2, \psi_2) = \det\nolimits_\kappa(M_1, \varphi_1, \psi_1) \det\nolimits_\kappa(M_3, \varphi_3, \psi_3). $$ in $\kappa^*$. \end{lemma} 
\begin{lemma} \label{lemma-multiplicativity-determinant} Let $R$ be a local ring with residue field $\kappa$. Let $M$ be a finite length $R$-module. Let $\alpha, \beta, \gamma$ be endomorphisms of $M$. Assume that \begin{enumerate} \item $I_\alpha = K_{\beta\gamma}$, and similarly for any permutation of $\alpha, \beta, \gamma$, \item $K_\alpha = I_{\beta\gamma}$, and similarly for any permutation of $\alpha, \beta, \gamma$. \end{enumerate} Then \begin{enumerate} \item The triple $(M, \alpha, \beta\gamma)$ is an exact $(2, 1)$-periodic complex. \item The triple $(I_\gamma, \alpha, \beta)$ is an exact $(2, 1)$-periodic complex. \item The triple $(M/K_\beta, \alpha, \gamma)$ is an exact $(2, 1)$-periodic complex. \item We have $$ \det\nolimits_\kappa(M, \alpha, \beta\gamma) = \det\nolimits_\kappa(I_\gamma, \alpha, \beta) \det\nolimits_\kappa(M/K_\beta, \alpha, \gamma). $$ \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-tricky} Let $R$ be a local ring with residue field $\kappa$. Let $\alpha : (M, \varphi, \psi) \to (M', \varphi', \psi')$ be a morphism of $(2, 1)$-periodic complexes over $R$. Assume \begin{enumerate} \item $M$, $M'$ have finite length, \item $(M, \varphi, \psi)$, $(M', \varphi', \psi')$ are exact, \item the maps $\varphi$, $\psi$ induce the zero map on $K = \Ker(\alpha)$, and \item the maps $\varphi$, $\psi$ induce the zero map on $Q = \Coker(\alpha)$. \end{enumerate} Denote $N = \alpha(M) \subset M'$. We obtain two short exact sequences of $(2, 1)$-periodic complexes $$ \begin{matrix} 0 \to (N, \varphi', \psi') \to (M', \varphi', \psi') \to (Q, 0, 0) \to 0 \\ 0 \to (K, 0, 0) \to (M, \varphi, \psi) \to (N, \varphi', \psi') \to 0 \end{matrix} $$ which induce two isomorphisms $\alpha_i : Q \to K$, $i = 0, 1$. Then $$ \det\nolimits_\kappa(M, \varphi, \psi) = \det\nolimits_\kappa(\alpha_0^{-1} \circ \alpha_1) \det\nolimits_\kappa(M', \varphi', \psi') $$ In particular, if $\alpha_0 = \alpha_1$, then $\det\nolimits_\kappa(M, \varphi, \psi) = \det\nolimits_\kappa(M', \varphi', \psi')$. \end{lemma} 
\begin{lemma} \label{lemma-pre-symbol} Let $A$ be a Noetherian local ring. Let $M$ be a finite $A$-module of dimension $1$. Assume $\varphi, \psi : M \to M$ are two injective $A$-module maps, and assume $\varphi(\psi(M)) = \psi(\varphi(M))$, for example if $\varphi$ and $\psi$ commute. Then $\text{length}_R(M/\varphi\psi M) < \infty$ and $(M/\varphi\psi M, \varphi, \psi)$ is an exact $(2, 1)$-periodic complex. \end{lemma} 
\begin{lemma} \label{lemma-symbol-defined} Let $A$ be a Noetherian local ring. Let $a, b \in A$. \begin{enumerate} \item If $M$ is a finite $A$-module of dimension $1$ such that $a, b$ are nonzerodivisors on $M$, then $\text{length}_A(M/abM) < \infty$ and $(M/abM, a, b)$ is a $(2, 1)$-periodic exact complex. \item If $a, b$ are nonzerodivisors and $\dim(A) = 1$ then $\text{length}_A(A/(ab)) < \infty$ and $(A/(ab), a, b)$ is a $(2, 1)$-periodic exact complex. \end{enumerate} In particular, in these cases $\det_\kappa(M/abM, a, b) \in \kappa^*$, resp.\ $\det_\kappa(A/(ab), a, b) \in \kappa^*$ are defined. \end{lemma} 
\begin{definition} \label{definition-symbol-M} Let $A$ be a Noetherian local ring with residue field $\kappa$. Let $a, b \in A$. Let $M$ be a finite $A$-module of dimension $1$ such that $a, b$ are nonzerodivisors on $M$. We define the {\it symbol associated to $M, a, b$} to be the element $$ d_M(a, b) = \det\nolimits_\kappa(M/abM, a, b) \in \kappa^* $$ \end{definition} 
\begin{lemma} \label{lemma-multiplicativity-symbol} Let $A$ be a Noetherian local ring. Let $a, b, c \in A$. Let $M$ be a finite $A$-module with $\dim(\text{Supp}(M)) = 1$. Assume $a, b, c$ are nonzerodivisors on $M$. Then $$ d_M(a, bc) = d_M(a, b) d_M(a, c) $$ and $d_M(a, b)d_M(b, a) = 1$. \end{lemma} 
\begin{definition} \label{definition-tame-symbol} Let $A$ be a Noetherian local domain of dimension $1$ with residue field $\kappa$. Let $K$ be the fraction field of $A$. We define the {\it tame symbol} of $A$ to be the map $$ K^* \times K^* \longrightarrow \kappa^*, \quad (x, y) \longmapsto d_A(x, y) $$ where $d_A(x, y)$ is extended to $K^* \times K^*$ by the multiplicativity of Lemma \ref{lemma-multiplicativity-symbol}. \end{definition} 
\begin{lemma} \label{lemma-symbol-when-equal} Let $A$ be a Noetherian local ring and $M$ a finite $A$-module of dimension $1$. Let $a \in A$ be a nonzerodivisor on $M$. Then $d_M(a, a) = (-1)^{\text{length}_A(M/aM)}$. \end{lemma} 
\begin{lemma} \label{lemma-symbol-when-one-is-a-unit} Let $A$ be a Noetherian local ring. Let $M$ be a finite $A$-module of dimension $1$. Let $b \in A$ be a nonzerodivisor on $M$, and let $u \in A^*$. Then $$ d_M(u, b) = u^{\text{length}_A(M/bM)} \bmod \mathfrak m_A. $$ In particular, if $M = A$, then $d_A(u, b) = u^{\text{ord}_A(b)} \bmod \mathfrak m_A$. \end{lemma} 
\begin{lemma} \label{lemma-symbol-short-exact-sequence} Let $A$ be a Noetherian local ring. Let $a, b \in A$. Let $$ 0 \to M \to M' \to M'' \to 0 $$ be a short exact sequence of $A$-modules of dimension $1$ such that $a, b$ are nonzerodivisors on all three $A$-modules. Then $$ d_{M'}(a, b) = d_M(a, b) d_{M''}(a, b) $$ in $\kappa^*$. \end{lemma} 
\begin{lemma} \label{lemma-symbol-compare-modules} Let $A$ be a Noetherian local ring. Let $\alpha : M \to M'$ be a homomorphism of finite $A$-modules of dimension $1$. Let $a, b \in A$. Assume \begin{enumerate} \item $a$, $b$ are nonzerodivisors on both $M$ and $M'$, and \item $\dim(\Ker(\alpha)), \dim(\Coker(\alpha)) \leq 0$. \end{enumerate} Then $d_M(a, b) = d_{M'}(a, b)$. \end{lemma} 
\begin{lemma} \label{lemma-compute-symbol-M} Let $A$ be a Noetherian local ring. Let $M$ be a finite $A$-module with $\dim(\text{Supp}(M)) = 1$. Let $a, b \in A$ nonzerodivisors on $M$. Let $\mathfrak q_1, \ldots, \mathfrak q_t$ be the minimal primes in the support of $M$. Then $$ d_M(a, b) = \prod\nolimits_{i = 1, \ldots, t} d_{A/\mathfrak q_i}(a, b)^{ \text{length}_{A_{\mathfrak q_i}}(M_{\mathfrak q_i})} $$ as elements of $\kappa^*$. \end{lemma} 
\begin{lemma} \label{lemma-symbol-is-usual-tame-symbol} Let $A$ be a discrete valuation ring with fraction field $K$. For nonzero $x, y \in K$ we have $$ d_A(x, y) = (-1)^{\text{ord}_A(x)\text{ord}_A(y)} \frac{x^{\text{ord}_A(y)}}{y^{\text{ord}_A(x)}} \bmod \mathfrak m_A, $$ in other words the symbol is equal to the usual tame symbol. \end{lemma} 
\begin{lemma} \label{lemma-symbol-is-steinberg-prepare} Let $A$ be a Noetherian local ring. Let $a, b \in A$. Let $M$ be a finite $A$-module of dimension $1$ on which each of $a$, $b$, $b - a$ are nonzerodivisors. Then $$ d_M(a, b - a)d_M(b, b) = d_M(b, b - a)d_M(a, b) $$ in $\kappa^*$. \end{lemma} 
\begin{lemma} \label{lemma-symbol-is-steinberg} Let $A$ be a Noetherian local domain of dimension $1$ with fraction field $K$. For $x \in K \setminus \{0, 1\}$ we have $$ d_A(x, 1 -x) = 1 $$ \end{lemma} 
\begin{lemma} \label{lemma-key-lemma} Let $R$ be a Noetherian local ring. Let $\mathfrak q \subset R$ be a prime with $\dim(R/\mathfrak q) = 1$. Let $\varphi : M \to N$ be a homomorphism of finite $R$-modules. Assume there exist $x_1, \ldots, x_l \in M$ and $y_1, \ldots, y_l \in M$ with the following properties \begin{enumerate} \item $M = \langle x_1, \ldots, x_l\rangle$, \item $\langle x_1, \ldots, x_i\rangle / \langle x_1, \ldots, x_{i - 1}\rangle \cong R/\mathfrak q$ for $i = 1, \ldots, l$, \item $N = \langle y_1, \ldots, y_l\rangle$, and \item $\langle y_1, \ldots, y_i\rangle / \langle y_1, \ldots, y_{i - 1}\rangle \cong R/\mathfrak q$ for $i = 1, \ldots, l$. \end{enumerate} Then $\varphi$ is injective if and only if $\varphi_{\mathfrak q}$ is an isomorphism, and in this case we have $$ \text{length}_R(\Coker(\varphi)) = \text{ord}_{R/\mathfrak q}(f) $$ where $f \in \kappa(\mathfrak q)$ is the element such that $$ [\varphi(x_1), \ldots, \varphi(x_l)] = f [y_1, \ldots, y_l] $$ in $\det_{\kappa(\mathfrak q)}(N_{\mathfrak q})$. \end{lemma} 
\begin{lemma} \label{lemma-good-sequence-exists} Let $R$ be a local Noetherian ring. Let $\mathfrak q \subset R$ be a prime ideal. Let $M$ be a finite $R$-module such that $\mathfrak q$ is one of the minimal primes of the support of $M$. Then there exist $x_1, \ldots, x_l \in M$ such that \begin{enumerate} \item the support of $M / \langle x_1, \ldots, x_l\rangle$ does not contain $\mathfrak q$, and \item $\langle x_1, \ldots, x_i\rangle / \langle x_1, \ldots, x_{i - 1}\rangle \cong R/\mathfrak q$ for $i = 1, \ldots, l$. \end{enumerate} Moreover, in this case $l = \text{length}_{R_\mathfrak q}(M_\mathfrak q)$. \end{lemma} 
\begin{proposition} \label{proposition-length-determinant-periodic-complex} Let $R$ be a local Noetherian ring with residue field $\kappa$. Suppose that $(M, \varphi, \psi)$ is a $(2, 1)$-periodic complex over $R$. Assume \begin{enumerate} \item $M$ is a finite $R$-module, \item the cohomology modules of $(M, \varphi, \psi)$ are of finite length, and \item $\dim(\text{Supp}(M)) = 1$. \end{enumerate} Let $\mathfrak q_i$, $i = 1, \ldots, t$ be the minimal primes of the support of $M$. Then we have\footnote{ Obviously we could get rid of the minus sign by redefining $\det_\kappa(M, \varphi, \psi)$ as the inverse of its current value, see Definition \ref{definition-periodic-determinant}.} $$ - e_R(M, \varphi, \psi) = \sum\nolimits_{i = 1, \ldots, t} \text{ord}_{R/\mathfrak q_i}\left( \det\nolimits_{\kappa(\mathfrak q_i)} (M_{\mathfrak q_i}, \varphi_{\mathfrak q_i}, \psi_{\mathfrak q_i}) \right) $$ \end{proposition} 
\begin{lemma} \label{lemma-application-herbrand-quotient} Let $R$ be a Noetherian local ring with maximal ideal $\mathfrak m$. Let $M$ be a finite $R$-module, and let $\psi : M \to M$ be an $R$-module map. Assume that \begin{enumerate} \item $\Ker(\psi)$ and $\Coker(\psi)$ have finite length, and \item $\dim(\text{Supp}(M)) \leq 1$. \end{enumerate} Write $\text{Supp}(M) = \{\mathfrak m, \mathfrak q_1, \ldots, \mathfrak q_t\}$ and denote $f_i \in \kappa(\mathfrak q_i)^*$ the element such that $\det_{\kappa(\mathfrak q_i)}(\psi_{\mathfrak q_i}) : \det_{\kappa(\mathfrak q_i)}(M_{\mathfrak q_i}) \to \det_{\kappa(\mathfrak q_i)}(M_{\mathfrak q_i})$ is multiplication by $f_i$. Then we have $$ \text{length}_R(\Coker(\psi)) - \text{length}_R(\Ker(\psi)) = \sum\nolimits_{i = 1, \ldots, t} \text{ord}_{R/\mathfrak q_i}(f_i). $$ \end{lemma} 
\begin{lemma}[Key Lemma] \label{lemma-secondary-ramification} \begin{reference} When $A$ is an excellent ring this is \cite[Proposition 1]{Kato-Milnor-K}. \end{reference} Let $A$ be a $2$-dimensional Noetherian local domain with fraction field $K$. Let $f, g \in K^*$. Let $\mathfrak q_1, \ldots, \mathfrak q_t$ be the height $1$ primes $\mathfrak q$ of $A$ such that either $f$ or $g$ is not an element of $A^*_{\mathfrak q}$. Then we have $$ \sum\nolimits_{i = 1, \ldots, t} \text{ord}_{A/\mathfrak q_i}(d_{A_{\mathfrak q_i}}(f, g)) = 0 $$ We can also write this as $$ \sum\nolimits_{\text{height}(\mathfrak q) = 1} \text{ord}_{A/\mathfrak q}(d_{A_{\mathfrak q}}(f, g)) = 0 $$ since at any height one prime $\mathfrak q$ of $A$ where $f, g \in A^*_{\mathfrak q}$ we have $d_{A_{\mathfrak q}}(f, g) = 1$ by Lemma \ref{lemma-symbol-when-one-is-a-unit}. \end{lemma} 
\begin{lemma} \label{lemma-maps-between-coherent-sheaves} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be a scheme locally of finite type over $S$. Let $\mathcal{F}$ be a coherent sheaf on $X$. Let $$ \xymatrix{ \ldots \ar[r] & \mathcal{F} \ar[r]^\varphi & \mathcal{F} \ar[r]^\psi & \mathcal{F} \ar[r]^\varphi & \mathcal{F} \ar[r] & \ldots } $$ be a complex as in Homology, Equation (\ref{homology-equation-cyclic-complex}). Assume that \begin{enumerate} \item $\dim_\delta(\text{Supp}(\mathcal{F})) \leq k + 1$. \item $\dim_\delta(\text{Supp}(H^i(\mathcal{F}, \varphi, \psi))) \leq k$ for $i = 0, 1$. \end{enumerate} Then we have $$ [H^0(\mathcal{F}, \varphi, \psi)]_k \sim_{rat} [H^1(\mathcal{F}, \varphi, \psi)]_k $$ as $k$-cycles on $X$. \end{lemma} 
\begin{lemma} \label{lemma-cycles-rational-equivalence-K-group} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be a scheme locally of finite type over $S$. The map $$ \CH_k(X) \longrightarrow K_0(\textit{Coh}_{\leq k + 1}(X)/\textit{Coh}_{\leq k - 1}(X)) $$ from Lemma \ref{lemma-from-chow-to-K} induces a bijection from $\CH_k(X)$ onto the image $B_k(X)$ of the map $$ K_0(\textit{Coh}_{\leq k}(X)/\textit{Coh}_{\leq k - 1}(X)) \longrightarrow K_0(\textit{Coh}_{\leq k + 1}(X)/\textit{Coh}_{\leq k - 1}(X)). $$ \end{lemma} 
\begin{lemma} \label{lemma-no-embedded-points-modules} Let $A$ be a Noetherian local ring. Let $M$ be a finite $A$-module. Let $a, b \in A$. Assume \begin{enumerate} \item $\dim(A) = 1$, \item both $a$ and $b$ are nonzerodivisors in $A$, \item $A$ has no embedded primes, \item $M$ has no embedded associated primes, \item $\text{Supp}(M) = \Spec(A)$. \end{enumerate} Let $I = \{x \in A \mid x(a/b) \in A\}$. Let $\mathfrak q_1, \ldots, \mathfrak q_t$ be the minimal primes of $A$. Then $(a/b)IM \subset M$ and $$ \text{length}_A(M/(a/b)IM) - \text{length}_A(M/IM) = \sum\nolimits_i \text{length}_{A_{\mathfrak q_i}}(M_{\mathfrak q_i}) \text{ord}_{A/\mathfrak q_i}(a/b) $$ \end{lemma} 
\begin{lemma} \label{lemma-no-embedded-points} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Let $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module. Let $s \in \Gamma(X, \mathcal{K}_X(\mathcal{L}))$ be a meromorphic section of $\mathcal{L}$. Assume \begin{enumerate} \item $\dim_\delta(X) \leq k + 1$, \item $X$ has no embedded points, \item $\mathcal{F}$ has no embedded associated points, \item the support of $\mathcal{F}$ is $X$, and \item the section $s$ is regular meromorphic. \end{enumerate} In this situation let $\mathcal{I} \subset \mathcal{O}_X$ be the ideal of denominators of $s$, see Divisors, Definition \ref{divisors-definition-regular-meromorphic-ideal-denominators}. Then we have the following: \begin{enumerate} \item there are short exact sequences $$ \begin{matrix} 0 & \to & \mathcal{I}\mathcal{F} & \xrightarrow{1} & \mathcal{F} & \to & \mathcal{Q}_1 & \to & 0 \\ 0 & \to & \mathcal{I}\mathcal{F} & \xrightarrow{s} & \mathcal{F} \otimes_{\mathcal{O}_X} \mathcal{L} & \to & \mathcal{Q}_2 & \to & 0 \end{matrix} $$ \item the coherent sheaves $\mathcal{Q}_1$, $\mathcal{Q}_2$ are supported in $\delta$-dimension $\leq k$, \item the section $s$ restricts to a regular meromorphic section $s_i$ on every irreducible component $X_i$ of $X$ of $\delta$-dimension $k + 1$, and \item writing $[\mathcal{F}]_{k + 1} = \sum m_i[X_i]$ we have $$ [\mathcal{Q}_2]_k - [\mathcal{Q}_1]_k = \sum m_i(X_i \to X)_*\text{div}_{\mathcal{L}|_{X_i}}(s_i) $$ in $Z_k(X)$, in particular $$ [\mathcal{Q}_2]_k - [\mathcal{Q}_1]_k = c_1(\mathcal{L}) \cap [\mathcal{F}]_{k + 1} $$ in $\CH_k(X)$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-coherent-sheaf-cap-c1} Let $(S, \delta)$ be as in Situation \ref{situation-setup}. Let $X$ be locally of finite type over $S$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Let $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module. Assume $\dim_\delta(\text{Supp}(\mathcal{F})) \leq k + 1$. Then the element $$ [\mathcal{F} \otimes_{\mathcal{O}_X} \mathcal{L}] - [\mathcal{F}] \in K_0(\textit{Coh}_{\leq k + 1}(X)/\textit{Coh}_{\leq k - 1}(X)) $$ lies in the subgroup $B_k(X)$ of Lemma \ref{lemma-cycles-rational-equivalence-K-group} and maps to the element $c_1(\mathcal{L}) \cap [\mathcal{F}]_{k + 1}$ via the map $B_k(X) \to \CH_k(X)$. \end{lemma} 
