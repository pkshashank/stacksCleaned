\begin{lemma} \label{lemma-closed-immersion} Let $i : Z \to X$ be a morphism of schemes. The following are equivalent: \begin{enumerate} \item The morphism $i$ is a closed immersion. \item For every affine open $\Spec(R) = U \subset X$, there exists an ideal $I \subset R$ such that $i^{-1}(U) = \Spec(R/I)$ as schemes over $U = \Spec(R)$. \item There exists an affine open covering $X = \bigcup_{j \in J} U_j$, $U_j = \Spec(R_j)$ and for every $j \in J$ there exists an ideal $I_j \subset R_j$ such that $i^{-1}(U_j) = \Spec(R_j/I_j)$ as schemes over $U_j = \Spec(R_j)$. \item The morphism $i$ induces a homeomorphism of $Z$ with a closed subset of $X$ and $i^\sharp : \mathcal{O}_X \to i_*\mathcal{O}_Z$ is surjective. \item The morphism $i$ induces a homeomorphism of $Z$ with a closed subset of $X$, the map $i^\sharp : \mathcal{O}_X \to i_*\mathcal{O}_Z$ is surjective, and the kernel $\Ker(i^\sharp)\subset \mathcal{O}_X$ is a quasi-coherent sheaf of ideals. \item The morphism $i$ induces a homeomorphism of $Z$ with a closed subset of $X$, the map $i^\sharp : \mathcal{O}_X \to i_*\mathcal{O}_Z$ is surjective, and the kernel $\Ker(i^\sharp)\subset \mathcal{O}_X$ is a sheaf of ideals which is locally generated by sections. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-closed-immersion-ideals} Let $X$ be a scheme. Let $i : Z \to X$ and $i' : Z' \to X$ be closed immersions and consider the ideal sheaves $\mathcal{I} = \Ker(i^\sharp)$ and $\mathcal{I}' = \Ker((i')^\sharp)$ of $\mathcal{O}_X$. \begin{enumerate} \item The morphism $i : Z \to X$ factors as $Z \to Z' \to X$ for some $a : Z \to Z'$ if and only if $\mathcal{I}' \subset \mathcal{I}$. If this happens, then $a$ is a closed immersion. \item We have $Z \cong Z'$ over $X$ if and only if $\mathcal{I} = \mathcal{I}'$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-closed-immersion-bijection-ideals} Let $X$ be a scheme. Let $\mathcal{I} \subset \mathcal{O}_X$ be a sheaf of ideals. The following are equivalent: \begin{enumerate} \item $\mathcal{I}$ is locally generated by sections as a sheaf of $\mathcal{O}_X$-modules, \item $\mathcal{I}$ is quasi-coherent as a sheaf of $\mathcal{O}_X$-modules, and \item there exists a closed immersion $i : Z \to X$ of schemes whose corresponding sheaf of ideals $\Ker(i^\sharp)$ is equal to $\mathcal{I}$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-base-change-closed-immersion} The base change of a closed immersion is a closed immersion. \end{lemma} 
\begin{lemma} \label{lemma-composition-closed-immersion} A composition of closed immersions is a closed immersion. \end{lemma} 
\begin{lemma} \label{lemma-closed-immersion-quasi-compact} A closed immersion is quasi-compact. \end{lemma} 
\begin{lemma} \label{lemma-closed-immersion-separated} A closed immersion is separated. \end{lemma} 
\begin{lemma} \label{lemma-immersion-permanence} Let $Z \to Y \to X$ be morphisms of schemes. \begin{enumerate} \item If $Z \to X$ is an immersion, then $Z \to Y$ is an immersion. \item If $Z \to X$ is a quasi-compact immersion and $Y \to X$ is quasi-separated, then $Z \to Y$ is a quasi-compact immersion. \item If $Z \to X$ is a closed immersion and $Y \to X$ is separated, then $Z \to Y$ is a closed immersion. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-factor-quasi-compact-immersion} Let $h : Z \to X$ be an immersion. If $h$ is quasi-compact, then we can factor $h = i \circ j$ with $j : Z \to \overline{Z}$ an open immersion and $i : \overline{Z} \to X$ a closed immersion. \end{lemma} 
\begin{lemma} \label{lemma-factor-reduced-immersion} Let $h : Z \to X$ be an immersion. If $Z$ is reduced, then we can factor $h = i \circ j$ with $j : Z \to \overline{Z}$ an open immersion and $i : \overline{Z} \to X$ a closed immersion. \end{lemma} 
\begin{lemma} \label{lemma-check-immersion} Let $f : Y \to X$ be a morphism of schemes. If for all $y \in Y$ there is an open subscheme $f(y) \in U \subset X$ such that $f|_{f^{-1}(U)} : f^{-1}(U) \to U$ is an immersion, then $f$ is an immersion. \end{lemma} 
\begin{lemma} \label{lemma-i-star-equivalence} Let $i : Z \to X$ be a closed immersion of schemes. Let $\mathcal{I} \subset \mathcal{O}_X$ be the quasi-coherent sheaf of ideals cutting out $Z$. The functor $$ i_* : \QCoh(\mathcal{O}_Z) \longrightarrow \QCoh(\mathcal{O}_X) $$ is exact, fully faithful, with essential image those quasi-coherent $\mathcal{O}_X$-modules $\mathcal{G}$ such that $\mathcal{I}\mathcal{G} = 0$. \end{lemma} 
\begin{lemma} \label{lemma-largest-quasi-coherent-subsheaf} Let $X$ be a scheme. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. Let $\mathcal{G} \subset \mathcal{F}$ be a $\mathcal{O}_X$-submodule. There exists a unique quasi-coherent $\mathcal{O}_X$-submodule $\mathcal{G}' \subset \mathcal{G}$ with the following property: For every quasi-coherent $\mathcal{O}_X$-module $\mathcal{H}$ the map $$ \Hom_{\mathcal{O}_X}(\mathcal{H}, \mathcal{G}') \longrightarrow \Hom_{\mathcal{O}_X}(\mathcal{H}, \mathcal{G}) $$ is bijective. In particular $\mathcal{G}'$ is the largest quasi-coherent $\mathcal{O}_X$-submodule of $\mathcal{F}$ contained in $\mathcal{G}$. \end{lemma} 
\begin{lemma} \label{lemma-i-upper-shriek} Let $i : Z \to X$ be a closed immersion of schemes. There is a functor\footnote{This is likely nonstandard notation.} $i^! : \QCoh(\mathcal{O}_X) \to \QCoh(\mathcal{O}_Z)$ which is a right adjoint to $i_*$. (Compare Modules, Lemma \ref{modules-lemma-i-star-right-adjoint}.) \end{lemma} 
\begin{definition} \label{definition-scheme-theoretic-intersection-union} Let $X$ be a scheme. Let $Z, Y \subset X$ be closed subschemes corresponding to quasi-coherent ideal sheaves $\mathcal{I}, \mathcal{J} \subset \mathcal{O}_X$. The {\it scheme theoretic intersection} of $Z$ and $Y$ is the closed subscheme of $X$ cut out by $\mathcal{I} + \mathcal{J}$. The {\it scheme theoretic union} of $Z$ and $Y$ is the closed subscheme of $X$ cut out by $\mathcal{I} \cap \mathcal{J}$. \end{definition} 
\begin{lemma} \label{lemma-scheme-theoretic-intersection} Let $X$ be a scheme. Let $Z, Y \subset X$ be closed subschemes. Let $Z \cap Y$ be the scheme theoretic intersection of $Z$ and $Y$. Then $Z \cap Y \to Z$ and $Z \cap Y \to Y$ are closed immersions and $$ \xymatrix{ Z \cap Y \ar[r] \ar[d] & Z \ar[d] \\ Y \ar[r] & X } $$ is a cartesian diagram of schemes, i.e., $Z \cap Y = Z \times_X Y$. \end{lemma} 
\begin{lemma} \label{lemma-scheme-theoretic-union} Let $S$ be a scheme. Let $X, Y \subset S$ be closed subschemes. Let $X \cup Y$ be the scheme theoretic union of $X$ and $Y$. Let $X \cap Y$ be the scheme theoretic intersection of $X$ and $Y$. Then $X \to X \cup Y$ and $Y \to X \cup Y$ are closed immersions, there is a short exact sequence $$ 0 \to \mathcal{O}_{X \cup Y} \to \mathcal{O}_X \times \mathcal{O}_Y \to \mathcal{O}_{X \cap Y} \to 0 $$ of $\mathcal{O}_S$-modules, and the diagram $$ \xymatrix{ X \cap Y \ar[r] \ar[d] & X \ar[d] \\ Y \ar[r] & X \cup Y } $$ is cocartesian in the category of schemes, i.e., $X \cup Y = X \amalg_{X \cap Y} Y$. \end{lemma} 
\begin{lemma} \label{lemma-support-affine-open} Let $X$ be a scheme. Let $\mathcal{F}$ be a quasi-coherent sheaf on $X$. Let $\Spec(A) = U \subset X$ be an affine open, and set $M = \Gamma(U, \mathcal{F})$. Let $x \in U$, and let $\mathfrak p \subset A$ be the corresponding prime. The following are equivalent \begin{enumerate} \item $\mathfrak p$ is in the support of $M$, and \item $x$ is in the support of $\mathcal{F}$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-support-closed-specialization} Let $X$ be a scheme. Let $\mathcal{F}$ be a quasi-coherent sheaf on $X$. The support of $\mathcal{F}$ is closed under specialization. \end{lemma} 
\begin{lemma} \label{lemma-support-finite-type} Let $\mathcal{F}$ be a finite type quasi-coherent module on a scheme $X$. Then \begin{enumerate} \item The support of $\mathcal{F}$ is closed. \item For $x \in X$ we have $$ x \in \text{Supp}(\mathcal{F}) \Leftrightarrow \mathcal{F}_x \not = 0 \Leftrightarrow \mathcal{F}_x \otimes_{\mathcal{O}_{X, x}} \kappa(x) \not = 0. $$ \item For any morphism of schemes $f : Y \to X$ the pullback $f^*\mathcal{F}$ is of finite type as well and we have $\text{Supp}(f^*\mathcal{F}) = f^{-1}(\text{Supp}(\mathcal{F}))$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-scheme-theoretic-support} Let $\mathcal{F}$ be a finite type quasi-coherent module on a scheme $X$. There exists a smallest closed subscheme $i : Z \to X$ such that there exists a quasi-coherent $\mathcal{O}_Z$-module $\mathcal{G}$ with $i_*\mathcal{G} \cong \mathcal{F}$. Moreover: \begin{enumerate} \item If $\Spec(A) \subset X$ is any affine open, and $\mathcal{F}|_{\Spec(A)} = \widetilde{M}$ then $Z \cap \Spec(A) = \Spec(A/I)$ where $I = \text{Ann}_A(M)$. \item The quasi-coherent sheaf $\mathcal{G}$ is unique up to unique isomorphism. \item The quasi-coherent sheaf $\mathcal{G}$ is of finite type. \item The support of $\mathcal{G}$ and of $\mathcal{F}$ is $Z$. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-scheme-theoretic-support} Let $X$ be a scheme. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module of finite type. The {\it scheme theoretic support of $\mathcal{F}$} is the closed subscheme $Z \subset X$ constructed in Lemma \ref{lemma-scheme-theoretic-support}. \end{definition} 
\begin{lemma} \label{lemma-scheme-theoretic-image} Let $f : X \to Y$ be a morphism of schemes. There exists a closed subscheme $Z \subset Y$ such that $f$ factors through $Z$ and such that for any other closed subscheme $Z' \subset Y$ such that $f$ factors through $Z'$ we have $Z \subset Z'$. \end{lemma} 
\begin{definition} \label{definition-scheme-theoretic-image} Let $f : X \to Y$ be a morphism of schemes. The {\it scheme theoretic image} of $f$ is the smallest closed subscheme $Z \subset Y$ through which $f$ factors, see Lemma \ref{lemma-scheme-theoretic-image} above. \end{definition} 
\begin{lemma} \label{lemma-quasi-compact-scheme-theoretic-image} Let $f : X \to Y$ be a morphism of schemes. Let $Z \subset Y$ be the scheme theoretic image of $f$. If $f$ is quasi-compact then \begin{enumerate} \item the sheaf of ideals $\mathcal{I} = \Ker(\mathcal{O}_Y \to f_*\mathcal{O}_X)$ is quasi-coherent, \item the scheme theoretic image $Z$ is the closed subscheme determined by $\mathcal{I}$, \item for any open $U \subset Y$ the scheme theoretic image of $f|_{f^{-1}(U)} : f^{-1}(U) \to U$ is equal to $Z \cap U$, and \item the image $f(X) \subset Z$ is a dense subset of $Z$, in other words the morphism $X \to Z$ is dominant (see Definition \ref{definition-dominant}). \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-reach-points-scheme-theoretic-image} Let $f : X \to Y$ be a quasi-compact morphism. Let $Z$ be the scheme theoretic image of $f$. Let $z \in Z$\footnote{By Lemma \ref{lemma-quasi-compact-scheme-theoretic-image} set-theoretically $Z$ agrees with the closure of $f(X)$ in $Y$.}. There exists a valuation ring $A$ with fraction field $K$ and a commutative diagram $$ \xymatrix{ \Spec(K) \ar[rr] \ar[d] & & X \ar[d] \ar[ld] \\ \Spec(A) \ar[r] & Z \ar[r] & Y } $$ such that the closed point of $\Spec(A)$ maps to $z$. In particular any point of $Z$ is the specialization of a point of $f(X)$. \end{lemma} 
\begin{lemma} \label{lemma-factor-factor} Let $$ \xymatrix{ X_1 \ar[d] \ar[r]_{f_1} & Y_1 \ar[d] \\ X_2 \ar[r]^{f_2} & Y_2 } $$ be a commutative diagram of schemes. Let $Z_i \subset Y_i$, $i = 1, 2$ be the scheme theoretic image of $f_i$. Then the morphism $Y_1 \to Y_2$ induces a morphism $Z_1 \to Z_2$ and a commutative diagram $$ \xymatrix{ X_1 \ar[r] \ar[d] & Z_1 \ar[d] \ar[r] & Y_1 \ar[d] \\ X_2 \ar[r] & Z_2 \ar[r] & Y_2 } $$ \end{lemma} 
\begin{lemma} \label{lemma-scheme-theoretic-image-reduced} Let $f : X \to Y$ be a morphism of schemes. If $X$ is reduced, then the scheme theoretic image of $f$ is the reduced induced scheme structure on $\overline{f(X)}$. \end{lemma} 
\begin{lemma} \label{lemma-scheme-theoretic-image-of-partial-section} Let $f : X \to Y$ be a separated morphism of schemes. Let $V \subset Y$ be a retrocompact open. Let $s : V \to X$ be a morphism such that $f \circ s = \text{id}_V$. Let $Y'$ be the scheme theoretic image of $s$. Then $Y' \to Y$ is an isomorphism over $V$. \end{lemma} 
\begin{definition} \label{definition-scheme-theoretically-dense} Let $X$ be a scheme. Let $U \subset X$ be an open subscheme. \begin{enumerate} \item The scheme theoretic image of the morphism $U \to X$ is called the {\it scheme theoretic closure of $U$ in $X$}. \item We say $U$ is {\it scheme theoretically dense in $X$} if for every open $V \subset X$ the scheme theoretic closure of $U \cap V$ in $V$ is equal to $V$. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-scheme-theoretically-dense-quasi-compact} Let $X$ be a scheme. Let $U \subset X$ be an open subscheme. If the inclusion morphism $U \to X$ is quasi-compact, then $U$ is scheme theoretically dense in $X$ if and only if the scheme theoretic closure of $U$ in $X$ is $X$. \end{lemma} 
\begin{lemma} \label{lemma-characterize-scheme-theoretically-dense} Let $j : U \to X$ be an open immersion of schemes. Then $U$ is scheme theoretically dense in $X$ if and only if $\mathcal{O}_X \to j_*\mathcal{O}_U$ is injective. \end{lemma} 
\begin{lemma} \label{lemma-intersection-scheme-theoretically-dense} Let $X$ be a scheme. If $U$, $V$ are scheme theoretically dense open subschemes of $X$, then so is $U \cap V$. \end{lemma} 
\begin{lemma} \label{lemma-quasi-compact-immersion} Let $h : Z \to X$ be an immersion. Assume either $h$ is quasi-compact or $Z$ is reduced. Let $\overline{Z} \subset X$ be the scheme theoretic image of $h$. Then the morphism $Z \to \overline{Z}$ is an open immersion which identifies $Z$ with a scheme theoretically dense open subscheme of $\overline{Z}$. Moreover, $Z$ is topologically dense in $\overline{Z}$. \end{lemma} 
\begin{lemma} \label{lemma-reduced-scheme-theoretically-dense} Let $X$ be a reduced scheme and let $U \subset X$ be an open subscheme. Then the following are equivalent \begin{enumerate} \item $U$ is topologically dense in $X$, \item the scheme theoretic closure of $U$ in $X$ is $X$, and \item $U$ is scheme theoretically dense in $X$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-reduced-subscheme-closure} Let $X$ be a scheme and let $U \subset X$ be a reduced open subscheme. Then the following are equivalent \begin{enumerate} \item the scheme theoretic closure of $U$ in $X$ is $X$, and \item $U$ is scheme theoretically dense in $X$. \end{enumerate} If this holds then $X$ is a reduced scheme. \end{lemma} 
\begin{lemma} \label{lemma-equality-of-morphisms} Let $S$ be a scheme. Let $X$, $Y$ be schemes over $S$. Let $f, g : X \to Y$ be morphisms of schemes over $S$. Let $U \subset X$ be an open subscheme such that $f|_U = g|_U$. If the scheme theoretic closure of $U$ in $X$ is $X$ and $Y \to S$ is separated, then $f = g$. \end{lemma} 
\begin{definition} \label{definition-dominant} A morphism $f : X \to S$ of schemes is called {\it dominant} if the image of $f$ is a dense subset of $S$. \end{definition} 
\begin{lemma} \label{lemma-generic-points-in-image-dominant} Let $f : X \to S$ be a morphism of schemes. If every generic point of every irreducible component of $S$ is in the image of $f$, then $f$ is dominant. \end{lemma} 
\begin{lemma} \label{lemma-quasi-compact-dominant} \begin{slogan} Morphisms whose image contains the generic points are dominant \end{slogan} Let $f : X \to S$ be a quasi-compact morphism of schemes. Then $f$ is dominant if and only if for every irreducible component $Z \subset S$ the generic point of $Z$ is in the image of $f$. \end{lemma} 
\begin{lemma} \label{lemma-base-change-dominant} Let $f : X \to S$ be a quasi-compact dominant morphism of schemes. Let $g : S' \to S$ be a morphism of schemes and denote $f' : X' \to S'$ the base change of $f$ by $g$. If generalizations lift along $g$, then $f'$ is dominant. \end{lemma} 
\begin{lemma} \label{lemma-quasi-compact-generic-point-not-in-image} Let $f : X \to S$ be a quasi-compact morphism of schemes. Let $\eta \in S$ be a generic point of an irreducible component of $S$. If $\eta \not \in f(X)$ then there exists an open neighbourhood $V \subset S$ of $\eta$ such that $f^{-1}(V) = \emptyset$. \end{lemma} 
\begin{lemma} \label{lemma-dominant-finite-number-irreducible-components} Let $f : X \to S$ be a morphism of schemes. Suppose that $X$ has finitely many irreducible components. Then $f$ is dominant (if and) only if for every irreducible component $Z \subset S$ the generic point of $Z$ is in the image of $f$. If so, then $S$ has finitely many irreducible components as well. \end{lemma} 
\begin{lemma} \label{lemma-dominant-between-integral} Let $f : X \to Y$ be a morphism of integral schemes. The following are equivalent \begin{enumerate} \item $f$ is dominant, \item $f$ maps the generic point of $X$ to the generic point of $Y$, \item for some nonempty affine opens $U \subset X$ and $V \subset Y$ with $f(U) \subset V$ the ring map $\mathcal{O}_Y(V) \to \mathcal{O}_X(U)$ is injective, \item for all nonempty affine opens $U \subset X$ and $V \subset Y$ with $f(U) \subset V$ the ring map $\mathcal{O}_Y(V) \to \mathcal{O}_X(U)$ is injective, \item for some $x \in X$ with image $y = f(x) \in Y$ the local ring map $\mathcal{O}_{Y, y} \to \mathcal{O}_{X, x}$ is injective, and \item for all $x \in X$ with image $y = f(x) \in Y$ the local ring map $\mathcal{O}_{Y, y} \to \mathcal{O}_{X, x}$ is injective. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-surjective} A morphism of schemes is said to be {\it surjective} if it is surjective on underlying topological spaces. \end{definition} 
\begin{lemma} \label{lemma-composition-surjective} The composition of surjective morphisms is surjective. \end{lemma} 
\begin{lemma} \label{lemma-when-point-maps-to-pair} Let $X$ and $Y$ be schemes over a base scheme $S$. Given points $x \in X$ and $y \in Y$, there is a point of $X \times_S Y$ mapping to $x$ and $y$ under the projections if and only if $x$ and $y$ lie above the same point of $S$. \end{lemma} 
\begin{lemma} \label{lemma-base-change-surjective} The base change of a surjective morphism is surjective. \end{lemma} 
\begin{lemma} \label{lemma-surjection-from-quasi-compact} Let $$ \xymatrix{ X \ar[rr]_f \ar[rd]_p & & Y \ar[dl]^q \\ & Z } $$ be a commutative diagram of morphisms of schemes. If $f$ is surjective and $p$ is quasi-compact, then $q$ is quasi-compact. \end{lemma} 
\begin{definition} \label{definition-universally-injective} Let $f : X \to S$ be a morphism. \begin{enumerate} \item We say that $f$ is {\it universally injective} if and only if for any morphism of schemes $S' \to S$ the base change $f' : X_{S'} \to S'$ is injective (on underlying topological spaces). \item We say $f$ is {\it radicial} if $f$ is injective as a map of topological spaces, and for every $x \in X$ the field extension $\kappa(x)/\kappa(f(x))$ is purely inseparable. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-universally-injective} Let $f : X \to S$ be a morphism of schemes. The following are equivalent: \begin{enumerate} \item For every field $K$ the induced map $\Mor(\Spec(K), X) \to \Mor(\Spec(K), S)$ is injective. \item The morphism $f$ is universally injective. \item The morphism $f$ is radicial. \item The diagonal morphism $\Delta_{X/S} : X \longrightarrow X \times_S X$ is surjective. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-universally-injective-separated} A universally injective morphism is separated. \end{lemma} 
\begin{lemma} \label{lemma-base-change-universally-injective} A base change of a universally injective morphism is universally injective. \end{lemma} 
\begin{lemma} \label{lemma-composition-universally-injective} A composition of radicial morphisms is radicial, and so the same holds for the equivalent condition of being universally injective. \end{lemma} 
\begin{definition} \label{definition-affine} A morphism of schemes $f : X \to S$ is called {\it affine} if the inverse image of every affine open of $S$ is an affine open of $X$. \end{definition} 
\begin{lemma} \label{lemma-affine-separated} An affine morphism is separated and quasi-compact. \end{lemma} 
\begin{lemma} \label{lemma-characterize-affine} \begin{reference} \cite[II, Corollary 1.3.2]{EGA} \end{reference} Let $f : X \to S$ be a morphism of schemes. The following are equivalent \begin{enumerate} \item The morphism $f$ is affine. \item There exists an affine open covering $S = \bigcup W_j$ such that each $f^{-1}(W_j)$ is affine. \item There exists a quasi-coherent sheaf of $\mathcal{O}_S$-algebras $\mathcal{A}$ and an isomorphism $X \cong \underline{\Spec}_S(\mathcal{A})$ of schemes over $S$. See Constructions, Section \ref{constructions-section-spec} for notation. \end{enumerate} Moreover, in this case $X = \underline{\Spec}_S(f_*\mathcal{O}_X)$. \end{lemma} 
\begin{lemma} \label{lemma-affine-equivalence-algebras} Let $S$ be a scheme. There is an anti-equivalence of categories $$ \begin{matrix} \text{Schemes affine} \\ \text{over }S \end{matrix} \longleftrightarrow \begin{matrix} \text{quasi-coherent sheaves} \\ \text{of }\mathcal{O}_S\text{-algebras} \end{matrix} $$ which associates to $f : X \to S$ the sheaf $f_*\mathcal{O}_X$. Moreover, this equivalence is compatible with arbitrary base change. \end{lemma} 
\begin{lemma} \label{lemma-quasi-coherence-scalar-restriction} Let $S$ be a scheme and let $\mathcal{A}$ be a quasi-coherent $\mathcal{O}_S$-algebra. An $\mathcal{A}$-module is quasi-coherent as an $\mathcal{O}_S$-module if and only if it is quasi-coherent as an $\mathcal{A}$-module. \end{lemma} 
\begin{lemma} \label{lemma-affine-equivalence-modules} Let $f : X \to S$ be an affine morphism of schemes. Let $\mathcal{A} = f_*\mathcal{O}_X$. The functor $\mathcal{F} \mapsto f_*\mathcal{F}$ induces an equivalence of categories $$ \left\{ \begin{matrix} \text{category of quasi-coherent}\\ \mathcal{O}_X\text{-modules} \end{matrix} \right\} \longrightarrow \left\{ \begin{matrix} \text{category of quasi-coherent}\\ \mathcal{A}\text{-modules} \end{matrix} \right\} $$ Moreover, an $\mathcal{A}$-module is quasi-coherent as an $\mathcal{O}_S$-module if and only if it is quasi-coherent as an $\mathcal{A}$-module. \end{lemma} 
\begin{lemma} \label{lemma-composition-affine} The composition of affine morphisms is affine. \end{lemma} 
\begin{lemma} \label{lemma-base-change-affine} The base change of an affine morphism is affine. \end{lemma} 
\begin{lemma} \label{lemma-closed-immersion-affine} A closed immersion is affine. \end{lemma} 
\begin{lemma} \label{lemma-affine-s-open} Let $X$ be a scheme. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Let $s \in \Gamma(X, \mathcal{L})$. The inclusion morphism $j : X_s \to X$ is affine. \end{lemma} 
\begin{lemma} \label{lemma-affine-permanence} Suppose $g : X \to Y$ is a morphism of schemes over $S$. \begin{enumerate} \item If $X$ is affine over $S$ and $\Delta : Y \to Y \times_S Y$ is affine, then $g$ is affine. \item If $X$ is affine over $S$ and $Y$ is separated over $S$, then $g$ is affine. \item A morphism from an affine scheme to a scheme with affine diagonal is affine. \item A morphism from an affine scheme to a separated scheme is affine. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-morphism-affines-affine} A morphism between affine schemes is affine. \end{lemma} 
\begin{lemma} \label{lemma-Artinian-affine} Let $S$ be a scheme. Let $A$ be an Artinian ring. Any morphism $\Spec(A) \to S$ is affine. \end{lemma} 
\begin{lemma} \label{lemma-get-affine} Let $j : Y \to X$ be an immersion of schemes. Assume there exists an open $U \subset X$ with complement $Z = X \setminus U$ such that \begin{enumerate} \item $U \to X$ is affine, \item $j^{-1}(U) \to U$ is affine, and \item $j(Y) \cap Z$ is closed. \end{enumerate} Then $j$ is affine. In particular, if $X$ is affine, so is $Y$. \end{lemma} 
\begin{definition} \label{definition-family-ample-invertible-modules} \begin{reference} \cite[II Definition 2.2.4]{SGA6} \end{reference} Let $X$ be a scheme. Let $\{\mathcal{L}_i\}_{i \in I}$ be a family of invertible $\mathcal{O}_X$-modules. We say $\{\mathcal{L}_i\}_{i \in I}$ is an {\it ample family of invertible modules on $X$} if \begin{enumerate} \item $X$ is quasi-compact, and \item for every $x \in X$ there exists an $i \in I$, an $n \geq 1$, and $s \in \Gamma(X, \mathcal{L}_i^{\otimes n})$ such that $x \in X_s$ and $X_s$ is affine. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-affine-diagonal} Let $X$ be a scheme such that for every point $x \in X$ there exists an invertible $\mathcal{O}_X$-module $\mathcal{L}$ and a global section $s \in \Gamma(X, \mathcal{L})$ such that $x \in X_s$ and $X_s$ is affine. Then the diagonal of $X$ is an affine morphism. \end{lemma} 
\begin{definition} \label{definition-quasi-affine} A morphism of schemes $f : X \to S$ is called {\it quasi-affine} if the inverse image of every affine open of $S$ is a quasi-affine scheme. \end{definition} 
\begin{lemma} \label{lemma-quasi-affine-separated} A quasi-affine morphism is separated and quasi-compact. \end{lemma} 
\begin{lemma} \label{lemma-characterize-quasi-affine} Let $f : X \to S$ be a morphism of schemes. The following are equivalent \begin{enumerate} \item The morphism $f$ is quasi-affine. \item There exists an affine open covering $S = \bigcup W_j$ such that each $f^{-1}(W_j)$ is quasi-affine. \item There exists a quasi-coherent sheaf of $\mathcal{O}_S$-algebras $\mathcal{A}$ and a quasi-compact open immersion $$ \xymatrix{ X \ar[rr] \ar[rd] & & \underline{\Spec}_S(\mathcal{A}) \ar[dl] \\ & S & } $$ over $S$. \item Same as in (3) but with $\mathcal{A} = f_*\mathcal{O}_X$ and the horizontal arrow the canonical morphism of Constructions, Lemma \ref{constructions-lemma-canonical-morphism}. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-composition-quasi-affine} The composition of quasi-affine morphisms is quasi-affine. \end{lemma} 
\begin{lemma} \label{lemma-base-change-quasi-affine} The base change of a quasi-affine morphism is quasi-affine. \end{lemma} 
\begin{lemma} \label{lemma-quasi-compact-immersion-quasi-affine} A quasi-compact immersion is quasi-affine. \end{lemma} 
\begin{lemma} \label{lemma-affine-quasi-affine} Let $S$ be a scheme. Let $X$ be an affine scheme. A morphism $f : X \to S$ is quasi-affine if and only if it is quasi-compact. In particular any morphism from an affine scheme to a quasi-separated scheme is quasi-affine. \end{lemma} 
\begin{lemma} \label{lemma-quasi-affine-permanence} Suppose $g : X \to Y$ is a morphism of schemes over $S$. If $X$ is quasi-affine over $S$ and $Y$ is quasi-separated over $S$, then $g$ is quasi-affine. In particular, any morphism from a quasi-affine scheme to a quasi-separated scheme is quasi-affine. \end{lemma} 
\begin{definition} \label{definition-property-local} Let $P$ be a property of ring maps. \begin{enumerate} \item We say that $P$ is {\it local} if the following hold: \begin{enumerate} \item For any ring map $R \to A$, and any $f \in R$ we have $P(R \to A) \Rightarrow P(R_f \to A_f)$. \item For any rings $R$, $A$, any $f \in R$, $a\in A$, and any ring map $R_f \to A$ we have $P(R_f \to A) \Rightarrow P(R \to A_a)$. \item For any ring map $R \to A$, and $a_i \in A$ such that $(a_1, \ldots, a_n) = A$ then $\forall i, P(R \to A_{a_i}) \Rightarrow P(R \to A)$. \end{enumerate} \item We say that $P$ is {\it stable under base change} if for any ring maps $R \to A$, $R \to R'$ we have $P(R \to A) \Rightarrow P(R' \to R' \otimes_R A)$. \item We say that $P$ is {\it stable under composition} if for any ring maps $A \to B$, $B \to C$ we have $P(A \to B) \wedge P(B \to C) \Rightarrow P(A \to C)$. \end{enumerate} \end{definition} 
\begin{definition} \label{definition-locally-P} Let $P$ be a property of ring maps. Let $f : X \to S$ be a morphism of schemes. We say $f$ is {\it locally of type $P$} if for any $x \in X$ there exists an affine open neighbourhood $U$ of $x$ in $X$ which maps into an affine open $V \subset S$ such that the induced ring map $\mathcal{O}_S(V) \to \mathcal{O}_X(U)$ has property $P$. \end{definition} 
\begin{lemma} \label{lemma-locally-P} Let $f : X \to S$ be a morphism of schemes. Let $P$ be a property of ring maps. Let $U$ be an affine open of $X$, and $V$ an affine open of $S$ such that $f(U) \subset V$. If $f$ is locally of type $P$ and $P$ is local, then $P(\mathcal{O}_S(V) \to \mathcal{O}_X(U))$ holds. \end{lemma} 
\begin{lemma} \label{lemma-locally-P-characterize} Let $P$ be a local property of ring maps. Let $f : X \to S$ be a morphism of schemes. The following are equivalent \begin{enumerate} \item The morphism $f$ is locally of type $P$. \item For every affine opens $U \subset X$, $V \subset S$ with $f(U) \subset V$ we have $P(\mathcal{O}_S(V) \to \mathcal{O}_X(U))$. \item There exists an open covering $S = \bigcup_{j \in J} V_j$ and open coverings $f^{-1}(V_j) = \bigcup_{i \in I_j} U_i$ such that each of the morphisms $U_i \to V_j$, $j\in J, i\in I_j$ is locally of type $P$. \item There exists an affine open covering $S = \bigcup_{j \in J} V_j$ and affine open coverings $f^{-1}(V_j) = \bigcup_{i \in I_j} U_i$ such that $P(\mathcal{O}_S(V_j) \to \mathcal{O}_X(U_i))$ holds, for all $j\in J, i\in I_j$. \end{enumerate} Moreover, if $f$ is locally of type $P$ then for any open subschemes $U \subset X$, $V \subset S$ with $f(U) \subset V$ the restriction $f|_U : U \to V$ is locally of type $P$. \end{lemma} 
\begin{lemma} \label{lemma-composition-type-P} Let $P$ be a property of ring maps. Assume $P$ is local and stable under composition. The composition of morphisms locally of type $P$ is locally of type $P$. \end{lemma} 
\begin{lemma} \label{lemma-base-change-type-P} Let $P$ be a property of ring maps. Assume $P$ is local and stable under base change. The base change of a morphism locally of type $P$ is locally of type $P$. \end{lemma} 
\begin{lemma} \label{lemma-properties-local} The following properties of a ring map $R \to A$ are local. \begin{enumerate} \item (Isomorphism on local rings.) For every prime $\mathfrak q$ of $A$ lying over $\mathfrak p \subset R$ the ring map $R \to A$ induces an isomorphism $R_{\mathfrak p} \to A_{\mathfrak q}$. \item (Open immersion.) For every prime $\mathfrak q$ of $A$ there exists an $f \in R$, $\varphi(f) \not \in \mathfrak q$ such that the ring map $\varphi : R \to A$ induces an isomorphism $R_f \to A_f$. \item (Reduced fibres.) For every prime $\mathfrak p$ of $R$ the fibre ring $A \otimes_R \kappa(\mathfrak p)$ is reduced. \item (Fibres of dimension at most $n$.) For every prime $\mathfrak p$ of $R$ the fibre ring $A \otimes_R \kappa(\mathfrak p)$ has Krull dimension at most $n$. \item (Locally Noetherian on the target.) The ring map $R \to A$ has the property that $A$ is Noetherian. \item Add more here as needed\footnote{But only those properties that are not already dealt with separately elsewhere.}. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-properties-base-change} The following properties of ring maps are stable under base change. \begin{enumerate} \item (Isomorphism on local rings.) For every prime $\mathfrak q$ of $A$ lying over $\mathfrak p \subset R$ the ring map $R \to A$ induces an isomorphism $R_{\mathfrak p} \to A_{\mathfrak q}$. \item (Open immersion.) For every prime $\mathfrak q$ of $A$ there exists an $f \in R$, $\varphi(f) \not \in \mathfrak q$ such that the ring map $\varphi : R \to A$ induces an isomorphism $R_f \to A_f$. \item Add more here as needed\footnote{But only those properties that are not already dealt with separately elsewhere.}. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-properties-composition} The following properties of ring maps are stable under composition. \begin{enumerate} \item (Isomorphism on local rings.) For every prime $\mathfrak q$ of $A$ lying over $\mathfrak p \subset R$ the ring map $R \to A$ induces an isomorphism $R_{\mathfrak p} \to A_{\mathfrak q}$. \item (Open immersion.) For every prime $\mathfrak q$ of $A$ there exists an $f \in R$, $\varphi(f) \not \in \mathfrak q$ such that the ring map $\varphi : R \to A$ induces an isomorphism $R_f \to A_f$. \item (Locally Noetherian on the target.) The ring map $R \to A$ has the property that $A$ is Noetherian. \item Add more here as needed\footnote{But only those properties that are not already dealt with separately elsewhere.}. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-finite-type} Let $f : X \to S$ be a morphism of schemes. \begin{enumerate} \item We say that $f$ is of {\it finite type at $x \in X$} if there exists an affine open neighbourhood $\Spec(A) = U \subset X$ of $x$ and an affine open $\Spec(R) = V \subset S$ with $f(U) \subset V$ such that the induced ring map $R \to A$ is of finite type. \item We say that $f$ is {\it locally of finite type} if it is of finite type at every point of $X$. \item We say that $f$ is of {\it finite type} if it is locally of finite type and quasi-compact. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-locally-finite-type-characterize} Let $f : X \to S$ be a morphism of schemes. The following are equivalent \begin{enumerate} \item The morphism $f$ is locally of finite type. \item For all affine opens $U \subset X$, $V \subset S$ with $f(U) \subset V$ the ring map $\mathcal{O}_S(V) \to \mathcal{O}_X(U)$ is of finite type. \item There exist an open covering $S = \bigcup_{j \in J} V_j$ and open coverings $f^{-1}(V_j) = \bigcup_{i \in I_j} U_i$ such that each of the morphisms $U_i \to V_j$, $j\in J, i\in I_j$ is locally of finite type. \item There exist an affine open covering $S = \bigcup_{j \in J} V_j$ and affine open coverings $f^{-1}(V_j) = \bigcup_{i \in I_j} U_i$ such that the ring map $\mathcal{O}_S(V_j) \to \mathcal{O}_X(U_i)$ is of finite type, for all $j\in J, i\in I_j$. \end{enumerate} Moreover, if $f$ is locally of finite type then for any open subschemes $U \subset X$, $V \subset S$ with $f(U) \subset V$ the restriction $f|_U : U \to V$ is locally of finite type. \end{lemma} 
\begin{lemma} \label{lemma-composition-finite-type} The composition of two morphisms which are locally of finite type is locally of finite type. The same is true for morphisms of finite type. \end{lemma} 
\begin{lemma} \label{lemma-base-change-finite-type} The base change of a morphism which is locally of finite type is locally of finite type. The same is true for morphisms of finite type. \end{lemma} 
\begin{lemma} \label{lemma-immersion-locally-finite-type} A closed immersion is of finite type. An immersion is locally of finite type. \end{lemma} 
\begin{lemma} \label{lemma-finite-type-noetherian} Let $f : X \to S$ be a morphism. If $S$ is (locally) Noetherian and $f$ (locally) of finite type then $X$ is (locally) Noetherian. \end{lemma} 
\begin{lemma} \label{lemma-finite-type-Noetherian-quasi-separated} Let $f : X \to S$ be locally of finite type with $S$ locally Noetherian. Then $f$ is quasi-separated. \end{lemma} 
\begin{lemma} \label{lemma-permanence-finite-type} Let $X \to Y$ be a morphism of schemes over a base scheme $S$. If $X$ is locally of finite type over $S$, then $X \to Y$ is locally of finite type. \end{lemma} 
\begin{lemma} \label{lemma-point-finite-type} Let $S$ be a scheme. Let $k$ be a field. Let $f : \Spec(k) \to S$ be a morphism. The following are equivalent: \begin{enumerate} \item The morphism $f$ is of finite type. \item The morphism $f$ is locally of finite type. \item There exists an affine open $U = \Spec(R)$ of $S$ such that $f$ corresponds to a finite ring map $R \to k$. \item There exists an affine open $U = \Spec(R)$ of $S$ such that the image of $f$ consists of a closed point $u$ in $U$ and the field extension $k/\kappa(u)$ is finite. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-artinian-finite-type} Let $S$ be a scheme. Let $A$ be an Artinian local ring with residue field $\kappa$. Let $f : \Spec(A) \to S$ be a morphism of schemes. Then $f$ is of finite type if and only if the composition $\Spec(\kappa) \to \Spec(A) \to S$ is of finite type. \end{lemma} 
\begin{definition} \label{definition-finite-type-point} Let $S$ be a scheme. Let us say that a point $s$ of $S$ is a {\it finite type point} if the canonical morphism $\Spec(\kappa(s)) \to S$ is of finite type. We denote $S_{\text{ft-pts}}$ the set of finite type points of $S$. \end{definition} 
\begin{lemma} \label{lemma-identify-finite-type-points} Let $S$ be a scheme. We have $$ S_{\text{ft-pts}} = \bigcup\nolimits_{U \subset S\text{ open}} U_0 $$ where $U_0$ is the set of closed points of $U$. Here we may let $U$ range over all opens or over all affine opens of $S$. \end{lemma} 
\begin{lemma} \label{lemma-finite-type-points-morphism} Let $f : T \to S$ be a morphism of schemes. If $f$ is locally of finite type, then $f(T_{\text{ft-pts}}) \subset S_{\text{ft-pts}}$. \end{lemma} 
\begin{lemma} \label{lemma-finite-type-points-surjective-morphism} Let $f : T \to S$ be a morphism of schemes. If $f$ is locally of finite type and surjective, then $f(T_{\text{ft-pts}}) = S_{\text{ft-pts}}$. \end{lemma} 
\begin{lemma} \label{lemma-enough-finite-type-points} Let $S$ be a scheme. For any locally closed subset $T \subset S$ we have $$ T \not = \emptyset \Rightarrow T \cap S_{\text{ft-pts}} \not = \emptyset. $$ In particular, for any closed subset $T \subset S$ we see that $T \cap S_{\text{ft-pts}}$ is dense in $T$. \end{lemma} 
\begin{lemma} \label{lemma-jacobson-finite-type-points} Let $S$ be a scheme. The following are equivalent: \begin{enumerate} \item the scheme $S$ is Jacobson, \item $S_{\text{ft-pts}}$ is the set of closed points of $S$, \item for all $T \to S$ locally of finite type closed points map to closed points, and \item for all $T \to S$ locally of finite type closed points $t \in T$ map to closed points $s \in S$ with $\kappa(s) \subset \kappa(t)$ finite. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-Jacobson-universally-Jacobson} Let $S$ be a Jacobson scheme. Any scheme locally of finite type over $S$ is Jacobson. \end{lemma} 
\begin{lemma} \label{lemma-ubiquity-Jacobson-schemes} The following types of schemes are Jacobson. \begin{enumerate} \item Any scheme locally of finite type over a field. \item Any scheme locally of finite type over $\mathbf{Z}$. \item Any scheme locally of finite type over a $1$-dimensional Noetherian domain with infinitely many primes. \item A scheme of the form $\Spec(R) \setminus \{\mathfrak m\}$ where $(R, \mathfrak m)$ is a Noetherian local ring. Also any scheme locally of finite type over it. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-universally-catenary} Let $S$ be a scheme. Assume $S$ is locally Noetherian. We say $S$ is {\it universally catenary} if for every morphism $X \to S$ locally of finite type the scheme $X$ is catenary. \end{definition} 
\begin{lemma} \label{lemma-universally-catenary-local} Let $S$ be a locally Noetherian scheme. The following are equivalent \begin{enumerate} \item $S$ is universally catenary, \item there exists an open covering of $S$ all of whose members are universally catenary schemes, \item for every affine open $\Spec(R) = U \subset S$ the ring $R$ is universally catenary, and \item there exists an affine open covering $S = \bigcup U_i$ such that each $U_i$ is the spectrum of a universally catenary ring. \end{enumerate} Moreover, in this case any scheme locally of finite type over $S$ is universally catenary as well. \end{lemma} 
\begin{lemma} \label{lemma-universally-catenary-local-rings-universally-catenary} Let $S$ be a locally Noetherian scheme. The following are equivalent: \begin{enumerate} \item $S$ is universally catenary, and \item all local rings $\mathcal{O}_{S, s}$ of $S$ are universally catenary. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-catenary-check-irreducible} Let $S$ be a locally Noetherian scheme. Then $S$ is universally catenary if and only if the irreducible components of $S$ are universally catenary. \end{lemma} 
\begin{lemma} \label{lemma-ubiquity-uc} The following types of schemes are universally catenary. \begin{enumerate} \item Any scheme locally of finite type over a field. \item Any scheme locally of finite type over a Cohen-Macaulay scheme. \item Any scheme locally of finite type over $\mathbf{Z}$. \item Any scheme locally of finite type over a $1$-dimensional Noetherian domain. \item And so on. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-finite-type-nagata} Let $f : X \to S$ be a morphism. If $S$ is Nagata and $f$ locally of finite type then $X$ is Nagata. If $S$ is universally Japanese and $f$ locally of finite type then $X$ is universally Japanese. \end{lemma} 
\begin{lemma} \label{lemma-ubiquity-nagata} The following types of schemes are Nagata. \begin{enumerate} \item Any scheme locally of finite type over a field. \item Any scheme locally of finite type over a Noetherian complete local ring. \item Any scheme locally of finite type over $\mathbf{Z}$. \item Any scheme locally of finite type over a Dedekind ring of characteristic zero. \item And so on. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-J} Let $X$ be a locally Noetherian scheme. We say $X$ is {\it J-2} if for every morphism $Y \to X$ which is locally of finite type the regular locus $\text{Reg}(Y)$ is open in $Y$. \end{definition} 
\begin{lemma} \label{lemma-J} Let $X$ be a locally Noetherian scheme. The following are equivalent \begin{enumerate} \item $X$ is J-2, \item there exists an open covering of $X$ all of whose members are J-2 schemes, \item for every affine open $\Spec(R) = U \subset X$ the ring $R$ is J-2, and \item there exists an affine open covering $S = \bigcup U_i$ such that each $\mathcal{O}(U_i)$ is J-2 for all $i$. \end{enumerate} Moreover, in this case any scheme locally of finite type over $X$ is J-2 as well. \end{lemma} 
\begin{lemma} \label{lemma-ubiquity-J-2} The following types of schemes are J-2. \begin{enumerate} \item Any scheme locally of finite type over a field. \item Any scheme locally of finite type over a Noetherian complete local ring. \item Any scheme locally of finite type over $\mathbf{Z}$. \item Any scheme locally of finite type over a Noetherian local ring of dimension $1$. \item Any scheme locally of finite type over a Nagata ring of dimension $1$. \item Any scheme locally of finite type over a Dedekind ring of characteristic zero. \item And so on. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-quasi-finite} \begin{reference} \cite[II Definition 6.2.3]{EGA} \end{reference} Let $f : X \to S$ be a morphism of schemes. \begin{enumerate} \item We say that $f$ is {\it quasi-finite at a point $x \in X$} if there exist an affine neighbourhood $\Spec(A) = U \subset X$ of $x$ and an affine open $\Spec(R) = V \subset S$ such that $f(U) \subset V$, the ring map $R \to A$ is of finite type, and $R \to A$ is quasi-finite at the prime of $A$ corresponding to $x$ (see above). \item We say $f$ is {\it locally quasi-finite} if $f$ is quasi-finite at every point $x$ of $X$. \item We say that $f$ is {\it quasi-finite} if $f$ is of finite type and every point $x$ is an isolated point of its fibre. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-algebraic-residue-field-extension-closed-point-fibre} Let $f : X \to S$ be a morphism of schemes. Let $x \in X$ be a point. Set $s = f(x)$. If $\kappa(x)/\kappa(s)$ is an algebraic field extension, then \begin{enumerate} \item $x$ is a closed point of its fibre, and \item if in addition $s$ is a closed point of $S$, then $x$ is a closed point of $X$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-closed-point-fibre-locally-finite-type} Let $f : X \to S$ be a morphism of schemes. Let $x \in X$ be a point. Set $s = f(x)$. Assume $f$ is locally of finite type. Then $x$ is a closed point of its fibre if and only if $\kappa(x)/\kappa(s)$ is a finite field extension. \end{lemma} 
\begin{lemma} \label{lemma-base-change-closed-point-fibre-locally-finite-type} Let $f : X \to S$ be a morphism of schemes which is locally of finite type. Let $g : S' \to S$ be any morphism. Denote $f' : X' \to S'$ the base change. If $x' \in X'$ maps to a point $x \in X$ which is closed in $X_{f(x)}$ then $x'$ is closed in $X'_{f'(x')}$. \end{lemma} 
\begin{lemma} \label{lemma-residue-field-quasi-finite} Let $f : X \to S$ be a morphism of schemes. Let $x \in X$ be a point. Set $s = f(x)$. If $f$ is quasi-finite at $x$, then the residue field extension $\kappa(x)/\kappa(s)$ is finite. \end{lemma} 
\begin{lemma} \label{lemma-quasi-finite-at-point-characterize} Let $f : X \to S$ be a morphism of schemes. Let $x \in X$ be a point. Set $s = f(x)$. Let $X_s$ be the fibre of $f$ at $s$. Assume $f$ is locally of finite type. The following are equivalent: \begin{enumerate} \item The morphism $f$ is quasi-finite at $x$. \item The point $x$ is isolated in $X_s$. \item The point $x$ is closed in $X_s$ and there is no point $x' \in X_s$, $x' \not = x$ which specializes to $x$. \item For any pair of affine opens $\Spec(A) = U \subset X$, $\Spec(R) = V \subset S$ with $f(U) \subset V$ and $x \in U$ corresponding to $\mathfrak q \subset A$ the ring map $R \to A$ is quasi-finite at $\mathfrak q$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-finite-fibre} Let $f : X \to S$ be a morphism of schemes. Let $s \in S$. Assume that \begin{enumerate} \item $f$ is locally of finite type, and \item $f^{-1}(\{s\})$ is a finite set. \end{enumerate} Then $X_s$ is a finite discrete topological space, and $f$ is quasi-finite at each point of $X$ lying over $s$. \end{lemma} 
\begin{lemma} \label{lemma-locally-quasi-finite-fibres} \begin{slogan} Finite type morphisms with discrete fibers are quasi-finite. \end{slogan} Let $f : X \to S$ be a morphism of schemes. Assume $f$ is locally of finite type. Then the following are equivalent \begin{enumerate} \item $f$ is locally quasi-finite, \item for every $s \in S$ the fibre $X_s$ is a discrete topological space, and \item for every morphism $\Spec(k) \to S$ where $k$ is a field the base change $X_k$ has an underlying discrete topological space. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-quasi-finite-locally-quasi-compact} Let $f : X \to S$ be a morphism of schemes. Then $f$ is quasi-finite if and only if $f$ is locally quasi-finite and quasi-compact. \end{lemma} 
\begin{lemma} \label{lemma-quasi-finite} Let $f : X \to S$ be a morphism of schemes. The following are equivalent: \begin{enumerate} \item $f$ is quasi-finite, and \item $f$ is locally of finite type, quasi-compact, and has finite fibres. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-locally-quasi-finite-characterize} Let $f : X \to S$ be a morphism of schemes. The following are equivalent \begin{enumerate} \item The morphism $f$ is locally quasi-finite. \item For every pair of affine opens $U \subset X$, $V \subset S$ with $f(U) \subset V$ the ring map $\mathcal{O}_S(V) \to \mathcal{O}_X(U)$ is quasi-finite. \item There exists an open covering $S = \bigcup_{j \in J} V_j$ and open coverings $f^{-1}(V_j) = \bigcup_{i \in I_j} U_i$ such that each of the morphisms $U_i \to V_j$, $j\in J, i\in I_j$ is locally quasi-finite. \item There exists an affine open covering $S = \bigcup_{j \in J} V_j$ and affine open coverings $f^{-1}(V_j) = \bigcup_{i \in I_j} U_i$ such that the ring map $\mathcal{O}_S(V_j) \to \mathcal{O}_X(U_i)$ is quasi-finite, for all $j\in J, i\in I_j$. \end{enumerate} Moreover, if $f$ is locally quasi-finite then for any open subschemes $U \subset X$, $V \subset S$ with $f(U) \subset V$ the restriction $f|_U : U \to V$ is locally quasi-finite. \end{lemma} 
\begin{lemma} \label{lemma-composition-quasi-finite} The composition of two morphisms which are locally quasi-finite is locally quasi-finite. The same is true for quasi-finite morphisms. \end{lemma} 
\begin{lemma} \label{lemma-base-change-quasi-finite} \begin{slogan} (Locally) quasi-finite morphisms are stable under base change. \end{slogan} Let $f : X \to S$ be a morphism of schemes. Let $g : S' \to S$ be a morphism of schemes. Denote $f' : X' \to S'$ the base change of $f$ by $g$ and denote $g' : X' \to X$ the projection. Assume $X$ is locally of finite type over $S$. \begin{enumerate} \item Let $U \subset X$ (resp.\ $U' \subset X'$) be the set of points where $f$ (resp.\ $f'$) is quasi-finite. Then $U' = U \times_S S' = (g')^{-1}(U)$. \item The base change of a locally quasi-finite morphism is locally quasi-finite. \item The base change of a quasi-finite morphism is quasi-finite. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-quasi-finite-at-a-finite-number-of-points} Let $f : X \to S$ be a morphism of schemes of finite type. Let $s \in S$. There are at most finitely many points of $X$ lying over $s$ at which $f$ is quasi-finite. \end{lemma} 
\begin{lemma} \label{lemma-monomorphism-loc-finite-type-loc-quasi-finite} Let $f : X \to Y$ be a morphism of schemes. If $f$ is locally of finite type and a monomorphism, then $f$ is separated and locally quasi-finite. \end{lemma} 
\begin{lemma} \label{lemma-immersion-locally-quasi-finite} Any immersion is locally quasi-finite. \end{lemma} 
\begin{lemma} \label{lemma-permanence-quasi-finite} Let $X \to Y$ be a morphism of schemes over a base scheme $S$. Let $x \in X$. If $X \to S$ is quasi-finite at $x$, then $X \to Y$ is quasi-finite at $x$. If $X$ is locally quasi-finite over $S$, then $X \to Y$ is locally quasi-finite. \end{lemma} 
\begin{lemma} \label{lemma-quasi-finite-local-source} Let $f : X \to Y$ and $g : Y \to S$ be morphisms of schemes. If $f$ is surjective, $g \circ f$ locally quasi-finite, and $g$ locally of finite type, then $g : Y \to S$  is locally quasi-finite. \end{lemma} 
\begin{definition} \label{definition-finite-presentation} Let $f : X \to S$ be a morphism of schemes. \begin{enumerate} \item We say that $f$ is of {\it finite presentation at $x \in X$} if there exists an affine open neighbourhood $\Spec(A) = U \subset X$ of $x$ and affine open $\Spec(R) = V \subset S$ with $f(U) \subset V$ such that the induced ring map $R \to A$ is of finite presentation. \item We say that $f$ is {\it locally of finite presentation} if it is of finite presentation at every point of $X$. \item We say that $f$ is of {\it finite presentation} if it is locally of finite presentation, quasi-compact and quasi-separated. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-locally-finite-presentation-characterize} Let $f : X \to S$ be a morphism of schemes. The following are equivalent \begin{enumerate} \item The morphism $f$ is locally of finite presentation. \item For every affine opens $U \subset X$, $V \subset S$ with $f(U) \subset V$ the ring map $\mathcal{O}_S(V) \to \mathcal{O}_X(U)$ is of finite presentation. \item There exist an open covering $S = \bigcup_{j \in J} V_j$ and open coverings $f^{-1}(V_j) = \bigcup_{i \in I_j} U_i$ such that each of the morphisms $U_i \to V_j$, $j\in J, i\in I_j$ is locally of finite presentation. \item There exist an affine open covering $S = \bigcup_{j \in J} V_j$ and affine open coverings $f^{-1}(V_j) = \bigcup_{i \in I_j} U_i$ such that the ring map $\mathcal{O}_S(V_j) \to \mathcal{O}_X(U_i)$ is of finite presentation, for all $j\in J, i\in I_j$. \end{enumerate} Moreover, if $f$ is locally of finite presentation then for any open subschemes $U \subset X$, $V \subset S$ with $f(U) \subset V$ the restriction $f|_U : U \to V$ is locally of finite presentation. \end{lemma} 
\begin{lemma} \label{lemma-composition-finite-presentation} The composition of two morphisms which are locally of finite presentation is locally of finite presentation. The same is true for morphisms of finite presentation. \end{lemma} 
\begin{lemma} \label{lemma-base-change-finite-presentation} The base change of a morphism which is locally of finite presentation is locally of finite presentation. The same is true for morphisms of finite presentation. \end{lemma} 
\begin{lemma} \label{lemma-open-immersion-locally-finite-presentation} Any open immersion is locally of finite presentation. \end{lemma} 
\begin{lemma} \label{lemma-quasi-compact-open-immersion-finite-presentation} Any open immersion is of finite presentation if and only if it is quasi-compact. \end{lemma} 
\begin{lemma} \label{lemma-closed-immersion-finite-presentation} \begin{slogan} Closed immersions of finite presentation correspond to quasi-coherent sheaves of ideals of finite type. \end{slogan} A closed immersion $i : Z \to X$ is of finite presentation if and only if the associated quasi-coherent sheaf of ideals $\mathcal{I} = \Ker(\mathcal{O}_X \to i_*\mathcal{O}_Z)$ is of finite type (as an $\mathcal{O}_X$-module). \end{lemma} 
\begin{lemma} \label{lemma-finite-presentation-finite-type} A morphism which is locally of finite presentation is locally of finite type. A morphism of finite presentation is of finite type. \end{lemma} 
\begin{lemma} \label{lemma-noetherian-finite-type-finite-presentation} \begin{slogan} Over a locally Noetherian base, finite type is finite presentation. \end{slogan} Let $f : X \to S$ be a morphism. \begin{enumerate} \item If $S$ is locally Noetherian and $f$ locally of finite type then $f$ is locally of finite presentation. \item If $S$ is locally Noetherian and $f$ of finite type then $f$ is of finite presentation. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-finite-presentation-quasi-compact-quasi-separated} Let $S$ be a scheme which is quasi-compact and quasi-separated. If $X$ is of finite presentation over $S$, then $X$ is quasi-compact and quasi-separated. \end{lemma} 
\begin{lemma} \label{lemma-finite-presentation-permanence} Let $f : X \to Y$ be a morphism of schemes over $S$. \begin{enumerate} \item If $X$ is locally of finite presentation over $S$ and $Y$ is locally of finite type over $S$, then $f$ is locally of finite presentation. \item If $X$ is of finite presentation over $S$ and $Y$ is quasi-separated and locally of finite type over $S$, then $f$ is of finite presentation. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-diagonal-morphism-finite-type} Let $f : X \to Y$ be a morphism of schemes with diagonal $\Delta : X \to X \times_Y X$. If $f$ is locally of finite type then $\Delta$ is locally of finite presentation. If $f$ is quasi-separated and locally of finite type, then $\Delta$ is of finite presentation. \end{lemma} 
\begin{lemma} \label{lemma-inverse-image-constructible} Let $f : X \to Y$ be a morphism of schemes. Let $E \subset Y$ be a subset. If $E$ is (locally) constructible in $Y$, then $f^{-1}(E)$ is (locally) constructible in $X$. \end{lemma} 
\begin{lemma} \label{lemma-chevalley} Let $f : X \to Y$ be a morphism of schemes. Assume \begin{enumerate} \item $f$ is quasi-compact and locally of finite presentation, and \item $Y$ is quasi-compact and quasi-separated. \end{enumerate} Then the image of every constructible subset of $X$ is constructible in $Y$. \end{lemma} 
\begin{theorem}[Chevalley's Theorem] \label{theorem-chevalley} \begin{reference} \cite[IV, Theorem 1.8.4]{EGA} \end{reference} Let $f : X \to Y$ be a morphism of schemes. Assume $f$ is quasi-compact and locally of finite presentation. Then the image of every locally constructible subset is locally constructible. \end{theorem} 
\begin{lemma} \label{lemma-constructible-containing-open} Let $X$ be a scheme. Let $x \in X$. Let $E \subset X$ be a locally constructible subset. If $\{x' \mid x' \leadsto x\} \subset E$, then $E$ contains an open neighbourhood of $x$. \end{lemma} 
\begin{definition} \label{definition-open} Let $f : X \to S$ be a morphism. \begin{enumerate} \item We say $f$ is {\it open} if the map on underlying topological spaces is open. \item We say $f$ is {\it universally open} if for any morphism of schemes $S' \to S$ the base change $f' : X_{S'} \to S'$ is open. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-locally-finite-presentation-universally-open} Let $f : X \to S$ be a morphism. \begin{enumerate} \item If $f$ is locally of finite presentation and generalizations lift along $f$, then $f$ is open. \item If $f$ is locally of finite presentation and generalizations lift along every base change of $f$, then $f$ is universally open. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-composition-open} A composition of (universally) open morphisms is (universally) open. \end{lemma} 
\begin{lemma} \label{lemma-scheme-over-field-universally-open} Let $k$ be a field. Let $X$ be a scheme over $k$. The structure morphism $X \to \Spec(k)$ is universally open. \end{lemma} 
\begin{lemma} \label{lemma-open-generizing} \begin{reference} Follows from the implication (a) $\Rightarrow$ (b) in \cite[IV, Corollary 1.10.4]{EGA} \end{reference} Let $\varphi : X \to Y$ be a morphism of schemes. If $\varphi$ is open, then $\varphi$ is generizing (i.e., generalizations lift along $\varphi$). If $\varphi$ is universally open, then $\varphi$ is universally generizing. \end{lemma} 
\begin{lemma} \label{lemma-descent-quasi-compact} Let $f : X \to Y$ be a morphism of schemes. Let $g : Y' \to Y$ be open and surjective such that the base change $f' : X' \to Y'$ is quasi-compact. Then $f$ is quasi-compact. \end{lemma} 
\begin{definition} \label{definition-submersive} Let $f : X \to Y$ be a morphism of schemes. \begin{enumerate} \item We say $f$ is {\it submersive}\footnote{This is very different from the notion of a submersion of differential manifolds.} if the continuous map of underlying topological spaces is submersive, see Topology, Definition \ref{topology-definition-submersive}. \item We say $f$ is {\it universally submersive} if for every morphism of schemes $Y' \to Y$ the base change $Y' \times_Y X \to Y'$ is submersive. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-base-change-universally-submersive} The base change of a universally submersive morphism of schemes by any morphism of schemes is universally submersive. \end{lemma} 
\begin{lemma} \label{lemma-composition-universally-submersive} The composition of a pair of (universally) submersive morphisms of schemes is (universally) submersive. \end{lemma} 
\begin{definition} \label{definition-flat} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent sheaf of $\mathcal{O}_X$-modules. \begin{enumerate} \item We say $f$ is {\it flat at a point $x \in X$} if the local ring $\mathcal{O}_{X, x}$ is flat over the local ring $\mathcal{O}_{S, f(x)}$. \item We say that $\mathcal{F}$ is {\it flat over $S$ at a point $x \in X$} if the stalk $\mathcal{F}_x$ is a flat $\mathcal{O}_{S, f(x)}$-module. \item We say $f$ is {\it flat} if $f$ is flat at every point of $X$. \item We say that $\mathcal{F}$ is {\it flat over $S$} if $\mathcal{F}$ is flat over $S$ at every point $x$ of $X$. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-flat-module-characterize} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent sheaf of $\mathcal{O}_X$-modules. The following are equivalent \begin{enumerate} \item The sheaf $\mathcal{F}$ is flat over $S$. \item For every affine opens $U \subset X$, $V \subset S$ with $f(U) \subset V$ the $\mathcal{O}_S(V)$-module $\mathcal{F}(U)$ is flat. \item There exists an open covering $S = \bigcup_{j \in J} V_j$ and open coverings $f^{-1}(V_j) = \bigcup_{i \in I_j} U_i$ such that each of the modules $\mathcal{F}|_{U_i}$ is flat over $V_j$, for all $j\in J, i\in I_j$. \item There exists an affine open covering $S = \bigcup_{j \in J} V_j$ and affine open coverings $f^{-1}(V_j) = \bigcup_{i \in I_j} U_i$ such that $\mathcal{F}(U_i)$ is a flat $\mathcal{O}_S(V_j)$-module, for all $j\in J, i\in I_j$. \end{enumerate} Moreover, if $\mathcal{F}$ is flat over $S$ then for any open subschemes $U \subset X$, $V \subset S$ with $f(U) \subset V$ the restriction $\mathcal{F}|_U$ is flat over $V$. \end{lemma} 
\begin{lemma} \label{lemma-flat-characterize} Let $f : X \to S$ be a morphism of schemes. The following are equivalent \begin{enumerate} \item The morphism $f$ is flat. \item For every affine opens $U \subset X$, $V \subset S$ with $f(U) \subset V$ the ring map $\mathcal{O}_S(V) \to \mathcal{O}_X(U)$ is flat. \item There exists an open covering $S = \bigcup_{j \in J} V_j$ and open coverings $f^{-1}(V_j) = \bigcup_{i \in I_j} U_i$ such that each of the morphisms $U_i \to V_j$, $j\in J, i\in I_j$ is flat. \item There exists an affine open covering $S = \bigcup_{j \in J} V_j$ and affine open coverings $f^{-1}(V_j) = \bigcup_{i \in I_j} U_i$ such that $\mathcal{O}_S(V_j) \to \mathcal{O}_X(U_i)$ is flat, for all $j\in J, i\in I_j$. \end{enumerate} Moreover, if $f$ is flat then for any open subschemes $U \subset X$, $V \subset S$ with $f(U) \subset V$ the restriction $f|_U : U \to V$ is flat. \end{lemma} 
\begin{lemma} \label{lemma-pushforward-flat-affine} Let $f : X \to Y$ be an affine morphism of schemes over a base scheme $S$. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. Then $\mathcal{F}$ is flat over $S$ if and only if $f_*\mathcal{F}$ is flat over $S$. \end{lemma} 
\begin{lemma} \label{lemma-composition-module-flat} Let $X \to Y \to Z$ be morphisms of schemes. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. Let $x \in X$ with image $y$ in $Y$. If $\mathcal{F}$ is flat over $Y$ at $x$, and $Y$ is flat over $Z$ at $y$, then $\mathcal{F}$ is flat over $Z$ at $x$. \end{lemma} 
\begin{lemma} \label{lemma-composition-flat} The composition of flat morphisms is flat. \end{lemma} 
\begin{lemma} \label{lemma-base-change-module-flat} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent sheaf of $\mathcal{O}_X$-modules. Let $g : S' \to S$ be a morphism of schemes. Denote $g' : X' = X_{S'} \to X$ the projection. Let $x' \in X'$ be a point with image $x = g'(x') \in X$. If $\mathcal{F}$ is flat over $S$ at $x$, then $(g')^*\mathcal{F}$ is flat over $S'$ at $x'$. In particular, if $\mathcal{F}$ is flat over $S$, then $(g')^*\mathcal{F}$ is flat over $S'$. \end{lemma} 
\begin{lemma} \label{lemma-base-change-flat} The base change of a flat morphism is flat. \end{lemma} 
\begin{lemma} \label{lemma-generalizations-lift-flat} Let $f : X \to S$ be a flat morphism of schemes. Then generalizations lift along $f$, see Topology, Definition \ref{topology-definition-lift-specializations}. \end{lemma} 
\begin{lemma} \label{lemma-fppf-open} A flat morphism locally of finite presentation is universally open. \end{lemma} 
\begin{lemma} \label{lemma-pf-flat-module-open} Let $f : X \to Y$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. Assume $f$ locally finite presentation, $\mathcal{F}$ of finite type, $X = \text{Supp}(\mathcal{F})$, and $\mathcal{F}$ flat over $Y$. Then $f$ is universally open. \end{lemma} 
\begin{lemma} \label{lemma-fpqc-quotient-topology} \begin{reference} \cite[Expose VIII, Corollaire 4.3]{SGA1} and \cite[IV, Corollaire 2.3.12]{EGA} \end{reference} Let $f : X \to Y$ be a quasi-compact, surjective, flat morphism. A subset $T \subset Y$ is open (resp.\ closed) if and only $f^{-1}(T)$ is open (resp.\ closed). In other words, $f$ is a submersive morphism. \end{lemma} 
\begin{lemma} \label{lemma-flat-permanence} Let $h : X \to Y$ be a morphism of schemes over $S$. Let $\mathcal{G}$ be a quasi-coherent sheaf on $Y$. Let $x \in X$ with $y = h(x) \in Y$. If $h$ is flat at $x$, then $$ \mathcal{G}\text{ flat over }S\text{ at }y \Leftrightarrow h^*\mathcal{G}\text{ flat over }S\text{ at }x. $$ In particular: If $h$ is surjective and flat, then $\mathcal{G}$ is flat over $S$, if and only if $h^*\mathcal{G}$ is flat over $S$. If $h$ is surjective and flat, and $X$ is flat over $S$, then $Y$ is flat over $S$. \end{lemma} 
\begin{lemma} \label{lemma-flat-pullback-support} Let $f : Y \to X$ be a morphism of schemes. Let $\mathcal{F}$ be a finite type quasi-coherent $\mathcal{O}_X$-module with scheme theoretic support $Z \subset X$. If $f$ is flat, then $f^{-1}(Z)$ is the scheme theoretic support of $f^*\mathcal{F}$. \end{lemma} 
\begin{lemma} \label{lemma-flat-morphism-scheme-theoretically-dense-open} Let $f : X \to Y$ be a flat morphism of schemes. Let $V \subset Y$ be a retrocompact open which is scheme theoretically dense. Then $f^{-1}V$ is scheme theoretically dense in $X$. \end{lemma} 
\begin{lemma} \label{lemma-flat-base-change-scheme-theoretic-image} \begin{slogan} Taking scheme theoretic images commutes with flat base change in the quasi-compact case \end{slogan} Let $f : X \to Y$ be a flat morphism of schemes. Let $g : V \to Y$ be a quasi-compact morphism of schemes. Let $Z \subset Y$ be the scheme theoretic image of $g$ and let $Z' \subset X$ be the scheme theoretic image of the base change $V \times_Y X \to X$. Then $Z' = f^{-1}Z$. \end{lemma} 
\begin{lemma} \label{lemma-characterize-flat-closed-immersions} Let $X$ be a scheme. The rule which associates to a closed subscheme of $X$ its underlying closed subset defines a bijection $$ \left\{ \begin{matrix} \text{closed subschemes }Z \subset X \\ \text{such that }Z \to X\text{ is flat} \end{matrix} \right\} \leftrightarrow \left\{ \begin{matrix} \text{closed subsets }Z \subset X \\ \text{closed under generalizations} \end{matrix} \right\} $$ If $Z \subset X$ is such a closed subscheme, every morphism of schemes $g : Y \to X$ with $g(Y) \subset Z$ set theoretically factors (scheme theoretically) through $Z$. \end{lemma} 
\begin{lemma} \label{lemma-flat-closed-immersions-finite-presentation} A flat closed immersion of finite presentation is the open immersion of an open and closed subscheme. \end{lemma} 
\begin{definition} \label{definition-scheme-structure-connected-component} Let $X$ be a scheme. Let $T \subset X$ be a connected component. The {\it canonical scheme structure on $T$} is the unique scheme structure on $T$ such that the closed immersion $T \to X$ is flat, see Lemma \ref{lemma-characterize-flat-closed-immersions}. \end{definition} 
\begin{lemma} \label{lemma-finite-flat-is-finite-locally-free} Let $X$ be a scheme. The following are equivalent \begin{enumerate} \item every finite flat quasi-coherent $\mathcal{O}_X$-module is finite locally free, and \item every closed subset $Z \subset X$ which is closed under generalizations is open. \end{enumerate} \end{lemma} 
\begin{proposition}[Generic flatness] \label{proposition-generic-flatness} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent sheaf of $\mathcal{O}_X$-modules. Assume \begin{enumerate} \item $S$ is integral, \item $f$ is of finite type, and \item $\mathcal{F}$ is a finite type $\mathcal{O}_X$-module. \end{enumerate} Then there exists an open dense subscheme $U \subset S$ such that $X_U \to U$ is flat and of finite presentation and such that $\mathcal{F}|_{X_U}$ is flat over $U$ and of finite presentation over $\mathcal{O}_{X_U}$. \end{proposition} 
\begin{proposition}[Generic flatness, reduced case] \label{proposition-generic-flatness-reduced} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{F}$ be a quasi-coherent sheaf of $\mathcal{O}_X$-modules. Assume \begin{enumerate} \item $S$ is reduced, \item $f$ is of finite type, and \item $\mathcal{F}$ is a finite type $\mathcal{O}_X$-module. \end{enumerate} Then there exists an open dense subscheme $U \subset S$ such that $X_U \to U$ is flat and of finite presentation and such that $\mathcal{F}|_{X_U}$ is flat over $U$ and of finite presentation over $\mathcal{O}_{X_U}$. \end{proposition} 
\begin{lemma} \label{lemma-dimension-fibre-at-a-point} Let $f : X \to S$ be a morphism of schemes. Let $x \in X$ and set $s = f(x)$. Assume $f$ is locally of finite type. Then $$ \dim_x(X_s) = \dim(\mathcal{O}_{X_s, x}) + \text{trdeg}_{\kappa(s)}(\kappa(x)). $$ \end{lemma} 
\begin{lemma} \label{lemma-dimension-fibre-at-a-point-additive} Let $f : X \to Y$ and $g : Y \to S$ be morphisms of schemes. Let $x \in X$ and set $y = f(x)$, $s = g(y)$. Assume $f$ and $g$ locally of finite type. Then $$ \dim_x(X_s) \leq \dim_x(X_y) + \dim_y(Y_s). $$ Moreover, equality holds if $\mathcal{O}_{X_s, x}$ is flat over $\mathcal{O}_{Y_s, y}$, which holds for example if $\mathcal{O}_{X, x}$ is flat over $\mathcal{O}_{Y, y}$. \end{lemma} 
\begin{lemma} \label{lemma-dimension-fibre-after-base-change} Let $$ \xymatrix{ X' \ar[r]_{g'} \ar[d]_{f'} & X \ar[d]^f \\ S' \ar[r]^g & S } $$ be a fibre product diagram of schemes. Assume $f$ locally of finite type. Suppose that $x' \in X'$, $x = g'(x')$, $s' = f'(x')$ and $s = g(s') = f(x)$. Then \begin{enumerate} \item $\dim_x(X_s) = \dim_{x'}(X'_{s'})$, \item if $F$ is the fibre of the morphism $X'_{s'} \to X_s$ over $x$, then $$ \dim(\mathcal{O}_{F, x'}) = \dim(\mathcal{O}_{X'_{s'}, x'}) - \dim(\mathcal{O}_{X_s, x}) = \text{trdeg}_{\kappa(s)}(\kappa(x)) - \text{trdeg}_{\kappa(s')}(\kappa(x')) $$ In particular $\dim(\mathcal{O}_{X'_{s'}, x'}) \geq \dim(\mathcal{O}_{X_s, x})$ and $\text{trdeg}_{\kappa(s)}(\kappa(x)) \geq \text{trdeg}_{\kappa(s')}(\kappa(x'))$. \item given $s', s, x$ there exists a choice of $x'$ such that $\dim(\mathcal{O}_{X'_{s'}, x'}) = \dim(\mathcal{O}_{X_s, x})$ and $\text{trdeg}_{\kappa(s)}(\kappa(x)) = \text{trdeg}_{\kappa(s')}(\kappa(x'))$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-openness-bounded-dimension-fibres} \begin{reference} \cite[IV Theorem 13.1.3]{EGA} \end{reference} Let $f : X \to S$ be a morphism of schemes. Let $n \geq 0$. Assume $f$ is locally of finite type. The set $$ U_n = \{x \in X \mid \dim_x X_{f(x)} \leq n\} $$ is open in $X$. \end{lemma} 
\begin{lemma} \label{lemma-morphism-finite-type-bounded-dimension} Let $f : X \to Y$ be a morphism of finite type with $Y$ quasi-compact. Then the dimension of the fibres of $f$ is bounded. \end{lemma} 
\begin{lemma} \label{lemma-openness-bounded-dimension-fibres-finite-presentation} Let $f : X \to S$ be a morphism of schemes. Let $n \geq 0$. Assume $f$ is locally of finite presentation. The open $$ U_n = \{x \in X \mid \dim_x X_{f(x)} \leq n\} $$ of Lemma \ref{lemma-openness-bounded-dimension-fibres} is retrocompact in $X$. (See Topology, Definition \ref{topology-definition-quasi-compact}.) \end{lemma} 
\begin{lemma} \label{lemma-dimension-fibre-specialization} Let $f : X \to S$ be a morphism of schemes. Let $x \leadsto x'$ be a nontrivial specialization of points in $X$ lying over the same point $s \in S$. Assume $f$ is locally of finite type. Then \begin{enumerate} \item $\dim_x(X_s) \leq \dim_{x'}(X_s)$, \item $\dim(\mathcal{O}_{X_s, x}) < \dim(\mathcal{O}_{X_s, x'})$, and \item $\text{trdeg}_{\kappa(s)}(\kappa(x)) > \text{trdeg}_{\kappa(s)}(\kappa(x'))$. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-relative-dimension-d} Let $f : X \to S$ be a morphism of schemes. Assume $f$ is locally of finite type. \begin{enumerate} \item We say $f$ is of {\it relative dimension $\leq d$ at $x$} if $\dim_x(X_{f(x)}) \leq d$. \item We say $f$ is of {\it relative dimension $\leq d$} if $\dim_x(X_{f(x)}) \leq d$ for all $x \in X$. \item We say $f$ is of {\it relative dimension $d$} if all nonempty fibres $X_s$ are equidimensional of dimension $d$. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-base-change-relative-dimension-d} Let $f : X \to S$ be a morphism of schemes which is locally of finite type. If $f$ has relative dimension $d$, then so does any base change of $f$. Same for relative dimension $\leq d$. \end{lemma} 
\begin{lemma} \label{lemma-composition-relative-dimension-d} Let $f : X \to Y$, $g : Y \to Z$ be locally of finite type. If $f$ has relative dimension $\leq d$ and $g$ has relative dimension $\leq e$ then $g \circ f$ has relative dimension $\leq d + e$. If \begin{enumerate} \item $f$ has relative dimension $d$, \item $g$ has relative dimension $e$, and \item $f$ is flat, \end{enumerate} then $g \circ f$ has relative dimension $d + e$. \end{lemma} 
\begin{lemma} \label{lemma-flat-finite-presentation-CM-fibres-relative-dimension} \begin{slogan} Cohen-Macaulay morphisms decompose into clopens of pure relative dimension \end{slogan} Let $f : X \to S$ be a morphism of schemes. Assume that \begin{enumerate} \item $f$ is flat, \item $f$ is locally of finite presentation, and \item for all $s \in S$ the fibre $X_s$ is Cohen-Macaulay (Properties, Definition \ref{properties-definition-Cohen-Macaulay}) \end{enumerate} Then there exist open and closed subschemes $X_d \subset X$ such that $X = \coprod_{d \geq 0} X_d$ and $f|_{X_d} : X_d \to S$ has relative dimension $d$. \end{lemma} 
\begin{lemma} \label{lemma-locally-quasi-finite-rel-dimension-0} Let $f : X \to S$ be a morphism of schemes. Assume $f$ is locally of finite type. Let $x \in X$ with $s = f(x)$. Then $f$ is quasi-finite at $x$ if and only if $\dim_x(X_s) = 0$. In particular, $f$ is locally quasi-finite if and only if $f$ has relative dimension $0$. \end{lemma} 
\begin{lemma} \label{lemma-rel-dimension-dimension} Let $f : X \to Y$ be a morphism of locally Noetherian schemes which is flat, locally of finite type and of relative dimension $d$. For every point $x$ in $X$ with image $y$ in $Y$ we have $\dim_x(X) = \dim_y(Y) + d$. \end{lemma} 
\begin{definition} \label{definition-syntomic} Let $f : X \to S$ be a morphism of schemes. \begin{enumerate} \item We say that $f$ is {\it syntomic at $x \in X$} if there exists an affine open neighbourhood $\Spec(A) = U \subset X$ of $x$ and affine open $\Spec(R) = V \subset S$ with $f(U) \subset V$ such that the induced ring map $R \to A$ is syntomic. \item We say that $f$ is {\it syntomic} if it is syntomic at every point of $X$. \item If $S = \Spec(k)$ and $f$ is syntomic, then we say that $X$ is a {\it local complete intersection over $k$}. \item A morphism of affine schemes $f : X \to S$ is called {\it standard syntomic} if there exists a global relative complete intersection $R \to R[x_1, \ldots, x_n]/(f_1, \ldots, f_c)$ (see Algebra, Definition \ref{algebra-definition-relative-global-complete-intersection}) such that $X \to S$ is isomorphic to $$ \Spec(R[x_1, \ldots, x_n]/(f_1, \ldots, f_c)) \to \Spec(R). $$ \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-syntomic-characterize} Let $f : X \to S$ be a morphism of schemes. The following are equivalent \begin{enumerate} \item The morphism $f$ is syntomic. \item For every affine opens $U \subset X$, $V \subset S$ with $f(U) \subset V$ the ring map $\mathcal{O}_S(V) \to \mathcal{O}_X(U)$ is syntomic. \item There exists an open covering $S = \bigcup_{j \in J} V_j$ and open coverings $f^{-1}(V_j) = \bigcup_{i \in I_j} U_i$ such that each of the morphisms $U_i \to V_j$, $j\in J, i\in I_j$ is syntomic. \item There exists an affine open covering $S = \bigcup_{j \in J} V_j$ and affine open coverings $f^{-1}(V_j) = \bigcup_{i \in I_j} U_i$ such that the ring map $\mathcal{O}_S(V_j) \to \mathcal{O}_X(U_i)$ is syntomic, for all $j\in J, i\in I_j$. \end{enumerate} Moreover, if $f$ is syntomic then for any open subschemes $U \subset X$, $V \subset S$ with $f(U) \subset V$ the restriction $f|_U : U \to V$ is syntomic. \end{lemma} 
\begin{lemma} \label{lemma-composition-syntomic} The composition of two morphisms which are syntomic is syntomic. \end{lemma} 
\begin{lemma} \label{lemma-base-change-syntomic} The base change of a morphism which is syntomic is syntomic. \end{lemma} 
\begin{lemma} \label{lemma-open-immersion-syntomic} Any open immersion is syntomic. \end{lemma} 
\begin{lemma} \label{lemma-syntomic-locally-finite-presentation} A syntomic morphism is locally of finite presentation. \end{lemma} 
\begin{lemma} \label{lemma-syntomic-flat} A syntomic morphism is flat. \end{lemma} 
\begin{lemma} \label{lemma-syntomic-open} A syntomic morphism is universally open. \end{lemma} 
\begin{lemma} \label{lemma-local-complete-intersection} Let $k$ be a field. Let $X$ be a scheme locally of finite type over $k$. The following are equivalent: \begin{enumerate} \item $X$ is a local complete intersection over $k$, \item for every $x \in X$ there exists an affine open $U = \Spec(R) \subset X$ neighbourhood of $x$ such that $R \cong k[x_1, \ldots, x_n]/(f_1, \ldots, f_c)$ is a global complete intersection over $k$, and \item for every $x \in X$ the local ring $\mathcal{O}_{X, x}$ is a complete intersection over $k$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-syntomic-locally-standard-syntomic} Let $f : X  \to S$ be a morphism of schemes. Let $x \in X$ be a point with image $s = f(x)$. Let $V \subset S$ be an affine open neighbourhood of $s$. The following are equivalent \begin{enumerate} \item The morphism $f$ is syntomic at $x$. \item There exist an affine open $U \subset X$ with $x \in U$ and $f(U) \subset V$ such that $f|_U : U \to V$ is standard syntomic. \item The morphism $f$ is of finite presentation at $x$, the local ring map $\mathcal{O}_{S, s} \to \mathcal{O}_{X, x}$ is flat and $\mathcal{O}_{X, x}/\mathfrak m_s \mathcal{O}_{X, x}$ is a complete intersection over $\kappa(s)$ (see Algebra, Definition \ref{algebra-definition-lci-local-ring}). \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-syntomic-flat-fibres} Let $f : X \to S$ be a morphism of schemes. If $f$ is flat, locally of finite presentation, and all fibres $X_s$ are local complete intersections, then $f$ is syntomic. \end{lemma} 
\begin{lemma} \label{lemma-set-points-where-fibres-lci} Let $f : X \to S$ be a morphism of schemes. Assume $f$ locally of finite type. Formation of the set $$ T = \{x \in X \mid \mathcal{O}_{X_{f(x)}, x} \text{ is a complete intersection over }\kappa(f(x))\} $$ commutes with arbitrary base change: For any morphism $g : S' \to S$, consider the base change $f' : X' \to S'$ of $f$ and the projection $g' : X' \to X$. Then the corresponding set $T'$ for the morphism $f'$ is equal to $T' = (g')^{-1}(T)$. In particular, if $f$ is assumed flat, and locally of finite presentation then the same holds for the open set of points where $f$ is syntomic. \end{lemma} 
\begin{lemma} \label{lemma-standard-syntomic-relative-dimension} Let $R$ be a ring. Let $R \to A = R[x_1, \ldots, x_n]/(f_1, \ldots, f_c)$ be a relative global complete intersection. Set $S = \Spec(R)$ and $X = \Spec(A)$. Consider the morphism $f : X \to S$ associated to the ring map $R \to A$. The function $x \mapsto \dim_x(X_{f(x)})$ is constant with value $n - c$. \end{lemma} 
\begin{lemma} \label{lemma-syntomic-relative-dimension} Let $f : X \to S$ be a syntomic morphism. The function $x \mapsto \dim_x(X_{f(x)})$ is locally constant on $X$. \end{lemma} 
\begin{definition} \label{definition-syntomic-relative-dimension} Let $d \geq 0$ be an integer. We say a morphism of schemes $f : X \to S$ is {\it syntomic of relative dimension $d$} if $f$ is syntomic and the function $\dim_x(X_{f(x)}) = d$ for all $x \in X$. \end{definition} 
\begin{lemma} \label{lemma-syntomic-permanence} Let $$ \xymatrix{ X \ar[rr]_f \ar[rd]_p & & Y \ar[dl]^q \\ & S } $$ be a commutative diagram of morphisms of schemes. Assume that \begin{enumerate} \item $f$ is surjective and syntomic, \item $p$ is syntomic, and \item $q$ is locally of finite presentation\footnote{In fact, if $f$ is surjective, flat, and locally of finite presentation and $p$ is syntomic, then both $q$ and $f$ are syntomic, see Descent, Lemma \ref{descent-lemma-syntomic-permanence}.}. \end{enumerate} Then $q$ is syntomic. \end{lemma} 
\begin{definition} \label{definition-conormal-sheaf} Let $i : Z \to X$ be an immersion. The {\it conormal sheaf $\mathcal{C}_{Z/X}$ of $Z$ in $X$} or the {\it conormal sheaf of $i$} is the quasi-coherent $\mathcal{O}_Z$-module $\mathcal{I}/\mathcal{I}^2$ described above. \end{definition} 
\begin{lemma} \label{lemma-affine-conormal} Let $i : Z \to X$ be an immersion. The conormal sheaf of $i$ has the following properties: \begin{enumerate} \item Let $U \subset X$ be any open subscheme such that $i$ factors as $Z \xrightarrow{i'} U \to X$ where $i'$ is a closed immersion. Let $\mathcal{I} = \Ker((i')^\sharp) \subset \mathcal{O}_U$. Then $$ \mathcal{C}_{Z/X} = (i')^*\mathcal{I}\quad\text{and}\quad i'_*\mathcal{C}_{Z/X} = \mathcal{I}/\mathcal{I}^2 $$ \item For any affine open $\Spec(R) = U \subset X$ such that $Z \cap U = \Spec(R/I)$ there is a canonical isomorphism $\Gamma(Z \cap U, \mathcal{C}_{Z/X}) = I/I^2$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-conormal-functorial} Let $$ \xymatrix{ Z \ar[r]_i \ar[d]_f & X \ar[d]^g \\ Z' \ar[r]^{i'} & X' } $$ be a commutative diagram in the category of schemes. Assume $i$, $i'$ immersions. There is a canonical map of $\mathcal{O}_Z$-modules $$ f^*\mathcal{C}_{Z'/X'} \longrightarrow \mathcal{C}_{Z/X} $$ characterized by the following property: For every pair of affine opens $(\Spec(R) = U \subset X, \Spec(R') = U' \subset X')$ with $f(U) \subset U'$ such that $Z \cap U = \Spec(R/I)$ and $Z' \cap U' = \Spec(R'/I')$ the induced map $$ \Gamma(Z' \cap U', \mathcal{C}_{Z'/X'}) = I'/I'^2 \longrightarrow I/I^2 = \Gamma(Z \cap U, \mathcal{C}_{Z/X}) $$ is the one induced by the ring map $f^\sharp : R' \to R$ which has the property $f^\sharp(I') \subset I$. \end{lemma} 
\begin{lemma} \label{lemma-conormal-functorial-flat} Let $$ \xymatrix{ Z \ar[r]_i \ar[d]_f & X \ar[d]^g \\ Z' \ar[r]^{i'} & X' } $$ be a fibre product diagram in the category of schemes with $i$, $i'$ immersions. Then the canonical map $f^*\mathcal{C}_{Z'/X'} \to \mathcal{C}_{Z/X}$ of Lemma \ref{lemma-conormal-functorial} is surjective. If $g$ is flat, then it is an isomorphism. \end{lemma} 
\begin{lemma} \label{lemma-transitivity-conormal} Let $Z \to Y \to X$ be immersions of schemes. Then there is a canonical exact sequence $$ i^*\mathcal{C}_{Y/X} \to \mathcal{C}_{Z/X} \to \mathcal{C}_{Z/Y} \to 0 $$ where the maps come from Lemma \ref{lemma-conormal-functorial} and $i : Z \to Y$ is the first morphism. \end{lemma} 
\begin{definition} \label{definition-sheaf-differentials} Let $f : X \to S$ be a morphism of schemes. The {\it sheaf of differentials $\Omega_{X/S}$ of $X$ over $S$} is the sheaf of differentials of $f$ viewed as a morphism of ringed spaces (Modules, Definition \ref{modules-definition-differentials}) equipped with its {\it universal $S$-derivation} $$ \text{d}_{X/S} : \mathcal{O}_X \longrightarrow \Omega_{X/S}. $$ \end{definition} 
\begin{lemma} \label{lemma-universal-derivation-universal} Let $f : X \to S$ be a morphism of schemes. The map $$ \Hom_{\mathcal{O}_X}(\Omega_{X/S}, \mathcal{F}) \longrightarrow \text{Der}_S(\mathcal{O}_X, \mathcal{F}),\quad \alpha \longmapsto \alpha \circ \text{d}_{X/S} $$ is an isomorphism of functors $\textit{Mod}(\mathcal{O}_X) \to \textit{Sets}$. \end{lemma} 
\begin{lemma} \label{lemma-differentials-restrict-open} Let $f : X \to S$ be a morphism of schemes. Let $U \subset X$, $V \subset S$ be open subschemes such that $f(U) \subset V$. Then there is a unique isomorphism $\Omega_{X/S}|_U = \Omega_{U/V}$ of $\mathcal{O}_U$-modules such that $\text{d}_{X/S}|_U = \text{d}_{U/V}$. \end{lemma} 
\begin{lemma} \label{lemma-affine-case-derivation} Let $R \to A$ be a ring map. Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_X$-modules on $X = \Spec(A)$. Set $S = \Spec(R)$. The rule which associates to an $S$-derivation on $\mathcal{F}$ its action on global sections defines a bijection between the set of $S$-derivations of $\mathcal{F}$ and the set of $R$-derivations on $M = \Gamma(X, \mathcal{F})$. \end{lemma} 
\begin{lemma} \label{lemma-differentials-affine} Let $f : X \to S$ be a morphism of schemes. For any pair of affine opens $\Spec(A) = U \subset X$, $\Spec(R) = V \subset S$ with $f(U) \subset V$ there is a unique isomorphism $$ \Gamma(U, \Omega_{X/S}) = \Omega_{A/R}. $$ compatible with $\text{d}_{X/S}$ and $\text{d} : A \to \Omega_{A/R}$. \end{lemma} 
\begin{lemma} \label{lemma-differentials-diagonal} Let $f : X \to S$ be a morphism of schemes. There is a canonical isomorphism between $\Omega_{X/S}$ and the conormal sheaf of the diagonal morphism $\Delta_{X/S} : X \longrightarrow X \times_S X$. \end{lemma} 
\begin{lemma} \label{lemma-functoriality-differentials} Let $$ \xymatrix{ X' \ar[d] \ar[r]_f & X \ar[d] \\ S' \ar[r] & S } $$ be a commutative diagram of schemes. The canonical map $\mathcal{O}_X \to f_*\mathcal{O}_{X'}$ composed with the map $f_*\text{d}_{X'/S'} : f_*\mathcal{O}_{X'} \to f_*\Omega_{X'/S'}$ is a $S$-derivation. Hence we obtain a canonical map of $\mathcal{O}_X$-modules $\Omega_{X/S} \to f_*\Omega_{X'/S'}$, and by adjointness of $f_*$ and $f^*$ a canonical $\mathcal{O}_{X'}$-module homomorphism $$ c_f : f^*\Omega_{X/S} \longrightarrow \Omega_{X'/S'}. $$ It is uniquely characterized by the property that $f^*\text{d}_{X/S}(h)$ maps to $\text{d}_{X'/S'}(f^* h)$ for any local section $h$ of $\mathcal{O}_X$. \end{lemma} 
\begin{lemma} \label{lemma-triangle-differentials} Let $f : X \to Y$, $g : Y \to S$ be morphisms of schemes. Then there is a canonical exact sequence $$ f^*\Omega_{Y/S} \to \Omega_{X/S} \to \Omega_{X/Y} \to 0 $$ where the maps come from applications of Lemma \ref{lemma-functoriality-differentials}. \end{lemma} 
\begin{lemma} \label{lemma-base-change-differentials} Let $X \to S$ be a morphism of schemes. Let $g : S' \to S$ be a morphism of schemes. Let $X' = X_{S'}$ be the base change of $X$. Denote $g' : X' \to X$ the projection. Then the map $$ (g')^*\Omega_{X/S} \to \Omega_{X'/S'} $$ of Lemma \ref{lemma-functoriality-differentials} is an isomorphism. \end{lemma} 
\begin{lemma} \label{lemma-differential-product} Let $f : X \to S$ and $g : Y \to S$ be morphisms of schemes with the same target. Let $p : X \times_S Y \to X$ and $q : X \times_S Y \to Y$ be the projection morphisms. The maps from Lemma \ref{lemma-functoriality-differentials} $$ p^*\Omega_{X/S} \oplus q^*\Omega_{Y/S} \longrightarrow \Omega_{X \times_S Y/S} $$ give an isomorphism. \end{lemma} 
\begin{lemma} \label{lemma-finite-type-differentials} Let $f : X \to S$ be a morphism of schemes. If $f$ is locally of finite type, then $\Omega_{X/S}$ is a finite type $\mathcal{O}_X$-module. \end{lemma} 
\begin{lemma} \label{lemma-finite-presentation-differentials} Let $f : X \to S$ be a morphism of schemes. If $f$ is locally of finite presentation, then $\Omega_{X/S}$ is an $\mathcal{O}_X$-module of finite presentation. \end{lemma} 
\begin{lemma} \label{lemma-immersion-differentials} If $X \to S$ is an immersion, or more generally a monomorphism, then $\Omega_{X/S}$ is zero. \end{lemma} 
\begin{lemma} \label{lemma-differentials-relative-immersion} Let $i : Z \to X$ be an immersion of schemes over $S$. There is a canonical exact sequence $$ \mathcal{C}_{Z/X} \to i^*\Omega_{X/S} \to \Omega_{Z/S} \to 0 $$ where the first arrow is induced by $\text{d}_{X/S}$ and the second arrow comes from Lemma \ref{lemma-functoriality-differentials}. \end{lemma} 
\begin{lemma} \label{lemma-differentials-relative-immersion-section} Let $i : Z \to X$ be an immersion of schemes over $S$, and assume $i$ (locally) has a left inverse. Then the canonical sequence $$ 0 \to \mathcal{C}_{Z/X} \to i^*\Omega_{X/S} \to \Omega_{Z/S} \to 0 $$ of Lemma \ref{lemma-differentials-relative-immersion} is (locally) split exact. In particular, if $s : S \to X$ is a section of the structure morphism $X \to S$ then the map $\mathcal{C}_{S/X} \to s^*\Omega_{X/S}$ induced by $\text{d}_{X/S}$ is an isomorphism. \end{lemma} 
\begin{lemma} \label{lemma-two-immersions} Let $$ \xymatrix{ Z \ar[r]_i \ar[rd]_j & X \ar[d] \\ & Y } $$ be a commutative diagram of schemes where $i$ and $j$ are immersions. Then there is a canonical exact sequence $$ \mathcal{C}_{Z/Y} \to \mathcal{C}_{Z/X} \to i^*\Omega_{X/Y} \to 0 $$ where the first arrow comes from Lemma \ref{lemma-conormal-functorial} and the second from Lemma \ref{lemma-differentials-relative-immersion}. \end{lemma} 
\begin{lemma} \label{lemma-affine-case-differential-operators} Let $R \to A$ be a ring map. Denote $f : X \to S$ the corresponding morphism of affine schemes. Let $\mathcal{F}$ and $\mathcal{G}$ be $\mathcal{O}_X$-modules. If $\mathcal{F}$ is quasi-coherent then the map $$ \text{Diff}^k_{X/S}(\mathcal{F}, \mathcal{G}) \to \text{Diff}^k_{A/R}(\Gamma(X, \mathcal{F}), \Gamma(X, \mathcal{G})) $$ sending a differential operator to its action on global sections is bijective. \end{lemma} 
\begin{lemma} \label{lemma-base-change-differential-operators} Let $a : X \to S$ and $b : Y \to S$ be morphisms of schemes. Let $\mathcal{F}$ and $\mathcal{F}'$ be quasi-coherent $\mathcal{O}_X$-modules. Let $D : \mathcal{F} \to \mathcal{F}'$ be a differential operator of order $k$ on $X/S$. Let $\mathcal{G}$ be a quasi-coherent $\mathcal{O}_Y$-module. Then there is a unique differential operator $$ D' : \text{pr}_1^*\mathcal{F} \otimes_{\mathcal{O}_{X \times_S Y}} \text{pr}_2^*\mathcal{G} \longrightarrow \text{pr}_1^*\mathcal{F}' \otimes_{\mathcal{O}_{X \times_S Y}} \text{pr}_2^*\mathcal{G} $$ of order $k$ on $X \times_S Y / Y$ such that $ D'(s \otimes t) = D(s) \otimes t $ for local sections $s$ of $\mathcal{F}$ and $t$ of $\mathcal{G}$. \end{lemma} 
\begin{definition} \label{definition-smooth} Let $f : X \to S$ be a morphism of schemes. \begin{enumerate} \item We say that $f$ is {\it smooth at $x \in X$} if there exist an affine open neighbourhood $\Spec(A) = U \subset X$ of $x$ and affine open $\Spec(R) = V \subset S$ with $f(U) \subset V$ such that the induced ring map $R \to A$ is smooth. \item We say that $f$ is {\it smooth} if it is smooth at every point of $X$. \item A morphism of affine schemes $f : X \to S$ is called {\it standard smooth} if there exists a standard smooth ring map $R \to R[x_1, \ldots, x_n]/(f_1, \ldots, f_c)$ (see Algebra, Definition \ref{algebra-definition-standard-smooth}) such that $X \to S$ is isomorphic to $$ \Spec(R[x_1, \ldots, x_n]/(f_1, \ldots, f_c)) \to \Spec(R). $$ \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-smooth-characterize} Let $f : X \to S$ be a morphism of schemes. The following are equivalent \begin{enumerate} \item The morphism $f$ is smooth. \item For every affine opens $U \subset X$, $V \subset S$ with $f(U) \subset V$ the ring map $\mathcal{O}_S(V) \to \mathcal{O}_X(U)$ is smooth. \item There exists an open covering $S = \bigcup_{j \in J} V_j$ and open coverings $f^{-1}(V_j) = \bigcup_{i \in I_j} U_i$ such that each of the morphisms $U_i \to V_j$, $j\in J, i\in I_j$ is smooth. \item There exists an affine open covering $S = \bigcup_{j \in J} V_j$ and affine open coverings $f^{-1}(V_j) = \bigcup_{i \in I_j} U_i$ such that the ring map $\mathcal{O}_S(V_j) \to \mathcal{O}_X(U_i)$ is smooth, for all $j\in J, i\in I_j$. \end{enumerate} Moreover, if $f$ is smooth then for any open subschemes $U \subset X$, $V \subset S$ with $f(U) \subset V$ the restriction $f|_U : U \to V$ is smooth. \end{lemma} 
\begin{lemma} \label{lemma-smooth-flat-smooth-fibres} Let $f : X \to S$ be a morphism of schemes. If $f$ is flat, locally of finite presentation, and all fibres $X_s$ are smooth, then $f$ is smooth. \end{lemma} 
\begin{lemma} \label{lemma-composition-smooth} The composition of two morphisms which are smooth is smooth. \end{lemma} 
\begin{lemma} \label{lemma-base-change-smooth} The base change of a morphism which is smooth is smooth. \end{lemma} 
\begin{lemma} \label{lemma-open-immersion-smooth} Any open immersion is smooth. \end{lemma} 
\begin{lemma} \label{lemma-smooth-syntomic} A smooth morphism is syntomic. \end{lemma} 
\begin{lemma} \label{lemma-smooth-locally-finite-presentation} A smooth morphism is locally of finite presentation. \end{lemma} 
\begin{lemma} \label{lemma-smooth-flat} A smooth morphism is flat. \end{lemma} 
\begin{lemma} \label{lemma-smooth-open} A smooth morphism is universally open. \end{lemma} 
\begin{lemma} \label{lemma-smooth-locally-standard-smooth} \begin{slogan} Smooth morphisms are locally standard smooth. \end{slogan} Let $f : X  \to S$ be a morphism of schemes. Let $x \in X$ be a point. Let $V \subset S$ be an affine open neighbourhood of $f(x)$. The following are equivalent \begin{enumerate} \item The morphism $f$ is smooth at $x$. \item There exists an affine open $U \subset X$, with $x \in U$ and $f(U) \subset V$ such that the induced morphism $f|_U : U \to V$ is standard smooth. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-smooth-omega-finite-locally-free} Let $f : X \to S$ be a morphism of schemes. Assume $f$ is smooth. Then the module of differentials $\Omega_{X/S}$ of $X$ over $S$ is finite locally free and $$ \text{rank}_x(\Omega_{X/S}) = \dim_x(X_{f(x)}) $$ for every $x \in X$. \end{lemma} 
\begin{definition} \label{definition-smooth-relative-dimension} Let $d \geq 0$ be an integer. We say a morphism of schemes $f : X \to S$ is {\it smooth of relative dimension $d$} if $f$ is smooth and $\Omega_{X/S}$ is finite locally free of constant rank $d$. \end{definition} 
\begin{lemma} \label{lemma-smooth-at-point} Let $f : X \to S$ be a morphism of schemes. Let $x \in X$. Set $s = f(x)$. Assume $f$ is locally of finite presentation. The following are equivalent: \begin{enumerate} \item The morphism $f$ is smooth at $x$. \item The local ring map $\mathcal{O}_{S, s} \to \mathcal{O}_{X, x}$ is flat and $X_s \to \Spec(\kappa(s))$ is smooth at $x$. \item The local ring map $\mathcal{O}_{S, s} \to \mathcal{O}_{X, x}$ is flat and the $\mathcal{O}_{X, x}$-module $\Omega_{X/S, x}$ can be generated by at most $\dim_x(X_{f(x)})$ elements. \item The local ring map $\mathcal{O}_{S, s} \to \mathcal{O}_{X, x}$ is flat and the $\kappa(x)$-vector space $$ \Omega_{X_s/s, x} \otimes_{\mathcal{O}_{X_s, x}} \kappa(x) = \Omega_{X/S, x} \otimes_{\mathcal{O}_{X, x}} \kappa(x) $$ can be generated by at most $\dim_x(X_{f(x)})$ elements. \item There exist affine opens $U \subset X$, and $V \subset S$ such that $x \in U$, $f(U) \subset V$ and the induced morphism $f|_U : U \to V$ is standard smooth. \item There exist affine opens $\Spec(A) = U \subset X$ and $\Spec(R) = V \subset S$ with $x \in U$ corresponding to $\mathfrak q \subset A$, and $f(U) \subset V$ such that there exists a presentation $$ A = R[x_1, \ldots, x_n]/(f_1, \ldots, f_c) $$ with $$ g = \det \left( \begin{matrix} \partial f_1/\partial x_1 & \partial f_2/\partial x_1 & \ldots & \partial f_c/\partial x_1 \\ \partial f_1/\partial x_2 & \partial f_2/\partial x_2 & \ldots & \partial f_c/\partial x_2 \\ \ldots & \ldots & \ldots & \ldots \\ \partial f_1/\partial x_c & \partial f_2/\partial x_c & \ldots & \partial f_c/\partial x_c \end{matrix} \right) $$ mapping to an element of $A$ not in $\mathfrak q$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-set-points-where-fibres-smooth} Let $$ \xymatrix{ X' \ar[r]_{g'} \ar[d]_{f'} & X \ar[d]^f \\ S' \ar[r]^g & S } $$ be a cartesian diagram of schemes. Let $W \subset X$, resp.\ $W' \subset X'$ be the open subscheme of points where $f$, resp.\ $f'$ is smooth. Then $W' = (g')^{-1}(W)$ if \begin{enumerate} \item $f$ is flat and locally of finite presentation, or \item $f$ is locally of finite presentation and $g$ is flat. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-triangle-differentials-smooth} Let $f : X \to Y$, $g : Y \to S$ be morphisms of schemes. Assume $f$ is smooth. Then $$ 0 \to f^*\Omega_{Y/S} \to \Omega_{X/S} \to \Omega_{X/Y} \to 0 $$ (see Lemma \ref{lemma-triangle-differentials}) is short exact. \end{lemma} 
\begin{lemma} \label{lemma-differentials-relative-immersion-smooth} Let $i : Z \to X$ be an immersion of schemes over $S$. Assume that $Z$ is smooth over $S$. Then the canonical exact sequence $$ 0 \to \mathcal{C}_{Z/X} \to i^*\Omega_{X/S} \to \Omega_{Z/S} \to 0 $$ of Lemma \ref{lemma-differentials-relative-immersion} is short exact. \end{lemma} 
\begin{lemma} \label{lemma-two-immersions-smooth} Let $$ \xymatrix{ Z \ar[r]_i \ar[rd]_j & X \ar[d] \\ & Y } $$ be a commutative diagram of schemes where $i$ and $j$ are immersions and $X \to Y$ is smooth. Then the canonical exact sequence $$ 0 \to  \mathcal{C}_{Z/Y} \to \mathcal{C}_{Z/X} \to i^*\Omega_{X/Y} \to 0 $$ of Lemma \ref{lemma-two-immersions} is exact. \end{lemma} 
\begin{lemma} \label{lemma-smooth-permanence} Let $$ \xymatrix{ X \ar[rr]_f \ar[rd]_p & & Y \ar[dl]^q \\ & S } $$ be a commutative diagram of morphisms of schemes. Assume that \begin{enumerate} \item $f$ is surjective, and smooth, \item $p$ is smooth, and \item $q$ is locally of finite presentation\footnote{In fact this is implied by (1) and (2), see Descent, Lemma \ref{descent-lemma-flat-finitely-presented-permanence}. Moreover, it suffices to assume $f$ is surjective, flat and locally of finite presentation, see Descent, Lemma \ref{descent-lemma-smooth-permanence}.}. \end{enumerate} Then $q$ is smooth. \end{lemma} 
\begin{lemma} \label{lemma-section-smooth-morphism} Let $f : X \to S$ be a morphism of schemes. Let $\sigma : S \to X$ be a section of $f$. Let $s \in S$ be a point such that $f$ is smooth at $x = \sigma(s)$. Then there exist affine open neighbourhoods $\Spec(A) = U \subset S$ of $s$ and $\Spec(B) = V \subset X$ of $x$ such that \begin{enumerate} \item $f(V) \subset U$ and $\sigma(U) \subset V$, \item with $I = \Ker(\sigma^\# : B \to A)$ the module $I/I^2$ is a free $A$-module, and \item $B^\wedge \cong A[[x_1, \ldots, x_d]]$ as $A$-algebras where $B^\wedge$ denotes the completion of $B$ with respect to $I$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-smoothness-dimension} Let $f : X \to Y$ be a smooth morphism of locally Noetherian schemes. For every point $x$ in $X$ with image $y$ in $Y$, $$ \dim_x(X) = \dim_y(Y) + \dim_x(X_y), $$ where $X_y$ denotes the fiber over $y$. \end{lemma} 
\begin{definition} \label{definition-unramified} Let $f : X \to S$ be a morphism of schemes. \begin{enumerate} \item We say that $f$ is {\it unramified at $x \in X$} if there exists an affine open neighbourhood $\Spec(A) = U \subset X$ of $x$ and affine open $\Spec(R) = V \subset S$ with $f(U) \subset V$ such that the induced ring map $R \to A$ is unramified. \item We say that $f$ is {\it G-unramified at $x \in X$} if there exists an affine open neighbourhood $\Spec(A) = U \subset X$ of $x$ and affine open $\Spec(R) = V \subset S$ with $f(U) \subset V$ such that the induced ring map $R \to A$ is G-unramified. \item We say that $f$ is {\it unramified} if it is unramified at every point of $X$. \item We say that $f$ is {\it G-unramified} if it is G-unramified at every point of $X$. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-unramified-omega-zero} Let $f : X \to S$ be a morphism of schemes. Then \begin{enumerate} \item $f$ is unramified if and only if $f$ is locally of finite type and $\Omega_{X/S} = 0$, and \item $f$ is G-unramified if and only if $f$ is locally of finite presentation and $\Omega_{X/S} = 0$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-unramified-characterize} Let $f : X \to S$ be a morphism of schemes. The following are equivalent \begin{enumerate} \item The morphism $f$ is unramified (resp.\ G-unramified). \item For every affine open $U \subset X$, $V \subset S$ with $f(U) \subset V$ the ring map $\mathcal{O}_S(V) \to \mathcal{O}_X(U)$ is unramified (resp.\ G-unramified). \item There exists an open covering $S = \bigcup_{j \in J} V_j$ and open coverings $f^{-1}(V_j) = \bigcup_{i \in I_j} U_i$ such that each of the morphisms $U_i \to V_j$, $j\in J, i\in I_j$ is unramified (resp.\ G-unramified). \item There exists an affine open covering $S = \bigcup_{j \in J} V_j$ and affine open coverings $f^{-1}(V_j) = \bigcup_{i \in I_j} U_i$ such that the ring map $\mathcal{O}_S(V_j) \to \mathcal{O}_X(U_i)$ is unramified (resp.\ G-unramified), for all $j\in J, i\in I_j$. \end{enumerate} Moreover, if $f$ is unramified (resp.\ G-unramified) then for any open subschemes $U \subset X$, $V \subset S$ with $f(U) \subset V$ the restriction $f|_U : U \to V$ is unramified (resp.\ G-unramified). \end{lemma} 
\begin{lemma} \label{lemma-composition-unramified} The composition of two morphisms which are unramified is unramified. The same holds for G-unramified morphisms. \end{lemma} 
\begin{lemma} \label{lemma-base-change-unramified} The base change of a morphism which is unramified is unramified. The same holds for G-unramified morphisms. \end{lemma} 
\begin{lemma} \label{lemma-noetherian-unramified} Let $f : X \to S$ be a morphism of schemes. Assume $S$ is locally Noetherian. Then $f$ is unramified if and only if $f$ is G-unramified. \end{lemma} 
\begin{lemma} \label{lemma-open-immersion-unramified} Any open immersion is G-unramified. \end{lemma} 
\begin{lemma} \label{lemma-closed-immersion-unramified} A closed immersion $i : Z \to X$ is unramified. It is G-unramified if and only if the associated quasi-coherent sheaf of ideals $\mathcal{I} = \Ker(\mathcal{O}_X \to i_*\mathcal{O}_Z)$ is of finite type (as an $\mathcal{O}_X$-module). \end{lemma} 
\begin{lemma} \label{lemma-unramified-locally-finite-type} An unramified morphism is locally of finite type. A G-unramified morphism is locally of finite presentation. \end{lemma} 
\begin{lemma} \label{lemma-unramified-quasi-finite} Let $f : X \to S$ be a morphism of schemes. If $f$ is unramified at $x$ then $f$ is quasi-finite at $x$. In particular, an unramified morphism is locally quasi-finite. \end{lemma} 
\begin{lemma} \label{lemma-unramified-over-field} Fibres of unramified morphisms. \begin{enumerate} \item Let $X$ be a scheme over a field $k$. The structure morphism $X \to \Spec(k)$ is unramified if and only if $X$ is a disjoint union of spectra of finite separable field extensions of $k$. \item If $f : X \to S$ is an unramified morphism then for every $s \in S$ the fibre $X_s$ is a disjoint union of spectra of finite separable field extensions of $\kappa(s)$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-unramified-etale-fibres} Let $f : X \to S$ be a morphism of schemes. \begin{enumerate} \item If $f$ is unramified then for any $x \in X$ the field extension $\kappa(x)/\kappa(f(x))$ is finite separable. \item If $f$ is locally of finite type, and for every $s \in S$ the fibre $X_s$ is a disjoint union of spectra of finite separable field extensions of $\kappa(s)$ then $f$ is unramified. \item If $f$ is locally of finite presentation, and for every $s \in S$ the fibre $X_s$ is a disjoint union of spectra of finite separable field extensions of $\kappa(s)$ then $f$ is G-unramified. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-diagonal-unramified-morphism} Let $f : X \to S$ be a morphism. \begin{enumerate} \item If $f$ is unramified, then the diagonal morphism $\Delta : X \to X \times_S X$ is an open immersion. \item If $f$ is locally of finite type and $\Delta$ is an open immersion, then $f$ is unramified. \item If $f$ is locally of finite presentation and $\Delta$ is an open immersion, then $f$ is G-unramified. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-unramified-at-point} Let $f : X \to S$ be a morphism of schemes. Let $x \in X$. Set $s = f(x)$. Assume $f$ is locally of finite type (resp.\ locally of finite presentation). The following are equivalent: \begin{enumerate} \item The morphism $f$ is unramified (resp.\ G-unramified) at $x$. \item The fibre $X_s$ is unramified over $\kappa(s)$ at $x$. \item The $\mathcal{O}_{X, x}$-module $\Omega_{X/S, x}$ is zero. \item The $\mathcal{O}_{X_s, x}$-module $\Omega_{X_s/s, x}$ is zero. \item The $\kappa(x)$-vector space $$ \Omega_{X_s/s, x} \otimes_{\mathcal{O}_{X_s, x}} \kappa(x) = \Omega_{X/S, x} \otimes_{\mathcal{O}_{X, x}} \kappa(x) $$ is zero. \item We have $\mathfrak m_s\mathcal{O}_{X, x} = \mathfrak m_x$ and the field extension $\kappa(x)/\kappa(s)$ is finite separable. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-set-points-where-fibres-unramified} Let $f : X \to S$ be a morphism of schemes. Assume $f$ locally of finite type. Formation of the open set \begin{align*} T & = \{x \in X \mid X_{f(x)}\text{ is unramified over }\kappa(f(x))\text{ at }x\} \\ & = \{x \in X \mid X\text{ is unramified over }S\text{ at }x\} \end{align*} commutes with arbitrary base change: For any morphism $g : S' \to S$, consider the base change $f' : X' \to S'$ of $f$ and the projection $g' : X' \to X$. Then the corresponding set $T'$ for the morphism $f'$ is equal to $T' = (g')^{-1}(T)$. If $f$ is assumed locally of finite presentation then the same holds for the open set of points where $f$ is G-unramified. \end{lemma} 
\begin{lemma} \label{lemma-unramified-permanence} Let $f : X \to Y$ be a morphism of schemes over $S$. \begin{enumerate} \item If $X$ is unramified over $S$, then $f$ is unramified. \item If $X$ is G-unramified over $S$ and $Y$ is locally of finite type over $S$, then $f$ is G-unramified. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-value-at-one-point} Let $S$ be a scheme. Let $X$, $Y$ be schemes over $S$. Let $f, g : X \to Y$ be morphisms over $S$. Let $x \in X$. Assume that \begin{enumerate} \item the structure morphism $Y \to S$ is unramified, \item $f(x) = g(x)$ in $Y$, say $y = f(x) = g(x)$, and \item the induced maps $f^\sharp, g^\sharp : \kappa(y) \to \kappa(x)$ are equal. \end{enumerate} Then there exists an open neighbourhood of $x$ in $X$ on which $f$ and $g$ are equal. \end{lemma} 
\begin{definition} \label{definition-etale} Let $f : X \to S$ be a morphism of schemes. \begin{enumerate} \item We say that $f$ is {\it \'etale at $x \in X$} if there exists an affine open neighbourhood $\Spec(A) = U \subset X$ of $x$ and affine open $\Spec(R) = V \subset S$ with $f(U) \subset V$ such that the induced ring map $R \to A$ is \'etale. \item We say that $f$ is {\it \'etale} if it is \'etale at every point of $X$. \item A morphism of affine schemes $f : X \to S$ is called {\it standard \'etale} if $X \to S$ is isomorphic to $$ \Spec(R[x]_h/(g)) \to \Spec(R) $$ where $R \to R[x]_h/(g)$ is a standard \'etale ring map, see Algebra, Definition \ref{algebra-definition-standard-etale}, i.e., $g$ is monic and $g'$ invertible in $R[x]_h/(g)$. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-etale-characterize} Let $f : X \to S$ be a morphism of schemes. The following are equivalent \begin{enumerate} \item The morphism $f$ is \'etale. \item For every affine opens $U \subset X$, $V \subset S$ with $f(U) \subset V$ the ring map $\mathcal{O}_S(V) \to \mathcal{O}_X(U)$ is \'etale. \item There exists an open covering $S = \bigcup_{j \in J} V_j$ and open coverings $f^{-1}(V_j) = \bigcup_{i \in I_j} U_i$ such that each of the morphisms $U_i \to V_j$, $j\in J, i\in I_j$ is \'etale. \item There exists an affine open covering $S = \bigcup_{j \in J} V_j$ and affine open coverings $f^{-1}(V_j) = \bigcup_{i \in I_j} U_i$ such that the ring map $\mathcal{O}_S(V_j) \to \mathcal{O}_X(U_i)$ is \'etale, for all $j\in J, i\in I_j$. \end{enumerate} Moreover, if $f$ is \'etale then for any open subschemes $U \subset X$, $V \subset S$ with $f(U) \subset V$ the restriction $f|_U : U \to V$ is \'etale. \end{lemma} 
\begin{lemma} \label{lemma-composition-etale} The composition of two morphisms which are \'etale is \'etale. \end{lemma} 
\begin{lemma} \label{lemma-base-change-etale} The base change of a morphism which is \'etale is \'etale. \end{lemma} 
\begin{lemma} \label{lemma-etale-smooth-unramified} Let $f : X \to S$ be a morphism of schemes. Let $x \in X$. Then $f$ is \'etale at $x$ if and only if $f$ is smooth and unramified at $x$. \end{lemma} 
\begin{lemma} \label{lemma-etale-locally-quasi-finite} An \'etale morphism is locally quasi-finite. \end{lemma} 
\begin{lemma} \label{lemma-etale-over-field} \begin{slogan} Description of the \'etale schemes over fields and fibres of \'etale morphisms. \end{slogan} Fibres of \'etale morphisms. \begin{enumerate} \item Let $X$ be a scheme over a field $k$. The structure morphism $X \to \Spec(k)$ is \'etale if and only if $X$ is a disjoint union of spectra of finite separable field extensions of $k$. \item If $f : X \to S$ is an \'etale morphism, then for every $s \in S$ the fibre $X_s$ is a disjoint union of spectra of finite separable field extensions of $\kappa(s)$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-etale-flat-etale-fibres} Let $f : X \to S$ be a morphism of schemes. If $f$ is flat, locally of finite presentation, and for every $s \in S$ the fibre $X_s$ is a disjoint union of spectra of finite separable field extensions of $\kappa(s)$, then $f$ is \'etale. \end{lemma} 
\begin{lemma} \label{lemma-open-immersion-etale} Any open immersion is \'etale. \end{lemma} 
\begin{lemma} \label{lemma-etale-syntomic} An \'etale morphism is syntomic. \end{lemma} 
\begin{lemma} \label{lemma-etale-locally-finite-presentation} An \'etale morphism is locally of finite presentation. \end{lemma} 
\begin{lemma} \label{lemma-etale-flat} An \'etale morphism is flat. \end{lemma} 
\begin{lemma} \label{lemma-etale-open} An \'etale morphism is open. \end{lemma} 
\begin{lemma} \label{lemma-etale-locally-standard-etale} Let $f : X  \to S$ be a morphism of schemes. Let $x \in X$ be a point. Let $V \subset S$ be an affine open neighbourhood of $f(x)$. The following are equivalent \begin{enumerate} \item The morphism $f$ is \'etale at $x$. \item There exist an affine open $U \subset X$ with $x \in U$ and $f(U) \subset V$ such that the induced morphism $f|_U : U \to V$ is standard \'etale (see Definition \ref{definition-etale}). \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-etale-at-point} Let $f : X \to S$ be a morphism of schemes. Let $x \in X$. Set $s = f(x)$. Assume $f$ is locally of finite presentation. The following are equivalent: \begin{enumerate} \item The morphism $f$ is \'etale at $x$. \item The local ring map $\mathcal{O}_{S, s} \to \mathcal{O}_{X, x}$ is flat and $X_s \to \Spec(\kappa(s))$ is \'etale at $x$. \item The local ring map $\mathcal{O}_{S, s} \to \mathcal{O}_{X, x}$ is flat and $X_s \to \Spec(\kappa(s))$ is unramified at $x$. \item The local ring map $\mathcal{O}_{S, s} \to \mathcal{O}_{X, x}$ is flat and the $\mathcal{O}_{X, x}$-module $\Omega_{X/S, x}$ is zero. \item The local ring map $\mathcal{O}_{S, s} \to \mathcal{O}_{X, x}$ is flat and the $\kappa(x)$-vector space $$ \Omega_{X_s/s, x} \otimes_{\mathcal{O}_{X_s, x}} \kappa(x) = \Omega_{X/S, x} \otimes_{\mathcal{O}_{X, x}} \kappa(x) $$ is zero. \item The local ring map $\mathcal{O}_{S, s} \to \mathcal{O}_{X, x}$ is flat, we have $\mathfrak m_s\mathcal{O}_{X, x} = \mathfrak m_x$ and the field extension $\kappa(x)/\kappa(s)$ is finite separable. \item There exist affine opens $U \subset X$, and $V \subset S$ such that $x \in U$, $f(U) \subset V$ and the induced morphism $f|_U : U \to V$ is standard smooth of relative dimension $0$. \item There exist affine opens $\Spec(A) = U \subset X$ and $\Spec(R) = V \subset S$ with $x \in U$ corresponding to $\mathfrak q \subset A$, and $f(U) \subset V$ such that there exists a presentation $$ A = R[x_1, \ldots, x_n]/(f_1, \ldots, f_n) $$ with $$ g = \det \left( \begin{matrix} \partial f_1/\partial x_1 & \partial f_2/\partial x_1 & \ldots & \partial f_n/\partial x_1 \\ \partial f_1/\partial x_2 & \partial f_2/\partial x_2 & \ldots & \partial f_n/\partial x_2 \\ \ldots & \ldots & \ldots & \ldots \\ \partial f_1/\partial x_n & \partial f_2/\partial x_n & \ldots & \partial f_n/\partial x_n \end{matrix} \right) $$ mapping to an element of $A$ not in $\mathfrak q$. \item There exist affine opens $U \subset X$, and $V \subset S$ such that $x \in U$, $f(U) \subset V$ and the induced morphism $f|_U : U \to V$ is standard \'etale. \item There exist affine opens $\Spec(A) = U \subset X$ and $\Spec(R) = V \subset S$ with $x \in U$ corresponding to $\mathfrak q \subset A$, and $f(U) \subset V$ such that there exists a presentation $$ A = R[x]_Q/(P) = R[x, 1/Q]/(P) $$ with $P, Q \in R[x]$, $P$ monic and $P' = \text{d}P/\text{d}x$ mapping to an element of $A$ not in $\mathfrak q$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-flat-unramified-etale} A morphism is \'etale at a point if and only if it is flat and G-unramified at that point. A morphism is \'etale if and only if it is flat and G-unramified. \end{lemma} 
\begin{lemma} \label{lemma-set-points-where-fibres-etale} Let $$ \xymatrix{ X' \ar[r]_{g'} \ar[d]_{f'} & X \ar[d]^f \\ S' \ar[r]^g & S } $$ be a cartesian diagram of schemes. Let $W \subset X$, resp.\ $W' \subset X'$ be the open subscheme of points where $f$, resp.\ $f'$ is \'etale. Then $W' = (g')^{-1}(W)$ if \begin{enumerate} \item $f$ is flat and locally of finite presentation, or \item $f$ is locally of finite presentation and $g$ is flat. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-etale-permanence} \begin{slogan} Cancellation law for \'etale morphisms \end{slogan} Let $f : X \to Y$ be a morphism of schemes over $S$. If $X$ and $Y$ are \'etale over $S$, then $f$ is \'etale. \end{lemma} 
\begin{lemma} \label{lemma-etale-permanence-two} Let $$ \xymatrix{ X \ar[rr]_f \ar[rd]_p & & Y \ar[dl]^q \\ & S } $$ be a commutative diagram of morphisms of schemes. Assume that \begin{enumerate} \item $f$ is surjective, and \'etale, \item $p$ is \'etale, and \item $q$ is locally of finite presentation\footnote{In fact this is implied by (1) and (2), see Descent, Lemma \ref{descent-lemma-flat-finitely-presented-permanence}. Moreover, it suffices to assume that $f$ is surjective, flat and locally of finite presentation, see Descent, Lemma \ref{descent-lemma-smooth-permanence}.}. \end{enumerate} Then $q$ is \'etale. \end{lemma} 
\begin{lemma} \label{lemma-smooth-etale-over-affine-space} \begin{slogan} Smooth schemes are \'etale-locally like affine spaces. \end{slogan} Let $\varphi : X \to Y$ be a morphism of schemes. Let $x \in X$. Let $V \subset Y$ be an affine open neighbourhood of $\varphi(x)$. If $\varphi$ is smooth at $x$, then there exists an integer $d \geq 0$ and an affine open $U \subset X$ with $x \in U$ and $\varphi(U) \subset V$ such that there exists a commutative diagram $$ \xymatrix{ X \ar[d] & U \ar[l] \ar[d] \ar[r]_-\pi & \mathbf{A}^d_V \ar[ld] \\ Y & V \ar[l] } $$ where $\pi$ is \'etale. \end{lemma} 
\begin{definition} \label{definition-relatively-ample} \begin{reference} \cite[II Definition 4.6.1]{EGA} \end{reference} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. We say $\mathcal{L}$ is {\it relatively ample}, or {\it $f$-relatively ample}, or {\it ample on $X/S$}, or {\it $f$-ample} if $f : X \to S$ is quasi-compact, and if for every affine open $V \subset S$ the restriction of $\mathcal{L}$ to the open subscheme $f^{-1}(V)$ of $X$ is ample. \end{definition} 
\begin{lemma} \label{lemma-ample-power-ample} Let $X \to S$ be a morphism of schemes. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Let $n \geq 1$. Then $\mathcal{L}$ is $f$-ample if and only if $\mathcal{L}^{\otimes n}$ is $f$-ample. \end{lemma} 
\begin{lemma} \label{lemma-relatively-ample-separated} Let $f : X \to S$ be a morphism of schemes. If there exists an $f$-ample invertible sheaf, then $f$ is separated. \end{lemma} 
\begin{lemma} \label{lemma-characterize-relatively-ample} \begin{reference} \cite[II, Proposition 4.6.3]{EGA} \end{reference} Let $f : X \to S$ be a quasi-compact morphism of schemes. Let $\mathcal{L}$ be an invertible sheaf on $X$. The following are equivalent: \begin{enumerate} \item The invertible sheaf $\mathcal{L}$ is $f$-ample. \item There exists an open covering $S = \bigcup V_i$ such that each $\mathcal{L}|_{f^{-1}(V_i)}$ is ample relative to $f^{-1}(V_i) \to V_i$. \item There exists an affine open covering $S = \bigcup V_i$ such that each $\mathcal{L}|_{f^{-1}(V_i)}$ is ample. \item There exists a quasi-coherent graded $\mathcal{O}_S$-algebra $\mathcal{A}$ and a map of graded $\mathcal{O}_X$-algebras $\psi : f^*\mathcal{A} \to \bigoplus_{d \geq 0} \mathcal{L}^{\otimes d}$ such that $U(\psi) = X$ and $$ r_{\mathcal{L}, \psi} : X \longrightarrow \underline{\text{Proj}}_S(\mathcal{A}) $$ is an open immersion (see Constructions, Lemma \ref{constructions-lemma-invertible-map-into-relative-proj} for notation). \item The morphism $f$ is quasi-separated and part (4) above holds with $\mathcal{A} = f_*(\bigoplus_{d \geq 0} \mathcal{L}^{\otimes d})$ and $\psi$ the adjunction mapping. \item Same as (4) but just requiring $r_{\mathcal{L}, \psi}$ to be an immersion. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-ample-over-affine} \begin{reference} \cite[II Corollary 4.6.6]{EGA} \end{reference} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Assume $S$ affine. Then $\mathcal{L}$ is $f$-relatively ample if and only if $\mathcal{L}$ is ample on $X$. \end{lemma} 
\begin{lemma} \label{lemma-quasi-affine-O-ample} \begin{reference} \cite[II Proposition 5.1.6]{EGA} \end{reference} Let $f : X \to S$ be a morphism of schemes. Then $f$ is quasi-affine if and only if $\mathcal{O}_X$ is $f$-relatively ample. \end{lemma} 
\begin{lemma} \label{lemma-pullback-ample-tensor-relatively-ample} Let $f : X \to Y$ be a morphism of schemes, $\mathcal{M}$ an invertible $\mathcal{O}_Y$-module, and $\mathcal{L}$ an invertible $\mathcal{O}_X$-module. \begin{enumerate} \item If $\mathcal{L}$ is $f$-ample and $\mathcal{M}$ is ample, then $\mathcal{L} \otimes f^*\mathcal{M}^{\otimes a}$ is ample for $a \gg 0$. \item If $\mathcal{M}$ is ample and $f$ quasi-affine, then $f^*\mathcal{M}$ is ample. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-ample-composition} Let $g : Y \to S$ and $f : X \to Y$ be morphisms of schemes. Let $\mathcal{M}$ be an invertible $\mathcal{O}_Y$-module. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. If $S$ is quasi-compact, $\mathcal{M}$ is $g$-ample, and $\mathcal{L}$ is $f$-ample, then $\mathcal{L} \otimes f^*\mathcal{M}^{\otimes a}$ is $g \circ f$-ample for $a \gg 0$. \end{lemma} 
\begin{lemma} \label{lemma-ample-base-change} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Let $S' \to S$ be a morphism of schemes. Let $f' : X' \to S'$ be the base change of $f$ and denote $\mathcal{L}'$ the pullback of $\mathcal{L}$ to $X'$. If $\mathcal{L}$ is $f$-ample, then $\mathcal{L}'$ is $f'$-ample. \end{lemma} 
\begin{lemma} \label{lemma-ample-permanence} Let $g : Y \to S$ and $f : X \to Y$ be morphisms of schemes. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. If $\mathcal{L}$ is $g \circ f$-ample and $f$ is quasi-compact\footnote{This follows if $g$ is quasi-separated by Schemes, Lemma \ref{schemes-lemma-quasi-compact-permanence}.} then $\mathcal{L}$ is $f$-ample. \end{lemma} 
\begin{definition} \label{definition-very-ample} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. We say $\mathcal{L}$ is {\it relatively very ample} or more precisely {\it $f$-relatively very ample}, or {\it very ample on $X/S$}, or {\it $f$-very ample} if there exist a quasi-coherent $\mathcal{O}_S$-module $\mathcal{E}$ and an immersion $i : X \to \mathbf{P}(\mathcal{E})$ over $S$ such that $\mathcal{L} \cong i^*\mathcal{O}_{\mathbf{P}(\mathcal{E})}(1)$. \end{definition} 
\begin{lemma} \label{lemma-ample-very-ample} \begin{reference} \cite[II, Proposition 4.6.2]{EGA} \end{reference} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. If $f$ is quasi-compact and $\mathcal{L}$ is a relatively very ample invertible sheaf, then $\mathcal{L}$ is a relatively ample invertible sheaf. \end{lemma} 
\begin{lemma} \label{lemma-relatively-very-ample-separated} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{L}$ be an invertible sheaf on $X$. If $\mathcal{L}$ is relatively very ample on $X/S$ then $f$ is separated. \end{lemma} 
\begin{lemma} \label{lemma-relatively-very-ample} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{L}$ be an invertible sheaf on $X$. Assume $f$ is quasi-compact. The following are equivalent \begin{enumerate} \item $\mathcal{L}$ is relatively very ample on $X/S$, \item there exists an open covering $S = \bigcup V_j$ such that $\mathcal{L}|_{f^{-1}(V_j)}$ is relatively very ample on $f^{-1}(V_j)/V_j$ for all $j$, \item there exists a quasi-coherent sheaf of graded $\mathcal{O}_S$-algebras $\mathcal{A}$ generated in degree $1$ over $\mathcal{O}_S$ and a map of graded $\mathcal{O}_X$-algebras $\psi : f^*\mathcal{A} \to \bigoplus_{n \geq 0} \mathcal{L}^{\otimes n}$ such that $f^*\mathcal{A}_1 \to \mathcal{L}$ is surjective and the associated morphism $r_{\mathcal{L}, \psi} : X \to \underline{\text{Proj}}_S(\mathcal{A})$ is an immersion, and \item $f$ is quasi-separated, the canonical map $\psi : f^*f_*\mathcal{L} \to \mathcal{L}$ is surjective, and the associated map $r_{\mathcal{L}, \psi} : X \to \mathbf{P}(f_*\mathcal{L})$ is an immersion. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-very-ample-base-change} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Let $S' \to S$ be a morphism of schemes. Let $f' : X' \to S'$ be the base change of $f$ and denote $\mathcal{L}'$ the pullback of $\mathcal{L}$ to $X'$. If $\mathcal{L}$ is $f$-very ample, then $\mathcal{L}'$ is $f'$-very ample. \end{lemma} 
\begin{lemma} \label{lemma-very-ample-finite-type-over-affine} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{L}$ be an invertible sheaf on $X$. Assume that \begin{enumerate} \item the invertible sheaf $\mathcal{L}$ is very ample on $X/S$, \item the morphism $X \to S$ is of finite type, and \item $S$ is affine. \end{enumerate} Then there exist an $n \geq 0$ and an immersion $i : X \to \mathbf{P}^n_S$ over $S$ such that $\mathcal{L} \cong i^*\mathcal{O}_{\mathbf{P}^n_S}(1)$. \end{lemma} 
\begin{lemma} \label{lemma-quasi-affine-finite-type-over-S} Let $\pi : X \to S$ be a morphism of schemes. Assume that $X$ is quasi-affine and that $\pi$ is locally of finite type. Then there exist $n \geq 0$ and an immersion $i : X \to \mathbf{A}^n_S$ over $S$. \end{lemma} 
\begin{lemma} \label{lemma-quasi-projective-finite-type-over-S} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{L}$ be an invertible sheaf on $X$. Assume that \begin{enumerate} \item the invertible sheaf $\mathcal{L}$ is ample on $X$, and \item the morphism $X \to S$ is locally of finite type. \end{enumerate} Then there exists a $d_0 \geq 1$ such that for every $d \geq d_0$ there exist an $n \geq 0$ and an immersion $i : X \to \mathbf{P}^n_S$ over $S$ such that $\mathcal{L}^{\otimes d} \cong i^*\mathcal{O}_{\mathbf{P}^n_S}(1)$. \end{lemma} 
\begin{lemma} \label{lemma-finite-type-over-affine-ample-very-ample} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Assume $S$ affine and $f$ of finite type. The following are equivalent \begin{enumerate} \item $\mathcal{L}$ is ample on $X$, \item $\mathcal{L}$ is $f$-ample, \item $\mathcal{L}^{\otimes d}$ is $f$-very ample for some $d \geq 1$, \item $\mathcal{L}^{\otimes d}$ is $f$-very ample for all $d \gg 1$, \item for some $d \geq 1$ there exist $n \geq 1$ and an immersion $i : X \to \mathbf{P}^n_S$ such that $\mathcal{L}^{\otimes d} \cong i^*\mathcal{O}_{\mathbf{P}^n_S}(1)$, and \item for all $d \gg 1$ there exist $n \geq 1$ and an immersion $i : X \to \mathbf{P}^n_S$ such that $\mathcal{L}^{\otimes d} \cong i^*\mathcal{O}_{\mathbf{P}^n_S}(1)$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-finite-type-ample-very-ample} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Assume $S$ quasi-compact and $f$ of finite type. The following are equivalent \begin{enumerate} \item $\mathcal{L}$ is $f$-ample, \item $\mathcal{L}^{\otimes d}$ is $f$-very ample for some $d \geq 1$, \item $\mathcal{L}^{\otimes d}$ is $f$-very ample for all $d \gg 1$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-characterize-very-ample-on-finite-type} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{L}$ be an invertible sheaf on $X$. Assume $f$ is of finite type. The following are equivalent: \begin{enumerate} \item $\mathcal{L}$ is $f$-relatively very ample, and \item there exist an open covering $S = \bigcup V_j$, for each $j$ an integer $n_j$, and immersions $$ i_j : X_j = f^{-1}(V_j) = V_j \times_S X \longrightarrow \mathbf{P}^{n_j}_{V_j} $$ over $V_j$ such that $\mathcal{L}|_{X_j} \cong i_j^*\mathcal{O}_{\mathbf{P}^{n_j}_{V_j}}(1)$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-characterize-ample-on-finite-type} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{L}$ be an invertible sheaf on $X$. Assume $f$ is of finite type. The following are equivalent: \begin{enumerate} \item $\mathcal{L}$ is $f$-relatively ample, and \item there exist an open covering $S = \bigcup V_j$, for each $j$ an integers $d_j \geq 1$, $n_j \geq 0$, and immersions $$ i_j : X_j = f^{-1}(V_j) = V_j \times_S X \longrightarrow \mathbf{P}^{n_j}_{V_j} $$ over $V_j$ such that $\mathcal{L}^{\otimes d_j}|_{X_j} \cong i_j^*\mathcal{O}_{\mathbf{P}^{n_j}_{V_j}}(1)$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-invertible-add-enough-ample-very-ample} Let $f : X \to S$ be a morphism of schemes. Let $\mathcal{N}$, $\mathcal{L}$ be invertible $\mathcal{O}_X$-modules. Assume $S$ is quasi-compact, $f$ is of finite type, and $\mathcal{L}$ is $f$-ample. Then $\mathcal{N} \otimes_{\mathcal{O}_X} \mathcal{L}^{\otimes d}$ is $f$-very ample for all $d \gg 1$. \end{lemma} 
\begin{definition} \label{definition-quasi-projective} \begin{reference} \cite[II, Definition 5.3.1]{EGA} and \cite[page 103]{H} \end{reference} Let $f : X \to S$ be a morphism of schemes. \begin{enumerate} \item We say $f$ is {\it quasi-projective} if $f$ is of finite type and there exists an $f$-relatively ample invertible $\mathcal{O}_X$-module. \item We say $f$ is {\it H-quasi-projective} if there exists a quasi-compact immersion $X \to \mathbf{P}^n_S$ over $S$ for some $n$.\footnote{This is not exactly the same as the definition in Hartshorne. Namely, the definition in Hartshorne (8th corrected printing, 1997) is that $f$ should be the composition of an open immersion followed by a H-projective morphism (see Definition \ref{definition-projective}), which does not imply $f$ is quasi-compact. See Lemma \ref{lemma-H-quasi-projective-open-H-projective} for the implication in the other direction.} \item We say $f$ is {\it locally quasi-projective} if there exists an open covering $S = \bigcup V_j$ such that each $f^{-1}(V_j) \to V_j$ is quasi-projective. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-base-change-quasi-projective} A base change of a quasi-projective morphism is quasi-projective. \end{lemma} 
\begin{lemma} \label{lemma-composition-quasi-projective} Let $f : X \to Y$ and $g : Y \to S$ be morphisms of schemes. If $S$ is quasi-compact and $f$ and $g$ are quasi-projective, then $g \circ f$ is quasi-projective. \end{lemma} 
\begin{lemma} \label{lemma-quasi-projective-properties} Let $f : X \to S$ be a morphism of schemes. If $f$ is quasi-projective, or H-quasi-projective or locally quasi-projective, then $f$ is separated of finite type. \end{lemma} 
\begin{lemma} \label{lemma-H-quasi-projective-quasi-projective} A H-quasi-projective morphism is quasi-projective. \end{lemma} 
\begin{lemma} \label{lemma-characterize-locally-quasi-projective} Let $f : X \to S$ be a morphism of schemes. The following are equivalent: \begin{enumerate} \item The morphism $f$ is locally quasi-projective. \item There exists an open covering $S = \bigcup V_j$ such that each $f^{-1}(V_j) \to V_j$ is H-quasi-projective. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-quasi-affine-finite-type-quasi-projective} \begin{reference} \cite[II, Proposition 5.3.4 (i)]{EGA} \end{reference} A quasi-affine morphism of finite type is quasi-projective. \end{lemma} 
\begin{lemma} \label{lemma-quasi-projective-permanence} Let $g : Y \to S$ and $f : X \to Y$ be morphisms of schemes. If $g \circ f$ is quasi-projective and $f$ is quasi-compact\footnote{This follows if $g$ is quasi-separated by Schemes, Lemma \ref{schemes-lemma-quasi-compact-permanence}.}, then $f$ is quasi-projective. \end{lemma} 
\begin{definition} \label{definition-proper} Let $f : X \to S$ be a morphism of schemes. We say $f$ is {\it proper} if $f$ is separated, finite type, and universally closed. \end{definition} 
\begin{lemma} \label{lemma-universally-closed-local-on-the-base} Let $f : X \to S$ be a morphism of schemes. The following are equivalent: \begin{enumerate} \item The morphism $f$ is universally closed. \item There exists an open covering $S = \bigcup V_j$ such that $f^{-1}(V_j) \to V_j$ is universally closed for all indices $j$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-proper-local-on-the-base} Let $f : X \to S$ be a morphism of schemes. The following are equivalent: \begin{enumerate} \item The morphism $f$ is proper. \item There exists an open covering $S = \bigcup V_j$ such that $f^{-1}(V_j) \to V_j$ is proper for all indices $j$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-composition-proper} The composition of proper morphisms is proper. The same is true for universally closed morphisms. \end{lemma} 
\begin{lemma} \label{lemma-base-change-proper} The base change of a proper morphism is proper. The same is true for universally closed morphisms. \end{lemma} 
\begin{lemma} \label{lemma-closed-immersion-proper} A closed immersion is proper, hence a fortiori universally closed. \end{lemma} 
\begin{lemma} \label{lemma-image-proper-scheme-closed} Suppose given a commutative diagram of schemes $$ \xymatrix{ X \ar[rr] \ar[rd] & & Y \ar[ld] \\ & S & } $$ with $Y$ separated over $S$. \begin{enumerate} \item If $X \to S$ is universally closed, then the morphism $X \to Y$ is universally closed. \item If $X$ is proper over $S$, then the morphism $X \to Y$ is proper. \end{enumerate} In particular, in both cases the image of $X$ in $Y$ is closed. \end{lemma} 
\begin{lemma} \label{lemma-universally-closed-quasi-compact} \begin{reference} Due to Bjorn Poonen. \end{reference} A universally closed morphism of schemes is quasi-compact. \end{lemma} 
\begin{lemma} \label{lemma-image-proper-is-proper} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of schemes over $S$. If $X$ is universally closed over $S$ and $f$ is surjective then $Y$ is universally closed over $S$. In particular, if also $Y$ is separated and locally of finite type over $S$, then $Y$ is proper over $S$. \end{lemma} 
\begin{lemma} \label{lemma-scheme-theoretic-image-is-proper} Suppose given a commutative diagram of schemes $$ \xymatrix{ X \ar[rr]_h \ar[rd]_f & & Y \ar[ld]^g \\ & S } $$ Assume \begin{enumerate} \item $X \to S$ is a universally closed (for example proper) morphism, and \item $Y \to S$ is separated and locally of finite type. \end{enumerate} Then the scheme theoretic image $Z \subset Y$ of $h$ is proper over $S$ and $X \to Z$ is surjective. \end{lemma} 
\begin{lemma} \label{lemma-image-universally-closed-separated} Let $S$ be a scheme. Let $f : X \to Y$ be a surjective universally closed morphism of schemes over $S$. \begin{enumerate} \item If $X$ is quasi-separated, then $Y$ is quasi-separated. \item If $X$ is separated, then $Y$ is separated. \item If $X$ is quasi-separated over $S$, then $Y$ is quasi-separated over $S$. \item If $X$ is separated over $S$, then $Y$ is separated over $S$. \end{enumerate} \end{lemma} 
\begin{lemma}[Valuative criterion for properness] \label{lemma-characterize-proper} \begin{reference} \cite[II Theorem 7.3.8]{EGA} \end{reference} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of schemes over $S$. Assume $f$ is of finite type and quasi-separated. Then the following are equivalent \begin{enumerate} \item $f$ is proper, \item $f$ satisfies the valuative criterion (Schemes, Definition \ref{schemes-definition-valuative-criterion}), \item given any commutative solid diagram $$ \xymatrix{ \Spec(K) \ar[r] \ar[d] & X \ar[d] \\ \Spec(A) \ar[r] \ar@{-->}[ru] & Y } $$ where $A$ is a valuation ring with field of fractions $K$, there exists a unique dotted arrow making the diagram commute. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-refined-valuative-criterion-universally-closed} Let $f : X \to S$ and $h : U \to X$ be morphisms of schemes. Assume that $f$ and $h$ are quasi-compact and that $h(U)$ is dense in $X$. If given any commutative solid diagram $$ \xymatrix{ \Spec(K) \ar[r] \ar[d] & U \ar[r]^h & X \ar[d]^f \\ \Spec(A) \ar[rr] \ar@{-->}[rru] & & S } $$ where $A$ is a valuation ring with field of fractions $K$, there exists a unique dotted arrow making the diagram commute, then $f$ is universally closed. If moreover $f$ is quasi-separated, then $f$ is separated. \end{lemma} 
\begin{lemma} \label{lemma-morphism-defined-local-ring} Let $S$ be a scheme. Let $X$, $Y$ be schemes over $S$. Let $s \in S$ and $x \in X$, $y \in Y$ points over $s$. \begin{enumerate} \item Let $f, g : X \to Y$ be morphisms over $S$ such that $f(x) = g(x) = y$ and $f^\sharp_x = g^\sharp_x : \mathcal{O}_{Y, y} \to \mathcal{O}_{X, x}$. Then there is an open neighbourhood $U \subset X$ with $f|_U = g|_U$ in the following cases \begin{enumerate} \item $Y$ is locally of finite type over $S$, \item $X$ is integral, \item $X$ is locally Noetherian, or \item $X$ is reduced with finitely many irreducible components. \end{enumerate} \item Let $\varphi : \mathcal{O}_{Y, y} \to \mathcal{O}_{X, x}$ be a local $\mathcal{O}_{S, s}$-algebra map. Then there exists an open neighbourhood $U \subset X$ of $x$ and a morphism $f : U \to Y$ mapping $x$ to $y$ with $f^\sharp_x = \varphi$ in the following cases \begin{enumerate} \item $Y$ is locally of finite presentation over $S$, \item $Y$ is locally of finite type and $X$ is integral, \item $Y$ is locally of finite type and $X$ is locally Noetherian, or \item $Y$ is locally of finite type and $X$ is reduced with finitely many irreducible components. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-extend-across} Let $S$ be a scheme. Let $X$, $Y$ be schemes over $S$. Let $x \in X$. Let $U \subset X$ be an open and let $f : U \to Y$ be a morphism over $S$. Assume \begin{enumerate} \item $x$ is in the closure of $U$, \item $X$ is reduced with finitely many irreducible components or $X$ is Noetherian, \item $\mathcal{O}_{X, x}$ is a valuation ring, \item $Y \to S$ is proper \end{enumerate} Then there exists an open $U \subset U' \subset X$ containing $x$ and an $S$-morphism $f' : U' \to Y$ extending $f$. \end{lemma} 
\begin{definition} \label{definition-projective} Let $f : X \to S$ be a morphism of schemes. \begin{enumerate} \item We say $f$ is {\it projective} if $X$ is isomorphic as an $S$-scheme to a closed subscheme of a projective bundle $\mathbf{P}(\mathcal{E})$ for some quasi-coherent, finite type $\mathcal{O}_S$-module $\mathcal{E}$. \item We say $f$ is {\it H-projective} if there exists an integer $n$ and a closed immersion $X \to \mathbf{P}^n_S$ over $S$. \item We say $f$ is {\it locally projective} if there exists an open covering $S = \bigcup U_i$ such that each $f^{-1}(U_i) \to U_i$ is projective. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-H-projective} An H-projective morphism is H-quasi-projective. An H-projective morphism is projective. \end{lemma} 
\begin{lemma} \label{lemma-characterize-locally-projective} Let $f : X \to S$ be a morphism of schemes. The following are equivalent: \begin{enumerate} \item The morphism $f$ is locally projective. \item There exists an open covering $S = \bigcup U_i$ such that each $f^{-1}(U_i) \to U_i$ is H-projective. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-locally-projective-proper} A locally projective morphism is proper. \end{lemma} 
\begin{lemma} \label{lemma-proper-ample-locally-projective} Let $f : X \to S$ be a proper morphism of schemes. If there exists an $f$-ample invertible sheaf on $X$, then $f$ is locally projective. \end{lemma} 
\begin{lemma} \label{lemma-H-projective-composition} A composition of H-projective morphisms is H-projective. \end{lemma} 
\begin{lemma} \label{lemma-H-projective-base-change} A base change of a H-projective morphism is H-projective. \end{lemma} 
\begin{lemma} \label{lemma-base-change-projective} A base change of a (locally) projective morphism is (locally) projective. \end{lemma} 
\begin{lemma} \label{lemma-projective-quasi-projective} A projective morphism is quasi-projective. \end{lemma} 
\begin{lemma} \label{lemma-H-quasi-projective-open-H-projective} Let $f : X \to S$ be a H-quasi-projective morphism. Then $f$ factors as $X \to X' \to S$ where $X \to X'$ is an open immersion and $X' \to S$ is H-projective. \end{lemma} 
\begin{lemma} \label{lemma-quasi-projective-open-projective} Let $f : X \to S$ be a quasi-projective morphism with $S$ quasi-compact and quasi-separated. Then $f$ factors as $X \to X' \to S$ where $X \to X'$ is an open immersion and $X' \to S$ is projective. \end{lemma} 
\begin{lemma} \label{lemma-projective-is-quasi-projective-proper} Let $S$ be a quasi-compact and quasi-separated scheme. Let $f : X \to S$ be a morphism of schemes. Then \begin{enumerate} \item $f$ is projective if and only if $f$ is quasi-projective and proper, and \item $f$ is H-projective if and only if $f$ is H-quasi-projective and proper. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-composition-projective} Let $f : X \to Y$ and $g : Y \to S$ be morphisms of schemes. If $S$ is quasi-compact and quasi-separated and $f$ and $g$ are projective, then $g \circ f$ is projective. \end{lemma} 
\begin{lemma} \label{lemma-projective-permanence} Let $g : Y \to S$ and $f : X \to Y$ be morphisms of schemes. If $g \circ f$ is projective and $g$ is separated, then $f$ is projective. \end{lemma} 
\begin{lemma} \label{lemma-projective-over-quasi-projective-is-H-projective} Let $S$ be a scheme which admits an ample invertible sheaf. Then \begin{enumerate} \item any projective morphism $X \to S$ is H-projective, and \item any quasi-projective morphism $X \to S$ is H-quasi-projective. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-proper-ample-is-proj} Let $f : X \to S$ be a universally closed morphism. Let $\mathcal{L}$ be an $f$-ample invertible $\mathcal{O}_X$-module. Then the canonical morphism $$ r : X \longrightarrow \underline{\text{Proj}}_S \left( \bigoplus\nolimits_{d \geq 0} f_*\mathcal{L}^{\otimes d} \right) $$ of Lemma \ref{lemma-characterize-relatively-ample} is an isomorphism. \end{lemma} 
\begin{lemma} \label{lemma-proper-ample-delete-affine} Let $f : X \to S$ be a universally closed morphism. Let $\mathcal{L}$ be an $f$-ample invertible $\mathcal{O}_X$-module. Let $s \in \Gamma(X, \mathcal{L})$. Then $X_s \to S$ is an affine morphism. \end{lemma} 
\begin{definition} \label{definition-integral} Let $f : X \to S$ be a morphism of schemes. \begin{enumerate} \item We say that $f$ is {\it integral} if $f$ is affine and if for every affine open $\Spec(R) = V \subset S$ with inverse image $\Spec(A) = f^{-1}(V) \subset X$ the associated ring map $R \to A$ is integral. \item We say that $f$ is {\it finite} if $f$ is affine and if for every affine open $\Spec(R) = V \subset S$ with inverse image $\Spec(A) = f^{-1}(V) \subset X$ the associated ring map $R \to A$ is finite. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-integral-local} Let $f : X \to S$ be a morphism of schemes. The following are equivalent: \begin{enumerate} \item The morphism $f$ is integral. \item There exists an affine open covering $S = \bigcup U_i$ such that each $f^{-1}(U_i)$ is affine and $\mathcal{O}_S(U_i) \to \mathcal{O}_X(f^{-1}(U_i))$ is integral. \item There exists an open covering $S = \bigcup U_i$ such that each $f^{-1}(U_i) \to U_i$ is integral. \end{enumerate} Moreover, if $f$ is integral then for every open subscheme $U \subset S$ the morphism $f : f^{-1}(U) \to U$ is integral. \end{lemma} 
\begin{lemma} \label{lemma-finite-local} Let $f : X \to S$ be a morphism of schemes. The following are equivalent: \begin{enumerate} \item The morphism $f$ is finite. \item There exists an affine open covering $S = \bigcup U_i$ such that each $f^{-1}(U_i)$ is affine and $\mathcal{O}_S(U_i) \to \mathcal{O}_X(f^{-1}(U_i))$ is finite. \item There exists an open covering $S = \bigcup U_i$ such that each $f^{-1}(U_i) \to U_i$ is finite. \end{enumerate} Moreover, if $f$ is finite then for every open subscheme $U \subset S$ the morphism $f : f^{-1}(U) \to U$ is finite. \end{lemma} 
\begin{lemma} \label{lemma-finite-integral} A finite morphism is integral. An integral morphism which is locally of finite type is finite. \end{lemma} 
\begin{lemma} \label{lemma-composition-finite} A composition of finite morphisms is finite. Same is true for integral morphisms. \end{lemma} 
\begin{lemma} \label{lemma-base-change-finite} A base change of a finite morphism is finite. Same is true for integral morphisms. \end{lemma} 
\begin{lemma} \label{lemma-integral-universally-closed} \begin{slogan} integral $=$ affine $+$ universally closed \end{slogan} Let $f : X \to S$ be a morphism of schemes. The following are equivalent \begin{enumerate} \item $f$ is integral, and \item $f$ is affine and universally closed. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-integral-fibres} Let $f : X \to S$ be an integral morphism. Then every point of $X$ is closed in its fibre. \end{lemma} 
\begin{lemma} \label{lemma-integral-dimension} Let $f : X \to Y$ be an integral morphism. Then $\dim(X) \leq \dim(Y)$. If $f$ is surjective then $\dim(X) = \dim(Y)$. \end{lemma} 
\begin{lemma} \label{lemma-finite-quasi-finite} A finite morphism is quasi-finite. \end{lemma} 
\begin{lemma} \label{lemma-finite-proper} Let $f : X \to S$ be a morphism of schemes. The following are equivalent \begin{enumerate} \item $f$ is finite, and \item $f$ is affine and proper. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-closed-immersion-finite} A closed immersion is finite (and a fortiori integral). \end{lemma} 
\begin{lemma} \label{lemma-finite-union-finite} Let $X_i \to Y$, $i = 1, \ldots, n$ be finite morphisms of schemes. Then $X_1 \amalg \ldots \amalg X_n \to Y$ is finite too. \end{lemma} 
\begin{lemma} \label{lemma-finite-permanence} Let $f : X \to Y$ and $g : Y \to Z$ be morphisms. \begin{enumerate} \item If $g \circ f$ is finite and $g$ separated then $f$ is finite. \item If $g \circ f$ is integral and $g$ separated then $f$ is integral. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-finite-monomorphism-closed} Let $f : X \to Y$ be a morphism of schemes. If $f$ is finite and a monomorphism, then $f$ is a closed immersion. \end{lemma} 
\begin{lemma} \label{lemma-finite-projective} A finite morphism is projective. \end{lemma} 
\begin{definition} \label{definition-universal-homeomorphism} A morphism $f : X \to Y$ of schemes is called a {\it universal homeomorphism} if the base change $f' : Y' \times_Y X \to Y'$ is a homeomorphism for every morphism $Y' \to Y$. \end{definition} 
\begin{lemma} \label{lemma-base-change-universal-homeomorphism} The base change of a universal homeomorphism of schemes by any morphism of schemes is a universal homeomorphism. \end{lemma} 
\begin{lemma} \label{lemma-composition-universal-homeomorphism} The composition of a pair of universal homeomorphisms of schemes is a universal homeomorphism. \end{lemma} 
\begin{lemma} \label{lemma-homeomorphism-affine} Let $f : X \to Y$ be a morphism of schemes. If $f$ is a homeomorphism onto a closed subset of $Y$ then $f$ is affine. \end{lemma} 
\begin{lemma} \label{lemma-universal-homeomorphism} Let $f : X \to Y$ be a morphism of schemes. The following are equivalent: \begin{enumerate} \item $f$ is a universal homeomorphism, and \item $f$ is integral, universally injective and surjective. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-reduction-universal-homeomorphism} Let $X$ be a scheme. The canonical closed immersion $X_{red} \to X$ (see Schemes, Definition \ref{schemes-definition-reduced-induced-scheme}) is a universal homeomorphism. \end{lemma} 
\begin{lemma} \label{lemma-check-closed-infinitesimally} Let $f : X \to S$ and $S' \to S$ be morphisms of schemes. Assume \begin{enumerate} \item $S' \to S$ is a closed immersion, \item $S' \to S$ is bijective on points, \item $X \times_S S' \to S'$ is a closed immersion, and \item $X \to S$ is of finite type or $S' \to S$ is of finite presentation. \end{enumerate} Then $f : X \to S$ is a closed immersion. \end{lemma} 
\begin{lemma} \label{lemma-permanence-universal-homeomorphism} Let $f : X \to Z$ be the composition of two morphisms  $g : X \to Y$ and $h : Y \to Z$. If two of the morphisms $\{f, g, h\}$ are universal homeomorphisms, so is the third morphism. \end{lemma} 
\begin{lemma} \label{lemma-subalgebra-inherits} Let $A \to B$ be a ring map such that the induced morphism of schemes $f : \Spec(B) \to \Spec(A)$ is a universal homeomorphism, resp.\ a universal homeomorphism inducing isomorphisms on residue fields, resp.\ universally closed, resp.\ universally closed and universally injective. Then for any $A$-subalgebra $B' \subset B$ the same thing is true for $f' : \Spec(B') \to \Spec(A)$. \end{lemma} 
\begin{lemma} \label{lemma-colimit-inherits} Let $A$ be a ring. Let $B = \colim B_\lambda$ be a filtered colimit of $A$-algebras. If each $f_\lambda : \Spec(B_\lambda) \to \Spec(A)$ is a universal homeomorphism, resp.\ a universal homeomorphism inducing isomorphisms on residue fields, resp.\ universally closed, resp.\ universally closed and universally injective, then the same thing is true for $f : \Spec(B) \to \Spec(A)$. \end{lemma} 
\begin{lemma} \label{lemma-special-elements-and-localization} Let $A \subset B$ be a ring extension. Let $S \subset A$ be a multiplicative subset. Let $n \geq 1$ and $b_i \in B$ for $1 \leq i \leq n$. Any $x \in S^{-1}B$ such that $$ x \not \in S^{-1}A\text{ and } b_i x^i \in S^{-1}A\text{ for }i = 1, \ldots, n $$ is equal to $s^{-1}y$ with $s \in S$ and $y \in B$ such that $$ y \not \in A\text{ and } b_i y^i \in A\text{ for }i = 1, \ldots, n $$ \end{lemma} 
\begin{lemma} \label{lemma-nth-and-nplusone-implies-square-and-cube} Let $A \subset B$ be a ring extension. If there exists $b \in B$, $b \not \in A$ and an integer $n \geq 2$ with $b^n \in A$ and $b^{n + 1} \in A$, then there exists a $b' \in B$, $b' \not \in A$ with $(b')^2 \in A$ and $(b')^3 \in A$. \end{lemma} 
\begin{lemma} \label{lemma-square-and-cube} Let $A \subset B$ be a ring extension such that $\Spec(B) \to \Spec(A)$ is a universal homeomorphism inducing isomorphisms on residue fields. If $A \not = B$, then there exists a $b \in B$, $b \not \in A$ with $b^2 \in A$ and $b^3 \in A$. \end{lemma} 
\begin{lemma} \label{lemma-pth-power-and-multiple} Let $A \subset B$ be a ring extension such that $\Spec(B) \to \Spec(A)$ is a universal homeomorphism. If $A \not = B$, then either there exists a $b \in B$, $b \not \in A$ with $b^2 \in A$ and $b^3 \in A$ or there exists a prime number $p$ and a $b \in B$, $b \not \in A$ with $pb \in A$ and $b^p \in A$. \end{lemma} 
\begin{proposition} \label{proposition-universal-homeomorphism-equal-residue-fields} Let $A \subset B$ be a ring extension. The following are equivalent \begin{enumerate} \item $\Spec(B) \to \Spec(A)$ is a universal homeomorphism inducing isomorphisms on residue fields, and \item every finite subset $E \subset B$ is contained in an extension $$ A[b_1, \ldots, b_n] \subset B $$ such that $b_i^2, b_i^3 \in A[b_1, \ldots, b_{i - 1}]$ for $i = 1, \ldots, n$. \end{enumerate} \end{proposition} 
\begin{proposition} \label{proposition-universal-homeomorphism} Let $A \subset B$ be a ring extension. The following are equivalent \begin{enumerate} \item $\Spec(B) \to \Spec(A)$ is a universal homeomorphism, and \item every finite subset $E \subset B$ is contained in an extension $$ A[b_1, \ldots, b_n] \subset B $$ such that for $i = 1, \ldots, n$ we have \begin{enumerate} \item $b_i^2, b_i^3 \in A[b_1, \ldots, b_{i - 1}]$, or \item there exists a prime number $p$ with $pb_i, b_i^p \in A[b_1, \ldots, b_{i - 1}]$. \end{enumerate} \end{enumerate} \end{proposition} 
\begin{lemma} \label{lemma-universal-homeo-iso-if-invert-p} Let $p$ be a prime number. Let $A \to B$ be a ring map which induces an isomorphism $A[1/p] \to B[1/p]$ (for example if $p$ is nilpotent in $A$). The following are equivalent \begin{enumerate} \item $\Spec(B) \to \Spec(A)$ is a universal homeomorphism, and \item the kernel of $A \to B$ is a locally nilpotent ideal and for every $b \in B$ there exists a $p$-power $q$ with $qb$ and $b^q$ in the image of $A \to B$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-make-universal-homeo} Let $A$ be a ring. Let $x, y \in A$. \begin{enumerate} \item If $x^3 = y^2$ in $A$, then $A \to B = A[t]/(t^2 - x, t^3 - y)$ induces bijections on residue fields and a universal homeomorphism on spectra. \item If there is a prime number $p$ such that $p^px = y^p$ in $A$, then $A \to B = A[t]/(t^p - x, pt - y)$ induces a universal homeomorphism on spectra. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-universal-homeo-limit} Let $A \to B$ be a ring map. \begin{enumerate} \item If $A \to B$ induces a universal homeomorphism on spectra, then $B = \colim B_i$ is a filtered colimit of finitely presented $A$-algebras $B_i$ such that $A \to B_i$ induces a universal homeomorphism on spectra. \item If $A \to B$ induces isomorphisms on residue fields and a universal homeomorphism on spectra, then $B = \colim B_i$ is a filtered colimit of finitely presented $A$-algebras $B_i$ such that $A \to B_i$ induces isomorphisms on residue fields and a universal homeomorphism on spectra. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-seminormal-ring} Let $A$ be a ring. \begin{enumerate} \item We say $A$ is {\it seminormal} if for all $x, y \in A$ with $x^3 = y^2$ there is a unique $a \in A$ with $x = a^2$ and $y = a^3$. \item We say $A$ is {\it absolutely weakly normal} if (a) $A$ is seminormal and (b) for any prime number $p$ and $x, y \in A$ with $p^px = y^p$ there is a unique $a \in A$ with $x = a^p$ and $y = pa$. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-seminormal-local-property} Being seminormal or being absolutely weakly normal is a local property of rings, see Properties, Definition \ref{properties-definition-property-local}. \end{lemma} 
\begin{definition} \label{definition-seminormal} Let $X$ be a scheme. \begin{enumerate} \item We say $X$ is {\it seminormal} if every $x \in X$ has an affine open neighbourhood $\Spec(R) = U \subset X$ such that the ring $R$ is seminormal. \item We say $X$ is {\it absolutely weakly normal} if every $x \in X$ has an affine open neighbourhood $\Spec(R) = U \subset X$ such that the ring $R$ is absolutely weakly normal. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-locally-seminormal} Let $X$ be a scheme. The following are equivalent: \begin{enumerate} \item The scheme $X$ is seminormal. \item For every affine open $U \subset X$ the ring $\mathcal{O}_X(U)$ is seminormal. \item There exists an affine open covering $X = \bigcup U_i$ such that each $\mathcal{O}_X(U_i)$ is seminormal. \item There exists an open covering $X = \bigcup X_j$ such that each open subscheme $X_j$ is seminormal. \end{enumerate} Moreover, if $X$ is seminormal then every open subscheme is seminormal. The same statements are true with ``seminormal'' replaced by ``absolutely weakly normal''. \end{lemma} 
\begin{lemma} \label{lemma-seminormal-reduced} A seminormal scheme or ring is reduced. A fortiori the same is true for absolutely weakly normal schemes or rings. \end{lemma} 
\begin{lemma} \label{lemma-seminormalization-ring} Let $A$ be a ring. \begin{enumerate} \item The category of ring maps $A \to B$ inducing a universal homeomorphism on spectra has a final object $A \to A^{awn}$. \item Given $A \to B$ in the category of (1) the resulting map $B \to A^{awn}$ is an isomorphism if and only if $B$ is absolutely weakly normal. \item The category of ring maps $A \to B$ inducing isomorphisms on residue fields and a universal homeomorphism on spectra has a final object $A \to A^{sn}$. \item Given $A \to B$ in the category of (3) the resulting map $B \to A^{sn}$ is an isomorphism if and only if $B$ is seminormal. \end{enumerate} For any ring map $\varphi : A \to A'$ there are unique maps $\varphi^{awn} : A^{awn} \to (A')^{awn}$ and $\varphi^{sn} : A^{sn} \to (A')^{sn}$ compatible with $\varphi$. \end{lemma} 
\begin{lemma} \label{lemma-seminormalization} Let $X$ be a scheme. \begin{enumerate} \item The category of universal homeomorphisms $Y \to X$ has an initial object $X^{awn} \to X$. \item Given $Y \to X$ in the category of (1) the resulting morphism $X^{awn} \to Y$ is an isomorphism if and only if $Y$ is absolutely weakly normal. \item The category of universal homeomorphisms $Y \to X$ which induce ismomorphisms on residue fields has an initial object $X^{sn} \to X$. \item Given $Y \to X$ in the category of (3) the resulting morphism $X^{sn} \to Y$ is an isomorphism if and only if $Y$ is seminormal. \end{enumerate} For any morphism $h : X' \to X$ of schemes there are unique morphisms $h^{awn} : (X')^{awn} \to X^{awn}$ and $h^{sn} : (X')^{sn} \to X^{sn}$ compatible with $h$. \end{lemma} 
\begin{definition} \label{definition-seminormalization} Let $X$ be a scheme. \begin{enumerate} \item The morphism $X^{sn} \to X$ constructed in Lemma \ref{lemma-seminormalization} is the {\it seminormalization} of $X$. \item The morphism $X^{awn} \to X$ constructed in Lemma \ref{lemma-seminormalization} is the {\it absolute weak normalization} of $X$. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-characterize-seminormal} Let $X$ be a scheme. The following are equivalent \begin{enumerate} \item $X$ is seminormal, \item $X$ is equal to its own seminormalization, i.e., the morphism $X^{sn} \to X$ is an isomorphism, \item if $\pi : Y \to X$ is a universal homeomorphism inducing isomorphisms on residue fields with $Y$ reduced, then $\pi$ is an isomorphism. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-characterize-absolutely-weakly-normal} Let $X$ be a scheme. The following are equivalent \begin{enumerate} \item $X$ is absolutely weakly normal, \item $X$ is equal to its own absolute weak normalization, i.e., the morphism $X^{awn} \to X$ is an isomorphism, \item if $\pi : Y \to X$ is a universal homeomorphism with $Y$ reduced, then $\pi$ is an isomorphism. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-finite-locally-free} Let $f : X \to S$ be a morphism of schemes. We say $f$ is {\it finite locally free} if $f$ is affine and $f_*\mathcal{O}_X$ is a finite locally free $\mathcal{O}_S$-module. In this case we say $f$ is has {\it rank} or {\it degree} $d$ if the sheaf $f_*\mathcal{O}_X$ is finite locally free of degree $d$. \end{definition} 
\begin{lemma} \label{lemma-finite-flat} Let $f : X \to S$ be a morphism of schemes. The following are equivalent: \begin{enumerate} \item $f$ is finite locally free, \item $f$ is finite, flat, and locally of finite presentation. \end{enumerate} If $S$ is locally Noetherian these are also equivalent to \begin{enumerate} \item[(3)] $f$ is finite and flat. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-composition-finite-locally-free} A composition of finite locally free morphisms is finite locally free. \end{lemma} 
\begin{lemma} \label{lemma-base-change-finite-locally-free} A base change of a finite locally free morphism is finite locally free. \end{lemma} 
\begin{lemma} \label{lemma-finite-locally-free} Let $f : X \to S$ be a finite locally free morphism of schemes. There exists a disjoint union decomposition $S = \coprod_{d \geq 0} S_d$ by open and closed subschemes such that setting $X_d = f^{-1}(S_d)$ the restrictions $f|_{X_d}$ are finite locally free morphisms $X_d \to S_d$ of degree $d$. \end{lemma} 
\begin{lemma} \label{lemma-massage-finite} Let $f : Y \to X$ be a finite morphism with $X$ affine. There exists a diagram $$ \xymatrix{ Z' \ar[rd] & Y' \ar[l]^i \ar[d] \ar[r] & Y \ar[d] \\  & X' \ar[r] & X } $$ where \begin{enumerate} \item $Y' \to Y$ and $X' \to X$ are surjective finite locally free, \item $Y' = X' \times_X Y$, \item $i : Y' \to Z'$ is a closed immersion, \item $Z' \to X'$ is finite locally free, and \item $Z' = \bigcup_{j = 1, \ldots, m} Z'_j$ is a (set theoretic) finite union of closed subschemes, each of which maps isomorphically to $X'$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-image-nowhere-dense-finite} Let $f : Y \to X$ be a finite morphism of schemes. Let $T \subset Y$ be a closed nowhere dense subset of $Y$. Then $f(T) \subset X$ is a closed nowhere dense subset of $X$. \end{lemma} 
\begin{definition} \label{definition-rational-map} Let $X$, $Y$ be schemes. \begin{enumerate} \item Let $f : U \to Y$, $g : V \to Y$ be morphisms of schemes defined on dense open subsets $U$, $V$ of $X$. We say that $f$ is {\it equivalent} to $g$ if $f|_W = g|_W$ for some $W \subset U \cap V$ dense open in $X$. \item A {\it rational map from $X$ to $Y$} is an equivalence class for the equivalence relation defined in (1). \item If $X$, $Y$ are schemes over a base scheme $S$ we say that a rational map from $X$ to $Y$ is an {\it $S$-rational map from $X$ to $Y$} if there exists a representative $f : U \to Y$ of the equivalence class which is an $S$-morphism. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-rational-map-finite-presentation} Let $S$ be a scheme. Let $X$ and $Y$ be schemes over $S$. Assume $X$ has finitely many irreducible components with generic points $x_1, \ldots, x_n$. Let $s_i \in S$ be the image of $x_i$. Consider the map $$ \left\{ \begin{matrix} S\text{-rational maps} \\ \text{from }X\text{ to }Y \end{matrix} \right\} \longrightarrow \left\{ \begin{matrix} (y_1, \varphi_1, \ldots, y_n, \varphi_n)\text{ where } y_i \in Y\text{ lies over }s_i\text{ and}\\ \varphi_i : \mathcal{O}_{Y, y_i} \to \mathcal{O}_{X, x_i} \text{ is a local }\mathcal{O}_{S, s_i}\text{-algebra map} \end{matrix} \right\} $$ which sends $f : U \to Y$ to the $2n$-tuple with $y_i = f(x_i)$ and $\varphi_i = f^\sharp_{x_i}$. Then \begin{enumerate} \item If $Y \to S$ is locally of finite type, then the map is injective. \item If $Y \to S$ is locally of finite presentation, then the map is bijective. \item If $Y \to S$ is locally of finite type and $X$ reduced, then the map is bijective. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-rational-function} Let $X$ be a scheme. A {\it rational function on $X$} is a rational map from $X$ to $\mathbf{A}^1_{\mathbf{Z}}$. \end{definition} 
\begin{definition} \label{definition-ring-of-rational-functions} Let $X$ be a scheme. The {\it ring of rational functions on $X$} is the ring $R(X)$ whose elements are rational functions with addition and multiplication as just described. \end{definition} 
\begin{lemma} \label{lemma-integral-scheme-rational-functions} Let $X$ be a scheme with finitely many irreducible components $X_1, \ldots, X_n$. If $\eta_i \in X_i$ is the generic point, then $$ R(X) = \mathcal{O}_{X, \eta_1} \times \ldots \times \mathcal{O}_{X, \eta_n} $$ If $X$ is reduced this is equal to $\prod \kappa(\eta_i)$. If $X$ is integral then $R(X) = \mathcal{O}_{X, \eta} = \kappa(\eta)$ is a field. \end{lemma} 
\begin{definition} \label{definition-function-field} Let $X$ be an integral scheme. The {\it function field}, or the {\it field of rational functions} of $X$ is the field $R(X)$. \end{definition} 
\begin{lemma} \label{lemma-distinct-local-rings} Let $X$ be an integral separated scheme. Let $Z_1$, $Z_2$ be distinct irreducible closed subsets of $X$. Let $\eta_i$ be the generic point of $Z_i$. If $Z_1 \not\subset Z_2$, then $\mathcal{O}_{X, \eta_1} \not \subset \mathcal{O}_{X, \eta_2}$ as subrings of $R(X)$. In particular, if $Z_1 = \{x\}$ consists of one closed point $x$, there exists a function regular in a neighborhood of $x$ which is not in $\mathcal{O}_{X, \eta_{2}}$. \end{lemma} 
\begin{definition} \label{definition-domain-of-definition} Let $\varphi$ be a rational map between two schemes $X$ and $Y$. We say $\varphi$ is {\it defined in a point $x \in X$} if there exists a representative $(U, f)$ of $\varphi$ with $x \in U$. The {\it domain of definition} of $\varphi$ is the set of all points where $\varphi$ is defined. \end{definition} 
\begin{lemma} \label{lemma-rational-map-from-reduced-to-separated} Let $X$ and $Y$ be schemes. Assume $X$ reduced and $Y$ separated. Let $\varphi$ be a rational map from $X$ to $Y$ with domain of definition $U \subset X$. Then there exists a unique morphism $f : U \to Y$ representing $\varphi$. If $X$ and $Y$ are schemes over a separated scheme $S$ and if $\varphi$ is an $S$-rational map, then $f$ is a morphism over $S$. \end{lemma} 
\begin{definition} \label{definition-dominant-rational} Let $X$ and $Y$ be irreducible schemes. A rational map from $X$ to $Y$ is called {\it dominant} if any representative $f : U \to Y$ is a dominant morphism of schemes. \end{definition} 
\begin{definition} \label{definition-birational-schemes} Let $X$ and $Y$ be irreducible schemes. \begin{enumerate} \item We say $X$ and $Y$ are {\it birational} if $X$ and $Y$ are isomorphic in the category of irreducible schemes and dominant rational maps. \item Assume $X$ and $Y$ are schemes over a base scheme $S$. We say $X$ and $Y$ are {\it $S$-birational} if $X$ and $Y$ are isomorphic in the category of irreducible schemes over $S$ and dominant $S$-rational maps. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-birational-integral} Let $X$ and $Y$ be irreducible schemes. \begin{enumerate} \item The schemes $X$ and $Y$ are birational if and only if they have isomorphic nonempty opens. \item Assume $X$ and $Y$ are schemes over a base scheme $S$. Then $X$ and $Y$ are $S$-birational if and only if there are nonempty opens $U \subset X$ and $V \subset Y$ which are $S$-isomorphic. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-birational} \begin{reference} \cite[(2.2.9)]{EGA1} \end{reference} Let $X$, $Y$ be schemes. Assume $X$ and $Y$ have finitely many irreducible components. We say a morphism $f : X \to Y$ is {\it birational} if \begin{enumerate} \item $f$ induces a bijection between the set of generic points of irreducible components of $X$ and the set of generic points of the irreducible components of $Y$, and \item for every generic point $\eta \in X$ of an irreducible component of $X$ the local ring map $\mathcal{O}_{Y, f(\eta)} \to \mathcal{O}_{X, \eta}$ is an isomorphism. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-birational-dominant} Let $f : X \to Y$ be a morphism of schemes having finitely many irreducible components. If $f$ is birational then $f$ is dominant. \end{lemma} 
\begin{lemma} \label{lemma-birational-generic-fibres} Let $f : X \to Y$ be a birational morphism of schemes having finitely many irreducible components. If $y \in Y$ is the generic point of an irreducible component, then the base change $X \times_Y \Spec(\mathcal{O}_{Y, y}) \to \Spec(\mathcal{O}_{Y, y})$ is an isomorphism. \end{lemma} 
\begin{lemma} \label{lemma-birational-birational} Let $f : X \to Y$ be a birational morphism of schemes having finitely many irreducible components over a base scheme $S$. Assume one of the following conditions is satisfied \begin{enumerate} \item $f$ is locally of finite type and $Y$ reduced, \item $f$ is locally of finite presentation. \end{enumerate} Then there exist dense opens $U \subset X$ and $V \subset Y$ such that $f(U) \subset V$ and $f|_U : U \to V$ is an isomorphism. In particular if $X$ and $Y$ are irreducible, then $X$ and $Y$ are $S$-birational. \end{lemma} 
\begin{lemma} \label{lemma-criterion-birational-finite-presentation} Let $S$ be a scheme. Let $X$ and $Y$ be irreducible schemes locally of finite presentation over $S$. Let $x \in X$ and $y \in Y$ be the generic points. The following are equivalent \begin{enumerate} \item $X$ and $Y$ are $S$-birational, \item there exist nonempty opens of $X$ and $Y$ which are $S$-isomorphic, and \item $x$ and $y$ map to the same point $s$ of $S$ and $\mathcal{O}_{X, x}$ and $\mathcal{O}_{Y, y}$ are isomorphic as $\mathcal{O}_{S, s}$-algebras. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-common-open} Let $S$ be a scheme. Let $X$ and $Y$ be integral schemes locally of finite type over $S$. Let $x \in X$ and $y \in Y$ be the generic points. The following are equivalent \begin{enumerate} \item $X$ and $Y$ are $S$-birational, \item there exist nonempty opens of $X$ and $Y$ which are $S$-isomorphic, and \item $x$ and $y$ map to the same point $s \in S$ and $\kappa(x) \cong \kappa(y)$ as $\kappa(s)$-extensions. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-generically-finite} Let $X$, $Y$ be schemes. Let $f : X \to Y$ be locally of finite type. Let $\eta \in Y$ be a generic point of an irreducible component of $Y$. The following are equivalent: \begin{enumerate} \item the set $f^{-1}(\{\eta\})$ is finite, \item there exist affine opens $U_i \subset X$, $i = 1, \ldots, n$ and $V \subset Y$ with $f(U_i) \subset V$, $\eta \in V$ and $f^{-1}(\{\eta\}) \subset \bigcup U_i$ such that each $f|_{U_i} : U_i \to V$ is finite. \end{enumerate} If $f$ is quasi-separated, then these are also equivalent to \begin{enumerate} \item[(3)] there exist affine opens $V \subset Y$, and $U \subset X$ with $f(U) \subset V$, $\eta \in V$ and $f^{-1}(\{\eta\}) \subset U$ such that $f|_U : U \to V$ is finite. \end{enumerate} If $f$ is quasi-compact and quasi-separated, then these are also equivalent to \begin{enumerate} \item[(4)] there exists an affine open $V \subset Y$, $\eta \in V$ such that $f^{-1}(V) \to V$ is finite. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-quasi-finiteness-over-generic-point} Let $X$, $Y$ be schemes. Let $f : X \to Y$ be locally of finite type. Let $X^0$, resp.\ $Y^0$ denote the set of generic points of irreducible components of $X$, resp.\ $Y$. Let $\eta \in Y^0$. The following are equivalent \begin{enumerate} \item $f^{-1}(\{\eta\}) \subset X^0$, \item $f$ is quasi-finite at all points lying over $\eta$, \item $f$ is quasi-finite at all $\xi \in X^0$ lying over $\eta$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-finite-over-dense-open} Let $X$, $Y$ be schemes. Let $f : X \to Y$ be locally of finite type. Let $X^0$, resp.\ $Y^0$ denote the set of generic points of irreducible components of $X$, resp.\ $Y$. Assume \begin{enumerate} \item $X^0$ and $Y^0$ are finite and $f^{-1}(Y^0) = X^0$, \item either $f$ is quasi-compact or $f$ is separated. \end{enumerate} Then there exists a dense open $V \subset Y$ such that $f^{-1}(V) \to V$ is finite. \end{lemma} 
\begin{lemma} \label{lemma-birational-isomorphism-over-dense-open} Let $X$, $Y$ be schemes. Let $f : X \to Y$ be a birational morphism between schemes which have finitely many irreducible components. Assume \begin{enumerate} \item either $f$ is quasi-compact or $f$ is separated, and \item either $f$ is locally of finite type and $Y$ is reduced or $f$ is locally of finite presentation. \end{enumerate} Then there exists a dense open $V \subset Y$ such that $f^{-1}(V) \to V$ is an isomorphism. \end{lemma} 
\begin{lemma} \label{lemma-finite-degree} Let $X$, $Y$ be integral schemes. Let $f : X \to Y$ be locally of finite type. Assume $f$ is dominant. The following are equivalent: \begin{enumerate} \item the extension $R(Y) \subset R(X)$ has transcendence degree $0$, \item the extension $R(Y) \subset R(X)$ is finite, \item there exist nonempty affine opens $U \subset X$ and $V \subset Y$ such that $f(U) \subset V$ and $f|_U : U \to V$ is finite, and \item the generic point of $X$ is the only point of $X$ mapping to the generic point of $Y$. \end{enumerate} If $f$ is separated or if $f$ is quasi-compact, then these are also equivalent to \begin{enumerate} \item[(5)] there exists a nonempty affine open $V \subset Y$ such that $f^{-1}(V) \to V$ is finite. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-degree} Let $X$ and $Y$ be integral schemes. Let $f : X \to Y$ be locally of finite type and dominant. Assume $[R(X) : R(Y)] < \infty$, or any other of the equivalent conditions (1) -- (4) of Lemma \ref{lemma-finite-degree}. Then the positive integer $$ \deg(X/Y) = [R(X) : R(Y)] $$ is called the {\it degree of $X$ over $Y$}. \end{definition} 
\begin{lemma} \label{lemma-degree-composition} Let $X$, $Y$, $Z$ be integral schemes. Let $f : X \to Y$ and $g : Y \to Z$ be dominant morphisms locally of finite type. Assume that $[R(X) : R(Y)] < \infty$ and $[R(Y) : R(Z)] < \infty$. Then $$ \deg(X/Z) = \deg(X/Y) \deg(Y/Z). $$ \end{lemma} 
\begin{definition} \label{definition-modification} Let $X$ be an integral scheme. A {\it modification of $X$} is a birational proper morphism $f : X' \to X$ with $X'$ integral. \end{definition} 
\begin{definition} \label{definition-alteration} \begin{reference} \cite[Definition 2.20]{alterations} \end{reference} Let $X$ be an integral scheme. An {\it alteration of $X$} is a proper dominant morphism $f : Y \to X$ with $Y$ integral such that $f^{-1}(U) \to U$ is finite for some nonempty open $U \subset X$. \end{definition} 
\begin{lemma} \label{lemma-dimension-formula} Let $S$ be a scheme. Let $f : X \to S$ be a morphism of schemes. Let $x \in X$, and set $s = f(x)$. Assume \begin{enumerate} \item $S$ is locally Noetherian, \item $f$ is locally of finite type, \item $X$ and $S$ integral, and \item $f$ dominant. \end{enumerate} We have \begin{equation} \label{equation-dimension-formula} \dim(\mathcal{O}_{X, x}) \leq \dim(\mathcal{O}_{S, s}) + \text{trdeg}_{R(S)}R(X) - \text{trdeg}_{\kappa(s)} \kappa(x). \end{equation} Moreover, equality holds if $S$ is universally catenary. \end{lemma} 
\begin{lemma} \label{lemma-dimension-formula-general} Let $S$ be a scheme. Let $f : X \to S$ be a morphism of schemes. Let $x \in X$, and set $s = f(x)$. Assume $S$ is locally Noetherian and $f$ is locally of finite type, We have \begin{equation} \label{equation-dimension-formula-general} \dim(\mathcal{O}_{X, x}) \leq \dim(\mathcal{O}_{S, s}) + E - \text{trdeg}_{\kappa(s)} \kappa(x). \end{equation} where $E$ is the maximum of $\text{trdeg}_{\kappa(f(\xi))}(\kappa(\xi))$ where $\xi$ runs over the generic points of irreducible components of $X$ containing $x$. \end{lemma} 
\begin{lemma} \label{lemma-dimension-function-propagates} Let $S$ be a locally Noetherian and universally catenary scheme. Let $\delta : S \to \mathbf{Z}$ be a dimension function. Let $f : X \to S$ be a morphism of schemes. Assume $f$ locally of finite type. Then the map \begin{align*} \delta = \delta_{X/S} : X & \longrightarrow \mathbf{Z} \\ x & \longmapsto \delta(f(x)) + \text{trdeg}_{\kappa(f(x))} \kappa(x) \end{align*} is a dimension function on $X$. \end{lemma} 
\begin{lemma} \label{lemma-alteration-dimension} Let $f : X \to Y$ be a morphism of schemes. Assume that \begin{enumerate} \item $Y$ is locally Noetherian, \item $X$ and $Y$ are integral schemes, \item $f$ is dominant, and \item $f$ is locally of finite type. \end{enumerate} Then we have $$ \dim(X) \leq \dim(Y) + \text{trdeg}_{R(Y)} R(X). $$ If $f$ is closed\footnote{For example if $f$ is proper, see Definition \ref{definition-proper}.} then equality holds. \end{lemma} 
\begin{lemma} \label{lemma-alteration-dimension-general} Let $f : X \to Y$ be a morphism of schemes. Assume that $Y$ is locally Noetherian and $f$ is locally of finite type. Then $$ \dim(X) \leq \dim(Y) + E $$ where $E$ is the supremum of $\text{trdeg}_{\kappa(f(\xi))}(\kappa(\xi))$ where $\xi$ runs through the generic points of the irreducible components of $X$. \end{lemma} 
\begin{lemma} \label{lemma-integral-closure} Let $X$ be a scheme. Let $\mathcal{A}$ be a quasi-coherent sheaf of $\mathcal{O}_X$-algebras. The subsheaf $\mathcal{A}' \subset \mathcal{A}$ defined by the rule $$ U \longmapsto \{f \in \mathcal{A}(U) \mid f_x \in \mathcal{A}_x \text{ integral over } \mathcal{O}_{X, x} \text{ for all }x \in U\} $$ is a quasi-coherent $\mathcal{O}_X$-algebra, the stalk $\mathcal{A}'_x$ is the integral closure of $\mathcal{O}_{X, x}$ in $\mathcal{A}_x$, and for any affine open $U \subset X$ the ring $\mathcal{A}'(U) \subset \mathcal{A}(U)$ is the integral closure of $\mathcal{O}_X(U)$ in $\mathcal{A}(U)$. \end{lemma} 
\begin{definition} \label{definition-integral-closure} Let $X$ be a scheme. Let $\mathcal{A}$ be a quasi-coherent sheaf of $\mathcal{O}_X$-algebras. The {\it integral closure of $\mathcal{O}_X$ in $\mathcal{A}$} is the quasi-coherent $\mathcal{O}_X$-subalgebra $\mathcal{A}' \subset \mathcal{A}$ constructed in Lemma \ref{lemma-integral-closure} above. \end{definition} 
\begin{definition} \label{definition-normalization-X-in-Y} Let $f : Y \to X$ be a quasi-compact and quasi-separated morphism of schemes. Let $\mathcal{O}'$ be the integral closure of $\mathcal{O}_X$ in $f_*\mathcal{O}_Y$. The {\it normalization of $X$ in $Y$} is the scheme\footnote{The scheme $X'$ need not be normal, for example if $Y = X$ and $f = \text{id}_X$, then $X' = X$.} $$ \nu : X' = \underline{\Spec}_X(\mathcal{O}') \to X $$ over $X$. It comes equipped with a natural factorization $$ Y \xrightarrow{f'} X' \xrightarrow{\nu} X $$ of the initial morphism $f$. \end{definition} 
\begin{lemma} \label{lemma-characterize-normalization} Let $f : Y \to X$ be a quasi-compact and quasi-separated morphism of schemes. The factorization $f = \nu \circ f'$, where $\nu : X' \to X$ is the normalization of $X$ in $Y$ is characterized by the following two properties: \begin{enumerate} \item the morphism $\nu$ is integral, and \item for any factorization $f = \pi \circ g$, with $\pi : Z \to X$ integral, there exists a commutative diagram $$ \xymatrix{ Y \ar[d]_{f'} \ar[r]_g & Z \ar[d]^\pi \\ X' \ar[ru]^h \ar[r]^\nu & X } $$ for some unique morphism $h : X' \to Z$. \end{enumerate} Moreover, the morphism $f' : Y \to X'$ is dominant and in (2) the morphism $h : X' \to Z$ is the normalization of $Z$ in $Y$. \end{lemma} 
\begin{lemma} \label{lemma-functoriality-normalization} Let $$ \xymatrix{ Y_2 \ar[d]_{f_2} \ar[r] & Y_1 \ar[d]^{f_1} \\ X_2 \ar[r] & X_1 } $$ be a commutative diagram of morphisms of schemes. Assume $f_1$, $f_2$ quasi-compact and quasi-separated. Let $f_i = \nu_i \circ f_i'$, $i = 1, 2$ be the canonical factorizations, where $\nu_i : X_i' \to X_i$ is the normalization of $X_i$ in $Y_i$. Then there exists a unique arrow $X'_2 \to X'_1$ fitting into a commutative diagram $$ \xymatrix{ Y_2 \ar[d]_{f_2'} \ar[r] & Y_1 \ar[d]^{f_1'} \\ X_2' \ar[d]_{\nu_2} \ar[r] & X_1' \ar[d]^{\nu_1} \\ X_2 \ar[r] & X_1 } $$ \end{lemma} 
\begin{lemma} \label{lemma-normalization-localization} Let $f : Y \to X$ be a quasi-compact and quasi-separated morphism of schemes. Let $U \subset X$ be an open subscheme and set $V = f^{-1}(U)$. Then the normalization of $U$ in $V$ is the inverse image of $U$ in the normalization of $X$ in $Y$. \end{lemma} 
\begin{lemma} \label{lemma-normalization-is-normalization} Let $f : Y \to X$ be a quasi-compact and quasi-separated morphism of schemes. Let $X'$ be the normalization of $X$ in $Y$. Then the normalization of $X'$ in $Y$ is $X'$. \end{lemma} 
\begin{lemma} \label{lemma-normalization-in-reduced} Let $f : Y \to X$ be a quasi-compact and quasi-separated morphism of schemes. Let $X' \to X$ be the normalization of $X$ in $Y$. If $Y$ is reduced, so is $X'$. \end{lemma} 
\begin{lemma} \label{lemma-normalization-generic} Let $f : Y \to X$ be a quasi-compact and quasi-separated morphism of schemes. Let $X' \to X$ be the normalization of $X$ in $Y$. Every generic point of an irreducible component of $X'$ is the image of a generic point of an irreducible component of $Y$. \end{lemma} 
\begin{lemma} \label{lemma-normalization-in-disjoint-union} Let $f : Y \to X$ be a quasi-compact and quasi-separated morphism of schemes. Suppose that $Y = Y_1 \amalg Y_2$ is a disjoint union of two schemes. Write $f_i = f|_{Y_i}$. Let $X_i'$ be the normalization of $X$ in $Y_i$. Then $X_1' \amalg X_2'$ is the normalization of $X$ in $Y$. \end{lemma} 
\begin{lemma} \label{lemma-normalization-in-universally-closed} Let $f : X \to S$ be a quasi-compact, quasi-separated and universally closed morphisms of schemes. Then $f_*\mathcal{O}_X$ is integral over $\mathcal{O}_S$. In other words, the normalization of $S$ in $X$ is equal to the factorization $$ X \longrightarrow \underline{\Spec}_S(f_*\mathcal{O}_X) \longrightarrow S $$ of Constructions, Lemma \ref{constructions-lemma-canonical-morphism}. \end{lemma} 
\begin{lemma} \label{lemma-normalization-in-integral} Let $f : Y \to X$ be an integral morphism. Then the normalization of $X$ in $Y$ is equal to $Y$. \end{lemma} 
\begin{lemma} \label{lemma-normal-normalization} Let $f : Y \to X$ be a quasi-compact and quasi-separated morphism of schemes. Let $X'$ be the normalization of $X$ in $Y$. Assume \begin{enumerate} \item $Y$ is a normal scheme, \item quasi-compact opens of $Y$ have finitely many irreducible components. \end{enumerate} Then $X'$ is a disjoint union of integral normal schemes. Moreover, the morphism $Y \to X'$ is dominant and induces a bijection of irreducible components. \end{lemma} 
\begin{lemma} \label{lemma-nagata-normalization-finite-general} Let $f : X \to S$ be a morphism. Assume that \begin{enumerate} \item $S$ is a Nagata scheme, \item $f$ is quasi-compact and quasi-separated, \item quasi-compact opens of $X$ have finitely many irreducible components, \item if $x \in X$ is a generic point of an irreducible component, then the field extension $\kappa(x)/\kappa(f(x))$ is finitely generated, and \item $X$ is reduced. \end{enumerate} Then the normalization $\nu : S' \to S$ of $S$ in $X$ is finite. \end{lemma} 
\begin{lemma} \label{lemma-nagata-normalization-finite} Let $f : X \to S$ be a morphism. Assume that \begin{enumerate} \item $S$ is a Nagata scheme, \item $f$ is of finite type, \item $X$ is reduced. \end{enumerate} Then the normalization $\nu : S' \to S$ of $S$ in $X$ is finite. \end{lemma} 
\begin{lemma} \label{lemma-relative-normalization-normal-codim-1} Let $f : Y \to X$ be a finite type morphism of schemes with $Y$ reduced and $X$ Nagata. Let $X'$ be the normalization of $X$ in $Y$. Let $x' \in X'$ be a point such that \begin{enumerate} \item $\dim(\mathcal{O}_{X', x'}) = 1$, and \item the fibre of $Y \to X'$ over $x'$ is empty. \end{enumerate} Then $\mathcal{O}_{X', x'}$ is a discrete valuation ring. \end{lemma} 
\begin{definition} \label{definition-normalization} Let $X$ be a scheme such that every quasi-compact open has finitely many irreducible components. We define the {\it normalization} of $X$ as the morphism $$ \nu : X^\nu \longrightarrow X $$ which is the normalization of $X$ in the morphism $f : Y \to X$ (\ref{equation-generic-points}) constructed above. \end{definition} 
\begin{lemma} \label{lemma-normalization-reduced} Let $X$ be a scheme such that every quasi-compact open has finitely many irreducible components. The normalization morphism $\nu$ factors through the reduction $X_{red}$ and $X^\nu \to X_{red}$ is the normalization of $X_{red}$. \end{lemma} 
\begin{lemma} \label{lemma-description-normalization} Let $X$ be a reduced scheme such that every quasi-compact open has finitely many irreducible components. Let $\Spec(A) = U \subset X$ be an affine open. Then \begin{enumerate} \item $A$ has finitely many minimal primes $\mathfrak q_1, \ldots, \mathfrak q_t$, \item the total ring of fractions $Q(A)$ of $A$ is $Q(A/\mathfrak q_1) \times \ldots \times Q(A/\mathfrak q_t)$, \item the integral closure $A'$ of $A$ in $Q(A)$ is the product of the integral closures of the domains $A/\mathfrak q_i$ in the fields $Q(A/\mathfrak q_i)$, and \item $\nu^{-1}(U)$ is identified with the spectrum of $A'$ where $\nu : X^\nu \to X$ is the normalization morphism. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-stalk-normalization} Let $X$ be a scheme such that every quasi-compact open has a finite number of irreducible components. Let $\nu : X^\nu \to X$ be the normalization of $X$. Let $x \in X$. Then the following are canonically isomorphic as $\mathcal{O}_{X, x}$-algebras \begin{enumerate} \item the stalk $(\nu_*\mathcal{O}_{X^\nu})_x$, \item the integral closure of $\mathcal{O}_{X, x}$ in the total ring of fractions of $(\mathcal{O}_{X, x})_{red}$, \item the integral closure of $\mathcal{O}_{X, x}$ in the product of the residue fields of the minimal primes of $\mathcal{O}_{X, x}$ (and there are finitely many of these). \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-normalization-normal} Let $X$ be a scheme such that every quasi-compact open has finitely many irreducible components. \begin{enumerate} \item The normalization $X^\nu$ is a disjoint union of integral normal schemes. \item The morphism $\nu : X^\nu \to X$ is integral, surjective, and induces a bijection on irreducible components. \item For any integral morphism $\alpha : X' \to X$ such that for $U \subset X$ quasi-compact open the inverse image $\alpha^{-1}(U)$ has finitely many irreducible components and $\alpha|_{\alpha^{-1}(U)} : \alpha^{-1}(U) \to U$ is birational\footnote{This awkward formulation is necessary as we've only defined what it means for a morphism to be birational if the source and target have finitely many irreducible components. It suffices if $X'_{red} \to X_{red}$ satisfies the condition.} there exists a factorization $X^\nu \to X' \to X$ and $X^\nu \to X'$ is the normalization of $X'$. \item For any morphism $Z \to X$ with $Z$ a normal scheme such that each irreducible component of $Z$ dominates an irreducible component of $X$ there exists a unique factorization $Z \to X^\nu \to X$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-normalization-in-terms-of-components} Let $X$ be a scheme such that every quasi-compact open has finitely many irreducible components. Let $Z_i \subset X$, $i \in I$ be the irreducible components of $X$ endowed with the reduced induced structure. Let $Z_i^\nu \to Z_i$ be the normalization. Then $\coprod_{i \in I} Z_i^\nu \to X$ is the normalization of $X$. \end{lemma} 
\begin{lemma} \label{lemma-normalization-birational} Let $X$ be a reduced scheme with finitely many irreducible components. Then the normalization morphism $X^\nu \to X$ is birational. \end{lemma} 
\begin{lemma} \label{lemma-finite-birational-over-normal} A finite (or even integral) birational morphism $f : X \to Y$ of integral schemes with $Y$ normal is an isomorphism. \end{lemma} 
\begin{lemma} \label{lemma-normalization-trivial} Let $X$ be a scheme with locally finitely many irreducible components. The normalization morphism $\nu : X^\nu \to X$ is an isomorphism if and only if $X$ is normal. \end{lemma} 
\begin{lemma} \label{lemma-Japanese-normalization} Let $X$ be an integral, Japanese scheme. The normalization $\nu : X^\nu \to X$ is a finite morphism. \end{lemma} 
\begin{lemma} \label{lemma-nagata-normalization} Let $X$ be a Nagata scheme. The normalization $\nu : X^\nu \to X$ is a finite morphism. \end{lemma} 
\begin{lemma} \label{lemma-normalization-geom-unibranch-univ-homeo} Let $X$ be an irreducible, geometrically unibranch scheme. The normalization morphism $\nu : X^\nu \to X$ is a universal homeomorphism. \end{lemma} 
\begin{lemma} \label{lemma-relative-weak-normalization-algebra} Let $A \to B$ be a ring map inducing a dominant morphism $\Spec(B) \to \Spec(A)$ of spectra. There exists an $A$-subalgebra $B' \subset B$ such that \begin{enumerate} \item $\Spec(B') \to \Spec(A)$ is a universal homeomorphism, \item given a factorization $A \to C \to B$ such that $\Spec(C) \to \Spec(A)$ is a universal homeomorphism, the image of $C \to B$ is contained in $B'$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-relative-weak-normalization-localization} Let $A \to B$ be a ring map inducing a dominant morphism $\Spec(B) \to \Spec(A)$ of spectra. Formation of the $A$-subalgebra $B' \subset B$ in Lemma \ref{lemma-relative-weak-normalization-algebra} commutes with localization (see proof for explanation). \end{lemma} 
\begin{lemma} \label{lemma-relative-seminormalization-algebra} Let $A \to B$ be a ring map inducing a dominant morphism $\Spec(B) \to \Spec(A)$ of spectra. There exists an $A$-subalgebra $B' \subset B$ such that \begin{enumerate} \item $\Spec(B') \to \Spec(A)$ is a universal homeomorphism inducing isomorphisms on residue fields, \item given a factorization $A \to C \to B$ such that $\Spec(C) \to \Spec(A)$ is a universal homeomorphism inducing isomorphisms on residue fields, the image of $C \to B$ is contained in $B'$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-relative-seminormalization-localization} Let $A \to B$ be a ring map inducing a dominant morphism $\Spec(B) \to \Spec(A)$ of spectra. Formation of the $A$-subalgebra $B' \subset B$ in Lemma \ref{lemma-relative-seminormalization-algebra} commutes with localization (see proof for explanation). \end{lemma} 
\begin{lemma} \label{lemma-relative-seminormalization} Let $f : Y \to X$ be a quasi-compact, quasi-separated, and dominant morphism of schemes. \begin{enumerate} \item The category of factorizations $Y \to X' \to X$ where $X' \to X$ is a universal homeomorphism has an initial object $Y \to X^{Y/wn} \to X$. \item The category of factorizations $Y \to X' \to X$ where $X' \to X$ is a universal homeomorphism inducing isomorphisms on residue fields has an initial object $Y \to X^{Y/sn} \to X$. \end{enumerate} Moreover, formation of the factorization $Y \to X^{Y/wn} \to X$ and $Y \to X^{Y/sn} \to X$ commutes with base change to open subschemes of $X$. \end{lemma} 
\begin{definition} \label{definition-relative-seminormalization} Let $f : Y \to X$ be a quasi-compact, quasi-separated, and dominant morphism of schemes. \begin{enumerate} \item The factorization $Y \to X^{Y/sn} \to X$ constructed in Lemma \ref{lemma-relative-seminormalization} part (2) is the {\it seminormalization of $X$ in $Y$}. \item The factorization $Y \to X^{Y/wn} \to X$ constructed in Lemma \ref{lemma-relative-seminormalization} part (1) is the {\it weak normalization of $X$ in $Y$}. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-seminormal-and-normalization} Let $X$ be a scheme such that every quasi-compact open has finitely many irreducible components. Let $\nu : X^\nu \to X$ be the normalization of $X$. Then the seminormalization of $X$ in $X^\nu$ is is the seminormalization of $X$. In a formula: $X^{sn} = X^{X^\nu/sn}$. \end{lemma} 
\begin{definition} \label{definition-weak-normalization} Let $X$ be a scheme such that every quasi-compact open has finitely many irreducible components. We define the {\it weak normalization} of $X$ as the weak normalization $$ X^\nu \longrightarrow X^{wn} \longrightarrow X $$ of $X$ in the normalization $X^\nu$ of $X$ (Definition \ref{definition-normalization}). In a formula: $X^{wn} = X^{X^\nu/wn}$. \end{definition} 
\begin{definition} \label{definition-weakly-normal} Let $X$ be a scheme such that every quasi-compact open has finitely many irreducible components. We say $X$ is {\it weakly normal} if the weak normalization $X^{wn} \to X$ is an isomorphism (Definition \ref{definition-weak-normalization}). \end{definition} 
\begin{lemma} \label{lemma-affine-weakly-normal} Let $X = \Spec(A)$ be an affine scheme which has finitely many irreducible components. Then $X$ is weakly normal if and only if \begin{enumerate} \item $A$ is seminormal (Definition \ref{definition-seminormal-ring}), \item for a prime number $p$ and $z, w \in A$ such that (a) $z$ is a nonzerodivisor, (b) $w^p$ is divisible by $z^p$, and (c) $pw$ is divisible by $z$, then $w$ is divisible by $z$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-locally-weakly-normal} Let $X$ be a scheme such that every quasi-compact open has finitely many irreducible components. The following are equivalent: \begin{enumerate} \item The scheme $X$ is weakly normal. \item For every affine open $U \subset X$ the ring $\mathcal{O}_X(U)$ satisfies conditions (1) and (2) of Lemma \ref{lemma-affine-weakly-normal}. \item There exists an affine open covering $X = \bigcup U_i$ such that each ring $\mathcal{O}_X(U_i)$ satisfies conditions (1) and (2) of Lemma \ref{lemma-affine-weakly-normal}. \item There exists an open covering $X = \bigcup X_j$ such that each open subscheme $X_j$ is weakly normal. \end{enumerate} Moreover, if $X$ is weakly normal then every open subscheme is weakly normal. \end{lemma} 
\begin{theorem}[Algebraic version of Zariski's Main Theorem] \label{theorem-main-theorem} Let $f : Y \to X$ be an affine morphism of schemes. Assume $f$ is of finite type. Let $X'$ be the normalization of $X$ in $Y$. Picture: $$ \xymatrix{ Y \ar[rd]_f \ar[rr]_{f'} & & X' \ar[ld]^\nu \\ & X & } $$ Then there exists an open subscheme $U' \subset X'$ such that \begin{enumerate} \item $(f')^{-1}(U') \to U'$ is an isomorphism, and \item $(f')^{-1}(U') \subset Y$ is the set of points at which $f$ is quasi-finite. \end{enumerate} \end{theorem} 
\begin{lemma} \label{lemma-quasi-finite-points-open} \begin{slogan} The locally quasi-finite locus of a morphism is open \end{slogan} Let $f : X \to S$ be a morphism of schemes. The set of points of $X$ where $f$ is quasi-finite is an open $U \subset X$. The induced morphism $U \to S$ is locally quasi-finite. \end{lemma} 
\begin{lemma} \label{lemma-quasi-finite-affine} Let $f : Y \to X$ be a morphism of schemes. Assume \begin{enumerate} \item $X$ and $Y$ are affine, and \item $f$ is quasi-finite. \end{enumerate} Then there exists a diagram $$ \xymatrix{ Y \ar[rd]_f \ar[rr]_j & & Z \ar[ld]^\pi \\ & X & } $$ with $Z$ affine, $\pi$ finite and $j$ an open immersion. \end{lemma} 
\begin{lemma} \label{lemma-image-nowhere-dense-quasi-finite} Let $f : Y \to X$ be a quasi-finite morphism of schemes. Let $T \subset Y$ be a closed nowhere dense subset of $Y$. Then $f(T) \subset X$ is a nowhere dense subset of $X$. \end{lemma} 
\begin{definition} \label{definition-universally-bounded} Let $f : X \to Y$ be a morphism of schemes. \begin{enumerate} \item We say the integer $n$ {\it bounds the degrees of the fibres of $f$} if for all $y \in Y$ the fibre $X_y$ is a finite scheme over $\kappa(y)$ whose degree over $\kappa(y)$ is $\leq n$. \item We say the {\it fibres of $f$ are universally bounded}\footnote{This is probably nonstandard notation.} if there exists an integer $n$ which bounds the degrees of the fibres of $f$. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-characterize-universally-bounded} Let $f : X \to Y$ be a morphism of schemes. Let $n \geq 0$. The following are equivalent: \begin{enumerate} \item the integer $n$ bounds the degrees of the fibres of $f$, and \item for every morphism $\Spec(k) \to Y$, where $k$ is a field, the fibre product $X_k = \Spec(k) \times_Y X$ is finite over $k$ of degree $\leq n$. \end{enumerate} In this case the fibres of $f$ are universally bounded and the schemes $X_k$ have at most $n$ points. More precisely, if $X_k = \{x_1, \ldots, x_t\}$, then we have $$ n \geq \sum\nolimits_{i = 1, \ldots, t} [\kappa(x_i) : k] $$ \end{lemma} 
\begin{lemma} \label{lemma-finite-locally-free-universally-bounded} If $f$ is a finite locally free morphism of degree $d$, then $d$ bounds the degree of the fibres of $f$. \end{lemma} 
\begin{lemma} \label{lemma-composition-universally-bounded} A composition of morphisms with universally bounded fibres is a morphism with universally bounded fibres. More precisely, assume that $n$ bounds the degrees of the fibres of $f : X \to Y$ and $m$ bounds the degrees of $g : Y \to Z$. Then $nm$ bounds the degrees of the fibres of $g \circ f : X \to Z$. \end{lemma} 
\begin{lemma} \label{lemma-base-change-universally-bounded} A base change of a morphism with universally bounded fibres is a morphism with universally bounded fibres. More precisely, if $n$ bounds the degrees of the fibres of $f : X \to Y$ and $Y' \to Y$ is any morphism, then the degrees of the fibres of the base change $f' : Y' \times_Y X \to Y'$ is also bounded by $n$. \end{lemma} 
\begin{lemma} \label{lemma-descent-universally-bounded} Let $f : X \to Y$ be a morphism of schemes. Let $Y' \to Y$ be a morphism of schemes, and let $f' : X' = X_{Y'} \to Y'$ be the base change of $f$. If $Y' \to Y$ is surjective and $f'$ has universally bounded fibres, then $f$ has universally bounded fibres. More precisely, if $n$ bounds the degree of the fibres of $f'$, then also $n$ bounds the degrees of the fibres of $f$. \end{lemma} 
\begin{lemma} \label{lemma-immersion-universally-bounded} An immersion has universally bounded fibres. \end{lemma} 
\begin{lemma} \label{lemma-etale-universally-bounded} Let $f : X \to Y$ be an \'etale morphism of schemes. Let $n \geq 0$. The following are equivalent \begin{enumerate} \item the integer $n$ bounds the degrees of the fibres, \item for every field $k$ and morphism $\Spec(k) \to Y$ the base change $X_k = \Spec(k) \times_Y X$ has at most $n$ points, and \item for every $y \in Y$ and every separable algebraic closure $\kappa(y) \subset \kappa(y)^{sep}$ the scheme $X_{\kappa(y)^{sep}}$ has at most $n$ points. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-locally-quasi-finite-qc-source-universally-bounded} Let $f : X \to Y$ be a morphism of schemes. Assume that \begin{enumerate} \item $f$ is locally quasi-finite, and \item $X$ is quasi-compact. \end{enumerate} Then $f$ has universally bounded fibres. \end{lemma} 
\begin{lemma} \label{lemma-universally-bounded-permanence} Consider a commutative diagram of morphisms of schemes $$ \xymatrix{ X \ar[rd]_g \ar[rr]_f & & Y \ar[ld]^h \\ & Z & } $$ If $g$ has universally bounded fibres, and $f$ is surjective and flat, then also $h$ has universally bounded fibres. More precisely, if $n$ bounds the degree of the fibres of $g$, then also $n$ bounds the degree of the fibres of $h$. \end{lemma} 
\begin{lemma} \label{lemma-factor-through-point} Let $f : Y \to X$ be a morphism of schemes. Let $x \in X$ be a point. Assume that $Y$ is reduced and $f(Y)$ is set-theoretically contained in $\{x\}$. Then $f$ factors through the canonical morphism $x = \Spec(\kappa(x)) \to X$. \end{lemma} 
\begin{lemma} \label{lemma-factor-through-set-of-points} Let $f : Y \to X$ be a morphism of schemes. Let $E \subset X$. Assume $X$ is locally Noetherian, there are no nontrivial specializations among the elements of $E$, $Y$ is reduced, and $f(Y) \subset E$. Then $f$ factors through $\coprod_{x \in E} x \to X$. \end{lemma} 
