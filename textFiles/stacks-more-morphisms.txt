\begin{definition} \label{definition-thickening} Thickenings. \begin{enumerate} \item We say an algebraic stack $\mathcal{X}'$ is a {\it thickening} of an algebraic stack $\mathcal{X}$ if $\mathcal{X}$ is a closed substack of $\mathcal{X}'$ and the associated topological spaces are equal. \item Given two thickenings $\mathcal{X} \subset \mathcal{X}'$ and $\mathcal{Y} \subset \mathcal{Y}'$ a {\it morphism of thickenings} is a morphism $f' : \mathcal{X}' \to \mathcal{Y}'$ of algebraic stacks such that $f'|_\mathcal{X}$ factors through the closed substack $\mathcal{Y}$. In this situation we set $f = f'|_\mathcal{X} : \mathcal{X} \to \mathcal{Y}$ and we say that $(f, f') : (\mathcal{X} \subset \mathcal{X}') \to (\mathcal{Y} \subset \mathcal{Y}')$ is a morphism of thickenings. \item Let $\mathcal{Z}$ be an algebraic stack. We similarly define {\it thickenings over $\mathcal{Z}$} and {\it morphisms of thickenings over $\mathcal{Z}$}. This means that the algebraic stacks $\mathcal{X}'$ and $\mathcal{Y}'$ are endowed with a structure morphism to $\mathcal{Z}$ and that $f'$ fits into a suitable $2$-commutative diagram of algebraic stacks. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-thickening} Let $i : \mathcal{X} \to \mathcal{X}'$ be a morphism of algebraic stacks. The following are equivalent \begin{enumerate} \item $i$ is a thickening of algebraic stacks (abuse of language as above), and \item $i$ is representable by algebraic spaces and is a thickening in the sense of Properties of Stacks, Section \ref{stacks-properties-section-properties-morphisms}. \end{enumerate} In this case $i$ is a closed immersion and a universal homeomorphism. \end{lemma} 
\begin{definition} \label{definition-first-order-thickening} We say an algebraic stack $\mathcal{X}'$ is a {\it first order thickening} of an algebraic stack $\mathcal{X}$ if $\mathcal{X}$ is a closed substack of $\mathcal{X}'$ and $\mathcal{X} \to \mathcal{X}'$ is a first order thickening in the sense of Properties of Stacks, Section \ref{stacks-properties-section-properties-morphisms}. \end{definition} 
\begin{lemma} \label{lemma-base-change-thickening} Let $\mathcal{Y} \subset \mathcal{Y}'$ be a thickening of algebraic stacks. Let $\mathcal{X}' \to \mathcal{Y}'$ be a morphism of algebraic stacks and set $\mathcal{X} = \mathcal{Y} \times_{\mathcal{Y}'} \mathcal{X}'$. Then $(\mathcal{X} \subset \mathcal{X}') \to (\mathcal{Y} \subset \mathcal{Y}')$ is a morphism of thickenings. If $\mathcal{Y} \subset \mathcal{Y}'$ is a first order thickening, then $\mathcal{X} \subset \mathcal{X}'$ is a first order thickening. \end{lemma} 
\begin{lemma} \label{lemma-composition-thickening} If $\mathcal{X} \subset \mathcal{X}'$ and $\mathcal{X}' \subset \mathcal{X}''$ are thickenings of algebraic stacks, then so is $\mathcal{X} \subset \mathcal{X}''$. \end{lemma} 
\begin{lemma} \label{lemma-reduced-diagonal} Let $(f, f') : (\mathcal{X} \subset \mathcal{X}') \to (\mathcal{Y} \subset \mathcal{Y}')$ be a morphism of thickenings of algebraic stacks. Then $\mathcal{X} \times_\mathcal{Y} \mathcal{X} \to \mathcal{X}' \times_{\mathcal{Y}'} \mathcal{X}'$ is a thickening and the canonical diagram $$ \xymatrix{ \mathcal{X} \ar[r]_-\Delta \ar[d] & \mathcal{X} \times_\mathcal{Y} \mathcal{X} \ar[d] \\ \mathcal{X}' \ar[r]^-{\Delta'} & \mathcal{X}' \times_{\mathcal{Y}'} \mathcal{X}' } $$ is cartesian. \end{lemma} 
\begin{lemma} \label{lemma-thickening-diagonals} Let $(f, f') : (\mathcal{X} \subset \mathcal{X}') \to (\mathcal{Y} \subset \mathcal{Y}')$ be a morphism of thickenings of algebraic stacks. Let $\Delta : \mathcal{X} \to \mathcal{X} \times_\mathcal{Y} \mathcal{X}$ and $\Delta' : \mathcal{X}' \to \mathcal{X}' \times_{\mathcal{Y}'} \mathcal{X}'$ be the corresponding diagonal morphisms. Then each property from the following list is satisfied by $\Delta$ if and only if it is satisfied by $\Delta'$: (a) representable by schemes, (b) affine, (c) surjective, (d) quasi-compact, (e) universally closed, (f) integral, (g) quasi-separated, (h) separated, (i) universally injective, (j) universally open, (k) locally quasi-finite, (l) finite, (m) unramified, (n) monomorphism, (o) immersion, (p) closed immersion, and (q) proper. \end{lemma} 
\begin{lemma} \label{lemma-thickening-properties} \begin{reference} \cite[Theorem 2.2.5]{Conrad-moduli} \end{reference} Let $\mathcal{X} \subset \mathcal{X}'$ be a thickening of algebraic stacks. Then \begin{enumerate} \item $\mathcal{X}$ is an algebraic space if and only if $\mathcal{X}'$ is an algebraic space, \item $\mathcal{X}$ is a scheme if and only if $\mathcal{X}'$ is a scheme, \item $\mathcal{X}$ is DM if and only if $\mathcal{X}'$ is DM, \item $\mathcal{X}$ is quasi-DM if and only if $\mathcal{X}'$ is quasi-DM, \item $\mathcal{X}$ is separated if and only if $\mathcal{X}'$ is separated, \item $\mathcal{X}$ is quasi-separated if and only if $\mathcal{X}'$ is quasi-separated, and \item add more here. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-thicken-property-morphisms} Let $(f, f') : (\mathcal{X} \subset \mathcal{X}') \to (\mathcal{Y} \subset \mathcal{Y}')$ be a morphism of thickenings of algebraic stacks. Then \begin{enumerate} \item $f$ is an affine morphism if and only if $f'$ is an affine morphism, \item $f$ is a surjective morphism if and only if $f'$ is a surjective morphism, \item $f$ is quasi-compact if and only if $f'$ quasi-compact, \item $f$ is universally closed if and only if $f'$ is universally closed, \item $f$ is integral if and only if $f'$ is integral, \item $f$ is universally injective if and only if $f'$ is universally injective, \item $f$ is universally open if and only if $f'$ is universally open, \item $f$ is quasi-DM if and only if $f'$ is quasi-DM, \item $f$ is DM if and only if $f'$ is DM, \item $f$ is (quasi-)separated if and only if $f'$ is (quasi-)separated, \item $f$ is representable if and only if $f'$ is representable, \item $f$ is representable by algebraic spaces if and only if $f'$ is representable by algebraic spaces, \item add more here. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-flatness-morphism-thickenings-fp-over-ft} Consider a commutative diagram $$ \xymatrix{ (\mathcal{X} \subset \mathcal{X}') \ar[rr]_{(f, f')} \ar[rd] & & (\mathcal{Y} \subset \mathcal{Y}') \ar[ld] \\ & (\mathcal{B} \subset \mathcal{B}') } $$ of thickenings of algebraic stacks. Assume \begin{enumerate} \item $\mathcal{Y}' \to \mathcal{B}'$ is locally of finite type, \item $\mathcal{X}' \to \mathcal{B}'$ is flat and locally of finite presentation, \item $f$ is flat, and \item $\mathcal{X} = \mathcal{B} \times_{\mathcal{B}'} \mathcal{X}'$ and $\mathcal{Y} = \mathcal{B} \times_{\mathcal{B}'} \mathcal{Y}'$. \end{enumerate} Then $f'$ is flat and for all $y' \in |\mathcal{Y}'|$ in the image of $|f'|$ the morphism $\mathcal{Y}' \to \mathcal{B}'$ is flat at $y'$. \end{lemma} 
\begin{lemma} \label{lemma-deform-property-fp-over-ft} Consider a commutative diagram $$ \xymatrix{ (\mathcal{X} \subset \mathcal{X}') \ar[rr]_{(f, f')} \ar[rd] & & (\mathcal{Y} \subset \mathcal{Y}') \ar[ld] \\ & (\mathcal{B} \subset \mathcal{B}') } $$ of thickenings of algebraic stacks. Assume $\mathcal{Y}' \to \mathcal{B}'$ locally of finite type, $\mathcal{X}' \to \mathcal{B}'$ flat and locally of finite presentation, $\mathcal{X} = \mathcal{B} \times_{\mathcal{B}'} \mathcal{X}'$, and $\mathcal{Y} = \mathcal{B} \times_{\mathcal{B}'} \mathcal{Y}'$. Then \begin{enumerate} \item $f$ is flat if and only if $f'$ is flat, \label{item-flat-fp-over-ft} \item $f$ is an isomorphism if and only if $f'$ is an isomorphism, \label{item-isomorphism-fp-over-ft} \item $f$ is an open immersion if and only if $f'$ is an open immersion, \label{item-open-immersion-fp-over-ft} \item $f$ is a monomorphism if and only if $f'$ is a monomorphism, \label{item-monomorphism-fp-over-ft} \item $f$ is locally quasi-finite if and only if $f'$ is locally quasi-finite, \label{item-quasi-finite-fp-over-ft} \item $f$ is syntomic if and only if $f'$ is syntomic, \label{item-syntomic-fp-over-ft} \item $f$ is smooth if and only if $f'$ is smooth, \label{item-smooth-fp-over-ft} \item $f$ is unramified if and only if $f'$ is unramified, \label{item-unramified-fp-over-ft} \item $f$ is \'etale if and only if $f'$ is \'etale, \label{item-etale-fp-over-ft} \item $f$ is finite if and only if $f'$ is finite, and \label{item-finite-fp-over-ft} \item add more here. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-morphisms-lifts-etale} For any morphism (\ref{equation-morphism}) the map $f' : V' \to U'$ is \'etale. \end{lemma} 
\begin{lemma} \label{lemma-gerbe-of-lifts-fibred} The category $p : \mathcal{C} \to W_{spaces, \etale}$ constructed in Remark \ref{remark-gerbe-of-lifts} is fibred in groupoids. \end{lemma} 
\begin{lemma} \label{lemma-gerbe-of-lifts-stack} The category $p : \mathcal{C} \to W_{spaces, \etale}$ constructed in Remark \ref{remark-gerbe-of-lifts} is a stack in groupoids. \end{lemma} 
\begin{lemma} \label{lemma-etale-local-lifts} Let $\mathcal{X} \subset \mathcal{X}'$ be a thickening of algebraic stacks. Let $W$ be an algebraic space and let $W \to \mathcal{X}$ be a smooth morphism. There exists an \'etale covering $\{W_i \to W\}_{i \in I}$ and for each $i$ a cartesian diagram $$ \xymatrix{ W_i \ar[r] \ar[d] & W_i' \ar[d] \\ \mathcal{X} \ar[r] & \mathcal{X}' } $$ with $W_i' \to \mathcal{X}'$ smooth. \end{lemma} 
\begin{lemma} \label{lemma-etale-local-lifts-isomorphic} Let $\mathcal{X} \subset \mathcal{X}'$ be a thickening of algebraic stacks. Consider a commutative diagram $$ \xymatrix{ W'' \ar[d]_{x''} & W \ar[l] \ar[r] \ar[d]_x & W' \ar[d]^{x'} \\ \mathcal{X}' & \mathcal{X} \ar[l] \ar[r] & \mathcal{X}' } $$ with cartesian squares where $W', W, W''$ are algebraic spaces and the vertical arrows are smooth. Then there exist \begin{enumerate} \item an \'etale covering $\{f'_k : W'_k \to W'\}_{k \in K}$, \item \'etale morphisms $f''_k : W'_k \to W''$, and \item $2$-morphisms $\gamma_k : x'' \circ f''_k \to x' \circ f'_k$ \end{enumerate} such that (a) $(f'_k)^{-1}(W) = (f''_k)^{-1}(W)$, (b) $f'_k|_{(f'_k)^{-1}(W)} = f''_k|_{(f''_k)^{-1}(W)}$, and (c) pulling back $\gamma_k$ to the closed subscheme of (a) agrees with the $2$-morphism given by the commutativity of the initial diagram over $W$. \end{lemma} 
\begin{lemma} \label{lemma-gerbe-of-lifts} The category $p : \mathcal{C} \to W_{spaces, \etale}$ constructed in Remark \ref{remark-gerbe-of-lifts} is a gerbe. \end{lemma} 
\begin{lemma} \label{lemma-gerbe-of-lifts-first-order} In Remark \ref{remark-gerbe-of-lifts} assume $\mathcal{X} \subset \mathcal{X}'$ is a first order thickening. Then \begin{enumerate} \item the automorphism sheaves of objects of the gerbe $p : \mathcal{C} \to W_{spaces, \etale}$ constructed in Remark \ref{remark-gerbe-of-lifts} are abelian, and \item the sheaf of groups $\mathcal{G}$ constructed in Stacks, Lemma \ref{stacks-lemma-gerbe-abelian-auts} is a quasi-coherent $\mathcal{O}_W$-module. \end{enumerate} \end{lemma} 
\begin{proposition}[Emerton] \label{proposition-affine-smooth-lift-to-first-order} \begin{reference} Email of Matthew Emerton dated April 27, 2016. \end{reference} Let $\mathcal{X} \subset \mathcal{X}'$ be a first order thickening of algebraic stacks. Let $W$ be an affine scheme and let $W \to \mathcal{X}$ be a smooth morphism. Then there exists a cartesian diagram $$ \xymatrix{ W \ar[d] \ar[r] & W' \ar[d] \\ \mathcal{X} \ar[r] & \mathcal{X}' } $$ with $W' \to \mathcal{X}'$ smooth and $W'$ affine. \end{proposition} 
\begin{lemma} \label{lemma-inf-quasi-coherent} Let $\mathcal{X}$ be an algebraic stack over a scheme $S$. Assume $\mathcal{I}_\mathcal{X} \to \mathcal{X}$ is locally of finite presentation. Let $A \to B$ be a flat $S$-algebra homomorphism. Let $x$ be an object of $\mathcal{X}$ over $A$ and set $y = x|_B$. Then $\text{Inf}_x(M) \otimes_A B = \text{Inf}_y(M \otimes_A B)$. \end{lemma} 
\begin{lemma} \label{lemma-sheaf-of-infinitesimal-lifts} Let $\mathcal{X}$ be an algebraic stack over a base scheme $S$. Assume $\mathcal{I}_\mathcal{X} \to \mathcal{X}$ is locally of finite presentation. Let $(A' \to A, x)$ be a deformation situation. Then the functor $$ F : B' \longmapsto \{\text{lifts of }x|_{B' \otimes_{A'} A}\text{ to } B'\}/\text{isomorphisms} $$ is a sheaf on the site $(\textit{Aff}/\Spec(A'))_{fppf}$ of Topologies, Definition \ref{topologies-definition-big-small-fppf}. \end{lemma} 
\begin{lemma} \label{lemma-T-quasi-coherent} Let $\mathcal{X}$ be an algebraic stack over a scheme $S$ whose structure morphism $\mathcal{X} \to S$ is locally of finite presentation. Let $A \to B$ be a flat $S$-algebra homomorphism. Let $x$ be an object of $\mathcal{X}$ over $A$. Then $T_x(M) \otimes_A B = T_y(M \otimes_A B)$. \end{lemma} 
\begin{lemma} \label{lemma-local-lift-enough} Let $\mathcal{X}$ be an algebraic stack over a scheme $S$ whose structure morphism $\mathcal{X} \to S$ is locally of finite presentation. Let $(A' \to A, x)$ be a deformation situation. If there exists a faithfully flat finitely presented $A'$-algebra $B'$ and an object $y'$ of $\mathcal{X}$ over $B'$ lifting $x|_{B' \otimes_{A'} A}$, then there exists an object $x'$ over $A'$ lifting $x$. \end{lemma} 
\begin{definition} \label{definition-formally-smooth} A morphism $f : \mathcal{X} \to \mathcal{Y}$ of algebraic stacks is said to be {\it formally smooth} if it is formally smooth on objects as a $1$-morphism in categories fibred in groupoids as explained in Criteria for Representability, Section \ref{criteria-section-formally-smooth}. \end{definition} 
\begin{lemma} \label{lemma-reformulate-formal-smoothness} A morphism $f : \mathcal{X} \to \mathcal{Y}$ of algebraic stacks is formally smooth (Definition \ref{definition-formally-smooth}) if and only if for every diagram (\ref{equation-diagram}) and $\gamma$ the category of dotted arrows is nonempty. \end{lemma} 
\begin{lemma} \label{lemma-base-change-formal-smoothness} The base change of a formally smooth morphism of algebraic stacks by any morphism of algebraic stacks is formally smooth. \end{lemma} 
\begin{lemma} \label{lemma-composition-formal-smoothness} The composition of formally smooth morphisms of algebraic stacks is formally smooth. \end{lemma} 
\begin{lemma} \label{lemma-formal-smoothness-representable} Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks which is representable by algebraic spaces. Then the following are equivalent \begin{enumerate} \item $f$ is formally smooth, \item for every scheme $T$ and morphism $T \to \mathcal{Y}$ the morphism $\mathcal{X} \times_\mathcal{Y} T \to T$ is formally smooth as a morphism of algebraic spaces. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-lift-to-smooth} Let $T \to T'$ be a first order thickening of affine schemes. Let $\mathcal{X}'$ be an algebraic stack over $T'$ whose structure morphism $\mathcal{X}' \to T'$ is smooth. Let $x : T \to \mathcal{X}'$ be a morphism over $T'$. Then there exists a morphsm $x' : T' \to \mathcal{X}'$ over $T'$ with $x'|_T = x$. \end{lemma} 
\begin{lemma}[Infinitesimal lifting criterion] \label{lemma-smooth-formally-smooth} Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks. The following are equivalent: \begin{enumerate} \item The morphism $f$ is smooth. \item The morphism $f$ is locally of finite presentation and formally smooth. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-flatten-stack} Let $f : \mathcal{X} \to Y$ be a morphism from an algebraic stack to an algebraic space. Let $V \subset Y$ be an open subspace. Assume \begin{enumerate} \item $Y$ is quasi-compact and quasi-separated, \item $f$ is of finite type and quasi-separated, \item $V$ is quasi-compact, and \item $\mathcal{X}_V$ is flat and locally of finite presentation over $V$. \end{enumerate} Then there exists a $V$-admissible blowup $Y' \to Y$ and a closed substack $\mathcal{X}' \subset \mathcal{X}_{Y'}$ with $\mathcal{X}'_V = \mathcal{X}_V$ such that $\mathcal{X}' \to Y'$ is flat and of finite presentation. \end{lemma} 
\begin{lemma} \label{lemma-finite-cover-factor} Let $Y$ be a quasi-compact and quasi-separated algebraic space. Let $V \subset Y$ be a quasi-compact open. Let $f : \mathcal{X} \to V$ be surjective, flat, and locally of finite presentation. Then there exists a finite surjective morphism $g : Y' \to Y$ such that $V' = g^{-1}(V) \to Y$ factors Zariski locally through $f$. \end{lemma} 
\begin{lemma} \label{lemma-make-section} Let $f : \mathcal{X} \to Y$ be a morphism from an algebraic stack to an algebraic space. Let $V \subset Y$ be an open subspace. Assume \begin{enumerate} \item $f$ is separated and of finite type, \item $Y$ is quasi-compact and quasi-separated, \item $V$ is quasi-compact, and \item $\mathcal{X}_V$ is a gerbe over $V$. \end{enumerate} Then there exists a commutative diagram $$ \xymatrix{ \overline{Z} \ar[rd]_{\overline{g}} & Z \ar[l]^j \ar[d]_g \ar[r]_h & \mathcal{X} \ar[ld]^f \\ & Y } $$ with $j$ an open immersion, $\overline{g}$ and $h$ proper, and such that $|V|$ is contained in the image of $|g|$. \end{lemma} 
\begin{theorem}[Chow's lemma] \label{theorem-chow-finite-type} \begin{reference} This is a result due to Ofer Gabber, see \cite[Theorem 1.1]{olsson_proper} \end{reference} Let $f : \mathcal{X} \to Y$ be a morphism from an algebraic stack to an algebraic space. Assume \begin{enumerate} \item $Y$ is quasi-compact and quasi-separated, \item $f$ is separated of finite type. \end{enumerate} Then there exists a commutative diagram $$ \xymatrix{ \mathcal{X} \ar[rd] & X \ar[l] \ar[d] \ar[r] & \overline{X} \ar[ld] \\ & Y } $$ where $X \to \mathcal{X}$ is proper surjective, $X \to \overline{X}$ is an open immersion, and $\overline{X} \to Y$ is proper morphism of algebraic spaces. \end{theorem} 
\begin{lemma} \label{lemma-reach-point-closure-Noetherian} Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks. Assume $f$ finite type and $\mathcal{Y}$ locally Noetherian. Let $y \in |\mathcal{Y}|$ be a point in the closure of the image of $|f|$. Then there exists a commutative diagram $$ \xymatrix{ \Spec(K) \ar[r] \ar[d] & \mathcal{X} \ar[d]^f \\ \Spec(A) \ar[r] & \mathcal{Y} } $$ of algebraic stacks where $A$ is a discrete valuation ring and $K$ is its field of fractions mapping the closed point of $\Spec(A)$ to $y$. \end{lemma} 
\begin{lemma} \label{lemma-check-separated-dvr} Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks. Assume \begin{enumerate} \item $\mathcal{Y}$ is locally Noetherian, \item $f$ is locally of finite type and quasi-separated, \item for every commutative diagram $$ \xymatrix{ \Spec(K) \ar[r]_x \ar[d]_j & \mathcal{X} \ar[d]^f \\ \Spec(A) \ar[r]^y \ar@{-->}[ru] & \mathcal{Y} } $$ where $A$ is a discrete valuation ring and $K$ its fraction field and any $2$-arrow $\gamma : y \circ j \to f \circ x$ the category of dotted arrows (Morphisms of Stacks, Definition \ref{stacks-morphisms-definition-fill-in-diagram}) is either empty or a setoid with exactly one isomorphism class. \end{enumerate} Then $f$ is separated. \end{lemma} 
\begin{lemma} \label{lemma-refined-valuative-criterion-proper} Let $f : \mathcal{X} \to \mathcal{Y}$ and $h : \mathcal{U} \to \mathcal{X}$ be morphisms of algebraic stacks. Assume that $\mathcal{Y}$ is locally Noetherian, that $f$ and $h$ are of finite type, that $f$ is separated, and that the image of $|h| : |\mathcal{U}| \to |\mathcal{X}|$ is dense in $|\mathcal{X}|$. If given any $2$-commutative diagram $$ \xymatrix{ \Spec(K) \ar[r]_-u \ar[d]_j & \mathcal{U} \ar[r]_h & \mathcal{X} \ar[d]^f \\ \Spec(A) \ar[rr]^-y & & \mathcal{Y} } $$ where $A$ is a discrete valuation ring with field of fractions $K$ and $\gamma : y \circ j \to f \circ h \circ u$ there exist an extension $K'/K$ of fields, a valuation ring $A' \subset K'$ dominating $A$ such that the category of dotted arrows for the induced diagram $$ \xymatrix{ \Spec(K') \ar[r]_-{x'} \ar[d]_{j'} & \mathcal{X} \ar[d]^f \\ \Spec(A') \ar[r]^-{y'} \ar@{..>}[ru] & \mathcal{Y} } $$ with induced $2$-arrow $\gamma' : y' \circ j' \to f \circ x'$ is nonempty (Morphisms of Stacks, Definition \ref{stacks-morphisms-definition-fill-in-diagram}), then $f$ is proper. \end{lemma} 
\begin{lemma} \label{lemma-refined-valuative-criterion-separated} Let $f : \mathcal{X} \to \mathcal{Y}$ and $h : \mathcal{U} \to \mathcal{X}$ be morphisms of algebraic stacks. Assume that $\mathcal{Y}$ is locally Noetherian, that $f$ is locally of finite type and quasi-separated, that $h$ is of finite type, and that the image of $|h| : |\mathcal{U}| \to |\mathcal{X}|$ is dense in $|\mathcal{X}|$. If given any $2$-commutative diagram $$ \xymatrix{ \Spec(K) \ar[r]_-u \ar[d]_j & \mathcal{U} \ar[r]_h & \mathcal{X} \ar[d]^f \\ \Spec(A) \ar[rr]^-y \ar@{..>}[rru] & & \mathcal{Y} } $$ where $A$ is a discrete valuation ring with field of fractions $K$ and $\gamma : y \circ j \to f \circ h \circ u$, the category of dotted arrows is either empty or a setoid with exactly one isomorphism class, then $f$ is separated. \end{lemma} 
\begin{lemma} \label{lemma-valuative-criterion-universally-closed} Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks. Assume that $\mathcal{Y}$ is locally Noetherian and that $f$ is of finite type. If given any $2$-commutative diagram $$ \xymatrix{ \Spec(K) \ar[r]_-x \ar[d]_j & \mathcal{X} \ar[d]^f \\ \Spec(A) \ar[r]^-y & \mathcal{Y} } $$ where $A$ is a discrete valuation ring with field of fractions $K$ and $\gamma : y \circ j \to f \circ x$ there exist an extension $K'/K$ of fields, a valuation ring $A' \subset K'$ dominating $A$ such that the category of dotted arrows for the induced diagram $$ \xymatrix{ \Spec(K') \ar[r]_-{x'} \ar[d]_{j'} & \mathcal{X} \ar[d]^f \\ \Spec(A') \ar[r]^-{y'} \ar@{..>}[ru] & \mathcal{Y} } $$ with induced $2$-arrow $\gamma' : y' \circ j' \to f \circ x'$ is nonempty (Morphisms of Stacks, Definition \ref{stacks-morphisms-definition-fill-in-diagram}), then $f$ is universally closed. \end{lemma} 
\begin{definition} \label{definition-categorical-quotient} Let $\mathcal{X}$ be an algebraic stack. Let $f : \mathcal{X} \to Y$ be a morphism to an algebraic space $Y$. \begin{enumerate} \item We say $f$ is a {\it categorical moduli space} if any morphism $\mathcal{X} \to W$ to an algebraic space $W$ factors uniquely through $f$. \item We say $f$ is a {\it uniform categorical moduli space} if for any flat morphism $Y' \to Y$ of algebraic spaces the base change $f' : Y' \times_Y \mathcal{X} \to Y'$ is a categorical moduli space. \end{enumerate} Let $\mathcal{C}$ be a full subcategory of the category of algebraic spaces. \begin{enumerate} \item[(3)] We say $f$ is a {\it categorical moduli space in $\mathcal{C}$} if $Y \in \Ob(\mathcal{C})$ and any morphism $\mathcal{X} \to W$ with $W \in \Ob(\mathcal{C})$ factors uniquely through $f$. \item[(4)] We say is a {\it uniform categorical moduli space in $\mathcal{C}$} if $Y \in \Ob(\mathcal{C})$ and for every flat morphism $Y' \to Y$ in $\mathcal{C}$ the base change $f' : Y' \times_Y \mathcal{X} \to Y'$ is a categorical moduli space in $\mathcal{C}$. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-quotient-compare} Let $(U, R, s, t, c)$ be a groupoid in algebraic spaces with $s, t : R \to U$ flat and locally of finite presentation. Consider the algebraic stack $\mathcal{X} = [U/R]$. Given an algebraic space $Y$ there is a $1$-to-$1$ correspondence between morphisms $f : \mathcal{X} \to Y$ and $R$-invariant morphisms $\phi : U \to Y$. \end{lemma} 
\begin{lemma} \label{lemma-categorical-quotient-compare} With assumption and notation as in Lemma \ref{lemma-quotient-compare}. Then $f$ is a (uniform) categorical moduli space if and only if $\phi$ is a (uniform) categorical quotient. Similarly for moduli spaces in a full subcategory. \end{lemma} 
\begin{lemma} \label{lemma-check-uniform-categorical-quotient-on-affines} Let $f : \mathcal{X} \to Y$ be a morphism from an algebraic stack to an algebraic space. If for every affine scheme $Y'$ and flat morphism $Y' \to Y$ the base change $f' : Y' \times_Y \mathcal{X} \to Y'$ is a categorical moduli space, then $f$ is a uniform categorical moduli space. \end{lemma} 
\begin{definition} \label{definition-well-nigh-affine} Let $\mathcal{X}$ be an algebraic stack. We say $\mathcal{X}$ is {\it well-nigh affine} if there exists an affine scheme $U$ and a surjective, flat, finite, and finitely presented morphism $U \to \mathcal{X}$. \end{definition} 
\begin{lemma} \label{lemma-well-nigh-affine} Let $\mathcal{X}$ be an algebraic stack. The following are equivalent \begin{enumerate} \item $\mathcal{X}$ is well-nigh affine, and \item there exists a groupoid scheme $(U, R, s, t, c)$ with $U$ and $R$ affine and $s, t : R \to U$ finite locally free such that $\mathcal{X} = [U/R]$. \end{enumerate} If true then $\mathcal{X}$ is quasi-compact, quasi-DM, and separated. \end{lemma} 
\begin{lemma} \label{lemma-affine-over-well-nigh-affine} Let the algebraic stack $\mathcal{X}$ be well-nigh affine. \begin{enumerate} \item If $\mathcal{X}$ is an algebraic space, then it is affine. \item If $\mathcal{X}' \to \mathcal{X}$ is an affine morphism of algebraic stacks, then $\mathcal{X}'$ is well-nigh affine. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-well-nigh-affine-moduli-space} Let the algebraic stack $\mathcal{X}$ be well-nigh affine. There exists a uniform categorical moduli space $$ f : \mathcal{X} \longrightarrow M $$ in the category of affine schemes. Moreover $f$ is separated, quasi-compact, and a universal homeomorphism. \end{lemma} 
\begin{lemma} \label{lemma-well-nigh-affine-moduli-space-etale} Let $h : \mathcal{X}' \to \mathcal{X}$ be a morphism of algebraic stacks. Assume $\mathcal{X}'$ and $\mathcal{X}$ are well-nigh affine, $h$ is \'etale, and $h$ induces isomorphisms on automorphism groups (Morphisms of Stacks, Remark \ref{stacks-morphisms-remark-identify-automorphism-groups}). Then there exists a cartesian diagram $$ \xymatrix{ \mathcal{X}' \ar[d] \ar[r] & \mathcal{X} \ar[d] \\ M' \ar[r] & M } $$ where $M' \to M$ is \'etale and the vertical arrows are the moduli spaces constructed in Lemma \ref{lemma-well-nigh-affine-moduli-space}. \end{lemma} 
\begin{lemma} \label{lemma-moduli-space-finite-affine} Let the algebraic stack $\mathcal{X}$ be well-nigh affine. The morphism $$ f : \mathcal{X} \longrightarrow M $$ of Lemma \ref{lemma-well-nigh-affine-moduli-space} is a uniform categorical moduli space. \end{lemma} 
\begin{lemma} \label{lemma-etale-separated-over-well-nigh-affine} Let $h : \mathcal{X}' \to \mathcal{X}$ be a morphism of algebraic stacks. Assume $\mathcal{X}$ is well-nigh affine, $h$ is \'etale, $h$ is separated, and $h$ induces isomorphisms on automorphism groups (Morphisms of Stacks, Remark \ref{stacks-morphisms-remark-identify-automorphism-groups}). Then there exists a cartesian diagram $$ \xymatrix{ \mathcal{X}' \ar[d] \ar[r] & \mathcal{X} \ar[d] \\ M' \ar[r] & M } $$ where $M' \to M$ is a separated \'etale morphism of schemes and $\mathcal{X} \to M$ is the moduli space constructed in Lemma \ref{lemma-well-nigh-affine-moduli-space}. \end{lemma} 
\begin{lemma} \label{lemma-etale-local-finite-inertia} Let $\mathcal{X}$ be an algebraic stack. Assume $\mathcal{I}_\mathcal{X} \to \mathcal{X}$ is finite. Then there exist a set $I$ and for $i \in I$ a morphism of algebraic stacks $$ g_i : \mathcal{X}_i \longrightarrow \mathcal{X} $$ with the following properties \begin{enumerate} \item $|\mathcal{X}| = \bigcup |g_i|(|\mathcal{X}_i|)$, \item $\mathcal{X}_i$ is well-nigh affine, \item $\mathcal{I}_{\mathcal{X}_i} \to \mathcal{X}_i \times_\mathcal{X} \mathcal{I}_\mathcal{X}$ is an isomorphism, and \item $g_i : \mathcal{X}_i \to \mathcal{X}$ is representable by algebraic spaces, separated, and \'etale, \end{enumerate} \end{lemma} 
\begin{theorem}[Keel-Mori] \label{theorem-keel-mori} Let $\mathcal{X}$ be an algebraic stack. Assume $\mathcal{I}_\mathcal{X} \to \mathcal{X}$ is finite. Then there exists a uniform categorical moduli space $$ f : \mathcal{X} \longrightarrow M $$ and $f$ is separated, quasi-compact, and a universal homeomorphism. \end{theorem} 
\begin{lemma} \label{lemma-etale-separated-over-keel-mori} Let $h : \mathcal{X}' \to \mathcal{X}$ be a morphism of algebraic stacks. Assume \begin{enumerate} \item $\mathcal{I}_\mathcal{X} \to \mathcal{X}$ is finite, \item $h$ is \'etale, separated, and induces isomorphisms on automorphism groups (Morphisms of Stacks, Remark \ref{stacks-morphisms-remark-identify-automorphism-groups}). \end{enumerate} Then there exists a cartesian diagram $$ \xymatrix{ \mathcal{X}' \ar[d] \ar[r] & \mathcal{X} \ar[d] \\ M' \ar[r] & M } $$ where $M' \to M$ is a separated \'etale morphism of algebraic spaces and the vertical arrows are the moduli spaces constructed in Theorem \ref{theorem-keel-mori}. \end{lemma} 
\begin{lemma} \label{lemma-keel-mori-finite-type} Let $p : \mathcal{X} \to Y$ be a morphism of an algebraic stack to an algebraic space. Assume \begin{enumerate} \item $\mathcal{I}_\mathcal{X} \to \mathcal{X}$ is finite, \item $Y$ is locally Noetherian, and \item $p$ is locally of finite type. \end{enumerate} Let $f : \mathcal{X} \to M$ be the moduli space constructed in Theorem \ref{theorem-keel-mori}. Then $M \to Y$ is locally of finite type. \end{lemma} 
\begin{lemma} \label{lemma-keel-mori-diagonal} Let $\mathcal{X}$ be an algebraic stack. Assume $\mathcal{I}_\mathcal{X} \to \mathcal{X}$ is finite. Let $f : \mathcal{X} \to M$ be the moduli space constructed in Theorem \ref{theorem-keel-mori}. \begin{enumerate} \item If $\mathcal{X}$ is quasi-separated, then $M$ is quasi-separated. \item If $\mathcal{X}$ is separated, then $M$ is separated. \item Add more here, for example relative versions of the above. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-keel-mori-proper} Let $p : \mathcal{X} \to Y$ be a morphism from an algebraic stack to an algebraic space. Assume \begin{enumerate} \item $\mathcal{I}_\mathcal{X} \to \mathcal{X}$ is finite, \item $p$ is proper, and \item $Y$ is locally Noetherian. \end{enumerate} Let $f : \mathcal{X} \to M$ be the moduli space constructed in Theorem \ref{theorem-keel-mori}. Then $M \to Y$ is proper. \end{lemma} 
\begin{proposition} \label{proposition-stack-fpqc} \begin{reference} Proposition 3.3.6 of ``Intro to Algebraic Stacks'' by Anatoly Preygel. \end{reference} Let $\mathcal{X}$ be an algebraic stack with quasi-affine\footnote{It suffices to assume ind-quasi-affine.} diagonal. Then $\mathcal{X}$ satisfies descent for fpqc coverings. \end{proposition} 
\begin{lemma} \label{lemma-extend} Let $\mathcal{X}$ and $\mathcal{Y}$ be Noetherian algebraic stacks. Any right exact tensor functor $F : \textit{Coh}(\mathcal{O}_\mathcal{X}) \to \textit{Coh}(\mathcal{O}_\mathcal{Y})$ extends uniquely to a right exact tensor functor $F : \QCoh(\mathcal{O}_\mathcal{X}) \to \QCoh(\mathcal{O}_\mathcal{Y})$ commuting with all colimits. \end{lemma} 
\begin{lemma} \label{lemma-affine} Let $\mathcal{X}$ be an algebraic stack with affine diagonal. Let $B$ be a ring. Let $F : \QCoh(\mathcal{O}_\mathcal{X}) \to \text{Mod}_B$ be a right exact tensor functor which commutes with direct sums. Let $g : U \to \mathcal{X}$ be a morphism with $U = \Spec(A)$ affine. Then \begin{enumerate} \item $C = F(g_{\QCoh, *}\mathcal{O}_U)$ is a commutative $B$-algebra and \item there is a ring map $A \to C$ \end{enumerate} such that $F \circ g_{\QCoh, *} : \text{Mod}_A \to \text{Mod}_B$ sends $M$ to $M \otimes_A C$ seen as $B$-module. \end{lemma} 
\begin{lemma} \label{lemma-universally-injective} Notation as in Lemma \ref{lemma-affine}. Assume $\mathcal{X}$ is Noetherian and $g$ is surjective and flat. Then $B \to C$ is universally injective. \end{lemma} 
\begin{lemma} \label{lemma-flat} Let $B \to C$ be a ring map. If \begin{enumerate} \item the coprojections $C \to C \otimes_B C$ are flat and \item $B \to C$ is universally injective, \end{enumerate} then $B \to C$ is faithfully flat. \end{lemma} 
\begin{lemma} \label{lemma-easy-kunneth} Let $a : \mathcal{Y} \to \mathcal{X}$ and $b : \mathcal{Z} \to \mathcal{X}$ be representable by schemes, quasi-compact, quasi-separated, and flat. Then $a_{\QCoh, *}\mathcal{O}_\mathcal{Y} \otimes_{\mathcal{O}_\mathcal{X}} b_{\QCoh, *}\mathcal{O}_\mathcal{Z} = f_{\QCoh, *}\mathcal{O}_{\mathcal{Y} \times_\mathcal{X} \mathcal{Z}}$ where $f : \mathcal{Y} \times_\mathcal{X} \mathcal{Z} \to \mathcal{X}$ is the obvious morphism. \end{lemma} 
\begin{lemma} \label{lemma-fully-faithful} Let $\mathcal{X}$ be an algebraic stack with affine diagonal. Let $B$ be a ring. Let $f_i : \Spec(B) \to \mathcal{X}$, $i = 1, 2$ be two morphisms. Let $t : f_1^* \to f_2^*$ be an isomorphism of the tensor functors $f_i^* : \QCoh(\mathcal{O}_\mathcal{X}) \to \text{Mod}_B$. Then there is a $2$-arrow $f_1 \to f_2$ inducing $t$. \end{lemma} 
\begin{lemma} \label{lemma-main} Let $\mathcal{X}$ be a Noetherian algebraic stack with affine diagonal. Let $B$ be a ring. Let $F : \QCoh(\mathcal{O}_\mathcal{X}) \to \text{Mod}_B$ be a right exact tensor functor which commutes with direct sums. Then $F$ comes from a unique morphism $\Spec(B) \to \mathcal{X}$. \end{lemma} 
\begin{theorem} \label{theorem-main} Let $\mathcal{X}$ be a Noetherian algebraic stack with affine diagonal. Let $B$ be a Noetherian ring. Let $F : \text{Coh}(\mathcal{O}_\mathcal{X}) \to \text{Mod}^{fg}_B$ be a right exact tensor functor. Then $F$ comes from a unique morphism $\Spec(B) \to \mathcal{X}$. \end{theorem} 
