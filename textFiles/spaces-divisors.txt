\begin{lemma} \label{lemma-associated} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. Let $x \in |X|$. The following are equivalent \begin{enumerate} \item for some \'etale morphism $f : U \to X$ with $U$ a scheme and $u \in U$ mapping to $x$, the point $u$ is weakly associated to $f^*\mathcal{F}$, \item for every \'etale morphism $f : U \to X$ with $U$ a scheme and $u \in U$ mapping to $x$, the point $u$ is weakly associated to $f^*\mathcal{F}$, \item the maximal ideal of $\mathcal{O}_{X, \overline{x}}$ is a weakly associated prime of the stalk $\mathcal{F}_{\overline{x}}$. \end{enumerate} If $X$ is locally Noetherian, then these are also equivalent to \begin{enumerate} \item[(4)] for some \'etale morphism $f : U \to X$ with $U$ a scheme and $u \in U$ mapping to $x$, the point $u$ is associated to $f^*\mathcal{F}$, \item[(5)] for every \'etale morphism $f : U \to X$ with $U$ a scheme and $u \in U$ mapping to $x$, the point $u$ is associated to $f^*\mathcal{F}$, \item[(6)] the maximal ideal of $\mathcal{O}_{X, \overline{x}}$ is an associated prime of the stalk $\mathcal{F}_{\overline{x}}$. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-weakly-associated} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{F}$ be a quasi-coherent sheaf on $X$. Let $x \in |X|$. \begin{enumerate} \item We say $x$ is {\it weakly associated} to $\mathcal{F}$ if the equivalent conditions (1), (2), and (3) of Lemma \ref{lemma-associated} are satisfied. \item We denote $\text{WeakAss}(\mathcal{F})$ the set of weakly associated points of $\mathcal{F}$. \item The {\it weakly associated points of $X$} are the weakly associated points of $\mathcal{O}_X$. \end{enumerate} If $X$ is locally Noetherian we will say {\it $x$ is associated to $\mathcal{F}$} if and only if $x$ is weakly associated to $\mathcal{F}$ and we set $\text{Ass}(\mathcal{F}) = \text{WeakAss}(\mathcal{F})$. Finally (still assuming $X$ is locally Noetherian), we will say {\it $x$ is an associated point of $X$} if and only if $x$ is a weakly associated point of $X$. \end{definition} 
\begin{lemma} \label{lemma-weakly-ass-support} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. Then $\text{WeakAss}(\mathcal{F}) \subset \text{Supp}(\mathcal{F})$. \end{lemma} 
\begin{lemma} \label{lemma-ses-weakly-ass} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $0 \to \mathcal{F}_1 \to \mathcal{F}_2 \to \mathcal{F}_3 \to 0$ be a short exact sequence of quasi-coherent sheaves on $X$. Then $\text{WeakAss}(\mathcal{F}_2) \subset \text{WeakAss}(\mathcal{F}_1) \cup \text{WeakAss}(\mathcal{F}_3)$ and $\text{WeakAss}(\mathcal{F}_1) \subset \text{WeakAss}(\mathcal{F}_2)$. \end{lemma} 
\begin{lemma} \label{lemma-weakly-ass-zero} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. Then $$ \mathcal{F} = (0) \Leftrightarrow \text{WeakAss}(\mathcal{F}) = \emptyset $$ \end{lemma} 
\begin{lemma} \label{lemma-minimal-support-in-weakly-ass} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. Let $x \in |X|$. If \begin{enumerate} \item $x \in \text{Supp}(\mathcal{F})$ \item $x$ is a codimension $0$ point of $X$ (Properties of Spaces, Definition \ref{spaces-properties-definition-dimension-local-ring}). \end{enumerate} Then $x \in \text{WeakAss}(\mathcal{F})$. If $\mathcal{F}$ is a finite type $\mathcal{O}_X$-module with scheme theoretic support $Z$ (Morphisms of Spaces, Definition \ref{spaces-morphisms-definition-scheme-theoretic-support}) and $x$ is a codimension $0$ point of $Z$, then $x \in \text{WeakAss}(\mathcal{F})$. \end{lemma} 
\begin{lemma} \label{lemma-minimal-support-in-weakly-ass-decent} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. Let $x \in |X|$. If \begin{enumerate} \item $X$ is decent (for example quasi-separated or locally separated), \item $x \in \text{Supp}(\mathcal{F})$ \item $x$ is not a specialization of another point in $\text{Supp}(\mathcal{F})$. \end{enumerate} Then $x \in \text{WeakAss}(\mathcal{F})$. \end{lemma} 
\begin{lemma} \label{lemma-finite-ass} Let $S$ be a scheme. Let $X$ be a locally Noetherian algebraic space over $S$. Let $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module. Then $\text{Ass}(\mathcal{F}) \cap W$ is finite for every quasi-compact open $W \subset |X|$. \end{lemma} 
\begin{lemma} \label{lemma-restriction-injective-open-contains-weakly-ass} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. If $U \to X$ is an \'etale morphism such that $\text{WeakAss}(\mathcal{F}) \subset \Im(|U| \to |X|)$, then $\Gamma(X, \mathcal{F}) \to \Gamma(U, \mathcal{F})$ is injective. \end{lemma} 
\begin{lemma} \label{lemma-weakass-pushforward} Let $S$ be a scheme. Let $f : X \to Y$ be a quasi-compact and quasi-separated morphism of algebraic spaces over $S$. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. Let $y \in |Y|$ be a point which is not in the image of $|f|$. Then $y$ is not weakly associated to $f_*\mathcal{F}$. \end{lemma} 
\begin{lemma} \label{lemma-check-injective-on-weakass} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\varphi : \mathcal{F} \to \mathcal{G}$ be a map of quasi-coherent $\mathcal{O}_X$-modules. Assume that for every $x \in |X|$ at least one of the following happens \begin{enumerate} \item $\mathcal{F}_{\overline{x}} \to \mathcal{G}_{\overline{x}}$ is injective, or \item $x \not \in \text{WeakAss}(\mathcal{F})$. \end{enumerate} Then $\varphi$ is injective. \end{lemma} 
\begin{lemma} \label{lemma-weakass-reduced} Let $S$ be a scheme. Let $X$ be a reduced algebraic space over $S$. Then the weakly associated point of $X$ are exactly the codimension $0$ points of $X$. \end{lemma} 
\begin{lemma} \label{lemma-weakly-ass-reverse-functorial} Let $S$ be a scheme. Let $f : X \to Y$ be an affine morphism of algebraic spaces over $S$. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. Then we have $$ \text{WeakAss}_S(f_*\mathcal{F}) \subset f(\text{WeakAss}_X(\mathcal{F})) $$ \end{lemma} 
\begin{lemma} \label{lemma-ass-functorial-equal} Let $S$ be a scheme. Let $f : X \to Y$ be an affine morphism of algebraic spaces over $S$. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. If $X$ is locally Noetherian, then we have $$ \text{WeakAss}_Y(f_*\mathcal{F}) = f(\text{WeakAss}_X(\mathcal{F})) $$ \end{lemma} 
\begin{lemma} \label{lemma-weakly-associated-finite} Let $S$ be a scheme. Let $f : X \to Y$ be a finite morphism of algebraic spaces over $S$. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. Then $\text{WeakAss}(f_*\mathcal{F}) = f(\text{WeakAss}(\mathcal{F}))$. \end{lemma} 
\begin{lemma} \label{lemma-weakly-ass-pullback} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces over $S$. Let $\mathcal{G}$ be a quasi-coherent $\mathcal{O}_Y$-module. Let $x \in |X|$ and $y = f(x) \in |Y|$. If \begin{enumerate} \item $y \in \text{WeakAss}_S(\mathcal{G})$, \item $f$ is flat at $x$, and \item the dimension of the local ring of the fibre of $f$ at $x$ is zero (Morphisms of Spaces, Definition \ref{spaces-morphisms-definition-dimension-fibre}), \end{enumerate} then $x \in \text{WeakAss}(f^*\mathcal{G})$. \end{lemma} 
\begin{lemma} \label{lemma-weakly-ass-change-fields} Let $K/k$ be a field extension. Let $X$ be an algebraic space over $k$. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. Let $y \in X_K$ with image $x \in X$. If $y$ is a weakly associated point of the pullback $\mathcal{F}_K$, then $x$ is a weakly associated point of $\mathcal{F}$. \end{lemma} 
\begin{lemma} \label{lemma-finite-flat-weak-assassin-up-down} Let $S$ be a scheme. Let $f : X \to Y$ be a finite flat morphism of algebraic spaces. Let $\mathcal{G}$ be a quasi-coherent $\mathcal{O}_Y$-module. Let $x \in |X|$ be a point with image $y \in |Y|$. Then $$ x \in \text{WeakAss}(g^*\mathcal{G}) \Leftrightarrow y \in \text{WeakAss}(\mathcal{G}) $$ \end{lemma} 
\begin{lemma} \label{lemma-etale-weak-assassin-up-down} Let $S$ be a scheme. Let $f : X \to Y$ be an \'etale morphism of algebraic spaces. Let $\mathcal{G}$ be a quasi-coherent $\mathcal{O}_Y$-module. Let $x \in |X|$ be a point with image $y \in |Y|$. Then $$ x \in \text{WeakAss}(f^*\mathcal{G}) \Leftrightarrow y \in \text{WeakAss}(\mathcal{G}) $$ \end{lemma} 
\begin{lemma} \label{lemma-locally-noetherian-fibre} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces over $S$. Let $y \in |Y|$. The following are equivalent \begin{enumerate} \item for some scheme $V$, point $v \in V$, and \'etale morphism $V \to Y$ mapping $v$ to $y$, the algebraic space $X_v$ is locally Noetherian, \item for every scheme $V$, point $v \in V$, and \'etale morphism $V \to Y$ mapping $v$ to $y$, the algebraic space $X_v$ is locally Noetherian, and \item there exists a field $k$ and a morphism $\Spec(k) \to Y$ representing $y$ such that $X_k$ is locally Noetherian. \end{enumerate} If there exists a field $k_0$ and a monomorphism $\Spec(k_0) \to Y$ representing $y$, then these are also equivalent to \begin{enumerate} \item[(4)] the algebraic space $X_{k_0}$ is locally Noetherian. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-locally-Noetherian-fibre} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces over $S$. Let $y \in |Y|$. We say {\it the fibre of $f$ over $y$ is locally Noetherian} if the equivalent conditions (1), (2), and (3) of Lemma \ref{lemma-locally-noetherian-fibre} are satisfied. We say {\it the fibres of $f$ are locally Noetherian} if this holds for every $y \in |Y|$. \end{definition} 
\begin{lemma} \label{lemma-locally-finite-type-locally-Noetherian-fibres} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces over $S$. If $f$ is locally of finite type, then  the fibres of $f$ are locally Noetherian. \end{lemma} 
\begin{lemma} \label{lemma-relative-assassin} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces over $S$. Let $x \in |X|$ and $y = f(x) \in |Y|$. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. Consider commutative diagrams $$ \xymatrix{ X \ar[d] & X \times_Y V \ar[d] \ar[l] & X_v \ar[d] \ar[l] \\ Y & V \ar[l] & v \ar[l] } \quad \xymatrix{ X \ar[d] & U \ar[d] \ar[l] & U_v \ar[d] \ar[l] \\ Y & V \ar[l] & v \ar[l] } \quad \xymatrix{ x \ar@{|->}[d] & x' \ar@{|->}[d] \ar@{|->}[l] & u \ar@{|->}[ld] \ar@{|->}[l] \\ y & v \ar@{|->}[l] } $$ where $V$ and $U$ are schemes, $V \to Y$ and $U \to X \times_Y V$ are \'etale, $v \in V$, $x' \in |X_v|$, $u \in U$ are points related as in the last diagram. Denote $\mathcal{F}|_{X_v}$ and $\mathcal{F}|_{U_v}$ the pullbacks of $\mathcal{F}$. The following are equivalent \begin{enumerate} \item for some $V, v, x'$ as above $x'$ is a weakly associated point of $\mathcal{F}|_{X_v}$, \item for every $V \to Y, v, x'$ as above $x'$ is a weakly associated point of $\mathcal{F}|_{X_v}$, \item for some $U, V, u, v$ as above $u$ is a weakly associated point of $\mathcal{F}|_{U_v}$, \item for every $U, V, u, v$ as above $u$ is a weakly associated point of $\mathcal{F}|_{U_v}$, \item for some field $k$ and morphism $\Spec(k) \to Y$ representing $y$ and some $t \in |X_k|$ mapping to $x$, the point $t$ is a weakly associated point of $\mathcal{F}|_{X_k}$. \end{enumerate} If there exists a field $k_0$ and a monomorphism $\Spec(k_0) \to Y$ representing $y$, then these are also equivalent to \begin{enumerate} \item[(6)] $x_0$ is a weakly associated point of $\mathcal{F}|_{X_{k_0}}$ where $x_0 \in |X_{k_0}|$ is the unique point mapping to $x$. \end{enumerate} If the fibre of $f$ over $y$ is locally Noetherian, then in conditions (1), (2), (3), (4), and (6) we may replace ``weakly associated'' with ``associated''. \end{lemma} 
\begin{definition} \label{definition-relative-weak-assassin} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces over $S$. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. The {\it relative weak assassin of $\mathcal{F}$ in $X$ over $Y$} is the set $\text{WeakAss}_{X/Y}(\mathcal{F}) \subset |X|$ consisting of those $x \in |X|$ such that the equivalent conditions of Lemma \ref{lemma-relative-assassin} are satisfied. If the fibres of $f$ are locally Noetherian (Definition \ref{definition-locally-Noetherian-fibre}) then we use the notation $\text{Ass}_{X/Y}(\mathcal{F})$. \end{definition} 
\begin{lemma} \label{lemma-bourbaki} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces over $S$. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. Let $\mathcal{G}$ be a quasi-coherent $\mathcal{O}_Y$-module. Assume \begin{enumerate} \item $\mathcal{F}$ is flat over $Y$, \item $X$ and $Y$ are locally Noetherian, and \item the fibres of $f$ are locally Noetherian. \end{enumerate} Then $$ \text{Ass}_X(\mathcal{F} \otimes_{\mathcal{O}_X} f^*\mathcal{G}) = \{x \in \text{Ass}_{X/Y}(\mathcal{F})\text{ such that } f(x) \in \text{Ass}_Y(\mathcal{G}) \} $$ \end{lemma} 
\begin{lemma} \label{lemma-base-change-relative-assassin} Let $S$ be a scheme. Let $$ \xymatrix{ X' \ar[d]_{f'} \ar[r]_{g'} & X \ar[d]^f \\ Y' \ar[r]^g & Y } $$ be a cartesian diagram of algebraic spaces over $S$. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module and set $\mathcal{F}' = (g')^*\mathcal{F}$. If $f$ is locally of finite type, then \begin{enumerate} \item $x' \in \text{Ass}_{X'/Y'}(\mathcal{F}') \Rightarrow g'(x') \in \text{Ass}_{X/Y}(\mathcal{F})$ \item if $x \in \text{Ass}_{X/Y}(\mathcal{F})$, then given $y' \in |Y'|$ with $f(x) = g(y')$, there exists an $x' \in \text{Ass}_{X'/Y'}(\mathcal{F}')$ with $g'(x') = x$ and $f'(x') = y'$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-base-change-relative-assassin-quasi-finite} With notation and assumptions as in Lemma \ref{lemma-base-change-relative-assassin}. Assume $g$ is locally quasi-finite, or more generally that for every $y' \in |Y'|$ the transcendence degree of $y'/g(y')$ is $0$. Then $\text{Ass}_{X'/Y'}(\mathcal{F}')$ is the inverse image of $\text{Ass}_{X/Y}(\mathcal{F})$. \end{lemma} 
\begin{lemma} \label{lemma-relative-weak-assassin-finite} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces over $S$. Let $i : Z \to X$ be a finite morphism. Let $\mathcal{G}$ be a quasi-coherent $\mathcal{O}_Z$-module. Then $\text{WeakAss}_{X/Y}(i_*\mathcal{G}) = i(\text{WeakAss}_{Z/Y}(\mathcal{G}))$. \end{lemma} 
\begin{lemma} \label{lemma-relative-assassin-constructible} Let $Y$ be a scheme. Let $X$ be an algebraic space of finite presentation over $Y$. Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module of finite presentation. Let $U \subset X$ be an open subspace such that $U \to Y$ is quasi-compact. Then the set $$ E = \{y \in Y \mid \text{Ass}_{X_y}(\mathcal{F}_y) \subset |U_y|\} $$ is locally constructible in $Y$. \end{lemma} 
\begin{lemma} \label{lemma-base-change-fitting-ideal} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces over $S$. Let $\mathcal{F}$ be a finite type, quasi-coherent $\mathcal{O}_Y$-module. Then $f^{-1}\text{Fit}_i(\mathcal{F}) \cdot \mathcal{O}_X = \text{Fit}_i(f^*\mathcal{F})$. \end{lemma} 
\begin{lemma} \label{lemma-fitting-ideal-of-finitely-presented} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{F}$ be a finitely presented $\mathcal{O}_X$-module. Then $\text{Fit}_r(\mathcal{F})$ is a quasi-coherent ideal of finite type. \end{lemma} 
\begin{lemma} \label{lemma-on-subscheme-cut-out-by-Fit-0} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{F}$ be a finite type, quasi-coherent $\mathcal{O}_X$-module. Let $Z_0 \subset X$ be the closed subspace cut out by $\text{Fit}_0(\mathcal{F})$. Let $Z \subset X$ be the scheme theoretic support of $\mathcal{F}$. Then \begin{enumerate} \item $Z \subset Z_0 \subset X$ as closed subspaces, \item $|Z| = |Z_0| = \text{Supp}(\mathcal{F})$ as closed subsets of $|X|$, \item there exists a finite type, quasi-coherent $\mathcal{O}_{Z_0}$-module $\mathcal{G}_0$ with $$ (Z_0 \to X)_*\mathcal{G}_0 = \mathcal{F}. $$ \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-fitting-ideal-generate-locally} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{F}$ be a finite type, quasi-coherent $\mathcal{O}_X$-module. Let $x \in |X|$. Then $\mathcal{F}$ can be generated by $r$ elements in an \'etale neighbourhood of $x$ if and only if $\text{Fit}_r(\mathcal{F})_{\overline{x}} = \mathcal{O}_{X, \overline{x}}$. \end{lemma} 
\begin{lemma} \label{lemma-fitting-ideal-finite-locally-free} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{F}$ be a finite type, quasi-coherent $\mathcal{O}_X$-module. Let $r \geq 0$. The following are equivalent \begin{enumerate} \item $\mathcal{F}$ is finite locally free of rank $r$ \item $\text{Fit}_{r - 1}(\mathcal{F}) = 0$ and $\text{Fit}_r(\mathcal{F}) = \mathcal{O}_X$, and \item $\text{Fit}_k(\mathcal{F}) = 0$ for $k < r$ and $\text{Fit}_k(\mathcal{F}) = \mathcal{O}_X$ for $k \geq r$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-locally-free-rank-r-pullback} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{F}$ be a finite type, quasi-coherent $\mathcal{O}_X$-module. The closed subspaces $$ X = Z_{-1} \supset Z_0 \supset Z_1 \supset Z_2 \ldots $$ defined by the Fitting ideals of $\mathcal{F}$ have the following properties \begin{enumerate} \item The intersection $\bigcap Z_r$ is empty. \item The functor $(\Sch/X)^{opp} \to \textit{Sets}$ defined by the rule $$ T \longmapsto \left\{ \begin{matrix} \{*\} & \text{if }\mathcal{F}_T\text{ is locally generated by } \leq r\text{ sections} \\ \emptyset & \text{otherwise} \end{matrix} \right. $$ is representable by the open subspace $X \setminus Z_r$. \item The functor $F_r : (\Sch/X)^{opp} \to \textit{Sets}$ defined by the rule $$ T \longmapsto \left\{ \begin{matrix} \{*\} & \text{if }\mathcal{F}_T\text{ locally free rank }r\\ \emptyset & \text{otherwise} \end{matrix} \right. $$ is representable by the locally closed subspace $Z_{r - 1} \setminus Z_r$ of $X$. \end{enumerate} If $\mathcal{F}$ is of finite presentation, then $Z_r \to X$, $X \setminus Z_r \to X$, and $Z_{r - 1} \setminus Z_r \to X$ are of finite presentation. \end{lemma} 
\begin{lemma} \label{lemma-finite-presentation-module} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{F}$ be an $\mathcal{O}_X$-module of finite presentation. Let $X = Z_{-1} \subset Z_0 \subset Z_1 \subset \ldots$ be as in Lemma \ref{lemma-locally-free-rank-r-pullback}. Set $X_r = Z_{r - 1} \setminus Z_r$. Then $X' = \coprod_{r \geq 0} X_r$ represents the functor $$ F_{flat} : \Sch/X \longrightarrow \textit{Sets},\quad\quad T \longmapsto \left\{ \begin{matrix} \{*\} & \text{if }\mathcal{F}_T\text{ flat over }T\\ \emptyset & \text{otherwise} \end{matrix} \right. $$ Moreover, $\mathcal{F}|_{X_r}$ is locally free of rank $r$ and the morphisms $X_r \to X$ and $X' \to X$ are of finite presentation. \end{lemma} 
\begin{definition} \label{definition-effective-Cartier-divisor} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. \begin{enumerate} \item A {\it locally principal closed subspace} of $X$ is a closed subspace whose sheaf of ideals is locally generated by $1$ element. \item An {\it effective Cartier divisor} on $X$ is a closed subspace $D \subset X$ such that the ideal sheaf $\mathcal{I}_D \subset \mathcal{O}_X$ is an invertible $\mathcal{O}_X$-module. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-characterize-effective-Cartier-divisor} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $D \subset X$ be a closed subspace. The following are equivalent: \begin{enumerate} \item The subspace $D$ is an effective Cartier divisor on $X$. \item For some scheme $U$ and surjective \'etale morphism $U \to X$ the inverse image $D \times_X U$ is an effective Cartier divisor on $U$. \item For every scheme $U$ and every \'etale morphism $U \to X$ the inverse image $D \times_X U$ is an effective Cartier divisor on $U$. \item For every $x \in |D|$ there exists an \'etale morphism $(U, u) \to (X, x)$ of pointed algebraic spaces such that $U = \Spec(A)$ and $D \times_X U = \Spec(A/(f))$ with $f \in A$ not a zerodivisor. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-complement-locally-principal-closed-subscheme} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $Z \subset X$ be a locally principal closed subspace. Let $U = X \setminus Z$. Then $U \to X$ is an affine morphism. \end{lemma} 
\begin{lemma} \label{lemma-complement-effective-Cartier-divisor} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $D \subset X$ be an effective Cartier divisor. Let $U = X \setminus D$. Then $U \to X$ is an affine morphism and $U$ is scheme theoretically dense in $X$. \end{lemma} 
\begin{lemma} \label{lemma-effective-Cartier-makes-dimension-drop} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $D \subset X$ be an effective Cartier divisor. Let $x \in |D|$. If $\dim_x(X) < \infty$, then $\dim_x(D) < \dim_x(X)$. \end{lemma} 
\begin{definition} \label{definition-sum-effective-Cartier-divisors} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Given effective Cartier divisors $D_1$, $D_2$ on $X$ we set $D = D_1 + D_2$ equal to the closed subspace of $X$ corresponding to the quasi-coherent sheaf of ideals $\mathcal{I}_{D_1}\mathcal{I}_{D_2} \subset \mathcal{O}_S$. We call this the {\it sum of the effective Cartier divisors $D_1$ and $D_2$}. \end{definition} 
\begin{lemma} \label{lemma-sum-effective-Cartier-divisors} The sum of two effective Cartier divisors is an effective Cartier divisor. \end{lemma} 
\begin{lemma} \label{lemma-sum-closed-subschemes-effective-Cartier} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $Z, Y$ be two closed subspaces of $X$ with ideal sheaves $\mathcal{I}$ and $\mathcal{J}$. If $\mathcal{I}\mathcal{J}$ defines an effective Cartier divisor $D \subset X$, then $Z$ and $Y$ are effective Cartier divisors and $D = Z + Y$. \end{lemma} 
\begin{lemma} \label{lemma-pullback-locally-principal} Let $S$ be a scheme. Let $f : X' \to X$ be a morphism of algebraic spaces over $S$. Let $Z \subset X$ be a locally principal closed subspace. Then the inverse image $f^{-1}(Z)$ is a locally principal closed subspace of $X'$. \end{lemma} 
\begin{definition} \label{definition-pullback-effective-Cartier-divisor} Let $S$ be a scheme. Let $f : X' \to X$ be a morphism of algebraic spaces over $S$. Let $D \subset X$ be an effective Cartier divisor. We say the {\it pullback of $D$ by $f$ is defined} if the closed subspace $f^{-1}(D) \subset X'$ is an effective Cartier divisor. In this case we denote it either $f^*D$ or $f^{-1}(D)$ and we call it the {\it pullback of the effective Cartier divisor}. \end{definition} 
\begin{lemma} \label{lemma-pullback-effective-Cartier-defined} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces over $S$. Let $D \subset Y$ be an effective Cartier divisor. The pullback of $D$ by $f$ is defined in each of the following cases: \begin{enumerate} \item $f(x) \not \in |D|$ for any weakly associated point $x$ of $X$, \item $f$ is flat, and \item add more here as needed. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-pullback-effective-Cartier-divisors-additive} Let $S$ be a scheme. Let $f : X' \to X$ be a morphism of algebraic spaces over $S$. Let $D_1$, $D_2$ be effective Cartier divisors on $X$. If the pullbacks of $D_1$ and $D_2$ are defined then the pullback of $D = D_1 + D_2$ is defined and $f^*D = f^*D_1 + f^*D_2$. \end{lemma} 
\begin{definition} \label{definition-invertible-sheaf-effective-Cartier-divisor} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$ and let $D \subset X$ be an effective Cartier divisor with ideal sheaf $\mathcal{I}_D$. \begin{enumerate} \item The {\it invertible sheaf $\mathcal{O}_X(D)$ associated to $D$} is defined by $$ \mathcal{O}_X(D) = \SheafHom_{\mathcal{O}_X}(\mathcal{I}_D, \mathcal{O}_X) = \mathcal{I}_D^{\otimes -1}. $$ \item The canonical section, usually denoted $1$ or $1_D$, is the global section of $\mathcal{O}_X(D)$ corresponding to the inclusion mapping $\mathcal{I}_D \to \mathcal{O}_X$. \item We write $\mathcal{O}_X(-D) = \mathcal{O}_X(D)^{\otimes -1} = \mathcal{I}_D$. \item Given a second effective Cartier divisor $D' \subset X$ we define $\mathcal{O}_X(D - D') = \mathcal{O}_X(D) \otimes_{\mathcal{O}_X} \mathcal{O}_X(-D')$. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-conormal-effective-Cartier-divisor} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $D \subset X$ be an effective Cartier divisor. Then for the conormal sheaf we have $\mathcal{C}_{D/X} = \mathcal{I}_D|D = \mathcal{O}_X(D)^{\otimes -1}|_D$. \end{lemma} 
\begin{lemma} \label{lemma-invertible-sheaf-sum-effective-Cartier-divisors} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $D_1$, $D_2$ be effective Cartier divisors on $X$. Let $D = D_1 + D_2$. Then there is a unique isomorphism $$ \mathcal{O}_X(D_1) \otimes_{\mathcal{O}_X} \mathcal{O}_X(D_2) \longrightarrow \mathcal{O}_X(D) $$ which maps $1_{D_1} \otimes 1_{D_2}$ to $1_D$. \end{lemma} 
\begin{definition} \label{definition-regular-section} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{L}$ be an invertible sheaf on $X$. A global section $s \in \Gamma(X, \mathcal{L})$ is called a {\it regular section} if the map $\mathcal{O}_X \to \mathcal{L}$, $f \mapsto fs$ is injective. \end{definition} 
\begin{lemma} \label{lemma-regular-section-structure-sheaf} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $f \in \Gamma(X, \mathcal{O}_X)$. The following are equivalent: \begin{enumerate} \item $f$ is a regular section, and \item for any $x \in X$ the image $f \in \mathcal{O}_{X, \overline{x}}$ is not a zerodivisor. \item for any affine $U = \Spec(A)$ \'etale over $X$ the restriction $f|_U$ is a nonzerodivisor of $A$, and \item there exists a scheme $U$ and a surjective \'etale morphism $U \to X$ such that $f|_U$ is a regular section of $\mathcal{O}_U$. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-zero-scheme-s} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{L}$ be an invertible sheaf. Let $s \in \Gamma(X, \mathcal{L})$. The {\it zero scheme} of $s$ is the closed subspace $Z(s) \subset X$ defined by the quasi-coherent sheaf of ideals $\mathcal{I} \subset \mathcal{O}_X$ which is the image of the map $s : \mathcal{L}^{\otimes -1} \to \mathcal{O}_X$. \end{definition} 
\begin{lemma} \label{lemma-zero-scheme} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Let $s \in \Gamma(X, \mathcal{L})$. \begin{enumerate} \item Consider closed immersions $i : Z \to X$ such that $i^*s \in \Gamma(Z, i^*\mathcal{L}))$ is zero ordered by inclusion. The zero scheme $Z(s)$ is the maximal element of this ordered set. \item For any morphism of algebraic spaces $f : Y \to X$ over $S$ we have $f^*s = 0$ in $\Gamma(Y, f^*\mathcal{L})$ if and only if $f$ factors through $Z(s)$. \item The zero scheme $Z(s)$ is a locally principal closed subspace of $X$. \item The zero scheme $Z(s)$ is an effective Cartier divisor on $X$ if and only if $s$ is a regular section of $\mathcal{L}$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-characterize-OD} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. \begin{enumerate} \item If $D \subset X$ is an effective Cartier divisor, then the canonical section $1_D$ of $\mathcal{O}_X(D)$ is regular. \item Conversely, if $s$ is a regular section of the invertible sheaf $\mathcal{L}$, then there exists a unique effective Cartier divisor $D = Z(s) \subset X$ and a unique isomorphism $\mathcal{O}_X(D) \to \mathcal{L}$ which maps $1_D$ to $s$. \end{enumerate} The constructions $D \mapsto (\mathcal{O}_X(D), 1_D)$ and $(\mathcal{L}, s) \mapsto Z(s)$ give mutually inverse maps $$ \left\{ \begin{matrix} \text{effective Cartier divisors on }X \end{matrix} \right\} \leftrightarrow \left\{ \begin{matrix} \text{pairs }(\mathcal{L}, s)\text{ consisting of an invertible}\\ \mathcal{O}_X\text{-module and a regular global section} \end{matrix} \right\} $$ \end{lemma} 
\begin{lemma} \label{lemma-effective-Cartier-divisor-Sk} Let $S$ be a scheme and let $X$ be a locally Noetherian algebraic space over $S$. Let $D \subset X$ be an effective Cartier divisor. If $X$ is $(S_k)$, then $D$ is $(S_{k - 1})$. \end{lemma} 
\begin{lemma} \label{lemma-normal-effective-Cartier-divisor-S1} Let $S$ be a scheme and let $X$ be a locally Noetherian normal algebraic space over $S$. Let $D \subset X$ be an effective Cartier divisor. Then $D$ is $(S_1)$. \end{lemma} 
\begin{lemma} \label{lemma-complement-open-affine-effective-cartier-divisor} Let $S$ be a scheme. Let $X$ be a regular Noetherian separated algebraic space over $S$. Let $U \subset X$ be a dense affine open. Then there exists an effective Cartier divisor $D \subset X$ with $U = X \setminus D$. \end{lemma} 
\begin{lemma} \label{lemma-Noetherian-regular-separated-pic-effective-Cartier} Let $S$ be a scheme. Let $X$ be a regular Noetherian separated algebraic space over $S$. Then every invertible $\mathcal{O}_X$-module is isomorphic to $$ \mathcal{O}_X(D - D') = \mathcal{O}_X(D) \otimes_{\mathcal{O}_X} \mathcal{O}_X(D')^{\otimes -1} $$ for some effective Cartier divisors $D, D'$ in $X$. \end{lemma} 
\begin{lemma} \label{lemma-smooth-over-valuation-ring-effective-Cartier} Let $R$ be a valuation ring with fraction field $K$. Let $X$ be an algebraic space over $R$ such that $X \to \Spec(R)$ is smooth. For every effective Cartier divisor $D \subset X_K$ there exists an effective Cartier divisor $D' \subset X$ with $D'_K = D$. \end{lemma} 
\begin{lemma} \label{lemma-relative-Cartier} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces over $S$. Let $D \subset X$ be a closed subspace. Assume \begin{enumerate} \item $D$ is an effective Cartier divisor, and \item $D \to Y$ is a flat morphism. \end{enumerate} Then for every morphism of schemes $g : Y' \to Y$ the pullback $(g')^{-1}D$ is an effective Cartier divisor on $X' = Y' \times_Y X$ where $g' : X' \to X$ is the projection. \end{lemma} 
\begin{definition} \label{definition-relative-effective-Cartier-divisor} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces over $S$. A {\it relative effective Cartier divisor} on $X/Y$ is an effective Cartier divisor $D \subset X$ such that $D \to Y$ is a flat morphism of algebraic spaces. \end{definition} 
\begin{definition} \label{definition-sheaf-meromorphic-functions} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. The {\it sheaf of meromorphic functions on $X$} is the sheaf {\it $\mathcal{K}_X$} on $X_\etale$ associated to the presheaf displayed above. A {\it meromorphic function} on $X$ is a global section of $\mathcal{K}_X$. \end{definition} 
\begin{lemma} \label{lemma-describe-S} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. For $U$ affine and \'etale over $X$ the set $\mathcal{S}_X(U)$ is the set of nonzerodivisors in $\mathcal{O}_X(U)$. \end{lemma} 
\begin{definition} \label{definition-meromorphic-section} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_X$-modules on $X_\etale$. \begin{enumerate} \item We denote $\mathcal{K}_X(\mathcal{F})$ the sheaf of $\mathcal{K}_X$-modules which is the sheafification of the presheaf $U \mapsto \mathcal{S}(U)^{-1}\mathcal{F}(U)$. Equivalently $\mathcal{K}_X(\mathcal{F}) = \mathcal{F} \otimes_{\mathcal{O}_X} \mathcal{K}_X$ (see above). \item A {\it meromorphic section of $\mathcal{F}$} is a global section of $\mathcal{K}_X(\mathcal{F})$. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-meromorphic-quasi-coherent} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Assume \begin{enumerate} \item[(a)] every weakly associated point of $X$ is a point of codimension $0$, and \item[(b)] $X$ satisfies the equivalent conditions of Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-prepare-normalization}. \end{enumerate} Then \begin{enumerate} \item $\mathcal{K}_X$ is a quasi-coherent sheaf of $\mathcal{O}_X$-algebras, \item for $U \in X_\etale$ affine $\mathcal{K}_X(U)$ is the total ring of fractions of $\mathcal{O}_X(U)$, \item for a geometric point $\overline{x}$ the set $\mathcal{S}_{\overline{x}}$ the set of nonzerodivisors of $\mathcal{O}_{X, \overline{x}}$, and \item for a geometric point $\overline{x}$ the ring $\mathcal{K}_{X, \overline{x}}$ is the total ring of fractions of $\mathcal{O}_{X, \overline{x}}$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-meromorphic-quasi-coherent-agree} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Assume \begin{enumerate} \item[(a)] every weakly associated point of $X$ is a point of codimension $0$, and \item[(b)] $X$ satisfies the equivalent conditions of Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-prepare-normalization}. \item[(c)] $X$ is representable by a scheme $X_0$ (awkward but temporary notation). \end{enumerate} Then the sheaf of meromorphic functions $\mathcal{K}_X$ is the quasi-coherent sheaf of $\mathcal{O}_X$-algebras associated to the quasi-coherent sheaf of meromorphic functions $\mathcal{K}_{X_0}$. \end{lemma} 
\begin{definition} \label{definition-pullback-meromorphic-sections} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces over $S$. We say that {\it pullbacks of meromorphic functions are defined for $f$} if for every commutative diagram $$ \xymatrix{ U \ar[r] \ar[d] & X \ar[d] \\ V \ar[r] & Y } $$ with $U \in X_\etale$ and $V \in Y_\etale$ and any section $s \in \mathcal{S}_Y(V)$ the pullback $f^\sharp(s) \in \mathcal{O}_X(U)$ is an element of $\mathcal{S}_X(U)$. \end{definition} 
\begin{lemma} \label{lemma-pullback-meromorphic-sections-defined} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces over $S$. Pullbacks of meromorphic sections are defined in each of the following cases \begin{enumerate} \item weakly associated points of $X$ are mapped to points of codimension $0$ on $Y$, \item $f$ is flat, \item add more here as needed. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-compute-meromorphic} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Assume \begin{enumerate} \item[(a)] every weakly associated point of $X$ is a point of codimension $0$, and \item[(b)] $X$ satisfies the equivalent conditions of Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-prepare-normalization}, \item[(c)] every codimension $0$ point of $X$ can be represented by a monomorphism $\Spec(k) \to X$. \end{enumerate} Let $X^0 \subset |X|$ be the set of codimension $0$ points of $X$. Then we have $$ \mathcal{K}_X = \bigoplus\nolimits_{\eta \in X^0} j_{\eta, *}\mathcal{O}_{X, \eta} = \prod\nolimits_{\eta \in X^0} j_{\eta, *}\mathcal{O}_{X, \eta} $$ where $j_\eta : \Spec(\mathcal{O}_{X, \eta}) \to X$ is the canonical map of Schemes, Section \ref{schemes-section-points}; this makes sense because $X^0$ is contained in the schematic locus of $X$. Similarly, for every quasi-coherent $\mathcal{O}_X$-module $\mathcal{F}$ we obtain the formula $$ \mathcal{K}_X(\mathcal{F}) = \bigoplus\nolimits_{\eta \in X^0} j_{\eta, *}\mathcal{F}_\eta = \prod\nolimits_{\eta \in X^0} j_{\eta, *}\mathcal{F}_\eta $$ for the sheaf of meromorphic sections of $\mathcal{F}$. Finally, the ring of rational functions of $X$ is the ring of meromorphic functions on $X$, in a formula: $R(X) = \Gamma(X, \mathcal{K}_X)$. \end{lemma} 
\begin{definition} \label{definition-regular-meromorphic-section} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. A meromorphic section $s$ of $\mathcal{L}$ is said to be {\it regular} if the induced map $\mathcal{K}_X \to \mathcal{K}_X(\mathcal{L})$ is injective. \end{definition} 
\begin{lemma} \label{lemma-meromorphic-sections-pullback} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces over $S$. Assume that pullbacks of meromorphic functions are defined for $f$ (see Definition \ref{definition-pullback-meromorphic-sections}). \begin{enumerate} \item Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_Y$-modules. There is a canonical pullback map $f^* : \Gamma(Y, \mathcal{K}_Y(\mathcal{F})) \to \Gamma(X, \mathcal{K}_X(f^*\mathcal{F}))$ for meromorphic sections of $\mathcal{F}$. \item Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. A regular meromorphic section $s$ of $\mathcal{L}$ pulls back to a regular meromorphic section $f^*s$ of $f^*\mathcal{L}$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-regular-meromorphic-section-exists} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$ satisfying (a), (b), and (c) of Lemma \ref{lemma-compute-meromorphic}. Then every invertible $\mathcal{O}_X$-module $\mathcal{L}$ has a regular meromorphic section. \end{lemma} 
\begin{lemma} \label{lemma-relative-proj} In Situation \ref{situation-relative-proj}. The functor $F$ above is an algebraic space. For any morphism $g : Z \to X$ where $Z$ is a scheme there is a canonical isomorphism $\underline{\text{Proj}}_Z(g^*\mathcal{A}) = Z \times_X F$ compatible with further base change. \end{lemma} 
\begin{definition} \label{definition-relative-proj} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{A}$ be a quasi-coherent sheaf of graded $\mathcal{O}_X$-algebras. The {\it relative homogeneous spectrum of $\mathcal{A}$ over $X$}, or the {\it homogeneous spectrum of $\mathcal{A}$ over $X$}, or the {\it relative Proj of $\mathcal{A}$ over $X$} is the algebraic space $F$ over $X$ of Lemma \ref{lemma-relative-proj}. We denote it $\pi : \underline{\text{Proj}}_X(\mathcal{A}) \to X$. \end{definition} 
\begin{lemma} \label{lemma-twists-of-structure-sheaf} In Situation \ref{situation-relative-proj}. The relative Proj comes equipped with a quasi-coherent sheaf of $\mathbf{Z}$-graded algebras $\bigoplus_{n \in \mathbf{Z}} \mathcal{O}_{\underline{\text{Proj}}_X(\mathcal{A})}(n)$ and a canonical homomorphism of graded algebras $$ \psi : \pi^*\mathcal{A} \longrightarrow \bigoplus\nolimits_{n \geq 0} \mathcal{O}_{\underline{\text{Proj}}_X(\mathcal{A})}(n) $$ whose base change to any scheme over $X$ agrees with Constructions, Lemma \ref{constructions-lemma-glue-relative-proj-twists}. \end{lemma} 
\begin{lemma} \label{lemma-relative-proj-base-change} Let $S$ be a scheme. Let $g : X' \to X$ be a morphism of algebraic spaces over $S$ and let $\mathcal{A}$ be a quasi-coherent sheaf of graded $\mathcal{O}_X$-algebras. Then there is a canonical isomorphism $$ r : \underline{\text{Proj}}_{X'}(g^*\mathcal{A}) \longrightarrow X' \times_X \underline{\text{Proj}}_X(\mathcal{A}) $$ as well as a corresponding isomorphism $$ \theta : r^*\text{pr}_2^*\left(\bigoplus\nolimits_{d \in \mathbf{Z}} \mathcal{O}_{\underline{\text{Proj}}_X(\mathcal{A})}(d)\right) \longrightarrow \bigoplus\nolimits_{d \in \mathbf{Z}} \mathcal{O}_{\underline{\text{Proj}}_{X'}(g^*\mathcal{A})}(d) $$ of $\mathbf{Z}$-graded $\mathcal{O}_{\underline{\text{Proj}}_{X'}(g^*\mathcal{A})}$-algebras. \end{lemma} 
\begin{lemma} \label{lemma-relative-proj-separated} In Situation \ref{situation-relative-proj} the morphism $\pi : \underline{\text{Proj}}_X(\mathcal{A}) \to X$ is separated. \end{lemma} 
\begin{lemma} \label{lemma-relative-proj-quasi-compact} In Situation \ref{situation-relative-proj}. If one of the following holds \begin{enumerate} \item $\mathcal{A}$ is of finite type as a sheaf of $\mathcal{A}_0$-algebras, \item $\mathcal{A}$ is generated by $\mathcal{A}_1$ as an $\mathcal{A}_0$-algebra and $\mathcal{A}_1$ is a finite type $\mathcal{A}_0$-module, \item there exists a finite type quasi-coherent $\mathcal{A}_0$-submodule $\mathcal{F} \subset \mathcal{A}_{+}$ such that $\mathcal{A}_{+}/\mathcal{F}\mathcal{A}$ is a locally nilpotent sheaf of ideals of $\mathcal{A}/\mathcal{F}\mathcal{A}$, \end{enumerate} then $\pi : \underline{\text{Proj}}_X(\mathcal{A}) \to X$ is quasi-compact. \end{lemma} 
\begin{lemma} \label{lemma-relative-proj-finite-type} In Situation \ref{situation-relative-proj}. If $\mathcal{A}$ is of finite type as a sheaf of $\mathcal{O}_X$-algebras, then $\pi : \underline{\text{Proj}}_X(\mathcal{A}) \to X$ is of finite type. \end{lemma} 
\begin{lemma} \label{lemma-relative-proj-universally-closed} In Situation \ref{situation-relative-proj}. If $\mathcal{O}_X \to \mathcal{A}_0$ is an integral algebra map\footnote{In other words, the integral closure of $\mathcal{O}_X$ in $\mathcal{A}_0$, see Morphisms of Spaces, Definition \ref{spaces-morphisms-definition-integral-closure}, equals $\mathcal{A}_0$.} and $\mathcal{A}$ is of finite type as an $\mathcal{A}_0$-algebra, then $\pi : \underline{\text{Proj}}_X(\mathcal{A}) \to X$ is universally closed. \end{lemma} 
\begin{lemma} \label{lemma-relative-proj-proper} In Situation \ref{situation-relative-proj}. The following conditions are equivalent \begin{enumerate} \item $\mathcal{A}_0$ is a finite type $\mathcal{O}_X$-module and $\mathcal{A}$ is of finite type as an $\mathcal{A}_0$-algebra, \item $\mathcal{A}_0$ is a finite type $\mathcal{O}_X$-module  and $\mathcal{A}$ is of finite type as an $\mathcal{O}_X$-algebra. \end{enumerate} If these conditions hold, then $\pi : \underline{\text{Proj}}_X(\mathcal{A}) \to X$ is proper. \end{lemma} 
\begin{lemma} \label{lemma-relative-proj-generated-in-degree-1} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{A}$ be a quasi-coherent sheaf of graded $\mathcal{O}_X$-modules generated as an $\mathcal{A}_0$-algebra by $\mathcal{A}_1$. With $P = \underline{\text{Proj}}_X(\mathcal{A})$ we have \begin{enumerate} \item $P$ represents the functor $F_1$ which associates to $T$ over $S$ the set of isomorphism classes of triples $(f, \mathcal{L}, \psi)$, where $f : T \to X$ is a morphism over $S$, $\mathcal{L}$ is an invertible $\mathcal{O}_T$-module, and $\psi : f^*\mathcal{A} \to \bigoplus_{n \geq 0} \mathcal{L}^{\otimes n}$ is a map of graded $\mathcal{O}_T$-algebras inducing a surjection $f^*\mathcal{A}_1 \to \mathcal{L}$, \item the canonical map $\pi^*\mathcal{A}_1 \to \mathcal{O}_P(1)$ is surjective, and \item each $\mathcal{O}_P(n)$ is invertible and the multiplication maps induce isomorphisms $\mathcal{O}_P(n) \otimes_{\mathcal{O}_P} \mathcal{O}_P(m) = \mathcal{O}_P(n + m)$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-morphism-relative-proj} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\psi : \mathcal{A} \to \mathcal{B}$ be a map of quasi-coherent graded $\mathcal{O}_X$-algebras. Set $P = \underline{\text{Proj}}_X(\mathcal{A}) \to X$ and $Q = \underline{\text{Proj}}_X(\mathcal{B}) \to X$. There is a canonical open subspace $U(\psi) \subset Q$ and a canonical morphism of algebraic spaces $$ r_\psi : U(\psi) \longrightarrow P $$ over $X$ and a map of $\mathbf{Z}$-graded $\mathcal{O}_{U(\psi)}$-algebras $$ \theta = \theta_\psi : r_\psi^*\left( \bigoplus\nolimits_{d \in \mathbf{Z}} \mathcal{O}_P(d) \right) \longrightarrow \bigoplus\nolimits_{d \in \mathbf{Z}} \mathcal{O}_{U(\psi)}(d). $$ The triple $(U(\psi), r_\psi, \theta)$ is characterized by the property that for any scheme $W$ \'etale over $X$ the triple $$ (U(\psi) \times_X W,\quad r_\psi|_{U(\psi) \times_X W} : U(\psi) \times_X W \to  P \times_X W,\quad \theta|_{U(\psi) \times_X W}) $$ is equal to the triple associated to $\psi : \mathcal{A}|_W \to \mathcal{B}|_W$ of Constructions, Lemma \ref{constructions-lemma-morphism-relative-proj}. \end{lemma} 
\begin{lemma} \label{lemma-morphism-relative-proj-transitive} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{A}$, $\mathcal{B}$, and $\mathcal{C}$ be quasi-coherent graded $\mathcal{O}_X$-algebras. Set $P = \underline{\text{Proj}}_X(\mathcal{A})$, $Q = \underline{\text{Proj}}_X(\mathcal{B})$ and $R = \underline{\text{Proj}}_X(\mathcal{C})$. Let $\varphi : \mathcal{A} \to \mathcal{B}$, $\psi : \mathcal{B} \to \mathcal{C}$ be graded $\mathcal{O}_X$-algebra maps. Then we have $$ U(\psi \circ \varphi) = r_\varphi^{-1}(U(\psi)) \quad \text{and} \quad r_{\psi \circ \varphi} = r_\varphi \circ r_\psi|_{U(\psi \circ \varphi)}. $$ In addition we have $$ \theta_\psi \circ r_\psi^*\theta_\varphi = \theta_{\psi \circ \varphi} $$ with obvious notation. \end{lemma} 
\begin{lemma} \label{lemma-surjective-graded-rings-map-relative-proj} With hypotheses and notation as in Lemma \ref{lemma-morphism-relative-proj} above. Assume $\mathcal{A}_d \to \mathcal{B}_d$ is surjective for $d \gg 0$. Then \begin{enumerate} \item $U(\psi) = Q$, \item $r_\psi : Q \to R$ is a closed immersion, and \item the maps $\theta : r_\psi^*\mathcal{O}_P(n) \to \mathcal{O}_Q(n)$ are surjective but not isomorphisms in general (even if $\mathcal{A} \to \mathcal{B}$ is surjective). \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-eventual-iso-graded-rings-map-relative-proj} With hypotheses and notation as in Lemma \ref{lemma-morphism-relative-proj} above. Assume $\mathcal{A}_d \to \mathcal{B}_d$ is an isomorphism for all $d \gg 0$. Then \begin{enumerate} \item $U(\psi) = Q$, \item $r_\psi : Q \to P$ is an isomorphism, and \item the maps $\theta : r_\psi^*\mathcal{O}_P(n) \to \mathcal{O}_Q(n)$ are isomorphisms. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-surjective-generated-degree-1-map-relative-proj} With hypotheses and notation as in Lemma \ref{lemma-morphism-relative-proj} above. Assume $\mathcal{A}_d \to \mathcal{B}_d$ is surjective for $d \gg 0$ and that $\mathcal{A}$ is generated by $\mathcal{A}_1$ over $\mathcal{A}_0$. Then \begin{enumerate} \item $U(\psi) = Q$, \item $r_\psi : Q \to P$ is a closed immersion, and \item the maps $\theta : r_\psi^*\mathcal{O}_P(n) \to \mathcal{O}_Q(n)$ are isomorphisms. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-invertible-map-into-relative-proj} With assumptions and notation as above. The morphism $\psi$ induces a canonical morphism of algebraic spaces over $Y$ $$ r_{\mathcal{L}, \psi} : U(\psi) \longrightarrow \underline{\text{Proj}}_Y(\mathcal{A}) $$ together with a map of graded $\mathcal{O}_{U(\psi)}$-algebras $$ \theta : r_{\mathcal{L}, \psi}^*\left( \bigoplus\nolimits_{d \geq 0} \mathcal{O}_{\underline{\text{Proj}}_Y(\mathcal{A})}(d) \right) \longrightarrow \bigoplus\nolimits_{d \geq 0} \mathcal{L}^{\otimes d}|_{U(\psi)} $$ characterized by the following properties: \begin{enumerate} \item For $V \to Y$ \'etale and $d \geq 0$ the diagram $$ \xymatrix{ \mathcal{A}_d(V) \ar[d]_{\psi} \ar[r]_{\psi} & \Gamma(V \times_Y X, \mathcal{L}^{\otimes d}) \ar[d]^{restrict} \\ \Gamma(V \times_Y \underline{\text{Proj}}_Y(\mathcal{A}), \mathcal{O}_{\underline{\text{Proj}}_Y(\mathcal{A})}(d)) \ar[r]^-\theta & \Gamma(V \times_Y U(\psi), \mathcal{L}^{\otimes d}) } $$ is commutative. \item For any $d \geq 1$ and any morphism $W \to X$ where $W$ is a scheme such that $\psi|_W : f^*\mathcal{A}_d|_W \to \mathcal{L}^{\otimes d}|_W$ is surjective we have (a) $W \to X$ factors through $U(\psi)$ and (b) composition of $W \to U(\psi)$ with $r_{\mathcal{L}, \psi}$ agrees with the morphism $W \to \underline{\text{Proj}}_Y(\mathcal{A})$ which exists by the construction of $\underline{\text{Proj}}_Y(\mathcal{A})$, see Definition \ref{definition-relative-proj}. \item Consider a commutative diagram $$ \xymatrix{ X' \ar[r]_{g'} \ar[d]_{f'} & X \ar[d]^f \\ Y' \ar[r]^g & Y } $$ where $X'$ and $Y'$ are schemes, set $\mathcal{A}' = g^*\mathcal{A}$ and $\mathcal{L}' = (g')^*\mathcal{L}$ and denote $\psi' : (f')^*\mathcal{A} \to \bigoplus_{d \geq 0} (\mathcal{L}')^{\otimes d}$ the pullback of $\psi$. Let $U(\psi')$, $r_{\psi', \mathcal{L}'}$, and $\theta'$ be the open, morphism, and homomorphism constructed in Constructions, Lemma \ref{lemma-invertible-map-into-relative-proj}. Then $U(\psi') = (g')^{-1}(U(\psi))$ and $r_{\psi', \mathcal{L}'}$ agrees with the base change of $r_{\psi, \mathcal{L}}$ via the isomorphism $\underline{\text{Proj}}_{Y'}(\mathcal{A}') = Y' \times_Y \underline{\text{Proj}}_Y(\mathcal{A})$ of Lemma \ref{lemma-relative-proj-base-change}. Moreover, $\theta'$ is the pullback of $\theta$. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-relatively-ample} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces over $S$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. We say $\mathcal{L}$ is {\it relatively ample}, or {\it $f$-relatively ample}, or {\it ample on $X/Y$}, or {\it $f$-ample} if $f : X \to Y$ is representable and for every morphism $Z \to Y$ where $Z$ is a scheme, the pullback $\mathcal{L}_Z$ of $\mathcal{L}$ to $X_Z = Z \times_Y X$ is ample on $X_Z/Z$ as in Morphisms, Definition \ref{morphisms-definition-relatively-ample}. \end{definition} 
\begin{lemma} \label{lemma-relatively-ample-sanity-check} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces over $S$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Assume $Y$ is a scheme. The following are equivalent \begin{enumerate} \item $\mathcal{L}$ is ample on $X/Y$ in the sense of Definition \ref{definition-relatively-ample}, and \item $X$ is a scheme and $\mathcal{L}$ is ample on $X/Y$ in the sense of Morphisms, Definition \ref{morphisms-definition-relatively-ample}. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-ample-base-change} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces over $S$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Let $Y' \to Y$ be a morphism of algebraic spaces over $S$. Let $f' : X' \to Y'$ be the base change of $f$ and denote $\mathcal{L}'$ the pullback of $\mathcal{L}$ to $X'$. If $\mathcal{L}$ is $f$-ample, then $\mathcal{L}'$ is $f'$-ample. \end{lemma} 
\begin{lemma} \label{lemma-relatively-ample-properties} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces over $S$. If there exists an $f$-ample invertible sheaf, then $f$ is representable, quasi-compact, and separated. \end{lemma} 
\begin{lemma} \label{lemma-descend-relatively-ample} Let $V \to U$ be a surjective \'etale morphism of affine schemes. Let $X$ be an algebraic space over $U$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Let $Y = V \times_U X$ and let $\mathcal{N}$ be the pullback of $\mathcal{L}$ to $Y$. The following are equivalent \begin{enumerate} \item $\mathcal{L}$ is ample on $X/U$, and \item $\mathcal{N}$ is ample on $Y/V$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-relatively-ample-local} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces over $S$. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. The following are equivalent \begin{enumerate} \item $\mathcal{L}$ is ample on $X/Y$, \item for every scheme $Z$ and every morphism $Z \to Y$ the algebraic space $X_Z = Z \times_Y X$ is a scheme and the pullback $\mathcal{L}_Z$ is ample on $X_Z/Z$, \item for every affine scheme $Z$ and every morphism $Z \to Y$ the algebraic space $X_Z = Z \times_Y X$ is a scheme and the pullback $\mathcal{L}_Z$ is ample on $X_Z/Z$, \item there exists a scheme $V$ and a surjective \'etale morphism $V \to Y$ such that the algebraic space $X_V = V \times_Y X$ is a scheme and the pullback $\mathcal{L}_V$ is ample on $X_V/V$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-quasi-affine-O-ample} Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces over $S$. Then $f$ is quasi-affine if and only if $\mathcal{O}_X$ is $f$-relatively ample. \end{lemma} 
\begin{lemma} \label{lemma-vanshing-gives-ample} Let $R$ be a Noetherian ring. Let $X$ be an algebraic space over $R$ such that the structure morphism $f : X \to \Spec(R)$ is proper. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. The following are equivalent \begin{enumerate} \item $\mathcal{L}$ is ample on $X/R$ (Definition \ref{definition-relatively-ample}), \item for every coherent $\mathcal{O}_X$-module $\mathcal{F}$ there exists an $n_0 \geq 0$ such that $H^p(X, \mathcal{F} \otimes \mathcal{L}^{\otimes n}) = 0$ for all $n \geq n_0$ and $p > 0$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-ample-on-fibre} Let $Y$ be a Noetherian scheme. Let $X$ be an algebraic space over $Y$ such that the structure morphism $f : X \to Y$ is proper. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Let $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module. Let $y \in Y$ be a point such that $X_y$ is a scheme and $\mathcal{L}_y$ is ample on $X_y$. Then there exists a $d_0$ such that for all $d \geq d_0$ we have $$ R^pf_*(\mathcal{F} \otimes_{\mathcal{O}_X} \mathcal{L}^{\otimes d})_y = 0 \text{ for }p > 0 $$ and the map $$ f_*(\mathcal{F} \otimes_{\mathcal{O}_X} \mathcal{L}^{\otimes d})_y \longrightarrow H^0(X_y, \mathcal{F}_y \otimes_{\mathcal{O}_{X_y}} \mathcal{L}_y^{\otimes d}) $$ is surjective. \end{lemma} 
\begin{lemma} \label{lemma-ample-in-neighbourhood} (For a more general version see Descent on Spaces, Lemma \ref{spaces-descent-lemma-ample-in-neighbourhood}). Let $Y$ be a Noetherian scheme. Let $X$ be an algebraic space over $Y$ such that the structure morphism $f : X \to Y$ is proper. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module. Let $y \in Y$ be a point such that $X_y$ is a scheme and $\mathcal{L}_y$ is ample on $X_y$. Then there is an open neighbourhood $V \subset Y$ of $y$ such that $\mathcal{L}|_{f^{-1}(V)}$ is ample on $f^{-1}(V)/V$ (as in Definition \ref{definition-relatively-ample}). \end{lemma} 
\begin{lemma} \label{lemma-closed-subscheme-proj} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{A}$ be a quasi-coherent graded $\mathcal{O}_X$-algebra. Let $\pi : P = \underline{\text{Proj}}_X(\mathcal{A}) \to X$ be the relative Proj of $\mathcal{A}$. Let $i : Z \to P$ be a closed subspace. Denote $\mathcal{I} \subset \mathcal{A}$ the kernel of the canonical map $$ \mathcal{A} \longrightarrow \bigoplus\nolimits_{d \geq 0} \pi_*\left((i_*\mathcal{O}_Z)(d)\right) $$ If $\pi$ is quasi-compact, then there is an isomorphism $Z = \underline{\text{Proj}}_X(\mathcal{A}/\mathcal{I})$. \end{lemma} 
\begin{lemma} \label{lemma-closed-subscheme-proj-finite} Let $S$ be a scheme. Let $X$ be a quasi-compact and quasi-separated algebraic space over $S$. Let $\mathcal{A}$ be a quasi-coherent graded $\mathcal{O}_X$-algebra. Let $\pi : P = \underline{\text{Proj}}_X(\mathcal{A}) \to X$ be the relative Proj of $\mathcal{A}$. Let $i : Z \to P$ be a closed subscheme. If $\pi$ is quasi-compact and $i$ of finite presentation, then there exists a $d > 0$ and a quasi-coherent finite type $\mathcal{O}_X$-submodule $\mathcal{F} \subset \mathcal{A}_d$ such that $Z = \underline{\text{Proj}}_X(\mathcal{A}/\mathcal{F}\mathcal{A})$. \end{lemma} 
\begin{lemma} \label{lemma-closed-subscheme-proj-finite-type} Let $S$ be a scheme. Let $X$ be a quasi-compact and quasi-separated algebraic space over $S$. Let $\mathcal{A}$ be a quasi-coherent graded $\mathcal{O}_X$-algebra. Let $\pi : P = \underline{\text{Proj}}_X(\mathcal{A}) \to X$ be the relative Proj of $\mathcal{A}$. Let $i : Z \to X$ be a closed subspace. Let $U \subset X$ be an open. Assume that \begin{enumerate} \item $\pi$ is quasi-compact, \item $i$ of finite presentation, \item $|U| \cap |\pi|(|i|(|Z|)) = \emptyset$, \item $U$ is quasi-compact, \item $\mathcal{A}_n$ is a finite type $\mathcal{O}_X$-module for all $n$. \end{enumerate} Then there exists a $d > 0$ and a quasi-coherent finite type $\mathcal{O}_X$-submodule $\mathcal{F} \subset \mathcal{A}_d$ with (a) $Z = \underline{\text{Proj}}_X(\mathcal{A}/\mathcal{F}\mathcal{A})$ and (b) the support of $\mathcal{A}_d/\mathcal{F}$ is disjoint from $U$. \end{lemma} 
\begin{lemma} \label{lemma-conormal-sheaf-section-projective-bundle} Let $S$ be a scheme and let $X$ be an algebraic space over $S$. Let $\mathcal{E}$ be a quasi-coherent $\mathcal{O}_X$-module. There is a bijection $$ \left\{ \begin{matrix} \text{sections }\sigma\text{ of the } \\ \text{morphism } \mathbf{P}(\mathcal{E}) \to X \end{matrix} \right\} \leftrightarrow \left\{ \begin{matrix} \text{surjections }\mathcal{E} \to \mathcal{L}\text{ where} \\ \mathcal{L}\text{ is an invertible }\mathcal{O}_X\text{-module} \end{matrix} \right\} $$ In this case $\sigma$ is a closed immersion and there is a canonical isomorphism $$ \Ker(\mathcal{E} \to \mathcal{L}) \otimes_{\mathcal{O}_X} \mathcal{L}^{\otimes -1} \longrightarrow \mathcal{C}_{\sigma(X)/\mathbf{P}(\mathcal{E})} $$ Both the bijection and isomorphism are compatible with base change. \end{lemma} 
\begin{definition} \label{definition-blow-up} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{I} \subset \mathcal{O}_X$ be a quasi-coherent sheaf of ideals, and let $Z \subset X$ be the closed subspace corresponding to $\mathcal{I}$ (Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-closed-immersion-ideals}). The {\it blowing up of $X$ along $Z$}, or the {\it blowing up of $X$ in the ideal sheaf $\mathcal{I}$} is the morphism $$ b : \underline{\text{Proj}}_X \left(\bigoplus\nolimits_{n \geq 0} \mathcal{I}^n\right) \longrightarrow X $$ The {\it exceptional divisor} of the blowup is the inverse image $b^{-1}(Z)$. Sometimes $Z$ is called the {\it center} of the blowup. \end{definition} 
\begin{lemma} \label{lemma-blowing-up-affine} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{I} \subset \mathcal{O}_X$ be a quasi-coherent sheaf of ideals. Let $U = \Spec(A)$ be an affine scheme \'etale over $X$ and let $I \subset A$ be the ideal corresponding to $\mathcal{I}|_U$. If $X' \to X$ is the blowup of $X$ in $\mathcal{I}$, then there is a canonical isomorphism $$ U \times_X X' = \text{Proj}(\bigoplus\nolimits_{d \geq 0} I^d) $$ of schemes over $U$, where the right hand side is the homogeneous spectrum of the Rees algebra of $I$ in $A$. Moreover, $U \times_X X'$ has an affine open covering by spectra of the affine blowup algebras $A[\frac{I}{a}]$. \end{lemma} 
\begin{lemma} \label{lemma-flat-base-change-blowing-up} Let $S$ be a scheme. Let $X_1 \to X_2$ be a flat morphism of algebraic spaces over $S$. Let $Z_2 \subset X_2$ be a closed subspace. Let $Z_1$ be the inverse image of $Z_2$ in $X_1$. Let $X'_i$ be the blowup of $Z_i$ in $X_i$. Then there exists a cartesian diagram $$ \xymatrix{ X_1' \ar[r] \ar[d] & X_2' \ar[d] \\ X_1 \ar[r] & X_2 } $$ of algebraic spaces over $S$. \end{lemma} 
\begin{lemma} \label{lemma-blowing-up-gives-effective-Cartier-divisor} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $Z \subset X$ be a closed subspace. The blowing up $b : X' \to X$ of $Z$ in $X$ has the following properties: \begin{enumerate} \item $b|_{b^{-1}(X \setminus Z)} : b^{-1}(X \setminus Z) \to X \setminus Z$ is an isomorphism, \item the exceptional divisor $E = b^{-1}(Z)$ is an effective Cartier divisor on $X'$, \item there is a canonical isomorphism $\mathcal{O}_{X'}(-1) = \mathcal{O}_{X'}(E)$ \end{enumerate} \end{lemma} 
\begin{lemma}[Universal property blowing up] \label{lemma-universal-property-blowing-up} \begin{slogan} Blow up a closed subset to make it Cartier. \end{slogan} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $Z \subset X$ be a closed subspace. Let $\mathcal{C}$ be the full subcategory of $(\textit{Spaces}/X)$ consisting of $Y \to X$ such that the inverse image of $Z$ is an effective Cartier divisor on $Y$. Then the blowing up $b : X' \to X$ of $Z$ in $X$ is a final object of $\mathcal{C}$. \end{lemma} 
\begin{lemma} \label{lemma-blow-up-effective-Cartier-divisor} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $Z \subset X$ be an effective Cartier divisor. The blowup of $X$ in $Z$ is the identity morphism of $X$. \end{lemma} 
\begin{lemma} \label{lemma-blow-up-reduced-space} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{I} \subset \mathcal{O}_X$ be a quasi-coherent sheaf of ideals. If $X$ is reduced, then the blowup $X'$ of $X$ in $\mathcal{I}$ is reduced. \end{lemma} 
\begin{lemma} \label{lemma-blowup-finite-nr-irreducibles} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $b : X' \to X$ be the blowup of $X$ in a closed subspace. If $X$ satisfies the equivalent conditions of Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-prepare-normalization} then so does $X'$. \end{lemma} 
\begin{lemma} \label{lemma-blow-up-pullback-effective-Cartier} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $b : X' \to X$ be a blowup of $X$ in a closed subspace. For any effective Cartier divisor $D$ on $X$ the pullback $b^{-1}D$ is defined (see Definition \ref{definition-pullback-effective-Cartier-divisor}). \end{lemma} 
\begin{lemma} \label{lemma-blowing-up-two-ideals} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{I} \subset \mathcal{O}_X$ and $\mathcal{J}$ be quasi-coherent sheaves of ideals. Let $b : X' \to X$ be the blowing up of $X$ in $\mathcal{I}$. Let $b' : X'' \to X'$ be the blowing up of $X'$ in $b^{-1}\mathcal{J} \mathcal{O}_{X'}$. Then $X'' \to X$ is canonically isomorphic to the blowing up of $X$ in $\mathcal{I}\mathcal{J}$. \end{lemma} 
\begin{lemma} \label{lemma-blowing-up-projective} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $\mathcal{I} \subset \mathcal{O}_X$ be a quasi-coherent sheaf of ideals. Let $b : X' \to X$ be the blowing up of $X$ in the ideal sheaf $\mathcal{I}$. If $\mathcal{I}$ is of finite type, then $b : X' \to X$ is a proper morphism. \end{lemma} 
\begin{lemma} \label{lemma-composition-finite-type-blowups} Let $S$ be a scheme and let $X$ be an algebraic space over $S$. Assume $X$ is quasi-compact and quasi-separated. Let $Z \subset X$ be a closed subspace of finite presentation. Let $b : X' \to X$ be the blowing up with center $Z$. Let $Z' \subset X'$ be a closed subspace of finite presentation. Let $X'' \to X'$ be the blowing up with center $Z'$. There exists a closed subspace $Y \subset X$ of finite presentation, such that \begin{enumerate} \item $|Y| = |Z| \cup |b|(|Z'|)$, and \item the composition $X'' \to X$ is isomorphic to the blowing up of $X$ in $Y$. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-strict-transform} With $Z \subset B$ and $f : X \to B$ as above. \begin{enumerate} \item Given a quasi-coherent $\mathcal{O}_X$-module $\mathcal{F}$ the {\it strict transform} of $\mathcal{F}$ with respect to the blowup of $B$ in $Z$ is the quotient $\mathcal{F}'$ of $\text{pr}_X^*\mathcal{F}$ by the submodule of sections supported on $|\text{pr}_{B'}^{-1}E|$. \item The {\it strict transform} of $X$ is the closed subspace $X' \subset X \times_B B'$ cut out by the quasi-coherent ideal of sections of $\mathcal{O}_{X \times_B B'}$ supported on $|\text{pr}_{B'}^{-1}E|$. \end{enumerate} \end{definition} 
\begin{lemma}[\'Etale localization and strict transform] \label{lemma-strict-transform-local} In the situation of Definition \ref{definition-strict-transform}. Let $$ \xymatrix{ U \ar[r] \ar[d] & X \ar[d] \\ V \ar[r] & B } $$ be a commutative diagram of morphisms with $U$ and $V$ schemes and \'etale horizontal arrows. Let $V' \to V$ be the blowup of $V$ in $Z \times_B V$. Then \begin{enumerate} \item $V' = V \times_B B'$ and the maps $V' \to B'$ and $U \times_V V' \to X \times_B B'$ are \'etale, \item the strict transform $U'$ of $U$ relative to $V' \to V$ is equal to $X' \times_X U$ where $X'$ is the strict transform of $X$ relative to $B' \to B$, and \item for a quasi-coherent $\mathcal{O}_X$-module $\mathcal{F}$ the restriction of the strict transform $\mathcal{F}'$ to $U \times_V V'$ is the strict transform of $\mathcal{F}|_U$ relative to $V' \to V$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-strict-transform} In the situation of Definition \ref{definition-strict-transform}. \begin{enumerate} \item The strict transform $X'$ of $X$ is the blowup of $X$ in the closed subspace $f^{-1}Z$ of $X$. \item For a quasi-coherent $\mathcal{O}_X$-module $\mathcal{F}$ the strict transform $\mathcal{F}'$ is canonically isomorphic to the pushforward along $X' \to X \times_B B'$ of the strict transform of $\mathcal{F}$ relative to the blowing up $X' \to X$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-strict-transform-flat} In the situation of Definition \ref{definition-strict-transform}. \begin{enumerate} \item If $X$ is flat over $B$ at all points lying over $Z$, then the strict transform of $X$ is equal to the base change $X \times_B B'$. \item Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. If $\mathcal{F}$ is flat over $B$ at all points lying over $Z$, then the strict transform $\mathcal{F}'$ of $\mathcal{F}$ is equal to the pullback $\text{pr}_X^*\mathcal{F}$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-strict-transform-affine} Let $S$ be a scheme. Let $B$ be an algebraic space over $S$. Let $Z \subset B$ be a closed subspace. Let $b : B' \to B$ be the blowing up of $Z$ in $B$. Let $g : X \to Y$ be an affine morphism of spaces over $B$. Let $\mathcal{F}$ be a quasi-coherent sheaf on $X$. Let $g' : X \times_B B' \to Y \times_B B'$ be the base change of $g$. Let $\mathcal{F}'$ be the strict transform of $\mathcal{F}$ relative to $b$. Then $g'_*\mathcal{F}'$ is the strict transform of $g_*\mathcal{F}$. \end{lemma} 
\begin{lemma} \label{lemma-strict-transform-different-centers} Let $S$ be a scheme. Let $B$ be an algebraic space over $S$. Let $Z \subset B$ be a closed subspace. Let $D \subset B$ be an effective Cartier divisor. Let $Z' \subset B$ be the closed subspace cut out by the product of the ideal sheaves of $Z$ and $D$. Let $B' \to B$ be the blowup of $B$ in $Z$. \begin{enumerate} \item The blowup of $B$ in $Z'$ is isomorphic to $B' \to B$. \item Let $f : X \to B$ be a morphism of algebraic spaces and let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. If the subsheaf of $\mathcal{F}$ of sections supported on $|f^{-1}D|$ is zero, then the strict transform of $\mathcal{F}$ relative to the blowing up in $Z$ agrees with the strict transform of $\mathcal{F}$ relative to the blowing up of $B$ in $Z'$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-strict-transform-composition-blowups} Let $S$ be a scheme. Let $B$ be an algebraic space over $S$. Let $Z \subset B$ be a closed subspace. Let $b : B' \to B$ be the blowing up with center $Z$. Let $Z' \subset B'$ be a closed subspace. Let $B'' \to B'$ be the blowing up with center $Z'$. Let $Y \subset B$ be a closed subscheme such that $|Y| = |Z| \cup |b|(|Z'|)$ and the composition $B'' \to B$ is isomorphic to the blowing up of $B$ in $Y$. In this situation, given any scheme $X$ over $B$ and $\mathcal{F} \in \QCoh(\mathcal{O}_X)$ we have \begin{enumerate} \item the strict transform of $\mathcal{F}$ with respect to the blowing up of $B$ in $Y$ is equal to the strict transform with respect to the blowup $B'' \to B'$ in $Z'$ of the strict transform of $\mathcal{F}$ with respect to the blowup $B' \to B$ of $B$ in $Z$, and \item the strict transform of $X$ with respect to the blowing up of $B$ in $Y$ is equal to the strict transform with respect to the blowup $B'' \to B'$ in $Z'$ of the strict transform of $X$ with respect to the blowup $B' \to B$ of $B$ in $Z$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-strict-transform-universally-injective} In the situation of Definition \ref{definition-strict-transform}. Suppose that $$ 0 \to \mathcal{F}_1 \to \mathcal{F}_2 \to \mathcal{F}_3 \to 0 $$ is an exact sequence of quasi-coherent sheaves on $X$ which remains exact after any base change $T \to B$. Then the strict transforms of $\mathcal{F}_i'$ relative to any blowup $B' \to B$ form a short exact sequence $0 \to \mathcal{F}'_1 \to \mathcal{F}'_2 \to \mathcal{F}'_3 \to 0$ too. \end{lemma} 
\begin{lemma} \label{lemma-strict-transform-blowup-fitting-ideal} Let $S$ be a scheme. Let $B$ be an algebraic space over $S$. Let $\mathcal{F}$ be a finite type quasi-coherent $\mathcal{O}_B$-module. Let $Z_k \subset S$ be the closed subscheme cut out by $\text{Fit}_k(\mathcal{F})$, see Section \ref{section-fitting-ideals}. Let $B' \to B$ be the blowup of $B$ in $Z_k$ and let $\mathcal{F}'$ be the strict transform of $\mathcal{F}$. Then $\mathcal{F}'$ can locally be generated by $\leq k$ sections. \end{lemma} 
\begin{lemma} \label{lemma-strict-transform-blowup-fitting-ideal-locally-free} Let $S$ be a scheme. Let $B$ be an algebraic space over $S$. Let $\mathcal{F}$ be a finite type quasi-coherent $\mathcal{O}_B$-module. Let $Z_k \subset S$ be the closed subscheme cut out by $\text{Fit}_k(\mathcal{F})$, see Section \ref{section-fitting-ideals}. Assume that $\mathcal{F}$ is locally free of rank $k$ on $B \setminus Z_k$. Let $B' \to B$ be the blowup of $B$ in $Z_k$ and let $\mathcal{F}'$ be the strict transform of $\mathcal{F}$. Then $\mathcal{F}'$ is locally free of rank $k$. \end{lemma} 
\begin{definition} \label{definition-admissible-blowup} Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $U \subset X$ be an open subspace. A morphism $X' \to X$ is called a {\it $U$-admissible blowup} if there exists a closed immersion $Z \to X$ of finite presentation with $Z$ disjoint from $U$ such that $X'$ is isomorphic to the blowup of $X$ in $Z$. \end{definition} 
\begin{lemma} \label{lemma-composition-admissible-blowups} Let $S$ be a scheme. Let $X$ be a quasi-compact and quasi-separated algebraic space over $S$. Let $U \subset X$ be a quasi-compact open subspace. Let $b : X' \to X$ be a $U$-admissible blowup. Let $X'' \to X'$ be a $U$-admissible blowup. Then the composition $X'' \to X$ is a $U$-admissible blowup. \end{lemma} 
\begin{lemma} \label{lemma-extend-admissible-blowups} Let $S$ be a scheme. Let $X$ be a quasi-compact and quasi-separated algebraic space. Let $U, V \subset X$ be quasi-compact open subspaces. Let $b : V' \to V$ be a $U \cap V$-admissible blowup. Then there exists a $U$-admissible blowup $X' \to X$ whose restriction to $V$ is $V'$. \end{lemma} 
\begin{lemma} \label{lemma-dominate-admissible-blowups} Let $S$ be a scheme. Let $X$ be a quasi-compact and quasi-separated algebraic space over $S$. Let $U \subset X$ be a quasi-compact open subspace. Let $b_i : X_i \to X$, $i = 1, \ldots, n$ be $U$-admissible blowups. There exists a $U$-admissible blowup $b : X' \to X$ such that (a) $b$ factors as $X' \to X_i \to X$ for $i = 1, \ldots, n$ and (b) each of the morphisms $X' \to X_i$ is a $U$-admissible blowup. \end{lemma} 
\begin{lemma} \label{lemma-separate-disjoint-opens-by-blowing-up} Let $S$ be a scheme. Let $X$ be a quasi-compact and quasi-separated algebraic space over $S$. Let $U, V$ be quasi-compact disjoint open subspaces of $X$. Then there exist a $U \cup V$-admissible blowup $b : X' \to X$ such that $X'$ is a disjoint union of open subspaces $X' = X'_1 \amalg X'_2$ with $b^{-1}(U) \subset X'_1$ and $b^{-1}(V) \subset X'_2$. \end{lemma} 
