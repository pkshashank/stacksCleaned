\begin{lemma} \label{lemma-extend-curves-to-spaces} Let $T \to B$ be a morphism of algebraic spaces. The category $$ \Mor_B(T, B\text{-}\Curvesstack) = \Mor(T, \Curvesstack) $$ is the category of families of curves over $T$. \end{lemma} 
\begin{lemma} \label{lemma-polarized-curves-in-polarized} The morphism $\textit{PolarizedCurves} \to \Polarizedstack$ is an open and closed immersion. \end{lemma} 
\begin{lemma} \label{lemma-polarized-curves-over-curves} The morphism $\textit{PolarizedCurves} \to \Curvesstack$ is smooth and surjective. \end{lemma} 
\begin{lemma} \label{lemma-etale-locally-scheme} Let $X \to S$ be a family of curves. Then there exists an \'etale covering $\{S_i \to S\}$ such that $X_i = X \times_S S_i$ is a scheme. We may even assume $X_i$ is H-projective over $S_i$. \end{lemma} 
\begin{lemma} \label{lemma-curves-diagonal-separated-fp} The diagonal of $\Curvesstack$ is separated and of finite presentation. \end{lemma} 
\begin{lemma} \label{lemma-curves-qs-lfp} The morphism $\Curvesstack \to \Spec(\mathbf{Z})$ is quasi-separated and locally of finite presentation. \end{lemma} 
\begin{lemma} \label{lemma-DM-curves} There exist an open substack $\Curvesstack^{DM} \subset \Curvesstack$ with the following properties \begin{enumerate} \item $\Curvesstack^{DM} \subset \Curvesstack$ is the maximal open substack which is DM, \item given a family of curves $X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack^{DM}$, \item the group algebraic space $\mathit{Aut}_S(X)$ is unramified over $S$, \end{enumerate} \item given $X$ a proper scheme over a field $k$ of dimension $\leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\Curvesstack^{DM}$, \item $\mathit{Aut}(X)$ is geometrically reduced over $k$ and has dimension $0$, \item $\mathit{Aut}(X) \to \Spec(k)$ is unramified. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-in-DM-locus-vector-fields} Let $X$ be a proper scheme over a field $k$ of dimension $\leq 1$. Then properties (3)(a), (b), (c) are also equivalent to $\text{Der}_k(\mathcal{O}_X, \mathcal{O}_X) = 0$. \end{lemma} 
\begin{lemma} \label{lemma-CM-curves} There exist an open substack $\Curvesstack^{CM} \subset \Curvesstack$ such that \begin{enumerate} \item given a family of curves $X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack^{CM}$, \item the morphism $X \to S$ is Cohen-Macaulay, \end{enumerate} \item given a scheme $X$ proper over a field $k$ with $\dim(X) \leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\Curvesstack^{CM}$, \item $X$ is Cohen-Macaulay. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-CM-1-curves} There exist an open substack $\Curvesstack^{CM, 1} \subset \Curvesstack$ such that \begin{enumerate} \item given a family of curves $X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack^{CM, 1}$, \item the morphism $X \to S$ is Cohen-Macaulay and has relative dimension $1$ (Morphisms of Spaces, Definition \ref{spaces-morphisms-definition-relative-dimension}), \end{enumerate} \item given a scheme $X$ proper over a field $k$ with $\dim(X) \leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\Curvesstack^{CM, 1}$, \item $X$ is Cohen-Macaulay and $X$ is equidimensional of dimension $1$. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-pre-genus-curves} There exist an open substack $\Curvesstack^{h0, 1} \subset \Curvesstack$ such that \begin{enumerate} \item given a family of curves $f : X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack^{h0, 1}$, \item $f_*\mathcal{O}_X = \mathcal{O}_S$, this holds after arbitrary base change, and the fibres of $f$ have dimension $1$, \end{enumerate} \item given a scheme $X$ proper over a field $k$ with $\dim(X) \leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\Curvesstack^{h0, 1}$, \item $H^0(X, \mathcal{O}_X) = k$ and $\dim(X) = 1$. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-pre-genus-in-CM-1} We have $\Curvesstack^{h0, 1} \subset \Curvesstack^{CM, 1}$ as open substacks of $\Curvesstack$. \end{lemma} 
\begin{lemma} \label{lemma-genus} Let $f : X \to S$ be a family of curves such that $\kappa(s) = H^0(X_s, \mathcal{O}_{X_s})$ for all $s \in S$, i.e., the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack^{h0, 1}$ (Lemma \ref{lemma-pre-genus-curves}). Then \begin{enumerate} \item $f_*\mathcal{O}_X = \mathcal{O}_S$ and this holds universally, \item $R^1f_*\mathcal{O}_X$ is a finite locally free $\mathcal{O}_S$-module, \item for any morphism $h : S' \to S$ if $f' : X' \to S'$ is the base change, then $h^*(R^1f_*\mathcal{O}_X) = R^1f'_*\mathcal{O}_{X'}$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-pre-genus-one-piece-per-genus} There is a decomposition into open and closed substacks $$ \Curvesstack^{h0, 1} = \coprod\nolimits_{g \geq 0} \Curvesstack_g $$ where each $\Curvesstack_g$ is characterized as follows: \begin{enumerate} \item given a family of curves $f : X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack_g$, \item $f_*\mathcal{O}_X = \mathcal{O}_S$, this holds after arbitrary base change, the fibres of $f$ have dimension $1$, and $R^1f_*\mathcal{O}_X$ is a locally free $\mathcal{O}_S$-module of rank $g$, \end{enumerate} \item given a scheme $X$ proper over a field $k$ with $\dim(X) \leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\Curvesstack_g$, \item $\dim(X) = 1$, $k = H^0(X, \mathcal{O}_X)$, and the genus of $X$ is $g$. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-geometrically-reduced-curves} There exist an open substack $\Curvesstack^{geomred} \subset \Curvesstack$ such that \begin{enumerate} \item given a family of curves $X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack^{geomred}$, \item the fibres of the morphism $X \to S$ are geometrically reduced (More on Morphisms of Spaces, Definition \ref{spaces-more-morphisms-definition-geometrically-reduced-fibre}), \end{enumerate} \item given a scheme $X$ proper over a field $k$ with $\dim(X) \leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\Curvesstack^{geomred}$, \item $X$ is geometrically reduced over $k$. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-geomred-in-CM} We have $\Curvesstack^{geomred} \subset \Curvesstack^{CM}$ as open substacks of $\Curvesstack$. \end{lemma} 
\begin{lemma} \label{lemma-geometrically-reduced-connected-1-curves} There exist an open substack $\Curvesstack^{grc, 1} \subset \Curvesstack$ such that \begin{enumerate} \item given a family of curves $X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack^{grc, 1}$, \item the geometric fibres of the morphism $X \to S$ are reduced, connected, and have dimension $1$, \end{enumerate} \item given a scheme $X$ proper over a field $k$ with $\dim(X) \leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\Curvesstack^{grc, 1}$, \item $X$ is geometrically reduced, geometrically connected, and has dimension $1$. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-geomredcon-in-h0-1} We have $\Curvesstack^{grc, 1} \subset \Curvesstack^{h0, 1}$ as open substacks of $\Curvesstack$. In particular, given a family of curves $f : X \to S$ whose geometric fibres are reduced, connected and of dimension $1$, then $R^1f_*\mathcal{O}_X$ is a finite locally free $\mathcal{O}_S$-module whose formation commutes with arbitrary base change. \end{lemma} 
\begin{lemma} \label{lemma-one-piece-per-genus} There is a decomposition into open and closed substacks $$ \Curvesstack^{grc, 1} = \coprod\nolimits_{g \geq 0} \Curvesstack^{grc, 1}_g $$ where each $\Curvesstack^{grc, 1}_g$ is characterized as follows: \begin{enumerate} \item given a family of curves $f : X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack^{grc, 1}_g$, \item the geometric fibres of the morphism $f : X \to S$ are reduced, connected, of dimension $1$ and $R^1f_*\mathcal{O}_X$ is a locally free $\mathcal{O}_S$-module of rank $g$, \end{enumerate} \item given a scheme $X$ proper over a field $k$ with $\dim(X) \leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\Curvesstack^{grc, 1}_g$, \item $X$ is geometrically reduced, geometrically connected, has dimension $1$, and has genus $g$. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-gorenstein-curves} There exist an open substack $\Curvesstack^{Gorenstein} \subset \Curvesstack$ such that \begin{enumerate} \item given a family of curves $X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack^{Gorenstein}$, \item the morphism $X \to S$ is Gorenstein, \end{enumerate} \item given a scheme $X$ proper over a field $k$ with $\dim(X) \leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\Curvesstack^{Gorenstein}$, \item $X$ is Gorenstein. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-gorenstein-1-curves} There exist an open substack $\Curvesstack^{Gorenstein, 1} \subset \Curvesstack$ such that \begin{enumerate} \item given a family of curves $X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack^{Gorenstein, 1}$, \item the morphism $X \to S$ is Gorenstein and has relative dimension $1$ (Morphisms of Spaces, Definition \ref{spaces-morphisms-definition-relative-dimension}), \end{enumerate} \item given a scheme $X$ proper over a field $k$ with $\dim(X) \leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\Curvesstack^{Gorenstein, 1}$, \item $X$ is Gorenstein and $X$ is equidimensional of dimension $1$. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-lci-curves} There exist an open substack $\Curvesstack^{lci} \subset \Curvesstack$ such that \begin{enumerate} \item given a family of curves $X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack^{lci}$, \item $X \to S$ is a local complete intersection morphism, and \item $X \to S$ is a syntomic morphism. \end{enumerate} \item given $X$ a proper scheme over a field $k$ of dimension $\leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\Curvesstack^{lci}$, \item $X$ is a local complete intersection over $k$. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-isolated-sings-curves} There exist an open substack $\Curvesstack^{+} \subset \Curvesstack$ such that \begin{enumerate} \item given a family of curves $X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack^{+}$, \item the singular locus of $X \to S$ endowed with any/some closed subspace structure is finite over $S$. \end{enumerate} \item given $X$ a proper scheme over a field $k$ of dimension $\leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\Curvesstack^{+}$, \item $X \to \Spec(k)$ is smooth except at finitely many points. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-in-smooth-locus} In the situation above the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through the open where $\Curvesstack \to \Spec(\mathbf{Z})$ is smooth, \item the deformation category $\Deformationcategory_X$ is unobstructed. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-big-smooth-part-curves} The open substack $$ \Curvesstack^{lci+} = \Curvesstack^{lci} \cap \Curvesstack^{+} \subset \Curvesstack $$ has the following properties \begin{enumerate} \item $\Curvesstack^{lci+} \to \Spec(\mathbf{Z})$ is smooth, \item given a family of curves $X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack^{lci+}$, \item $X \to S$ is a local complete intersection morphism and the singular locus of $X \to S$ endowed with any/some closed subspace structure is finite over $S$, \end{enumerate} \item given $X$ a proper scheme over a field $k$ of dimension $\leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\Curvesstack^{lci+}$, \item $X$ is a local complete intersection over $k$ and $X \to \Spec(k)$ is smooth except at finitely many points. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-smooth-curves} There exist an open substacks $$ \Curvesstack^{smooth, 1} \subset \Curvesstack^{smooth} \subset \Curvesstack $$ such that \begin{enumerate} \item given a family of curves $f : X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack^{smooth}$, resp.\ $\Curvesstack^{smooth, 1}$, \item $f$ is smooth, resp.\ smooth of relative dimension $1$, \end{enumerate} \item given $X$ a scheme proper over a field $k$ with $\dim(X) \leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\Curvesstack^{smooth}$, resp.\ $\Curvesstack^{smooth, 1}$, \item $X$ is smooth over $k$, resp.\ $X$ is smooth over $k$ and $X$ is equidimensional of dimension $1$. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-smooth-curves-smooth} The morphism $\Curvesstack^{smooth} \to \Spec(\mathbf{Z})$ is smooth. \end{lemma} 
\begin{lemma} \label{lemma-smooth-curves-h0} There exist an open substack $\Curvesstack^{smooth, h0} \subset \Curvesstack$ such that \begin{enumerate} \item given a family of curves $f : X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack^{smooth}$, \item $f_*\mathcal{O}_X = \mathcal{O}_S$, this holds after any base change, and $f$ is smooth of relative dimension $1$, \end{enumerate} \item given $X$ a scheme proper over a field $k$ with $\dim(X) \leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\Curvesstack^{smooth, h0}$, \item $X$ is smooth, $\dim(X) = 1$, and $k = H^0(X, \mathcal{O}_X)$, \item $X$ is smooth, $\dim(X) = 1$, and $X$ is geometrically connected, \item $X$ is smooth, $\dim(X) = 1$, and $X$ is geometrically integral, and \item $X_{\overline{k}}$ is a smooth curve. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-deligne-mumford-smooth} \begin{reference} \cite{DM} \end{reference} We denote $\mathcal{M}$ and we name it the {\it moduli stack of smooth proper curves} the algebraic stack $\Curvesstack^{smooth, h0}$ parametrizing families of curves introduced in Lemma \ref{lemma-smooth-curves-h0}. For $g \geq 0$ we denote $\mathcal{M}_g$ and we name it the {\it moduli stack of smooth proper curves of genus $g$} the algebraic stack introduced in Lemma \ref{lemma-smooth-one-piece-per-genus}. \end{definition} 
\begin{lemma} \label{lemma-smooth-one-piece-per-genus} There is a decomposition into open and closed substacks $$ \mathcal{M} = \coprod\nolimits_{g \geq 0} \mathcal{M}_g $$ where each $\mathcal{M}_g$ is characterized as follows: \begin{enumerate} \item given a family of curves $f : X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\mathcal{M}_g$, \item $X \to S$ is smooth, $f_*\mathcal{O}_X = \mathcal{O}_S$, this holds after any base change, and $R^1f_*\mathcal{O}_X$ is a locally free $\mathcal{O}_S$-module of rank $g$, \end{enumerate} \item given $X$ a scheme proper over a field $k$ with $\dim(X) \leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\mathcal{M}_g$, \item $X$ is smooth, $\dim(X) = 1$, $k = H^0(X, \mathcal{O}_X)$, and $X$ has genus $g$, \item $X$ is smooth, $\dim(X) = 1$, $X$ is geometrically connected, and $X$ has genus $g$, \item $X$ is smooth, $\dim(X) = 1$, $X$ is geometrically integral, and $X$ has genus $g$, and \item $X_{\overline{k}}$ is a smooth curve of genus $g$. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-smooth-curves-h0-smooth} The morphisms $\mathcal{M} \to \Spec(\mathbf{Z})$ and $\mathcal{M}_g \to \Spec(\mathbf{Z})$ are smooth. \end{lemma} 
\begin{lemma} \label{lemma-smooth-dense} The inclusion $$ |\Curvesstack^{smooth}| \subset |\Curvesstack^{lci+}| $$ is that of an open dense subset. \end{lemma} 
\begin{lemma} \label{lemma-nodal-curves} There exist an open substack $\Curvesstack^{nodal} \subset \Curvesstack$ such that \begin{enumerate} \item given a family of curves $f : X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack^{nodal}$, \item $f$ is at-worst-nodal of relative dimension $1$, \end{enumerate} \item given $X$ a scheme proper over a field $k$ with $\dim(X) \leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\Curvesstack^{nodal}$, \item the singularities of $X$ are at-worst-nodal and $X$ is equidimensional of dimension $1$. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-nodal-curves-smooth} The morphism $\Curvesstack^{nodal} \to \Spec(\mathbf{Z})$ is smooth. \end{lemma} 
\begin{lemma} \label{lemma-CM-dualizing} Let $X \to S$ be a family of curves with Cohen-Macaulay fibres equidimensional of dimension $1$ (Lemma \ref{lemma-CM-1-curves}). Then $\omega_{X/S}^\bullet = \omega_{X/S}[1]$ where $\omega_{X/S}$ is a pseudo-coherent $\mathcal{O}_X$-module flat over $S$ whose formation commutes with arbitrary base change. \end{lemma} 
\begin{definition} \label{definition-relative-dualizing-sheaf} Let $f : X \to S$ be a family of curves with Cohen-Macaulay fibres equidimensional of dimension $1$ (Lemma \ref{lemma-CM-1-curves}). Then the $\mathcal{O}_X$-module $$ \omega_{X/S} = H^{-1}(\omega_{X/S}^\bullet) $$ studied in Lemma \ref{lemma-CM-dualizing} is called the {\it relative dualizing sheaf} of $f$. \end{definition} 
\begin{lemma} \label{lemma-gorenstein-dualizing} Let $X \to S$ be a family of curves with Gorenstein fibres equidimensional of dimension $1$ (Lemma \ref{lemma-gorenstein-1-curves}). Then the relative dualizing sheaf $\omega_{X/S}$ is an invertible $\mathcal{O}_X$-module whose formation commutes with arbitrary base change. \end{lemma} 
\begin{definition} \label{definition-prestable} Let $f : X \to S$ be a family of curves. We say $f$ is a {\it prestable family of curves} if \begin{enumerate} \item $f$ is at-worst-nodal of relative dimension $1$, and \item $f_*\mathcal{O}_X = \mathcal{O}_S$ and this holds after any base change\footnote{In fact, it suffices to require $f_*\mathcal{O}_X = \mathcal{O}_S$ because the Stein factorization of $f$ is \'etale in this case, see More on Morphisms of Spaces, Lemma \ref{spaces-more-morphisms-lemma-stein-factorization-etale}. The condition may also be replaced by asking the geometric fibres to be connected, see Lemma \ref{lemma-geomredcon-in-h0-1}.}. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-prestable-curves} There exist an open substack $\Curvesstack^{prestable} \subset \Curvesstack$ such that \begin{enumerate} \item given a family of curves $f : X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack^{prestable}$, \item $X \to S$ is a prestable family of curves, \end{enumerate} \item given $X$ a scheme proper over a field $k$ with $\dim(X) \leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\Curvesstack^{prestable}$, \item the singularities of $X$ are at-worst-nodal, $\dim(X) = 1$, and $k = H^0(X, \mathcal{O}_X)$. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-prestable-one-piece-per-genus} There is a decomposition into open and closed substacks $$ \Curvesstack^{prestable} = \coprod\nolimits_{g \geq 0} \Curvesstack^{prestable}_g $$ where each $\Curvesstack^{prestable}_g$ is characterized as follows: \begin{enumerate} \item given a family of curves $f : X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack^{prestable}_g$, \item $X \to S$ is a prestable family of curves and $R^1f_*\mathcal{O}_X$ is a locally free $\mathcal{O}_S$-module of rank $g$, \end{enumerate} \item given $X$ a scheme proper over a field $k$ with $\dim(X) \leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\Curvesstack^{prestable}_g$, \item the singularities of $X$ are at-worst-nodal, $\dim(X) = 1$, $k = H^0(X, \mathcal{O}_X)$, and the genus of $X$ is $g$. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-prestable-curves-smooth} The morphisms $\Curvesstack^{prestable} \to \Spec(\mathbf{Z})$ and $\Curvesstack^{prestable}_g \to \Spec(\mathbf{Z})$ are smooth. \end{lemma} 
\begin{lemma} \label{lemma-semistable} Let $f : X \to S$ be a prestable family of curves of genus $g \geq 1$. Let $s \in S$ be a point of the base scheme. Let $m \geq 2$. The following are equivalent \begin{enumerate} \item $X_s$ does not have a rational tail (Algebraic Curves, Example \ref{curves-example-rational-tail}), and \item $f^*f_*\omega_{X/S}^{\otimes m} \to \omega_{X/S}^{\otimes m}$, is surjective over $f^{-1}(U)$ for some $s \in U \subset S$ open. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-semistable} Let $f : X \to S$ be a family of curves. We say $f$ is a {\it semistable family of curves} if \begin{enumerate} \item $X \to S$ is a prestable family of curves, and \item $X_s$ has genus $\geq 1$ and does not have a rational tail for all $s \in S$. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-semistable-curves} There exist an open substack $\Curvesstack^{semistable} \subset \Curvesstack$ such that \begin{enumerate} \item given a family of curves $f : X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack^{semistable}$, \item $X \to S$ is a semistable family of curves, \end{enumerate} \item given $X$ a scheme proper over a field $k$ with $\dim(X) \leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\Curvesstack^{semistable}$, \item the singularities of $X$ are at-worst-nodal, $\dim(X) = 1$, $k = H^0(X, \mathcal{O}_X)$, the genus of $X$ is $\geq 1$, and $X$ has no rational tails, \item the singularities of $X$ are at-worst-nodal, $\dim(X) = 1$, $k = H^0(X, \mathcal{O}_X)$, and $\omega_{X_s}^{\otimes m}$ is globally generated for $m \geq 2$. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-semistable-one-piece-per-genus} There is a decomposition into open and closed substacks $$ \Curvesstack^{semistable} = \coprod\nolimits_{g \geq 1} \Curvesstack^{semistable}_g $$ where each $\Curvesstack^{semistable}_g$ is characterized as follows: \begin{enumerate} \item given a family of curves $f : X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack^{semistable}_g$, \item $X \to S$ is a semistable family of curves and $R^1f_*\mathcal{O}_X$ is a locally free $\mathcal{O}_S$-module of rank $g$, \end{enumerate} \item given $X$ a scheme proper over a field $k$ with $\dim(X) \leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\Curvesstack^{semistable}_g$, \item the singularities of $X$ are at-worst-nodal, $\dim(X) = 1$, $k = H^0(X, \mathcal{O}_X)$, the genus of $X$ is $g$, and $X$ has no rational tail, \item the singularities of $X$ are at-worst-nodal, $\dim(X) = 1$, $k = H^0(X, \mathcal{O}_X)$, the genus of $X$ is $g$, and $\omega_{X_s}^{\otimes m}$ is globally generated for $m \geq 2$. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-semistable-curves-smooth} The morphisms $\Curvesstack^{semistable} \to \Spec(\mathbf{Z})$ and $\Curvesstack^{semistable}_g \to \Spec(\mathbf{Z})$ are smooth. \end{lemma} 
\begin{lemma} \label{lemma-stable} Let $f : X \to S$ be a prestable family of curves of genus $g \geq 2$. Let $s \in S$ be a point of the base scheme. The following are equivalent \begin{enumerate} \item $X_s$ does not have a rational tail and does not have a rational bridge (Algebraic Curves, Examples \ref{curves-example-rational-tail} and \ref{curves-example-rational-bridge}), and \item $\omega_{X/S}$ is ample on $f^{-1}(U)$ for some $s \in U \subset S$ open. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-stable} Let $f : X \to S$ be a family of curves. We say $f$ is a {\it stable family of curves} if \begin{enumerate} \item $X \to S$ is a prestable family of curves, and \item $X_s$ has genus $\geq 2$ and does not have a rational tails or bridges for all $s \in S$. \end{enumerate} \end{definition} 
\begin{lemma} \label{lemma-stable-curves} There exist an open substack $\Curvesstack^{stable} \subset \Curvesstack$ such that \begin{enumerate} \item given a family of curves $f : X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\Curvesstack^{stable}$, \item $X \to S$ is a stable family of curves, \end{enumerate} \item given $X$ a scheme proper over a field $k$ with $\dim(X) \leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\Curvesstack^{stable}$, \item the singularities of $X$ are at-worst-nodal, $\dim(X) = 1$, $k = H^0(X, \mathcal{O}_X)$, the genus of $X$ is $\geq 2$, and $X$ has no rational tails or bridges, \item the singularities of $X$ are at-worst-nodal, $\dim(X) = 1$, $k = H^0(X, \mathcal{O}_X)$, and $\omega_{X_s}$ is ample. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-deligne-mumford} \begin{reference} \cite{DM} \end{reference} We denote $\overline{\mathcal{M}}$ and we name the {\it moduli stack of stable curves} the algebraic stack $\Curvesstack^{stable}$ parametrizing stable families of curves introduced in Lemma \ref{lemma-stable-curves}. For $g \geq 2$ we denote $\overline{\mathcal{M}}_g$ and we name the {\it moduli stack of stable curves of genus $g$} the algebraic stack introduced in Lemma \ref{lemma-stable-one-piece-per-genus}. \end{definition} 
\begin{lemma} \label{lemma-stable-one-piece-per-genus} There is a decomposition into open and closed substacks $$ \overline{\mathcal{M}} = \coprod\nolimits_{g \geq 2} \overline{\mathcal{M}}_g $$ where each $\overline{\mathcal{M}}_g$ is characterized as follows: \begin{enumerate} \item given a family of curves $f : X \to S$ the following are equivalent \begin{enumerate} \item the classifying morphism $S \to \Curvesstack$ factors through $\overline{\mathcal{M}}_g$, \item $X \to S$ is a stable family of curves and $R^1f_*\mathcal{O}_X$ is a locally free $\mathcal{O}_S$-module of rank $g$, \end{enumerate} \item given $X$ a scheme proper over a field $k$ with $\dim(X) \leq 1$ the following are equivalent \begin{enumerate} \item the classifying morphism $\Spec(k) \to \Curvesstack$ factors through $\overline{\mathcal{M}}_g$, \item the singularities of $X$ are at-worst-nodal, $\dim(X) = 1$, $k = H^0(X, \mathcal{O}_X)$, the genus of $X$ is $g$, and $X$ has no rational tails or bridges. \item the singularities of $X$ are at-worst-nodal, $\dim(X) = 1$, $k = H^0(X, \mathcal{O}_X)$, the genus of $X$ is $g$, and $\omega_{X_s}$ is ample. \end{enumerate} \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-stable-curves-smooth} The morphisms $\overline{\mathcal{M}} \to \Spec(\mathbf{Z})$ and $\overline{\mathcal{M}}_g \to \Spec(\mathbf{Z})$ are smooth. \end{lemma} 
\begin{lemma} \label{lemma-stable-curves-deligne-mumford} The stacks $\overline{\mathcal{M}}$ and $\overline{\mathcal{M}}_g$ are open substacks of $\Curvesstack^{DM}$. In particular, $\overline{\mathcal{M}}$ and $\overline{\mathcal{M}}_g$ are DM (Morphisms of Stacks, Definition \ref{stacks-morphisms-definition-absolute-separated}) as well as Deligne-Mumford stacks (Algebraic Stacks, Definition \ref{algebraic-definition-deligne-mumford}). \end{lemma} 
\begin{lemma} \label{lemma-smooth-dense-in-stable} Let $g \geq 2$. The inclusion $$ |\mathcal{M}_g| \subset |\overline{\mathcal{M}}_g| $$ is that of an open dense subset. \end{lemma} 
\begin{lemma} \label{lemma-contract} Let $S$ be a scheme and $s \in S$ a point. Let $f : X \to S$ and $g : Y \to S$ be families of curves. Let $c : X \to Y$ be a morphism over $S$. If $c_{s, *}\mathcal{O}_{X_s} = \mathcal{O}_{Y_s}$ and $R^1c_{s, *}\mathcal{O}_{X_s} = 0$, then after replacing $S$ by an open neighbourhood of $s$ we have $\mathcal{O}_Y = c_*\mathcal{O}_X$ and $R^1c_*\mathcal{O}_X = 0$ and this remains true after base change by any morphism $S' \to S$. \end{lemma} 
\begin{lemma} \label{lemma-contract-basic-uniqueness} Let $S$ be a scheme and $s \in S$ a point. Let $f : X \to S$ and $g_i : Y_i \to S$, $i = 1, 2$ be families of curves. Let $c_i : X \to Y_i$ be morphisms over $S$. Assume there is an isomorphism $Y_{1, s} \cong Y_{2, s}$ of fibres compatible with $c_{1, s}$ and $c_{2, s}$. If $c_{1, s, *}\mathcal{O}_{X_s} = \mathcal{O}_{Y_{1, s}}$ and $R^1c_{1, s, *}\mathcal{O}_{X_s} = 0$, then there exist an open neighbourhood $U$ of $s$ and an isomorphism $Y_{1, U} \cong Y_{2, U}$ of families of curves over $U$ compatible with the given isomorphism of fibres and with $c_1$ and $c_2$. \end{lemma} 
\begin{lemma} \label{lemma-contract-basic} Let $f : X \to S$ be a family of curves. Let $s \in S$ be a point. Let $h_0 : X_s \to Y_0$ be a morphism to a proper scheme $Y_0$ over $\kappa(s)$ such that $h_{0, *}\mathcal{O}_{X_s} = \mathcal{O}_{Y_0}$ and $R^1h_{0, *}\mathcal{O}_{X_s} = 0$. Then there exist an elementary \'etale neighbourhood $(U, u) \to (S, s)$, a family of curves $Y \to U$, and a morphism $h : X_U \to Y$ over $U$ whose fibre in $u$ is isomorphic to $h_0$. \end{lemma} 
\begin{lemma} \label{lemma-contract-prestable-to-stable} Let $f : X \to S$ be a prestable family of curves of genus $g \geq 2$. There is a factorization $X \to Y \to S$ of $f$ where $g : Y \to S$ is a stable family of curves and $c : X \to Y$ has the following properties \begin{enumerate} \item $\mathcal{O}_Y = c_*\mathcal{O}_X$ and $R^1c_*\mathcal{O}_X = 0$ and this remains true after base change by any morphism $S' \to S$, and \item for any $s \in S$ the morphism $c_s : X_s \to Y_s$ is the contraction of rational tails and bridges discussed in Algebraic Curves, Section \ref{curves-section-contracting-to-stable}. \end{enumerate} Moreover $c : X \to Y$ is unique up to unique isomorphism. \end{lemma} 
\begin{lemma} \label{lemma-stabilization-morphism} Let $g \geq 2$. There is a morphism of algebraic stacks over $\mathbf{Z}$ $$ stabilization : \Curvesstack^{prestable}_g \longrightarrow \overline{\mathcal{M}}_g $$ which sends a prestable family of curves $X \to S$ of genus $g$ to the stable family $Y \to S$ associated to it in Lemma \ref{lemma-contract-prestable-to-stable}. \end{lemma} 
\begin{lemma} \label{lemma-stable-reduction} Let $R$ be a discrete valuation ring with fraction field $K$. Let $C$ be a smooth projective curve over $K$ with $K = H^0(C, \mathcal{O}_C)$ having genus $g \geq 2$. The following are equivalent \begin{enumerate} \item $C$ has semistable reduction (Semistable Reduction, Definition \ref{models-definition-semistable}), or \item there is a stable family of curves over $R$ with generic fibre $C$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-unique-stable-model} Let $R$ be a discrete valuation ring with fraction field $K$. Let $C$ be a smooth proper curve over $K$ with $K = H^0(C, \mathcal{O}_C)$ and genus $g$. If $X$ and $X'$ are models of $C$ (Semistable Reduction, Section \ref{models-section-models}) and $X$ and $X'$ are stable families of genus $g$ curves over $R$, then there exists an unique isomorphism $X \to X'$ of models. \end{lemma} 
\begin{theorem} \label{theorem-stable-reduction} \begin{reference} \cite[Corollary 2.7]{DM} \end{reference} Let $R$ be a discrete valuation ring with fraction field $K$. Let $C$ be a smooth projective curve over $K$ with $H^0(C, \mathcal{O}_C) = K$ and genus $g \geq 2$. Then \begin{enumerate} \item there exists an extension of discrete valuation rings $R \subset R'$ inducing a finite separable extension of fraction fields $K'/K$ and a stable family of curves $Y \to \Spec(R')$ of genus $g$ with $Y_{K'} \cong C_{K'}$ over $K'$, and \item there exists a finite separable extension $L/K$ and a stable family of curves $Y \to \Spec(A)$ of genus $g$ where $A \subset L$ is the integral closure of $R$ in $L$ such that $Y_L \cong C_L$ over $L$. \end{enumerate} \end{theorem} 
\begin{lemma} \label{lemma-stable-separated} Let $g \geq 2$. The stack $\overline{\mathcal{M}}_g$ is separated. \end{lemma} 
\begin{lemma} \label{lemma-stable-quasi-compact} Let $g \geq 2$. The stack $\overline{\mathcal{M}}_g$ is quasi-compact. \end{lemma} 
\begin{theorem} \label{theorem-stable-smooth-proper} Let $g \geq 2$. The algebraic stack $\overline{\mathcal{M}}_g$ is a Deligne-Mumford stack, proper and smooth over $\Spec(\mathbf{Z})$. Moreover, the locus $\mathcal{M}_g$ parametrizing smooth curves is a dense open substack. \end{theorem} 
