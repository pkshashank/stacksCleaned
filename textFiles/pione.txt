\begin{definition} \label{definition-G-set-continuous} Let $G$ be a topological group. A {\it $G$-set}, sometimes called a {\it discrete $G$-set}, is a set $X$ endowed with a left action $a : G \times X \to X$ such that $a$ is continuous when $X$ is given the discrete topology and $G \times X$ the product topology. A {\it morphism of $G$-sets} $f : X \to Y$ is simply any $G$-equivariant map from $X$ to $Y$. The category of $G$-sets is denoted {\it $G\textit{-Sets}$}. \end{definition} 
\begin{lemma} \label{lemma-sheaves-point} Let $K$ be a field. Let $K^{sep}$ be a separable closure of $K$. Consider the profinite group $G = \text{Gal}(K^{sep}/K)$. The functor $$ \begin{matrix} \text{schemes \'etale over }K & \longrightarrow & G\textit{-Sets} \\ X/K & \longmapsto & \Mor_{\Spec(K)}(\Spec(K^{sep}), X) \end{matrix} $$ is an equivalence of categories. \end{lemma} 
\begin{lemma} \label{lemma-aut-inverse-limit} Let $\mathcal{C}$ be a category and let $F : \mathcal{C} \to \textit{Sets}$ be a functor. The map (\ref{equation-embedding-product}) identifies $\text{Aut}(F)$ with a closed subgroup of $\prod_{X \in \Ob(\mathcal{C})} \text{Aut}(F(X))$. In particular, if $F(X)$ is finite for all $X$, then $\text{Aut}(F)$ is a profinite group. \end{lemma} 
\begin{lemma} \label{lemma-single-out-profinite} Let $G$ be a topological group. The automorphism group of the functor (\ref{equation-forgetful}) endowed with its profinite topology from Lemma \ref{lemma-aut-inverse-limit} is the profinite completion of $G$. \end{lemma} 
\begin{lemma} \label{lemma-second-fundamental-functor} Let $G$ be a topological group. Let $F : \textit{Finite-}G\textit{-Sets} \to \textit{Sets}$ be an exact functor with $F(X)$ finite for all $X$. Then $F$ is isomorphic to the functor (\ref{equation-forgetful}). \end{lemma} 
\begin{definition} \label{definition-galois-category} \begin{reference} Different from the definition in \cite[Expos\'e V, Definition 5.1]{SGA1}. Compare with \cite[Definition 7.2.1]{BS}. \end{reference} Let $\mathcal{C}$ be a category and let $F : \mathcal{C} \to \textit{Sets}$ be a functor. The pair $(\mathcal{C}, F)$ is a {\it Galois category} if \begin{enumerate} \item $\mathcal{C}$ has finite limits and finite colimits, \item \label{item-connected-components} every object of $\mathcal{C}$ is a finite (possibly empty) coproduct of connected objects, \item $F(X)$ is finite for all $X \in \Ob(\mathcal{C})$, and \item $F$ reflects isomorphisms\footnote{Namely, given a morphism $f$ of $\mathcal{C}$ if $F(f)$ is an isomorphism, then $f$ is an isomorphism.} and is exact\footnote{This means that $F$ commutes with finite limits and colimits, see Categories, Section \ref{categories-section-exact-functor}.}. \end{enumerate} Here we say $X \in \Ob(\mathcal{C})$ is connected if it is not initial and for any monomorphism $Y \to X$ either $Y$ is initial or $Y \to X$ is an isomorphism. \end{definition} 
\begin{lemma} \label{lemma-epi-mono} Let $(\mathcal{C}, F)$ be a Galois category. Let $X \to Y \in \text{Arrows}(\mathcal{C})$. Then \begin{enumerate} \item $F$ is faithful, \item $X \to Y$ is a monomorphism $\Leftrightarrow F(X) \to F(Y)$ is injective, \item $X \to Y$ is an epimorphism $\Leftrightarrow F(X) \to F(Y)$ is surjective, \item an object $A$ of $\mathcal{C}$ is initial if and only if $F(A) = \emptyset$, \item an object $Z$ of $\mathcal{C}$ is final if and only if $F(Z)$ is a singleton, \item if $X$ and $Y$ are connected, then $X \to Y$ is an epimorphism, \item \label{item-one-element} if $X$ is connected and $a, b : X \to Y$ are two morphisms then $a = b$ as soon as $F(a)$ and $F(b)$ agree on one element of $F(X)$, \item if $X = \coprod_{i = 1, \ldots, n} X_i$ and $Y = \coprod_{j = 1, \ldots, m} Y_j$ where $X_i$, $Y_j$ are connected, then there is map $\alpha : \{1, \ldots, n\} \to \{1, \ldots, m\}$ such that $X \to Y$ comes from a collection of morphisms $X_i \to Y_{\alpha(i)}$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-galois} Let $(\mathcal{C}, F)$ be a Galois category. For any connected object $X$ of $\mathcal{C}$ there exists a Galois object $Y$ and a morphism $Y \to X$. \end{lemma} 
\begin{lemma} \label{lemma-tame} \begin{reference} Compare with \cite[Definition 7.2.4]{BS}. \end{reference} Let $(\mathcal{C}, F)$ be a Galois category. Let $G = \text{Aut}(F)$ be as in Example \ref{example-from-C-F-to-G-sets}. For any connected $X$ in $\mathcal{C}$ the action of $G$ on $F(X)$ is transitive. \end{lemma} 
\begin{proposition} \label{proposition-galois} \begin{reference} This is a weak version of \cite[Expos\'e V]{SGA1}. The proof is borrowed from \cite[Theorem 7.2.5]{BS}. \end{reference} Let $(\mathcal{C}, F)$ be a Galois category. Let $G = \text{Aut}(F)$ be as in Example \ref{example-from-C-F-to-G-sets}. The functor $F : \mathcal{C} \to \textit{Finite-}G\textit{-Sets}$ (\ref{equation-remember}) an equivalence. \end{proposition} 
\begin{lemma} \label{lemma-functoriality-galois} Let $(\mathcal{C}, F)$ and $(\mathcal{C}', F')$ be Galois categories. Let $H : \mathcal{C} \to \mathcal{C}'$ be an exact functor. There exists an isomorphism $t : F' \circ H \to F$. The choice of $t$ determines a continuous homomorphism $h : G' = \text{Aut}(F') \to \text{Aut}(F) = G$ and a $2$-commutative diagram $$ \xymatrix{ \mathcal{C} \ar[r]_H \ar[d] & \mathcal{C}' \ar[d] \\ \textit{Finite-}G\textit{-Sets} \ar[r]^h & \textit{Finite-}G'\textit{-Sets} } $$ The map $h$ is independent of $t$ up to an inner automorphism of $G$. Conversely, given a continuous homomorphism $h : G' \to G$ there is an exact functor $H : \mathcal{C} \to \mathcal{C}'$ and an isomorphism $t$ recovering $h$ as above. \end{lemma} 
\begin{lemma} \label{lemma-functoriality-galois-surjective} In diagram (\ref{equation-translation}) the following are equivalent \begin{enumerate} \item $h : G' \to G$ is surjective, \item $H : \mathcal{C} \to \mathcal{C}'$ is fully faithful, \item if $X \in \Ob(\mathcal{C})$ is connected, then $H(X)$ is connected, \item if $X \in \Ob(\mathcal{C})$ is connected and there is a morphism $*' \to H(X)$ in $\mathcal{C}'$, then there is a morphism $* \to X$, and \item for any object $X$ of $\mathcal{C}$ the map $\Mor_\mathcal{C}(*, X) \to \Mor_{\mathcal{C}'}(*', H(X))$ is bijective. \end{enumerate} Here $*$ and $*'$ are final objects of $\mathcal{C}$ and $\mathcal{C}'$. \end{lemma} 
\begin{lemma} \label{lemma-composition-trivial} In diagram (\ref{equation-translation}) the following are equivalent \begin{enumerate} \item $h \circ h'$ is trivial, and \item the image of $H' \circ H$ consists of objects isomorphic to finite coproducts of final objects. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-functoriality-galois-ses} In diagram (\ref{equation-translation}) the following are equivalent \begin{enumerate} \item the sequence $G'' \xrightarrow{h'} G' \xrightarrow{h} G \to 1$ is exact in the following sense: $h$ is surjective, $h \circ h'$ is trivial, and $\Ker(h)$ is the smallest closed normal subgroup containing $\Im(h')$, \item $H$ is fully faithful and an object $X'$ of $\mathcal{C}'$ is in the essential image of $H$ if and only if $H'(X')$ is isomorphic to a finite coproduct of final objects, and \item $H$ is fully faithful, $H \circ H'$ sends every object to a finite coproduct of final objects, and for an object $X'$ of $\mathcal{C}'$ such that $H'(X')$ is a finite coproduct of final objects there exists an object $X$ of $\mathcal{C}$ and an epimorphism $H(X) \to X'$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-functoriality-galois-injective} In diagram (\ref{equation-translation}) the following are equivalent \begin{enumerate} \item $h'$ is injective, and \item for every connected object $X''$ of $\mathcal{C}''$ there exists an object $X'$ of $\mathcal{C}'$ and a diagram $$ X'' \leftarrow Y'' \rightarrow H(X') $$ in $\mathcal{C}''$ where $Y'' \to X''$ is an epimorphism and $Y'' \to H(X')$ is a monomorphism. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-functoriality-galois-normal} In diagram (\ref{equation-translation}) the following are equivalent \begin{enumerate} \item the image of $h'$ is normal, and \item for every connected object $X'$ of $\mathcal{C}'$ such that there is a morphism from the final object of $\mathcal{C}''$ to $H'(X')$ we have that $H'(X')$ is isomorphic to a finite coproduct of final objects. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-finite-etale-covers-limits-colimits} Let $X$ be a scheme. The category $\textit{F\'Et}_X$ has finite limits and finite colimits and for any morphism $X' \to X$ the base change functor $\textit{F\'Et}_X \to \textit{F\'Et}_{X'}$ is exact. \end{lemma} 
\begin{lemma} \label{lemma-internal-hom-finite-etale} Let $X$ be a scheme. Given $U, V$ finite \'etale over $X$ there exists a scheme $W$ finite \'etale over $X$ such that $$ \Mor_X(X, W) = \Mor_X(U, V) $$ and such that the same remains true after any base change. \end{lemma} 
\begin{lemma} \label{lemma-finite-etale-connected-galois-category} Let $X$ be a connected scheme. Let $\overline{x}$ be a geometric point. The functor $$ F_{\overline{x}} : \textit{F\'Et}_X \longrightarrow \textit{Sets},\quad Y \longmapsto |Y_{\overline{x}}| $$ defines a Galois category (Definition \ref{definition-galois-category}). \end{lemma} 
\begin{definition} \label{definition-fundamental-group} Let $X$ be a connected scheme. Let $\overline{x}$ be a geometric point of $X$. The {\it fundamental group} of $X$ with {\it base point} $\overline{x}$ is the group $$ \pi_1(X, \overline{x}) = \text{Aut}(F_{\overline{x}}) $$ of automorphisms of the fibre functor $F_{\overline{x}} : \textit{F\'Et}_X \to \textit{Sets}$ endowed with its canonical profinite topology from Lemma \ref{lemma-aut-inverse-limit}. \end{definition} 
\begin{theorem} \label{theorem-fundamental-group} Let $X$ be a connected scheme. Let $\overline{x}$ be a geometric point of $X$. \begin{enumerate} \item The fibre functor $F_{\overline{x}}$ defines an equivalence of categories $$ \textit{F\'Et}_X \longrightarrow \textit{Finite-}\pi_1(X, \overline{x})\textit{-Sets} $$ \item Given a second geometric point $\overline{x}'$ of $X$ there exists an isomorphism $t : F_{\overline{x}} \to F_{\overline{x}'}$. This gives an isomorphism $\pi_1(X, \overline{x}) \to \pi_1(X, \overline{x}')$ compatible with the equivalences in (1). This isomorphism is independent of $t$ up to inner conjugation. \item Given a morphism $f : X \to Y$ of connected schemes denote $\overline{y} = f \circ \overline{x}$. There is a canonical continuous homomorphism $$ f_* : \pi_1(X, \overline{x}) \to \pi_1(Y, \overline{y}) $$ such that the diagram $$ \xymatrix{ \textit{F\'Et}_Y \ar[r]_{\text{base change}} \ar[d]_{F_{\overline{y}}} & \textit{F\'Et}_X \ar[d]^{F_{\overline{x}}} \\ \textit{Finite-}\pi_1(Y, \overline{y})\textit{-Sets} \ar[r]^{f_*} & \textit{Finite-}\pi_1(X, \overline{x})\textit{-Sets} } $$ is commutative. \end{enumerate} \end{theorem} 
\begin{lemma} \label{lemma-fundamental-group-Galois-group} Let $K$ be a field and set $X = \Spec(K)$. Let $\overline{K}$ be an algebraic closure and denote $\overline{x} : \Spec(\overline{K}) \to X$ the corresponding geometric point. Let $K^{sep} \subset \overline{K}$ be the separable algebraic closure. \begin{enumerate} \item The functor of Lemma \ref{lemma-sheaves-point} induces an equivalence $$ \textit{F\'Et}_X \longrightarrow \textit{Finite-}\text{Gal}(K^{sep}/K)\textit{-Sets}. $$ compatible with $F_{\overline{x}}$ and the functor $\textit{Finite-}\text{Gal}(K^{sep}/K)\textit{-Sets} \to \textit{Sets}$. \item This induces a canonical isomorphism $$ \text{Gal}(K^{sep}/K) \longrightarrow \pi_1(X, \overline{x}) $$ of profinite topological groups. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-what-equivalence-gives} Let $f : X \to Y$ be a morphism of quasi-compact and quasi-separated schemes such that the base change functor $\textit{F\'Et}_Y \to \textit{F\'Et}_X$ is an equivalence of categories. In this case \begin{enumerate} \item $f$ induces a homeomorphism $\pi_0(X) \to \pi_0(Y)$, \item if $X$ or equivalently $Y$ is connected, then $\pi_1(X, \overline{x}) = \pi_1(Y, \overline{y})$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-gabber} Let $(A, I)$ be a henselian pair. Set $X = \Spec(A)$ and $Z = \Spec(A/I)$. The functor $$ \textit{F\'Et}_X \longrightarrow \textit{F\'Et}_Z,\quad U \longmapsto U \times_X Z $$ is an equivalence of categories. \end{lemma} 
\begin{lemma} \label{lemma-thickening} Let $X \subset X'$ be a thickening of schemes. The functor $$ \textit{F\'Et}_{X'} \longrightarrow \textit{F\'Et}_X,\quad U' \longmapsto U' \times_{X'} X $$ is an equivalence of categories. \end{lemma} 
\begin{proposition} \label{proposition-universal-homeomorphism} Let $f : X \to Y$ be a universal homeomorphism of schemes. Then $$ \textit{F\'Et}_Y \longrightarrow \textit{F\'Et}_X,\quad V \longmapsto V \times_Y X $$ is an equivalence. Thus if $X$ and $Y$ are connected, then $f$ induces an isomorphism $\pi_1(X, \overline{x}) \to \pi_1(Y, \overline{y})$ of fundamental groups. \end{proposition} 
\begin{lemma} \label{lemma-finite-etale-on-proper-over-henselian} Let $A$ be a henselian local ring. Let $X$ be a proper scheme over $A$ with closed fibre $X_0$. Then the functor $$ \textit{F\'Et}_X \to \textit{F\'Et}_{X_0},\quad U \longmapsto U_0 = U \times_X X_0 $$ is an equivalence of categories. \end{lemma} 
\begin{lemma} \label{lemma-finite-etale-on-proper-over-henselian-pair} Let $(A, I)$ be a henselian pair. Let $X$ be a proper scheme over $A$. Set $X_0 = X \times_{\Spec(A)} \Spec(A/I)$. Then the functor $$ \textit{F\'Et}_X \to \textit{F\'Et}_{X_0},\quad U \longmapsto U_0 = U \times_X X_0 $$ is an equivalence of categories. \end{lemma} 
\begin{lemma} \label{lemma-finite-etale-invariant-over-proper} Let $k'/k$ be an extension of algebraically closed fields. Let $X$ be a proper scheme over $k$. Then the functor $$ U \longmapsto U_{k'} $$ is an equivalence of categories between schemes finite \'etale over $X$ and schemes finite \'etale over $X_{k'}$. \end{lemma} 
\begin{lemma} \label{lemma-dense-faithful} Let $f : X \to Y$ be a morphism of schemes. If $f(X)$ is dense in $Y$ then the base change functor $\textit{F\'Et}_Y \to \textit{F\'Et}_X$ is faithful. \end{lemma} 
\begin{lemma} \label{lemma-same-etale-extensions} Let $(A, \mathfrak m)$ be a local ring. Set $X = \Spec(A)$ and let $U = X \setminus \{\mathfrak m\}$. If the punctured spectrum of the strict henselization of $A$ is connected, then $$ \textit{F\'Et}_X \longrightarrow \textit{F\'Et}_U,\quad Y \longmapsto Y \times_X U $$ is a fully faithful functor. \end{lemma} 
\begin{lemma} \label{lemma-quasi-compact-dense-open-connected-at-infinity-Noetherian} Let $X$ be a scheme. Let $U \subset X$ be a dense open. Assume \begin{enumerate} \item the underlying topological space of $X$ is Noetherian, and \item for every $x \in X \setminus U$ the punctured spectrum of the strict henselization of $\mathcal{O}_{X, x}$ is connected. \end{enumerate} Then $\textit{F\'Et}_X \to \textit{F\'et}_U$ is fully faithful. \end{lemma} 
\begin{lemma} \label{lemma-retrocompact-dense-open-connected-at-infinity-closed} Let $X$ be a scheme. Let $U \subset X$ be a dense open. Assume \begin{enumerate} \item $U \to X$ is quasi-compact, \item every point of $X \setminus U$ is closed, and \item for every $x \in X \setminus U$ the punctured spectrum of the strict henselization of $\mathcal{O}_{X, x}$ is connected. \end{enumerate} Then $\textit{F\'Et}_X \to \textit{F\'et}_U$ is fully faithful. \end{lemma} 
\begin{lemma} \label{lemma-quasi-compact-dense-open-connected-at-infinity} Let $X$ be a scheme. Let $U \subset X$ be a dense open. Assume \begin{enumerate} \item every quasi-compact open of $X$ has finitely many irreducible components, \item for every $x \in X \setminus U$ the punctured spectrum of the strict henselization of $\mathcal{O}_{X, x}$ is connected. \end{enumerate} Then $\textit{F\'Et}_X \to \textit{F\'et}_U$ is fully faithful. \end{lemma} 
\begin{lemma} \label{lemma-local-exact-sequence} Let $(A, \mathfrak m)$ be a local ring. Set $X = \Spec(A)$ and $U = X \setminus \{\mathfrak m\}$. Let $U^{sh}$ be the punctured spectrum of the strict henselization $A^{sh}$ of $A$. Assume $U$ is quasi-compact and $U^{sh}$ is connected. Then the sequence $$ \pi_1(U^{sh}, \overline{u}) \to \pi_1(U, \overline{u}) \to \pi_1(X, \overline{u}) \to 1 $$ is exact in the sense of Lemma \ref{lemma-functoriality-galois-ses} part (1). \end{lemma} 
\begin{lemma} \label{lemma-irreducible-geometrically-unibranch} Let $X$ be an irreducible, geometrically unibranch scheme. For any nonempty open $U \subset X$ the canonical map $$ \pi_1(U, \overline{u}) \longrightarrow \pi_1(X, \overline{u}) $$ is surjective. The map (\ref{equation-inclusion-generic-point}) $\pi_1(\eta, \overline{\eta}) \to \pi_1(X, \overline{\eta})$ is surjective as well. \end{lemma} 
\begin{lemma} \label{lemma-exact-sequence-finite-nr-closed-pts} Let $X$ be a scheme. Let $x_1, \ldots, x_n \in X$ be a finite number of closed points such that \begin{enumerate} \item $U = X \setminus \{x_1, \ldots, x_n\}$ is connected and is a retrocompact open of $X$, and \item for each $i$ the punctured spectrum $U_i^{sh}$ of the strict henselization of $\mathcal{O}_{X, x_i}$ is connected. \end{enumerate} Then the map $\pi_1(U) \to \pi_1(X)$ is surjective and the kernel is the smallest closed normal subgroup of $\pi_1(U)$ containing the image of $\pi_1(U_i^{sh}) \to \pi_1(U)$ for $i = 1, \ldots, n$. \end{lemma} 
\begin{lemma} \label{lemma-unramified-in-L} In the situation above the following are equivalent \begin{enumerate} \item $X$ is unramified in $L$, \item $Y \to X$ is \'etale, and \item $Y \to X$ is finite \'etale. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-finite-etale-covering-normal-unramified} Let $X$ be a normal integral scheme with function field $K$. Let $Y \to X$ be a finite \'etale morphism. If $Y$ is connected, then $Y$ is an integral normal scheme and $Y$ is the normalization of $X$ in the function field of $Y$. \end{lemma} 
\begin{proposition} \label{proposition-normal} Let $X$ be a normal integral scheme with function field $K$. Then the canonical map (\ref{equation-inclusion-generic-point}) $$ \text{Gal}(K^{sep}/K) = \pi_1(\eta, \overline{\eta}) \longrightarrow \pi_1(X, \overline{\eta}) $$ is identified with the quotient map $\text{Gal}(K^{sep}/K) \to \text{Gal}(M/K)$ where $M \subset K^{sep}$ is the union of the finite subextensions $L$ such that $X$ is unramified in $L$. \end{proposition} 
\begin{lemma} \label{lemma-local-exact-sequence-normal} Let $(A, \mathfrak m)$ be a normal local ring. Set $X = \Spec(A)$. Let $A^{sh}$ be the strict henselization of $A$. Let $K$ and $K^{sh}$ be the fraction fields of $A$ and $A^{sh}$. Then the sequence $$ \pi_1(\Spec(K^{sh})) \to \pi_1(\Spec(K)) \to \pi_1(X) \to 1 $$ is exact in the sense of Lemma \ref{lemma-functoriality-galois-ses} part (1). \end{lemma} 
\begin{lemma} \label{lemma-get-algebraic-closure} Let $A$ be a normal domain whose fraction field $K$ is separably algebraically closed. Let $\mathfrak p \subset A$ be a nonzero prime ideal. Then the residue field $\kappa(\mathfrak p)$ is algebraically closed. \end{lemma} 
\begin{lemma} \label{lemma-normal-local-domain-separablly-closed-fraction-field} A normal local ring with separably closed fraction field is strictly henselian. \end{lemma} 
\begin{lemma} \label{lemma-inertia-base-change} Let $G$ be a finite group acting on a ring $R$. Let $R^G \to A$ be a ring map. Let $\mathfrak q' \subset A \otimes_{R^G} R$ be a prime lying over the prime $\mathfrak q \subset R$. Then $$ I_\mathfrak q = \{\sigma \in G \mid \sigma(\mathfrak q) = \mathfrak q\text{ and } \sigma \bmod \mathfrak q = \text{id}_{\kappa(\mathfrak q)}\} $$ is equal to $$ I_{\mathfrak q'} = \{\sigma \in G \mid \sigma(\mathfrak q') = \mathfrak q'\text{ and } \sigma \bmod \mathfrak q' = \text{id}_{\kappa(\mathfrak q')}\} $$ \end{lemma} 
\begin{lemma} \label{lemma-inertia-invariants-etale} Let $G$ be a finite group acting on a ring $R$. Let $\mathfrak q \subset R$ be a prime. Set $$ I = \{\sigma \in G \mid \sigma(\mathfrak q) = \mathfrak q \text{ and } \sigma \bmod \mathfrak q = \text{id}_\mathfrak q\} $$ Then $R^G \to R^I$ is \'etale at $R^I \cap \mathfrak q$. \end{lemma} 
\begin{lemma} \label{lemma-inertial-invariants-unramified} Let $A$ be a normal domain with fraction field $K$. Let $L/K$ be a (possibly infinite) Galois extension. Let $G = \text{Gal}(L/K)$ and let $B$ be the integral closure of $A$ in $L$. Let $\mathfrak q \subset B$. Set $$ I = \{\sigma \in G \mid \sigma(\mathfrak q) = \mathfrak q \text{ and } \sigma \bmod \mathfrak q = \text{id}_{\kappa(\mathfrak q)}\} $$ Then $(B^I)_{B^I \cap \mathfrak q}$ is a filtered colimit of \'etale $A$-algebras. \end{lemma} 
\begin{lemma} \label{lemma-identify-inertia} In the situation described above, via the isomorphism $\pi_1(U) = \text{Gal}(K^{sep}/K)$ the diagram (\ref{equation-inertia-diagram-pione}) translates into the diagram $$ \xymatrix{ I \ar[r] \ar[rd]_1 & D \ar[d] \ar[r] & \text{Gal}(K^{sep}/K) \ar[d] \\ & \text{Gal}(\kappa(\mathfrak m^{sh})/\kappa) \ar[r] & \text{Gal}(M/K) } $$ where $K^{sep}/M/K$ is the maximal subextension unramified with respect to $A$. Moreover, the vertical arrows are surjective, the kernel of the left vertical arrow is $I$ and the kernel of the right vertical arrow is the smallest closed normal subgroup of $\text{Gal}(K^{sep}/K)$ containing $I$. \end{lemma} 
\begin{lemma} \label{lemma-normal-pione-quotient-inertia} Let $X$ be a normal integral scheme with function field $K$. With notation as above, the following three subgroups of $\text{Gal}(K^{sep}/K) = \pi_1(\Spec(K))$ are equal \begin{enumerate} \item the kernel of the surjection $\text{Gal}(K^{sep}/K) \longrightarrow \pi_1(X)$, \item the smallest normal closed subgroup containing $I_y$ for all $y \in X^{sep}$, and \item the smallest normal closed subgroup containing $\text{Gal}(K^{sep}/K_x^{sh})$ for all $x \in  X$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-unramified} Let $X$ be an integral normal scheme with function field $K$. Let $L/K$ be a finite extension. Let $Y \to X$ be the normalization of $X$ in $L$. The following are equivalent \begin{enumerate} \item $X$ is unramified in $L$ as defined in Section \ref{section-normal}, \item $Y \to X$ is an unramified morphism of schemes, \item $Y \to X$ is an \'etale morphism of schemes, \item $Y \to X$ is a finite \'etale morphism of schemes, \item for $x \in X$ the projection $Y \times_X \Spec(\mathcal{O}_{X, x}) \to \Spec(\mathcal{O}_{X, x})$ is unramified, \item same as in (5) but with $\mathcal{O}_{X, x}^h$, \item same as in (5) but with $\mathcal{O}_{X, x}^{sh}$, \item for $x \in X$ the scheme theoretic fibre $Y_x$ is \'etale over $x$ of degree $\geq [L : K]$. \end{enumerate} If $L/K$ is Galois with Galois group $G$, then these are also equivalent to \begin{enumerate} \item[(9)] for $y \in Y$ the group $I_y = \{g \in G \mid g(y) = y\text{ and } g \bmod \mathfrak m_y = \text{id}_{\kappa(y)}\}$ is trivial. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-structure-decomposition} Let $A$ be a discrete valuation ring with fraction field $K$. Let $L/K$ be a (possibly infinite) Galois extension. Let $B$ be the integral closure of $A$ in $L$. Let $\mathfrak m$ be a maximal ideal of $B$. Let $G = \text{Gal}(L/K)$, $D = \{\sigma \in G \mid \sigma(\mathfrak m) = \mathfrak m\}$, and $I = \{\sigma \in D \mid \sigma \bmod \mathfrak m = \text{id}_{\kappa(\mathfrak m)}\}$. The decomposition group $D$ fits into a canonical exact sequence $$ 1 \to I \to D \to \text{Aut}(\kappa(\mathfrak m)/\kappa_A) \to 1 $$ The inertia group $I$ fits into a canonical exact sequence $$ 1 \to P \to I \to I_t \to 1 $$ such that \begin{enumerate} \item $P$ is a normal subgroup of $D$, \item $P$ is a pro-$p$-group if the characteristic of $\kappa_A$ is $p > 1$ and $P = \{1\}$ if the characteristic of $\kappa_A$ is zero, \item there is a multiplicatively directed $S \subset \mathbf{N}$ such that $\kappa(\mathfrak m)$ contains a primitive $n$th root of unity for each $n \in S$ (elements of $S$ are prime to $p$), \item there exists a canonical surjective map $$ \theta_{can} : I \to \lim_{n \in S} \mu_n(\kappa(\mathfrak m)) $$ whose kernel is $P$, which satisfies $\theta_{can}(\tau \sigma \tau^{-1}) = \tau(\theta_{can}(\sigma))$ for $\tau \in D$, $\sigma \in I$, and which induces an isomorphism $I_t \to \lim_{n \in S} \mu_n(\kappa(\mathfrak m))$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-structure-decomposition-separable-closure} Let $A$ be a discrete valuation ring with fraction field $K$. Let $K^{sep}$ be a separable closure of $K$. Let $A^{sep}$ be the integral closure of $A$ in $K^{sep}$. Let $\mathfrak m^{sep}$ be a maximal ideal of $A^{sep}$. Let $\mathfrak m = \mathfrak m^{sep} \cap A$, let $\kappa = A/\mathfrak m$, and let $\overline{\kappa} = A^{sep}/\mathfrak m^{sep}$. Then $\overline{\kappa}$ is an algebraic closure of $\kappa$. Let $G = \text{Gal}(K^{sep}/K)$, $D = \{\sigma \in G \mid \sigma(\mathfrak m^{sep}) = \mathfrak m^{sep}\}$, and $I = \{\sigma \in D \mid \sigma \bmod \mathfrak m^{sep} = \text{id}_{\kappa(\mathfrak m^{sep})}\}$. The decomposition group $D$ fits into a canonical exact sequence $$ 1 \to I \to D \to \text{Gal}(\kappa^{sep}/\kappa) \to 1 $$ where $\kappa^{sep} \subset \overline{\kappa}$ is the separable closure of $\kappa$. The inertia group $I$ fits into a canonical exact sequence $$ 1 \to P \to I \to I_t \to 1 $$ such that \begin{enumerate} \item $P$ is a normal subgroup of $D$, \item $P$ is a pro-$p$-group if the characteristic of $\kappa_A$ is $p > 1$ and $P = \{1\}$ if the characteristic of $\kappa_A$ is zero, \item there exists a canonical surjective map $$ \theta_{can} : I \to \lim_{n\text{ prime to }p} \mu_n(\kappa^{sep}) $$ whose kernel is $P$, which satisfies $\theta_{can}(\tau \sigma \tau^{-1}) = \tau(\theta_{can}(\sigma))$ for $\tau \in D$, $\sigma \in I$, and which induces an isomorphism $I_t \to \lim_{n\text{ prime to }p} \mu_n(\kappa^{sep})$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-limit} Let $I$ be a directed set. Let $X_i$ be an inverse system of quasi-compact and quasi-separated schemes over $I$ with affine transition morphisms. Let $X = \lim X_i$ as in Limits, Section \ref{limits-section-limits}. Then there is an equivalence of categories $$ \colim \textit{F\'Et}_{X_i} = \textit{F\'Et}_X $$ If $X_i$ is connected for all sufficiently large $i$ and $\overline{x}$ is a geometric point of $X$, then $$ \pi_1(X, \overline{x}) = \lim \pi_1(X_i, \overline{x}) $$ \end{lemma} 
\begin{lemma} \label{lemma-perfection} Let $k$ be a field with perfection $k^{perf}$. Let $X$ be a connected scheme over $k$. Then $X_{k^{perf}}$ is connected and $\pi_1(X_{k^{perf}}) \to \pi_1(X)$ is an isomorphism. \end{lemma} 
\begin{lemma} \label{lemma-ses-field} Let $k$ be a field with algebraic closure $\overline{k}$. Let $X$ be a quasi-compact and quasi-separated scheme over $k$. If the base change $X_{\overline{k}}$ is connected, then there is a short exact sequence $$ 1 \to \pi_1(X_{\overline{k}}) \to \pi_1(X) \to \pi_1(\Spec(k)) \to 1 $$ of profinite topological groups. \end{lemma} 
\begin{lemma} \label{lemma-stein-factorization-etale} \begin{reference} \cite[Expose X, Proposition 1.2, p. 262]{SGA1}. \end{reference} Let $f : X \to S$ be a proper morphism of schemes. Let $X \to S' \to S$ be the Stein factorization of $f$, see More on Morphisms, Theorem \ref{more-morphisms-theorem-stein-factorization-general}. If $f$ is of finite presentation, flat, with geometrically reduced fibres, then $S' \to S$ is finite \'etale. \end{lemma} 
\begin{proposition} \label{proposition-first-homotopy-sequence} Let $f : X \to S$ be a flat proper morphism of finite presentation whose geometric fibres are connected and reduced. Assume $S$ is connected and let $\overline{s}$ be a geometric point of $S$. Then there is an exact sequence $$ \pi_1(X_{\overline{s}}) \to \pi_1(X) \to \pi_1(S) \to 1 $$ of fundamental groups. \end{proposition} 
\begin{lemma} \label{lemma-specialization-map-base-change} Consider a commutative diagram $$ \xymatrix{ Y \ar[d]_g \ar[r] & X \ar[d]^f \\ T \ar[r] & S } $$ of schemes where $f$ and $g$ are proper with geometrically connected fibres. Let $t' \leadsto t$ be a specialization of points in $T$ and consider a specialization map $sp : \pi_1(Y_{\overline{t}'}) \to \pi_1(Y_{\overline{t}})$ as above. Then there is a commutative diagram $$ \xymatrix{ \pi_1(Y_{\overline{t}'}) \ar[r]_{sp} \ar[d] & \pi_1(Y_{\overline{t}}) \ar[d] \\ \pi_1(X_{\overline{s}'}) \ar[r]^{sp} & \pi_1(X_{\overline{s}}) } $$ of specialization maps where $\overline{s}$ and $\overline{s}'$ are the images of $\overline{t}$ and $\overline{t}'$. \end{lemma} 
\begin{lemma} \label{lemma-specialization-map-composition} Let $f : X \to S$ be a proper morphism with geometrically connected fibres. Let $s'' \leadsto s' \leadsto s$ be specializations of points of $S$. A composition of specialization maps $\pi_1(X_{\overline{s}''}) \to \pi_1(X_{\overline{s}'}) \to \pi_1(X_{\overline{s}})$ is a specialization map $\pi_1(X_{\overline{s}''}) \to \pi_1(X_{\overline{s}})$. \end{lemma} 
\begin{lemma} \label{lemma-specialization-map-valuation-ring} Let $f : X \to S$ be a proper morphism with geometrically connected fibres. Let $s' \leadsto s$ be a specialization of points of $S$ and let $sp : \pi_1(X_{\overline{s}'}) \to \pi_1(X_{\overline{s}})$ be a specialization map. Then there exists a strictly henselian valuation ring $R$ over $S$ with algebraically closed fraction field such that $sp$ is isomorphic to $sp_R$ defined above. \end{lemma} 
\begin{lemma} \label{lemma-specialization-map-discrete-valuation-ring} Let $f : X \to S$ be a proper morphism with geometrically connected fibres. Let $s' \leadsto s$ be a specialization of points of $S$ and let $sp : \pi_1(X_{\overline{s}'}) \to \pi_1(X_{\overline{s}})$ be a specialization map. If $S$ is Noetherian, then there exists a strictly henselian discrete valuation ring $R$ over $S$ such that $sp$ is isomorphic to $sp_R$ defined above. \end{lemma} 
\begin{lemma} \label{lemma-restriction-fully-faithful} Let $X$ be a Noetherian scheme and let $Y \subset X$ be a closed subscheme with ideal sheaf $\mathcal{I} \subset \mathcal{O}_X$. Assume the completion functor $$ \textit{Coh}(\mathcal{O}_X) \longrightarrow  \textit{Coh}(X, \mathcal{I}),\quad \mathcal{F} \longmapsto \mathcal{F}^\wedge $$ is fully faithful on the full subcategory of finite locally free objects (see above). Then the restriction functor $\textit{F\'Et}_X \to \textit{F\'Et}_Y$ is fully faithful. \end{lemma} 
\begin{lemma} \label{lemma-restriction-equivalence} Let $X$ be a Noetherian scheme and let $Y \subset X$ be a closed subscheme with ideal sheaf $\mathcal{I} \subset \mathcal{O}_X$. Assume the completion functor $$ \textit{Coh}(\mathcal{O}_X) \longrightarrow  \textit{Coh}(X, \mathcal{I}),\quad \mathcal{F} \longmapsto \mathcal{F}^\wedge $$ is an equivalence on full subcategories of finite locally free objects (see above). Then the restriction functor $\textit{F\'Et}_X \to \textit{F\'Et}_Y$ is an equivalence. \end{lemma} 
\begin{lemma} \label{lemma-restriction-fully-faithful-general} Let $X$ be a Noetherian scheme and let $Y \subset X$ be a closed subscheme with ideal sheaf $\mathcal{I} \subset \mathcal{O}_X$. Let $\mathcal{V}$ be the set of open subschemes $V \subset X$ containing $Y$ ordered by reverse inclusion. Assume the completion functor $$ \colim_\mathcal{V} \textit{Coh}(\mathcal{O}_V) \longrightarrow \textit{Coh}(X, \mathcal{I}), \quad \mathcal{F} \longmapsto \mathcal{F}^\wedge $$ defines is fully faithful on the full subcategory of finite locally free objects (see above). Then the restriction functor $\colim_\mathcal{V} \textit{F\'Et}_V \to \textit{F\'Et}_Y$ is fully faithful. \end{lemma} 
\begin{lemma} \label{lemma-restriction-equivalence-general} Let $X$ be a Noetherian scheme and let $Y \subset X$ be a closed subscheme with ideal sheaf $\mathcal{I} \subset \mathcal{O}_X$. Let $\mathcal{V}$ be the set of open subschemes $V \subset X$ containing $Y$ ordered by reverse inclusion. Assume the completion functor $$ \colim_\mathcal{V} \textit{Coh}(\mathcal{O}_V) \longrightarrow \textit{Coh}(X, \mathcal{I}), \quad \mathcal{F} \longmapsto \mathcal{F}^\wedge $$ defines an equivalence of the full subcategories of finite locally free objects (see explanation above). Then the restriction functor $$ \colim_\mathcal{V} \textit{F\'Et}_V \to \textit{F\'Et}_Y $$ is an equivalence. \end{lemma} 
\begin{lemma} \label{lemma-restriction-faithful} Let $X$ be a scheme and let $Y \subset X$ be a closed subscheme. If every connected component of $X$ meets $Y$, then the restriction functor $\textit{F\'Et}_X \to \textit{F\'Et}_Y$ is faithful. \end{lemma} 
\begin{lemma} \label{lemma-restriction-fully-faithful-special} Let $X$ be a Noetherian scheme and let $Y \subset X$ be a closed subscheme. Let $Y_n \subset X$ be the $n$th infinitesimal neighbourhood of $Y$ in $X$. Assume one of the following holds \begin{enumerate} \item $X$ is quasi-affine and $\Gamma(X, \mathcal{O}_X) \to \lim \Gamma(Y_n, \mathcal{O}_{Y_n})$ is an isomorphism, or \item $X$ has an ample invertible module $\mathcal{L}$ and $\Gamma(X, \mathcal{L}^{\otimes m}) \to \lim \Gamma(Y_n, \mathcal{L}^{\otimes m}|_{Y_n})$ is an isomorphism for all $m \gg 0$, or \item for every finite locally free $\mathcal{O}_X$-module $\mathcal{E}$ the map $\Gamma(X, \mathcal{E}) \to \lim \Gamma(Y_n, \mathcal{E}|_{Y_n})$ is an isomorphism. \end{enumerate} Then the restriction functor $\textit{F\'Et}_X \to \textit{F\'Et}_Y$ is fully faithful. \end{lemma} 
\begin{lemma} \label{lemma-restriction-fully-faithful-general-special} Let $X$ be a Noetherian scheme and let $Y \subset X$ be a closed subscheme. Let $Y_n \subset X$ be the $n$th infinitesimal neighbourhood of $Y$ in $X$. Let $\mathcal{V}$ be the set of open subschemes $V \subset X$ containing $Y$ ordered by reverse inclusion. Assume one of the following holds \begin{enumerate} \item $X$ is quasi-affine and $$ \colim_\mathcal{V} \Gamma(V, \mathcal{O}_V) \longrightarrow \lim \Gamma(Y_n, \mathcal{O}_{Y_n}) $$ is an isomorphism, or \item $X$ has an ample invertible module $\mathcal{L}$ and $$ \colim_\mathcal{V} \Gamma(V, \mathcal{L}^{\otimes m}) \longrightarrow \lim \Gamma(Y_n, \mathcal{L}^{\otimes m}|_{Y_n}) $$ is an isomorphism for all $m \gg 0$, or \item for every $V \in \mathcal{V}$ and every finite locally free $\mathcal{O}_V$-module $\mathcal{E}$ the map $$ \colim_{V' \geq V} \Gamma(V', \mathcal{E}|_{V'}) \longrightarrow \lim \Gamma(Y_n, \mathcal{E}|_{Y_n}) $$ is an isomorphism. \end{enumerate} Then the functor $$ \colim_\mathcal{V} \textit{F\'Et}_V \to \textit{F\'Et}_Y $$ is fully faithful. \end{lemma} 
\begin{lemma} \label{lemma-pushout-along-closed-immersion-and-integral} In More on Morphisms, Situation \ref{more-morphisms-situation-pushout-along-closed-immersion-and-integral}, for example if $Z \to Y$ and $Z \to X$ are closed immersions of schemes, there is an equivalence of categories $$ \textit{F\'Et}_{Y \amalg_Z X} \longrightarrow \textit{F\'Et}_Y \times_{\textit{F\'Et}_Z} \textit{F\'Et}_X $$ \end{lemma} 
\begin{lemma} \label{lemma-faithful} In Situation \ref{situation-local-lefschetz}. Assume one of the following holds \begin{enumerate} \item $\dim(A/\mathfrak p) \geq 2$ for every minimal prime $\mathfrak p \subset A$ with $f \not \in \mathfrak p$, or \item every connected component of $U$ meets $U_0$. \end{enumerate} Then $$ \textit{F\'Et}_U \longrightarrow \textit{F\'Et}_{U_0},\quad V \longmapsto V_0 = V \times_U U_0 $$ is a faithful functor. \end{lemma} 
\begin{lemma} \label{lemma-fill-in-missing} In Situation \ref{situation-local-lefschetz}. Let $V \to U$ be a finite morphism.  Let $A^\wedge$ be the $\mathfrak m$-adic completion of $A$, let $X' = \Spec(A^\wedge)$ and let $U'$ and $V'$ be the base changes of $U$ and $V$ to $X'$. If $Y' \to X'$ is a finite morphism such that $V' = Y' \times_{X'} U'$, then there exists a finite morphism $Y \to X$ such that $V = Y \times_X U$ and $Y' = Y \times_X X'$. \end{lemma} 
\begin{lemma} \label{lemma-fully-faithful-henselian-completion} In Situation \ref{situation-local-lefschetz} assume $A$ is henselian or more generally that $(A, (f))$ is a henselian pair. Let $A^\wedge$ be the $\mathfrak m$-adic completion of $A$, let $X' = \Spec(A^\wedge)$ and let $U'$ and $U'_0$ be the base changes of $U$ and $U_0$ to $X'$. If $\textit{F\'Et}_{U'} \to \textit{F\'Et}_{U'_0}$ is fully faithful, then $\textit{F\'Et}_U \to \textit{F\'Et}_{U_0}$ is fully faithful. \end{lemma} 
\begin{lemma} \label{lemma-fully-faithful-simple} In Situation \ref{situation-local-lefschetz}. Assume \begin{enumerate} \item[(a)] $A$ has a dualizing complex, \item[(b)] the pair $(A, (f))$ is henselian, \item[(c)] one of the following is true \begin{enumerate} \item[(i)] $A_f$ is $(S_2)$ and every irreducible component of $X$ not contained in $X_0$ has dimension $\geq 3$, or \item[(ii)] for every prime $\mathfrak p \subset A$, $f \not \in \mathfrak p$ we have $\text{depth}(A_\mathfrak p) + \dim(A/\mathfrak p) > 2$. \end{enumerate} \end{enumerate} Then the restriction functor $\textit{F\'Et}_U \longrightarrow \textit{F\'Et}_{U_0}$ is fully faithful. \end{lemma} 
\begin{lemma} \label{lemma-fully-faithful-minimal} \begin{reference} \cite[Corollary 1.11]{Bhatt-local} \end{reference} In Situation \ref{situation-local-lefschetz}. Assume \begin{enumerate} \item $H^1_\mathfrak m(A)$ and $H^2_\mathfrak m(A)$ are annihilated by a power of $f$, and \item $A$ is henselian or more generally $(A, (f))$ is a henselian pair. \end{enumerate} Then the restriction functor $\textit{F\'Et}_U \longrightarrow \textit{F\'Et}_{U_0}$ is fully faithful. \end{lemma} 
\begin{lemma} \label{lemma-fully-faithful} In Situation \ref{situation-local-lefschetz} assume $A$ has depth $\geq 3$ and $A$ is henselian or more generally $(A, (f))$ is a henselian pair. Then the restriction functor $\textit{F\'Et}_U \to \textit{F\'Et}_{U_0}$ is fully faithful. \end{lemma} 
\begin{lemma} \label{lemma-sections-over-punctured-spec} Let $(A, \mathfrak m)$ be a Noetherian local ring. Set $X = \Spec(A)$ and let $U = X \setminus \{\mathfrak m\}$. Let $\pi : Y \to X$ be a finite morphism such that $\text{depth}(\mathcal{O}_{Y, y}) \geq 2$ for all closed points $y \in Y$. Then $Y$ is the spectrum of $B = \mathcal{O}_Y(\pi^{-1}(U))$. \end{lemma} 
\begin{lemma} \label{lemma-reformulate-purity} Let $(A, \mathfrak m)$ be a Noetherian local ring. Set $X = \Spec(A)$ and let $U = X \setminus \{\mathfrak m\}$. Let $V$ be finite \'etale over $U$. Assume $A$ has depth $\geq 2$. The following are equivalent \begin{enumerate} \item $V = Y \times_X U$ for some $Y \to X$ finite \'etale, \item $B = \Gamma(V, \mathcal{O}_V)$ is finite \'etale over $A$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-reformulate-purity-normal} Let $(A, \mathfrak m)$ be a Noetherian local ring. Set $X = \Spec(A)$ and let $U = X \setminus \{\mathfrak m\}$. Assume $A$ is normal of dimension $\geq 2$. The functor $$ \textit{F\'Et}_U \longrightarrow \left\{ \begin{matrix} \text{finite normal }A\text{-algebras }B\text{ such} \\ \text{that }\Spec(B) \to X\text{ is \'etale over }U \end{matrix} \right\}, \quad V \longmapsto \Gamma(V, \mathcal{O}_V) $$ is an equivalence. Moreover, $V = Y \times_X U$ for some $Y \to X$ finite \'etale if and only if $B = \Gamma(V, \mathcal{O}_V)$ is finite \'etale over $A$. \end{lemma} 
\begin{lemma} \label{lemma-purity-and-completion} Let $(A, \mathfrak m)$ be a Noetherian local ring. Set $X = \Spec(A)$ and let $U = X \setminus \{\mathfrak m\}$. Let $V$ be finite \'etale over $U$. Let $A^\wedge$ be the $\mathfrak m$-adic completion of $A$, let $X' = \Spec(A^\wedge)$ and let $U'$ and $V'$ be the base changes of $U$ and $V$ to $X'$. The following are equivalent \begin{enumerate} \item $V = Y \times_X U$ for some $Y \to X$ finite \'etale, and \item $V' = Y' \times_{X'} U'$ for some $Y' \to X'$ finite \'etale. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-lift-simple} In Situation \ref{situation-local-lefschetz}. Let $V$ be finite \'etale over $U$. Assume \begin{enumerate} \item[(a)] $A$ has a dualizing complex, \item[(b)] the pair $(A, (f))$ is henselian, \item[(c)] one of the following is true \begin{enumerate} \item[(i)] $A_f$ is $(S_2)$ and every irreducible component of $X$ not contained in $X_0$ has dimension $\geq 3$, or \item[(ii)] for every prime $\mathfrak p \subset A$, $f \not \in \mathfrak p$ we have $\text{depth}(A_\mathfrak p) + \dim(A/\mathfrak p) > 2$. \end{enumerate} \item[(d)] $V_0 = V \times_U U_0$ is equal to $Y_0 \times_{X_0} U_0$ for some $Y_0 \to X_0$ finite \'etale. \end{enumerate} Then $V = Y \times_X U$ for some $Y \to X$ finite \'etale. \end{lemma} 
\begin{lemma} \label{lemma-lift-purity-general} In Situation \ref{situation-local-lefschetz}. Let $V$ be finite \'etale over $U$. Assume \begin{enumerate} \item $H^1_\mathfrak m(A)$ and $H^2_\mathfrak m(A)$ are annihilated by a power of $f$, \item $V_0 = V \times_U U_0$ is equal to $Y_0 \times_{X_0} U_0$ for some $Y_0 \to X_0$ finite \'etale. \end{enumerate} Then $V = Y \times_X U$ for some $Y \to X$ finite \'etale. \end{lemma} 
\begin{lemma} \label{lemma-lift-purity} In Situation \ref{situation-local-lefschetz}. Let $V$ be finite \'etale over $U$. Assume \begin{enumerate} \item $A$ has depth $\geq 3$, \item $V_0 = V \times_U U_0$ is equal to $Y_0 \times_{X_0} U_0$ for some $Y_0 \to X_0$ finite \'etale. \end{enumerate} Then $V = Y \times_X U$ for some $Y \to X$ finite \'etale. \end{lemma} 
\begin{lemma} \label{lemma-find-point-codim-1} Let $(A, \mathfrak m)$ be a Noetherian local ring with $\dim(A) \geq 1$. Let $f \in \mathfrak m$. Then there exist a $\mathfrak p \in V(f)$ with $\dim(A_\mathfrak p) = 1$. \end{lemma} 
\begin{lemma} \label{lemma-ramification-quasi-finite-flat} Let $f : X \to Y$ be a morphism of locally Noetherian schemes. Let $x \in X$. Assume \begin{enumerate} \item $f$ is flat, \item $f$ is quasi-finite at $x$, \item $x$ is not a generic point of an irreducible component of $X$, \item for specializations $x' \leadsto x$ with $\dim(\mathcal{O}_{X, x'}) = 1$ our $f$ is unramified at $x'$. \end{enumerate} Then $f$ is \'etale at $x$. \end{lemma} 
\begin{lemma} \label{lemma-local-purity} Let $(A, \mathfrak m)$ be a regular local ring of dimension $d \geq 2$. Set $X = \Spec(A)$ and $U = X \setminus \{\mathfrak m\}$. Then \begin{enumerate} \item the functor $\textit{F\'Et}_X \to \textit{F\'Et}_U$ is essentially surjective, i.e., purity holds for $A$, \item any finite $A \to B$ with $B$ normal which induces a finite \'etale morphism on punctured spectra is \'etale. \end{enumerate} \end{lemma} 
\begin{lemma}[Purity of branch locus] \label{lemma-purity} \begin{reference} \cite{Nagata-Purity} and \cite[Exp. X, Thm. 3.1]{SGA1} \end{reference} \begin{history} This result was first stated and proved by Zariski in geometric form in \cite{Zariski-Purity}. The generalization to nonperfect ground fields by Nagata was published as the next article in the same volume of the Proceedings of the National Academy of Sciences of the United States of America in \cite{Nagata-Remarks-Purity}. In the following year Nagata proved the result for Noetherian local rings in \cite{Nagata-Purity}. His proof uses a result of Chow which is a Bertini theorem for complete local domains, see \cite{Chow-Bertini}; the history of Bertini's theorems is discussed in Kleiman's historical article \cite{Kleiman-Bertini}. A few years later a completely different proof was found by Auslander, see \cite{Auslander-Purity}. \end{history} Let $f : X \to Y$ be a morphism of locally Noetherian schemes. Let $x \in X$ and set $y = f(x)$. Assume \begin{enumerate} \item $\mathcal{O}_{X, x}$ is normal, \item $\mathcal{O}_{Y, y}$ is regular, \item $f$ is quasi-finite at $x$, \item $\dim(\mathcal{O}_{X, x}) = \dim(\mathcal{O}_{Y, y}) \geq 1$ \item for specializations $x' \leadsto x$ with $\dim(\mathcal{O}_{X, x'}) = 1$ our $f$ is unramified at $x'$. \end{enumerate} Then $f$ is \'etale at $x$. \end{lemma} 
\begin{lemma} \label{lemma-extend-S2} Let $j : U \to X$ be an open immersion of locally Noetherian schemes such that $\text{depth}(\mathcal{O}_{X, x}) \geq 2$ for $x \not \in U$. Let $\pi : V \to U$ be finite \'etale. Then \begin{enumerate} \item $\mathcal{B} = j_*\pi_*\mathcal{O}_V$ is a reflexive coherent $\mathcal{O}_X$-algebra, set $Y = \underline{\Spec}_X(\mathcal{B})$, \item $Y \to X$ is the unique finite morphism such that $V = Y \times_X U$ and $\text{depth}(\mathcal{O}_{Y, y}) \geq 2$ for $y \in Y \setminus V$, \item $Y \to X$ is \'etale at $y$ if and only if $Y \to X$ is flat at $y$, and \item $Y \to X$ is \'etale if and only if $\mathcal{B}$ is finite locally free as an $\mathcal{O}_X$-module. \end{enumerate} Moreover, (a) the construction of $\mathcal{B}$ and $Y \to X$ commutes with base change by flat morphisms $X' \to X$ of locally Noetherian schemes, and (b) if $V' \to U'$ is a finite \'etale morphism with $U \subset U' \subset X$ open which restricts to $V \to U$ over $U$, then there is a unique isomorphism $Y' \times_X U' = V'$ over $U'$. \end{lemma} 
\begin{lemma} \label{lemma-extend-pure} Let $j : U \to X$ be an open immersion of Noetherian schemes such that purity holds for $\mathcal{O}_{X, x}$ for all $x \not \in U$. Then $$ \textit{F\'Et}_X \longrightarrow \textit{F\'Et}_U $$ is essentially surjective. \end{lemma} 
\begin{lemma} \label{lemma-faithful-general} In Situation \ref{situation-local-lefschetz}. Let $U' \subset U$ be open and contain $U_0$. Assume for $\mathfrak p \subset A$ minimal with $\mathfrak p \in U'$, $\mathfrak p \not \in U_0$ we have $\dim(A/\mathfrak p) \geq 2$. Then $$ \textit{F\'Et}_{U'} \longrightarrow \textit{F\'Et}_{U_0},\quad V' \longmapsto V_0 = V' \times_{U'} U_0 $$ is a faithful functor. Moreover, there exists a $U'$ satisfying the assumption and any smaller open $U'' \subset U'$ containing $U_0$ also satisfies this assumption. In particular, the restriction functor $$ \colim_{U_0 \subset U' \subset U\text{ open}} \textit{F\'Et}_{U'} \longrightarrow \textit{F\'Et}_{U_0} $$ is faithful. \end{lemma} 
\begin{lemma} \label{lemma-fully-faithful-general-better} In Situation \ref{situation-local-lefschetz} assume \begin{enumerate} \item $A$ has a dualizing complex and is $f$-adically complete, \item every irreducible component of $X$ not contained in $X_0$ has dimension $\geq 3$. \end{enumerate} Then the restriction functor $$ \colim_{U_0 \subset U' \subset U\text{ open}} \textit{F\'Et}_{U'} \longrightarrow \textit{F\'Et}_{U_0} $$ is fully faithful. \end{lemma} 
\begin{lemma} \label{lemma-fully-faithful-general} In Situation \ref{situation-local-lefschetz} assume \begin{enumerate} \item $A$ is $f$-adically complete, \item $f$ is a nonzerodivisor. \item $H^1_\mathfrak m(A/fA)$ is a finite $A$-module. \end{enumerate} Then the restriction functor $$ \colim_{U_0 \subset U' \subset U\text{ open}} \textit{F\'Et}_{U'} \longrightarrow \textit{F\'Et}_{U_0} $$ is fully faithful. \end{lemma} 
\begin{lemma} \label{lemma-essentially-surjective-general-better} In Situation \ref{situation-local-lefschetz} assume \begin{enumerate} \item $A$ has a dualizing complex and is $f$-adically complete, \item one of the following is true \begin{enumerate} \item $A_f$ is $(S_2)$ and every irreducible component of $X$ not contained in $X_0$ has dimension $\geq 4$, or \item if $\mathfrak p \not \in V(f)$ and $V(\mathfrak p) \cap V(f) \not = \{\mathfrak m\}$, then $\text{depth}(A_\mathfrak p) + \dim(A/\mathfrak p) > 3$. \end{enumerate} \end{enumerate} Then the restriction functor $$ \colim_{U_0 \subset U' \subset U\text{ open}} \textit{F\'Et}_{U'} \longrightarrow \textit{F\'Et}_{U_0} $$ is an equivalence. \end{lemma} 
\begin{lemma} \label{lemma-essentially-surjective-general} In Situation \ref{situation-local-lefschetz} assume \begin{enumerate} \item $A$ is $f$-adically complete, \item $f$ is a nonzerodivisor, \item $H^1_\mathfrak m(A/fA)$ and $H^2_\mathfrak m(A/fA)$ are finite $A$-modules. \end{enumerate} Then the restriction functor $$ \colim_{U_0 \subset U' \subset U\text{ open}} \textit{F\'Et}_{U'} \longrightarrow \textit{F\'Et}_{U_0} $$ is an equivalence. \end{lemma} 
\begin{lemma} \label{lemma-equivalence-better} In Situation \ref{situation-local-lefschetz} assume \begin{enumerate} \item $A$ has a dualizing complex and is $f$-adically complete, \item one of the following is true \begin{enumerate} \item $A_f$ is $(S_2)$ and every irreducible component of $X$ not contained in $X_0$ has dimension $\geq 4$, or \item if $\mathfrak p \not \in V(f)$ and $V(\mathfrak p) \cap V(f) \not = \{\mathfrak m\}$, then $\text{depth}(A_\mathfrak p) + \dim(A/\mathfrak p) > 3$. \end{enumerate} \item for every maximal ideal $\mathfrak p \subset A_f$ purity holds for $(A_f)_\mathfrak p$. \end{enumerate} Then the restriction functor $\textit{F\'Et}_U \to \textit{F\'Et}_{U_0}$ is essentially surjective. \end{lemma} 
\begin{lemma} \label{lemma-equivalence} Let $(A, \mathfrak m)$ be a Noetherian local ring. Let $f \in \mathfrak m$. Assume \begin{enumerate} \item $A$ is $f$-adically complete, \item $f$ is a nonzerodivisor, \item $H^1_\mathfrak m(A/fA)$ and $H^2_\mathfrak m(A/fA)$ are finite $A$-modules, \item for every maximal ideal $\mathfrak p \subset A_f$ purity holds for $(A_f)_\mathfrak p$. \end{enumerate} Then the restriction functor $\textit{F\'Et}_U \to \textit{F\'Et}_{U_0}$ is essentially surjective. \end{lemma} 
\begin{lemma} \label{lemma-purity-inherited-by-hypersurface-better} Let $(A, \mathfrak m)$ be a Noetherian local ring. Let $f \in \mathfrak m$. Assume \begin{enumerate} \item $A$ has a dualizing complex and is $f$-adically complete, \item one of the following is true \begin{enumerate} \item $A_f$ is $(S_2)$ and every irreducible component of $X$ not contained in $X_0$ has dimension $\geq 4$, or \item if $\mathfrak p \not \in V(f)$ and $V(\mathfrak p) \cap V(f) \not = \{\mathfrak m\}$, then $\text{depth}(A_\mathfrak p) + \dim(A/\mathfrak p) > 3$. \end{enumerate} \item for every maximal ideal $\mathfrak p \subset A_f$ purity holds for $(A_f)_\mathfrak p$, and \item purity holds for $A$. \end{enumerate} Then purity holds for $A/fA$. \end{lemma} 
\begin{lemma} \label{lemma-purity-inherited-by-hypersurface} Let $(A, \mathfrak m)$ be a Noetherian local ring. Let $f \in \mathfrak m$. Assume \begin{enumerate} \item $A$ is $f$-adically complete, \item $f$ is a nonzerodivisor, \item $H^1_\mathfrak m(A/fA)$ and $H^2_\mathfrak m(A/fA)$ are finite $A$-modules, \item for every maximal ideal $\mathfrak p \subset A_f$ purity holds for $(A_f)_\mathfrak p$, \item purity holds for $A$. \end{enumerate} Then purity holds for $A/fA$. \end{lemma} 
\begin{proposition} \label{proposition-purity-complete-intersection} Let $(A, \mathfrak m)$ be a Noetherian local ring. If $A$ is a complete intersection of dimension $\geq 3$, then purity holds for $A$ in the sense that any finite \'etale cover of the punctured spectrum extends. \end{proposition} 
\begin{lemma} \label{lemma-fully-faithful-power-series-over-depth2} Let $(A, \mathfrak m)$ be a Noetherian local ring of depth $\geq 2$. Let $B = A[[x_1, \ldots, x_d]]$ with $d \geq 1$. Set $Y = \Spec(B)$ and $Y_0 = V(x_1, \ldots, x_d)$. For any open subscheme $V \subset Y$ with $V_0 = V \cap Y_0$ equal to $Y_0 \setminus \{\mathfrak m_B\}$ the restriction functor $$ \textit{F\'Et}_V \longrightarrow \textit{F\'Et}_{V_0} $$ is fully faithful. \end{lemma} 
\begin{lemma} \label{lemma-purity-power-series-over-depth2} \begin{slogan} Ramanujam-Samuel for finite \'etale covers \end{slogan} Let $(A, \mathfrak m)$ be a Noetherian local ring of depth $\geq 2$. Let $B = A[[x_1, \ldots, x_d]]$ with $d \geq 1$. For any open $V \subset Y = \Spec(B)$ which contains \begin{enumerate} \item any prime $\mathfrak q \subset B$ such that $\mathfrak q \cap A \not = \mathfrak m$, \item the prime $\mathfrak m B$ \end{enumerate} the functor $ \textit{F\'Et}_Y \to \textit{F\'Et}_V $ is an equivalence. In particular purity holds for $B$. \end{lemma} 
\begin{lemma} \label{lemma-purity-smooth-over-depth2} Let $f : X \to S$ be a morphism of schemes. Let $U \subset X$ be an open subscheme. Assume \begin{enumerate} \item $f$ is smooth, \item $S$ is Noetherian, \item for $s \in S$ with $\text{depth}(\mathcal{O}_{S, s}) \leq 1$ we have $X_s = U_s$, \item $U_s \subset X_s$ is dense for all $s \in S$. \end{enumerate} Then $\textit{F\'Et}_X \to \textit{F\'Et}_U$ is an equivalence. \end{lemma} 
\begin{proposition} \label{proposition-purity-smooth-over-depth2} Let $A \to B$ be a local homomorphism of local Noetherian rings. Assume $A$ has depth $\geq 2$, $A \to B$ is formally smooth for the $\mathfrak m_B$-adic topology, and $\dim(B) > \dim(A)$. For any open $V \subset Y = \Spec(B)$ which contains \begin{enumerate} \item any prime $\mathfrak q \subset B$ such that $\mathfrak q \cap A \not = \mathfrak m_A$, \item the prime $\mathfrak m_A B$ \end{enumerate} the functor $\textit{F\'Et}_Y \to \textit{F\'Et}_V$ is an equivalence. In particular purity holds for $B$. \end{proposition} 
\begin{proposition} \label{proposition-lefschetz-fully-faithful} Let $k$ be a field. Let $X$ be a proper scheme over $k$. Let $\mathcal{L}$ be an ample invertible $\mathcal{O}_X$-module. Let $s \in \Gamma(X, \mathcal{L})$. Let $Y = Z(s)$ be the zero scheme of $s$. Assume that for all $x \in X \setminus Y$ we have $$ \text{depth}(\mathcal{O}_{X, x}) + \dim(\overline{\{x\}}) > 1 $$ Then the restriction functor $\textit{F\'Et}_X \to \textit{F\'Et}_Y$ is fully faithful. In fact, for any open subscheme $V \subset X$ containing $Y$ the restriction functor $\textit{F\'Et}_V \to \textit{F\'Et}_Y$ is fully faithful.  \end{proposition} 
\begin{proposition} \label{proposition-lefschetz-equivalence-general} Let $k$ be a field. Let $X$ be a proper scheme over $k$. Let $\mathcal{L}$ be an ample invertible $\mathcal{O}_X$-module. Let $s \in \Gamma(X, \mathcal{L})$. Let $Y = Z(s)$ be the zero scheme of $s$. Let $\mathcal{V}$ be the set of open subschemes of $X$ containing $Y$ ordered by reverse inclusion. Assume that for all $x \in X \setminus Y$ we have $$ \text{depth}(\mathcal{O}_{X, x}) + \dim(\overline{\{x\}}) > 2 $$ Then the restriction functor $$ \colim_\mathcal{V} \textit{F\'Et}_V \to \textit{F\'Et}_Y $$ is an equivalence. \end{proposition} 
\begin{proposition} \label{proposition-lefschetz-equivalence} Let $k$ be a field. Let $X$ be a proper scheme over $k$. Let $\mathcal{L}$ be an ample invertible $\mathcal{O}_X$-module. Let $s \in \Gamma(X, \mathcal{L})$. Let $Y = Z(s)$ be the zero scheme of $s$. Assume that for all $x \in X \setminus Y$ we have $$ \text{depth}(\mathcal{O}_{X, x}) + \dim(\overline{\{x\}}) > 2 $$ and that for $x \in X \setminus Y$ closed purity holds for $\mathcal{O}_{X, x}$. Then the restriction functor $\textit{F\'Et}_X \to \textit{F\'Et}_Y$ is an equivalence. If $X$ or equivalently $Y$ is connected, then $$ \pi_1(Y, \overline{y}) \to \pi_1(X, \overline{y}) $$ is an isomorphism for any geometric point $\overline{y}$ of $Y$. \end{proposition} 
\begin{lemma} \label{lemma-characterize-rational-singularity} Let $A$ be a Noetherian normal local domain of dimension $2$. Assume $A$ is Nagata, has a dualizing module $\omega_A$, and has a resolution of singularities $f : X \to \Spec(A)$. Let $\omega_X$ be as in Resolution of Surfaces, Remark \ref{resolve-remark-dualizing-setup}. If $\omega_X \cong \mathcal{O}_X(E)$ for some effective Cartier divisor $E \subset X$ supported on the exceptional fibre, then $A$ defines a rational singularity. If $f$ is a minimal resolution, then $E = 0$. \end{lemma} 
\begin{lemma} \label{lemma-key-purity-ramification} Let $f : X \to \Spec(A)$ be a finite type morphism. Let $x \in X$ be a point. Assume \begin{enumerate} \item $A$ is an excellent regular local ring, \item $\mathcal{O}_{X, x}$ is normal of dimension $2$, \item $f$ is \'etale outside of $\overline{\{x\}}$. \end{enumerate} Then $f$ is \'etale at $x$. \end{lemma} 
\begin{lemma}[Purity of ramification locus] \label{lemma-purity-ramification} \begin{reference} This result for complex spaces can be found on page 170 of \cite{Fischer}. In general this is \cite[Theorem 2.4]{Zong} attributed to Gabber. \end{reference} Let $f : X \to Y$ be a morphism of locally Noetherian schemes. Let $x \in X$ and set $y = f(x)$. Assume \begin{enumerate} \item $\mathcal{O}_{X, x}$ is normal of dimension $\geq 1$, \item $\mathcal{O}_{Y, y}$ is regular, \item $f$ is locally of finite type, and \item for specializations $x' \leadsto x$ with $\dim(\mathcal{O}_{X, x'}) = 1$ our $f$ is \'etale at $x'$. \end{enumerate} Then $f$ is \'etale at $x$. \end{lemma} 
\begin{lemma} \label{lemma-structure-cohomology} Let $(A, \mathfrak m)$ be a regular local ring which contains a field. Let $f : V \to \Spec(A)$ be \'etale and quasi-compact. Assume that $\mathfrak m \not \in f(V)$ and assume that $g : V \to \Spec(A) \setminus \{\mathfrak m\}$ is affine. Then $H^i(V, \mathcal{O}_V)$, $i > 0$ is isomorphic to a direct sum of copies of the injective hull of the residue field of $A$. \end{lemma} 
\begin{lemma} \label{lemma-conclude} In the situation of Lemma \ref{lemma-structure-cohomology} assume that $H^i(V, \mathcal{O}_V) = 0$ for $i \geq \dim(A) - 1$. Then $V$ is affine. \end{lemma} 
\begin{theorem} \label{theorem-global} Let $Y$ be an excellent regular scheme over a field. Let $f : X \to Y$ be a finite type morphism of schemes with $X$ normal. Let $V \subset X$ be the maximal open subscheme where $f$ is \'etale. Then the inclusion morphism $V \to X$ is affine. \end{theorem} 
\begin{lemma} \label{lemma-specialization-map-surjective} Let $f : X \to S$ be a flat proper morphism with geometrically connected fibres. Let $s' \leadsto s$ be a specialization. If $X_s$ is geometrically reduced, then the specialization map $sp : \pi_1(X_{\overline{s}'}) \to \pi_1(X_{\overline{s}})$ is surjective. \end{lemma} 
\begin{proposition} \label{proposition-specialization-map-isomorphism} Let $f : X \to S$ be a smooth proper morphism with geometrically connected fibres. Let $s' \leadsto s$ be a specialization. If the characteristic to $\kappa(s)$ is zero, then the specialization map $$ sp : \pi_1(X_{\overline{s}'}) \to \pi_1(X_{\overline{s}}) $$ is an isomorphism. \end{proposition} 
\begin{theorem} \label{theorem-specialization-map-isomorphism-prime-to-p} Let $f : X \to S$ be a smooth proper morphism with geometrically connected fibres. Let $s' \leadsto s$ be a specialization. If the characteristic of $\kappa(s)$ is $p$, then the specialization map $$ sp : \pi_1(X_{\overline{s}'}) \to \pi_1(X_{\overline{s}}) $$ is surjective and induces an isomorphism $$ \pi'_1(X_{\overline{s}'}) \cong \pi'_1(X_{\overline{s}}) $$ of the maximal prime-to-p quotients \end{theorem} 
\begin{lemma} \label{lemma-pullback-tame-codim1} Let $X' \to X$ be a morphism of locally Noetherian schemes. Let $U \subset X$ be a dense open. Assume \begin{enumerate} \item $U' = f^{-1}(U)$ is dense open in $X'$, \item for every prime divisor $Z \subset X$ with $Z \cap U = \emptyset$ the local ring $\mathcal{O}_{X, \xi}$ of $X$ at the generic point $\xi$ of $Z$ is a discrete valuation ring, \item for every prime divisor $Z' \subset X'$ with $Z' \cap U' = \emptyset$ the local ring $\mathcal{O}_{X', \xi'}$ of $X'$ at the generic point $\xi'$ of $Z'$ is a discrete valuation ring, \item if $\xi' \in X'$ is as in (3), then $\xi = f(\xi')$ is as in (2). \end{enumerate} Then if $f : Y \to U$ is finite \'etale and $Y$ is unramified, resp.\ tamely ramified over $X$ in codimension $1$, then $Y' = Y \times_X X' \to U'$ is finite \'etale and $Y'$ is unramified, resp.\ tamely ramified over $X'$ in codimension $1$. \end{lemma} 
\begin{lemma} \label{lemma-purity-one-divisor-general} Let $X$ be a locally Noetherian scheme. Let $U \subset X$ be open and dense. Let $Y \to U$ be a finite \'etale morphism. Assume \begin{enumerate} \item $Y$ is unramified over $X$ in codimension $1$, and \item $\mathcal{O}_{X, x}$ is regular for all $x \in X \setminus U$. \end{enumerate} Then there exists a finite \'etale morphism $Y' \to X$ whose restriction to $X \setminus D$ is $Y$. \end{lemma} 
\begin{lemma} \label{lemma-purity-one-divisor} Let $X$ be a locally Noetherian scheme. Let $D \subset X$ be an effective Cartier divisor such that $D$ is a regular scheme. Let $Y \to X \setminus D$ be a finite \'etale morphism. If $Y$ is unramified over $X$ in codimension $1$, then there exists a finite \'etale morphism $Y' \to X$ whose restriction to $X \setminus D$ is $Y$. \end{lemma} 
\begin{lemma}[Abhyankar's lemma for regular divisor] \label{lemma-abhyankar-one-divisor} Let $X$ be a locally Noetherian scheme. Let $D \subset X$ be an effective Cartier divisor such that $D$ is a regular scheme. Let $Y \to X \setminus D$ be a finite \'etale morphism. If $Y$ is tamely ramified over $X$ in codimension $1$, then \'etale locally on $X$ the morphism $Y \to X$ is as given as a finite disjoint union of standard tamely ramified morphisms as described in Example \ref{example-tamely-ramified}. \end{lemma} 
\begin{lemma} \label{lemma-extend-tame-covering-normal} In the situation of Lemma \ref{lemma-abhyankar-one-divisor} the normalization of $X$ in $Y$ is a finite locally free morphism $\pi : Y' \to X$ such that \begin{enumerate} \item the restriction of $Y'$ to $X \setminus D$ is isomorphic to $Y$, \item $D' = \pi^{-1}(D)_{red}$ is an effective Cartier divisor on $Y'$, and \item $D'$ is a regular scheme. \end{enumerate} Moreover, \'etale locally on $X$ the morphism $Y' \to X$ is a finite disjoint union of morphisms $$ \Spec(A[x]/(x^e - f)) \to \Spec(A) $$ where $A$ is a Noetherian ring, $f \in A$ is a nonzerodivisor with $A/fA$ regular, and $e \geq 1$ is invertible in $A$. \end{lemma} 
\begin{lemma} \label{lemma-tame-covering-split} In the situation of Lemma \ref{lemma-abhyankar-one-divisor} let $Y' \to X$ be as in Lemma \ref{lemma-extend-tame-covering-normal}. Let $R$ be a discrete valuation ring with fraction field $K$. Let $$ t : \Spec(R) \to X $$ be a morphism such that the scheme theoretic inverse image $t^{-1}D$ is the reduced closed point of $\Spec(R)$. \begin{enumerate} \item If $t|_{\Spec(K)}$ lifts to a point of $Y$, then we get a lift $t' : \Spec(R) \to Y'$ such that $Y' \to X$ is \'etale along $t'(\Spec(R))$. \item If $\Spec(K) \times_X Y$ is isomorphic to a disjoint union of copies of $\Spec(K)$, then $Y' \to X$ is finite \'etale over an open neighbourhood of $t(\Spec(R))$. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-extend-covering} Let $S$ be an integral normal Noetherian scheme with generic point $\eta$. Let $f : X \to S$ be a smooth morphism with geometrically connected fibres. Let $\sigma : S \to X$ be a section of $f$. Let $Z \to X_\eta$ be a finite \'etale Galois cover (Section \ref{section-finite-etale-under-galois}) with group $G$ of order invertible on $S$ such that $Z$ has a $\kappa(\eta)$-rational point mapping to $\sigma(\eta)$. Then there exists a finite \'etale Galois cover $Y \to X$ with group $G$ whose restriction to $X_\eta$ is $Z$. \end{lemma} 
\begin{lemma} \label{lemma-extend-covering-general} Let $S$ be a quasi-compact and quasi-separated integral normal scheme with generic point $\eta$. Let $f : X \to S$ be a quasi-compact and quasi-separated smooth morphism with geometrically connected fibres. Let $\sigma : S \to X$ be a section of $f$. Let $Z \to X_\eta$ be a finite \'etale Galois cover (Section \ref{section-finite-etale-under-galois}) with group $G$ of order invertible on $S$ such that $Z$ has a $\kappa(\eta)$-rational point mapping to $\sigma(\eta)$. Then there exists a finite \'etale Galois cover $Y \to X$ with group $G$ whose restriction to $X_\eta$ is $Z$. \end{lemma} 
\begin{lemma} \label{lemma-lower-invariant} In the situation above, if $NF(C, \varphi, \tau) > 0$, then there exist an \'etale $k$-algebra map $\varphi'$ and a surjective $k$-algebra map $\tau'$ fitting into the commutative diagram $$ \xymatrix{ & B \\ C \ar[r] & C/\varphi'(I)C \ar[u]_{\tau'} \\ k[x_1, \ldots, x_n] \ar[u]^{\varphi'} \ar[r] & A \ar[u] \ar@/_3em/[uu]_\pi } $$ with $NF(C, \varphi', \tau') < NF(C, \varphi, \tau)$. \end{lemma} 
\begin{lemma} \label{lemma-affine-etale-over-affine-space} Let $k$ be a field of characteristic $p > 0$. Let $X \to \mathbf{A}^n_k$ be an \'etale morphism with $X$ affine. Then there exists a finite \'etale morphism $X \to \mathbf{A}^n_k$. \end{lemma} 
\begin{lemma} \label{lemma-dominate-affine-space} Let $k$ be a field of characteristic $p > 0$. Let $Z \subset \mathbf{A}^n_k$ be a closed subscheme. Let $Y \to Z$ be finite \'etale. There exists a finite \'etale morphism $f : U \to \mathbf{A}^n_k$ such that there is an open and closed immersion $Y \to f^{-1}(Z)$ over $Z$. \end{lemma} 
\begin{proposition} \label{proposition-injective} Let $p$ be a prime number. Let $i : Z \to X$ be a closed immersion of connected affine schemes over $\mathbf{F}_p$. For any geometric point $\overline{z}$ of $Z$ the map $$ \pi_1(Z, \overline{z}) \to \pi_1(X, \overline{z}) $$ is injective. \end{proposition} 
