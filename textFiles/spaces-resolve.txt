\begin{lemma} \label{lemma-modification} Let $(A, \mathfrak m, \kappa)$ be a $2$-dimensional Noetherian local domain such that $U = \Spec(A) \setminus \{\mathfrak m\}$ is a normal scheme. Then any modification $f : X \to \Spec(A)$ is a morphism as in (\ref{equation-modification}). \end{lemma} 
\begin{lemma} \label{lemma-closed-immersion-on-fibre} Let $(A, \mathfrak m, \kappa)$ be a Noetherian local ring. Let $g : X \to Y$ be a morphism in the category (\ref{equation-modification}). If the induced morphism $X_\kappa \to Y_\kappa$ of special fibres is a closed immersion, then $g$ is a closed immersion. \end{lemma} 
\begin{lemma} \label{lemma-dimension-special-fibre} Let $(A, \mathfrak m, \kappa)$ be a Noetherian local domain of dimension $\geq 1$. Let $f : X \to \Spec(A)$ be a morphism of algebraic spaces. Assume at least one of the following conditions is satisfied \begin{enumerate} \item $f$ is a modification (Spaces over Fields, Definition \ref{spaces-over-fields-definition-modification}), \item $f$ is an alteration (Spaces over Fields, Definition \ref{spaces-over-fields-definition-alteration}), \item $f$ is locally of finite type, quasi-separated, $X$ is integral, and there is exactly one point of $|X|$ mapping to the generic point of $\Spec(A)$, \item $f$ is locally of finite type, $X$ is decent, and the points of $|X|$ mapping to the generic point of $\Spec(A)$ are the generic points of irreducible components of $|X|$, \item add more here. \end{enumerate} Then $\dim(X_\kappa) \leq \dim(A) - 1$. \end{lemma} 
\begin{lemma} \label{lemma-modification-of-dim-2-is-projective-over-complete} If $(A, \mathfrak m, \kappa)$ is a complete Noetherian local domain of dimension $2$, then every modification of $\Spec(A)$ is projective over $A$. \end{lemma} 
\begin{lemma} \label{lemma-equivalence} The functor $F$ (\ref{equation-equivalence}) is an equivalence. \end{lemma} 
\begin{lemma} \label{lemma-equivalence-properties} Let $X, x_i, U_i \to X, u_i$ be as in (\ref{equation-equivalence}). If $f : Y \to X$ corresponds to $g_i : Y_i \to U_i$ under $F$, then $f$ is quasi-compact, quasi-separated, separated, locally of finite presentation, of finite presentation, locally of finite type, of finite type, proper, integral, finite, if and only if $g_i$ is so for $i = 1, \ldots, n$. \end{lemma} 
\begin{lemma} \label{lemma-equivalence-fibre} Let $X, x_i, U_i \to X, u_i$ be as in (\ref{equation-equivalence}). If $f : Y \to X$ corresponds to $g_i : Y_i \to U_i$ under $F$, then $Y_{x_i} \cong (Y_i)_{u_i}$ as algebraic spaces. \end{lemma} 
\begin{definition} \label{definition-blowup-at-point} Let $S$ be a scheme. Let $X$ be a decent algebraic space over $S$. Let $x \in |X|$ be a closed point. By Decent Spaces, Lemma \ref{decent-spaces-lemma-decent-space-closed-point} we can represent $x$ by a closed immersion $i : \Spec(k) \to X$. The {\it blowing up $X' \to X$ of $X$ at $x$} means the blowing up of $X$ in the closed subspace $Z = i(\Spec(k)) \subset X$. \end{definition} 
\begin{lemma} \label{lemma-equivalence-sequence-blowups} Let $X, x_i, U_i \to X, u_i$ be as in (\ref{equation-equivalence}) and assume $f : Y \to X$ corresponds to $g_i : Y_i \to U_i$ under $F$. Then there exists a factorization $$ Y = Z_m \to Z_{m - 1} \to \ldots \to Z_1 \to Z_0 = X $$ of $f$ where $Z_{j + 1} \to Z_j$ is the blowing up of $Z_j$ at a closed point $z_j$ lying over $\{x_1, \ldots, x_n\}$ if and only if for each $i$ there exists a factorization $$ Y_i = Z_{i, m_i} \to Z_{i, m_i - 1} \to \ldots \to Z_{i, 1} \to Z_{i, 0} = U_i $$ of $g_i$ where $Z_{i, j + 1} \to Z_{i, j}$ is the blowing up of $Z_{i, j}$ at a closed point $z_{i, j}$ lying over $u_i$. \end{lemma} 
\begin{lemma} \label{lemma-make-ideal-principal} Let $S$ be a scheme. Let $X$ be a Noetherian algebraic space over $S$. Let $T \subset |X|$ be a finite set of closed points $x$ such that (1) $X$ is regular at $x$ and (2) the local ring of $X$ at $x$ has dimension $2$. Let $\mathcal{I} \subset \mathcal{O}_X$ be a quasi-coherent sheaf of ideals such that $\mathcal{O}_X/\mathcal{I}$ is supported on $T$. Then there exists a sequence $$ X_m \to X_{m - 1} \to \ldots \to X_1 \to X_0 = X $$ where $X_{j + 1} \to X_j$ is the blowing up of $X_j$ at a closed point $x_j$ lying above a point of $T$ such that $\mathcal{I}\mathcal{O}_{X_n}$ is an invertible ideal sheaf. \end{lemma} 
\begin{lemma} \label{lemma-dominate-by-blowing-up-in-points} Let $S$ be a scheme. Let $X$ be a Noetherian algebraic space over $S$. Let $T \subset |X|$ be a finite set of closed points $x$ such that (1) $X$ is regular at $x$ and (2) the local ring of $X$ at $x$ has dimension $2$. Let $f : Y \to X$ be a proper morphism of algebraic spaces which is an isomorphism over $U = X \setminus T$. Then there exists a sequence $$ X_n \to X_{n - 1} \to \ldots \to X_1 \to X_0 = X $$ where $X_{i + 1} \to X_i$ is the blowing up of $X_i$ at a closed point $x_i$ lying above a point of $T$ and a factorization $X_n \to Y \to X$ of the composition. \end{lemma} 
\begin{definition} \label{definition-normalized-blowup} Let $S$ be a scheme. Let $X$ be a decent algebraic space over $S$ satisfying the equivalent conditions of Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-prepare-normalization}. Let $x \in |X|$ be a closed point. The {\it normalized blowup of $X$ at $x$} is the composition $X'' \to X' \to X$ where $X' \to X$ is the blowup of $X$ at $x$ (Definition \ref{definition-blowup-at-point}) and $X'' \to X'$ is the normalization of $X'$. \end{definition} 
\begin{lemma} \label{lemma-Nagata-normalized-blowup} In Definition \ref{definition-normalized-blowup} if $X$ is Nagata, then the normalized blowing up of $X$ at $x$ is a normal Nagata algebraic space proper over $X$. \end{lemma} 
\begin{lemma} \label{lemma-equivalence-sequence-normalized-blowups} Let $X, x_i, U_i \to X, u_i$ be as in (\ref{equation-equivalence}) and assume $f : Y \to X$ corresponds to $g_i : Y_i \to U_i$ under $F$. Assume $X$ satisfies the equivalent conditions of Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-prepare-normalization}. Then there exists a factorization $$ Y = Z_m \to Z_{m - 1} \to \ldots \to Z_1 \to Z_0 = X $$ of $f$ where $Z_{j + 1} \to Z_j$ is the normalized blowing up of $Z_j$ at a closed point $z_j$ lying over $\{x_1, \ldots, x_n\}$ if and only if for each $i$ there exists a factorization $$ Y_i = Z_{i, m_i} \to Z_{i, m_i - 1} \to \ldots \to Z_{i, 1} \to Z_{i, 0} = U_i $$ of $g_i$ where $Z_{i, j + 1} \to Z_{i, j}$ is the normalized blowing up of $Z_{i, j}$ at a closed point $z_{i, j}$ lying over $u_i$. \end{lemma} 
\begin{lemma} \label{lemma-dominate-by-normalized-blowing-up} Let $S$ be a scheme. Let $X$ be a Noetherian Nagata algebraic space over $S$ with $\dim(X) = 2$. Let $f : Y \to X$ be a proper birational morphism. Then there exists a commutative diagram $$ \xymatrix{ X_n \ar[r] \ar[d] & X_{n - 1} \ar[r] & \ldots \ar[r] & X_1 \ar[r] & X_0 \ar[d] \\ Y \ar[rrrr]  & & & & X } $$ where $X_0 \to X$ is the normalization and where $X_{i + 1} \to X_i$ is the normalized blowing up of $X_i$ at a closed point. \end{lemma} 
\begin{lemma} \label{lemma-iso-completions} Let $(A, \mathfrak m, \kappa)$ be a local ring with finitely generated maximal ideal $\mathfrak m$. Let $X$ be a decent algebraic space over $A$. Let $Y = X \times_{\Spec(A)} \Spec(A^\wedge)$ where $A^\wedge$ is the $\mathfrak m$-adic completion of $A$. For a point $q \in |Y|$ with image $p \in |X|$ lying over the closed point of $\Spec(A)$ the map $\mathcal{O}_{X, p}^h \to \mathcal{O}_{Y, q}^h$ of henselian local rings induces an isomorphism on completions. \end{lemma} 
\begin{lemma} \label{lemma-port-regularity-to-completion} Let $(A, \mathfrak m, \kappa)$ be a Noetherian local ring. Let $X \to \Spec(A)$ be a morphism which is locally of finite type with $X$ a decent algebraic space. Set $Y = X \times_{\Spec(A)} \Spec(A^\wedge)$. Let $y \in |Y|$ with image $x \in |X|$. Then \begin{enumerate} \item if $\mathcal{O}_{Y, y}^h$ is regular, then $\mathcal{O}_{X, x}^h$ is regular, \item if $y$ is in the closed fibre, then $\mathcal{O}_{Y, y}^h$ is regular $\Leftrightarrow \mathcal{O}_{X, x}^h$ is regular, and \item If $X$ is proper over $A$, then $X$ is regular if and only if $Y$ is regular. \end{enumerate} \end{lemma} 
\begin{lemma} \label{lemma-formally-unramified} Let $(A, \mathfrak m)$ be a local Noetherian ring. Let $X$ be an algebraic space over $A$. Assume \begin{enumerate} \item $A$ is analytically unramified (Algebra, Definition \ref{algebra-definition-analytically-unramified}), \item $X$ is locally of finite type over $A$, \item $X \to \Spec(A)$ is \'etale at every point of codimension $0$ in $X$. \end{enumerate} Then the normalization of $X$ is finite over $X$. \end{lemma} 
\begin{lemma} \label{lemma-regular-alteration-implies} Let $S$ be a scheme. Let $Y$ be a Noetherian integral algebraic space over $S$. Assume there exists an alteration $f : X \to Y$ with $X$ regular. Then the normalization $Y^\nu \to Y$ is finite and $Y$ has a dense open which is regular. \end{lemma} 
\begin{lemma} \label{lemma-regular-alteration-implies-local} Let $(A, \mathfrak m, \kappa)$ be a local Noetherian domain. Assume there exists an alteration $f : X \to \Spec(A)$ with $X$ regular. Then \begin{enumerate} \item there exists a nonzero $f \in A$ such that $A_f$ is regular, \item the integral closure $B$ of $A$ in its fraction field is finite over $A$, \item the $\mathfrak m$-adic completion of $B$ is a normal ring, i.e., the completions of $B$ at its maximal ideals are normal domains, and \item the generic formal fibre of $A$ is regular. \end{enumerate} \end{lemma} 
\begin{definition} \label{definition-resolution} Let $S$ be a scheme. Let $Y$ be a Noetherian integral algebraic space over $S$. A {\it resolution of singularities} of $X$ is a modification $f : X \to Y$ such that $X$ is regular. \end{definition} 
\begin{definition} \label{definition-resolution-surface} Let $S$ be a scheme. Let $Y$ be a $2$-dimensional Noetherian integral algebraic space over $S$. We say $Y$ has a {\it resolution of singularities by normalized blowups} if there exists a sequence $$ Y_n \to X_{n - 1} \to \ldots \to Y_1 \to Y_0 \to Y $$ where \begin{enumerate} \item $Y_i$ is proper over $Y$ for $i = 0, \ldots, n$, \item $Y_0 \to Y$ is the normalization, \item $Y_i \to Y_{i - 1}$ is a normalized blowup for $i = 1, \ldots, n$, and \item $Y_n$ is regular. \end{enumerate} \end{definition} 
\begin{theorem} \label{theorem-resolve} Let $S$ be a scheme. Let $Y$ be a two dimensional integral Noetherian algebraic space over $S$. The following are equivalent \begin{enumerate} \item there exists an alteration $X \to Y$ with $X$ regular, \item there exists a resolution of singularities of $Y$, \item $Y$ has a resolution of singularities by normalized blowups, \item the normalization $Y^\nu \to Y$ is finite, $Y^\nu$ has finitely many singular points $y_1, \ldots, y_m \in |Y|$, and for each $i$ the completion of the henselian local ring $\mathcal{O}_{Y^\nu, y_i}^h$ is normal. \end{enumerate} \end{theorem} 
